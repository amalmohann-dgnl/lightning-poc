function hM(){import.meta.url,import("_").catch(()=>1);async function*c(){}}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function n(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerPolicy&&(f.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?f.credentials="include":u.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function o(u){if(u.ep)return;u.ep=!0;const f=n(u);fetch(u.href,f)}})();const zo={},Si={},db=(c,t)=>{zo.app=c,zo.platform=t,zo.user={}},fb=(c,t)=>{Si[c]&&Si[c].forEach(n=>n(t))},pb=(c={},t)=>{if(c===null)return;const n=t.split(".");for(let o=0;o<n.length;o++)c=c[n[o]]=c[n[o]]!==void 0?c[n[o]]:{};return typeof c=="object"&&c!==null?Object.keys(c).length?c:void 0:c},Ai={get(c,t,n=void 0){const o=pb(zo[c],t);return o!==void 0?o:n},has(c,t){return!!this.get(c,t)},set(c,t){zo.user[c]=t,fb(c,t)},subscribe(c,t){Si[c]=Si[c]||[],Si[c].push(t)},unsubscribe(c,t){if(t){const n=Si[c]&&Si[c].findIndex(o=>o===t);n>-1&&Si[c].splice(n,1)}else c in Si&&(Si[c]=[])},clearSubscribers(){for(const c of Object.getOwnPropertyNames(Si))delete Si[c]}},$l=(c,t)=>{const n={Info:"green",Debug:"gray",Warn:"orange",Error:"red"};return t=Array.from(t),["%c"+(t.length>1&&typeof t[0]=="string"?t.shift():c),"background-color: "+n[c]+"; color: white; padding: 2px 4px; border-radius: 2px",t]},ve={info(){Ai.get("platform","log")&&console.log.apply(console,$l("Info",arguments))},debug(){Ai.get("platform","log")&&console.debug.apply(console,$l("Debug",arguments))},error(){Ai.get("platform","log")&&console.error.apply(console,$l("Error",arguments))},warn(){Ai.get("platform","log")&&console.warn.apply(console,$l("Warn",arguments))}};class Te{static mergeNumbers(t,n,o){return t*o+n*(1-o)}static rgb(t,n,o){return(t<<16)+(n<<8)+o+255*16777216}static rgba(t,n,o,u){return(t<<16)+(n<<8)+o+(u*255|0)*16777216}static getRgbString(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256;return"rgb("+n+","+o+","+u+")"}static getRgbaString(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256,f=(t/16777216|0)/255;return"rgba("+n+","+o+","+u+","+f.toFixed(4)+")"}static getRgbaStringFromArray(t){let n=Math.floor(t[0]*255),o=Math.floor(t[1]*255),u=Math.floor(t[2]*255),f=Math.floor(t[3]*255)/255;return"rgba("+n+","+o+","+u+","+f.toFixed(4)+")"}static getRgbaComponentsNormalized(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256,f=t/16777216|0;return[n/255,o/255,u/255,f/255]}static getRgbComponentsNormalized(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256;return[n/255,o/255,u/255]}static getRgbaComponents(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256,f=t/16777216|0;return[n,o,u,f]}static getArgbNumber(t){t[0]=Math.max(0,Math.min(255,t[0])),t[1]=Math.max(0,Math.min(255,t[1])),t[2]=Math.max(0,Math.min(255,t[2])),t[3]=Math.max(0,Math.min(255,t[3]));let n=((t[3]|0)<<24)+((t[0]|0)<<16)+((t[1]|0)<<8)+(t[2]|0);return n<0&&(n=4294967295+n+1),n}static mergeColors(t,n,o){let u=(t/65536|0)%256,f=(t/256|0)%256,m=t%256,p=t/16777216|0,v=(n/65536|0)%256,w=(n/256|0)%256,C=n%256,L=n/16777216|0,E=u*o+v*(1-o),R=f*o+w*(1-o),y=m*o+C*(1-o),I=p*o+L*(1-o);return Math.round(I)*16777216+Math.round(E)*65536+Math.round(R)*256+Math.round(y)}static mergeMultiColors(t,n){let o=0,u=0,f=0,m=0,p=0,v=t.length;for(let w=0;w<v;w++){let C=(t[w]/65536|0)%256,L=(t[w]/256|0)%256,E=t[w]%256,R=t[w]/16777216|0;o+=C*n[w],u+=L*n[w],f+=E*n[w],m+=R*n[w],p+=n[w]}return p=1/p,Math.round(m*p)*16777216+Math.round(o*p)*65536+Math.round(u*p)*256+Math.round(f*p)}static mergeMultiColorsEqual(t){let n=0,o=0,u=0,f=0,m=0,p=t.length;for(let v=0;v<p;v++){let w=(t[v]/65536|0)%256,C=(t[v]/256|0)%256,L=t[v]%256,E=t[v]/16777216|0;n+=w,o+=C,u+=L,f+=E,m+=1}return m=1/m,Math.round(f*m)*16777216+Math.round(n*m)*65536+Math.round(o*m)*256+Math.round(u*m)}static mergeColorAlpha(t,n){let o=(t/16777216|0)*n|0;return((t>>16&255)*o/255&255)+((t&65280)*o/255&65280)+(((t&255)<<16)*o/255&16711680)+(o<<24)}static rad(t){return t*(Math.PI/180)}static getTimingBezier(t,n,o,u){let f=3*t,m=3*(o-t)-f,p=1-f-m,v=3*n,w=3*(u-n)-v,C=1-v-w;return function(L){if(L>=1)return 1;if(L<=0)return 0;let E=.5,R,y,I;for(let te=0;te<20;te++){if(R=E*(E*(E*p+m)+f),I=L-R,I>-1e-8&&I<1e-8)return E*(E*(E*C+w)+v);if(y=E*(E*(3*p)+2*m)+f,y>1e-10&&y<1e-10)break;E+=I/y}let U=0,Z=1;for(let te=0;te<20;te++){if(E=.5*(U+Z),R=E*(E*(E*p+m)+f),I=L-R,I>-1e-8&&I<1e-8)return E*(E*(E*C+w)+v);I<0?Z=E:U=E}}}static getTimingFunction(t){switch(t){case"linear":return function(o){return o};case"ease":return Te.getTimingBezier(.25,.1,.25,1);case"ease-in":return Te.getTimingBezier(.42,0,1,1);case"ease-out":return Te.getTimingBezier(0,0,.58,1);case"ease-in-out":return Te.getTimingBezier(.42,0,.58,1);case"step-start":return function(){return 1};case"step-end":return function(o){return o===1?1:0};default:let n="cubic-bezier(";if(t&&t.indexOf(n)===0){let o=t.substr(n.length,t.length-n.length-1).split(",");if(o.length!==4)return console.warn("[Lightning] Unknown timing function: "+t),function(v){return v};let u=parseFloat(o[0]),f=parseFloat(o[1]),m=parseFloat(o[2]),p=parseFloat(o[3]);return isNaN(u)||isNaN(f)||isNaN(m)||isNaN(p)?(console.warn("[Lightning] Unknown timing function: "+t),function(v){return v}):Te.getTimingBezier(u,f,m,p)}else return console.warn("[Lightning] Unknown timing function: "+t),function(o){return o}}}}let $=class ii{static isFunction(t){return typeof t=="function"}static isNumber(t){return typeof t=="number"}static isInteger(t){return typeof t=="number"&&t%1===0}static isBoolean(t){return t===!0||t===!1}static isString(t){return typeof t=="string"}static clone(t){return ii.isObjectLiteral(t)||Array.isArray(t)?ii.getDeepClone(t):t}static cloneObjShallow(t){let n=Object.keys(t),o={};for(let u=0;u<n.length;u++)o[n[u]]=t[n[u]];return o}static merge(t,n){let o=Object.keys(n);for(let u=0;u<o.length;u++)t[o[u]]=n[o[u]];return t}static isObject(t){let n=typeof t;return!!t&&(n==="object"||n==="function")}static isPlainObject(t){return!!t&&typeof t==="object"}static isObjectLiteral(t){return typeof t=="object"&&t&&t.constructor===Object}static getArrayIndex(t,n){return ii.getModuloIndex(t,n.length)}static getModuloIndex(t,n){if(n===0)return t;for(;t<0;)t+=Math.ceil(-t/n)*n;return t=t%n,t}static getDeepClone(t){let n,o;if(ii.isFunction(t))return t;if(Array.isArray(t)){o=[];let u=Object.keys(t);for(n=0;n<u.length;n++)o[u[n]]=ii.getDeepClone(t[u[n]]);return o}else if(ii.isObject(t)){o={};let u=Object.keys(t);for(n=0;n<u.length;n++)o[u[n]]=ii.getDeepClone(t[u[n]]);return o}else return t}static equalValues(t,n){return typeof t!=typeof n?!1:ii.isObjectLiteral(t)?ii.isObjectLiteral(n)&&ii.equalObjectLiterals(t,n):Array.isArray(t)?Array.isArray(n)&&ii.equalArrays(t,n):t===n}static equalObjectLiterals(t,n){let o=Object.keys(t),u=Object.keys(n);if(o.length!==u.length)return!1;for(let f=0,m=o.length;f<m;f++){const p=o[f],v=u[f];if(p!==v)return!1;const w=t[p],C=n[v];if(!ii.equalValues(w,C))return!1}return!0}static equalArrays(t,n){if(t.length!==n.length)return!1;for(let o=0,u=t.length;o<u;o++)if(!this.equalValues(t[o],n[o]))return!1;return!0}static setToArray(t){let n=[];return t.forEach(function(o){n.push(o)}),n}static iteratorToArray(t){let n=[],o=t.next();for(;!o.done;)n.push(o.value),o=t.next();return n}static isUcChar(t){return t>=65&&t<=90}};$.isWeb=typeof window<"u"&&typeof sparkscene>"u";$.isWPE=$.isWeb&&navigator.userAgent.indexOf("WPE")!==-1;$.isSpark=typeof sparkscene<"u";$.isNode=typeof window>"u"||$.isSpark;$.isPS4=$.isWeb&&navigator.userAgent.indexOf("PlayStation 4")!==-1;$.isZiggo=$.isWeb&&(navigator.userAgent.indexOf("EOSSTB")!==-1||navigator.userAgent.indexOf("HZNSTB")!==-1);class Ot{static defaultSetter(t,n,o){t[n]=o}static patchObject(t,n){if(!$.isObjectLiteral(n))console.error("[Lightning] Settings must be object literal");else{let o=Object.keys(n);for(let u=0,f=o.length;u<f;u++){let m=o[u];this.patchObjectProperty(t,m,n[m])}}}static patchObjectProperty(t,n,o){let u=t.setSetting||Ot.defaultSetter;n.charAt(0)==="_"?n!=="__create"&&console.error("[Lightning] Patch of private property '"+n+"' is not allowed"):n!=="type"&&($.isFunction(o)&&o.__local&&(o=o.__local(t)),u(t,n,o))}static local(t){t.__local=!0}}class Xv{static getSpacing(t,n,o){const u=n-1;let f,m,p;switch(t){case"flex-start":m=0,p=0;break;case"flex-end":m=o,p=0;break;case"center":m=o/2,p=0;break;case"space-between":m=0,p=Math.max(0,o)/u;break;case"space-around":if(o<0)return this.getSpacing("center",n,o);f=o/(u+1),m=.5*f,p=f;break;case"space-evenly":if(o<0)return this.getSpacing("center",n,o);f=o/(u+2),m=f,p=f;break;case"stretch":m=0,p=0;break;default:throw new Error("Unknown mode: "+t)}return{spacingBefore:m,spacingBetween:p}}}class gb{constructor(t){this._layout=t,this._totalCrossAxisSize=0}get _lines(){return this._layout._lines}init(){this._totalCrossAxisSize=this._getTotalCrossAxisSize()}align(){const n=this._layout.crossAxisSize-this._totalCrossAxisSize,{spacingBefore:o,spacingBetween:u}=this._getSpacing(n),f=this._lines,m=this._layout._flexContainer.alignContent;let p=0;m==="stretch"&&f.length&&n>0&&(p=n/f.length);let v=o;for(let w=0,C=f.length;w<C;w++){const L=v,E=f[w].createItemAligner();let R=f[w].crossAxisLayoutSize+p;E.setCrossAxisLayoutSize(R),E.setCrossAxisLayoutOffset(L),E.align(),E.recursiveResizeOccured&&f[w].setItemPositions(),v+=R,v+=u}}get totalCrossAxisSize(){return this._totalCrossAxisSize}_getTotalCrossAxisSize(){const t=this._lines;let n=0;for(let o=0,u=t.length;o<u;o++){const f=t[o];n+=f.crossAxisLayoutSize}return n}_getSpacing(t){const n=this._layout._flexContainer.alignContent,o=this._lines.length;return Xv.getSpacing(n,o,t)}}class Re{static getParentAxisSizeWithPadding(t,n){const u=t.target.getParent();if(u){const f=t.flexParent;return f?this.getAxisLayoutSize(f,n)+this.getTotalPadding(f,n):n?u.w:u.h}else return 0}static getRelAxisSize(t,n){return n?t.funcW?this._allowRelAxisSizeFunction(t,!0)?t.funcW(this.getParentAxisSizeWithPadding(t,!0)):0:t.originalWidth:t.funcH?this._allowRelAxisSizeFunction(t,!1)?t.funcH(this.getParentAxisSizeWithPadding(t,!1)):0:t.originalHeight}static _allowRelAxisSizeFunction(t,n){const o=t.flexParent;return!(o&&o._flex._layout.isAxisFitToContents(n))}static isZeroAxisSize(t,n){return n?!t.originalWidth&&!t.funcW:!t.originalHeight&&!t.funcH}static getAxisLayoutPos(t,n){return n?t.x:t.y}static getAxisLayoutSize(t,n){return n?t.w:t.h}static setAxisLayoutPos(t,n,o){n?t.x=o:t.y=o}static setAxisLayoutSize(t,n,o){n?t.w=o:t.h=o}static getAxisMinSize(t,n){let o=this.getPlainAxisMinSize(t,n),u=0;return t.isFlexItemEnabled()&&(u=t._flexItem._getMinSizeSetting(n)),u>0&&(o=Math.max(o,u)),o}static getPlainAxisMinSize(t,n){return t.isFlexEnabled()?t._flex._layout.getAxisMinSize(n):t.flexItem.shrink!==0?0:this.getRelAxisSize(t,n)}static resizeAxis(t,n,o){t.isFlexEnabled()?t._flex._horizontal===n?t._flex._layout.resizeMainAxis(o):t._flex._layout.resizeCrossAxis(o):this.setAxisLayoutSize(t,n,o)}static getPaddingOffset(t,n){if(t.isFlexEnabled()){const o=t._flex;return n?o.paddingLeft:o.paddingTop}else return 0}static getTotalPadding(t,n){if(t.isFlexEnabled()){const o=t._flex;return n?o.paddingRight+o.paddingLeft:o.paddingTop+o.paddingBottom}else return 0}static getMarginOffset(t,n){const o=t.flexItem;return o?n?o.marginLeft:o.marginTop:0}static getTotalMargin(t,n){const o=t.flexItem;return o?n?o.marginRight+o.marginLeft:o.marginTop+o.marginBottom:0}}class mb{constructor(t){this._line=t,this._amountRemaining=0,this._shrunkSize=0}shrink(t){this._shrunkSize=0,this._amountRemaining=t;let n=this._getTotalShrinkAmount();if(n){const o=this._line.items;do{let u=this._amountRemaining/n;for(let f=this._line.startIndex;f<=this._line.endIndex;f++){const p=o[f].flexItem,v=p.shrink;if(v>0){let C=v*u;const L=p._getMainAxisMinSize(),E=p._getMainAxisLayoutSize();if(E>L){const R=E-L;C>=R&&(C=R,n-=v);const I=E-C;if(p._resizeMainAxis(I),this._shrunkSize+=C,this._amountRemaining-=C,Math.abs(this._amountRemaining)<1e-5)return}}}}while(n&&Math.abs(this._amountRemaining)>1e-5)}}_getTotalShrinkAmount(){let t=0;const n=this._line.items;for(let o=this._line.startIndex;o<=this._line.endIndex;o++){const f=n[o].flexItem;if(f.shrink){const m=f._getMainAxisMinSize();f._getMainAxisLayoutSize()>m&&(t+=f.shrink)}}return t}getShrunkSize(){return this._shrunkSize}}class _b{constructor(t){this._line=t,this._amountRemaining=0,this._grownSize=0}grow(t){this._grownSize=0,this._amountRemaining=t;let n=this._getTotalGrowAmount();if(n){const o=this._line.items;do{let u=this._amountRemaining/n;for(let f=this._line.startIndex;f<=this._line.endIndex;f++){const p=o[f].flexItem,v=p.grow;if(v>0){let C=v*u;const L=p._getMainAxisMaxSizeSetting(),E=p._getMainAxisLayoutSize();if(L>0)if(E>=L)C=0;else{const R=L-E;C>=R&&(C=R,n-=v)}if(C>0){const R=E+C;if(p._resizeMainAxis(R),this._grownSize+=C,this._amountRemaining-=C,Math.abs(this._amountRemaining)<1e-5)return}}}}while(n&&Math.abs(this._amountRemaining)>1e-5)}}_getTotalGrowAmount(){let t=0;const n=this._line.items;for(let o=this._line.startIndex;o<=this._line.endIndex;o++){const f=n[o].flexItem;if(f.grow){const m=f._getMainAxisMaxSizeSetting(),p=f._getMainAxisLayoutSize();(m===0||p<m)&&(t+=f.grow)}}return t}getGrownSize(){return this._grownSize}}class yb{constructor(t){this._line=t}get _layout(){return this._line._layout}position(){const{spacingBefore:t,spacingBetween:n}=this._getSpacing();let o=t;const u=this._line.items;for(let f=this._line.startIndex;f<=this._line.endIndex;f++){const m=u[f];m.flexItem._setMainAxisLayoutPos(o),o+=m.flexItem._getMainAxisLayoutSizeWithPaddingAndMargin(),o+=n}}_getSpacing(){const t=this._line._availableSpace;let n=this._layout._flexContainer.justifyContent;const o=this._line.numberOfItems;return Xv.getSpacing(n,o,t)}}class xb{constructor(t){this._line=t,this._crossAxisLayoutSize=0,this._crossAxisLayoutOffset=0,this._alignItemsSetting=null,this._recursiveResizeOccured=!1,this._isCrossAxisFitToContents=!1}get _layout(){return this._line._layout}get _flexContainer(){return this._layout._flexContainer}setCrossAxisLayoutSize(t){this._crossAxisLayoutSize=t}setCrossAxisLayoutOffset(t){this._crossAxisLayoutOffset=t}align(){this._alignItemsSetting=this._flexContainer.alignItems,this._isCrossAxisFitToContents=this._layout.isAxisFitToContents(!this._flexContainer._horizontal),this._recursiveResizeOccured=!1;const t=this._line.items;for(let n=this._line.startIndex;n<=this._line.endIndex;n++){const o=t[n];this._alignItem(o)}}get recursiveResizeOccured(){return this._recursiveResizeOccured}_alignItem(t){const n=t.flexItem;let o=n.alignSelf||this._alignItemsSetting;switch(o==="stretch"&&this._preventStretch(n)&&(o="flex-start"),o!=="stretch"&&!this._isCrossAxisFitToContents&&n._hasRelCrossAxisSize()&&n._resetCrossAxisLayoutSize(),o){case"flex-start":this._alignItemFlexStart(n);break;case"flex-end":this._alignItemFlexEnd(n);break;case"center":this._alignItemFlexCenter(n);break;case"stretch":this._alignItemStretch(n);break}}_alignItemFlexStart(t){t._setCrossAxisLayoutPos(this._crossAxisLayoutOffset)}_alignItemFlexEnd(t){const n=t._getCrossAxisLayoutSizeWithPaddingAndMargin();t._setCrossAxisLayoutPos(this._crossAxisLayoutOffset+(this._crossAxisLayoutSize-n))}_alignItemFlexCenter(t){const n=t._getCrossAxisLayoutSizeWithPaddingAndMargin(),o=(this._crossAxisLayoutSize-n)/2;t._setCrossAxisLayoutPos(this._crossAxisLayoutOffset+o)}_alignItemStretch(t){t._setCrossAxisLayoutPos(this._crossAxisLayoutOffset);const n=t._getMainAxisLayoutSize();let o=this._crossAxisLayoutSize-t._getCrossAxisMargin()-t._getCrossAxisPadding();const u=t._getCrossAxisMinSizeSetting();u>0&&(o=Math.max(o,u));const f=t._getCrossAxisMaxSizeSetting();f>0&&(o=Math.min(o,f)),t._resizeCrossAxis(o),t._getMainAxisLayoutSize()!==n&&(this._recursiveResizeOccured=!0)}_preventStretch(t){const n=t._hasFixedCrossAxisSize(),o=t.alignSelf==="stretch";return n&&!o}}class vb{constructor(t,n,o,u){this._layout=t,this.items=t.items,this.startIndex=n,this.endIndex=o,this._availableSpace=u}performLayout(){this._setItemSizes(),this.setItemPositions(),this._calcLayoutInfo()}_setItemSizes(){this._availableSpace>0?this._growItemSizes(this._availableSpace):this._availableSpace<0&&this._shrinkItemSizes(-this._availableSpace)}_growItemSizes(t){const n=new _b(this);n.grow(t),this._availableSpace-=n.getGrownSize()}_shrinkItemSizes(t){const n=new mb(this);n.shrink(t),this._availableSpace+=n.getShrunkSize()}setItemPositions(){new yb(this).position()}createItemAligner(){return new xb(this)}_calcLayoutInfo(){this._calcCrossAxisMaxLayoutSize()}getMainAxisMinSize(){let t=0;for(let n=this.startIndex;n<=this.endIndex;n++){const o=this.items[n];t+=o.flexItem._getMainAxisMinSizeWithPaddingAndMargin()}return t}get numberOfItems(){return this.endIndex-this.startIndex+1}get crossAxisLayoutSize(){const t=this._layout.isCrossAxisFitToContents()&&!this._layout.resizingCrossAxis;return this._layout.isWrapping()||t?this._crossAxisMaxLayoutSize:this._layout.crossAxisSize}_calcCrossAxisMaxLayoutSize(){this._crossAxisMaxLayoutSize=this._getCrossAxisMaxLayoutSize()}_getCrossAxisMaxLayoutSize(){let t=0;for(let n=this.startIndex;n<=this.endIndex;n++){const o=this.items[n];t=Math.max(t,o.flexItem._getCrossAxisLayoutSizeWithPaddingAndMargin())}return t}}class wb{constructor(t){this._layout=t,this._mainAxisMinSize=-1,this._crossAxisMinSize=-1,this._mainAxisContentSize=0}get lines(){return this._lines}get mainAxisMinSize(){return this._mainAxisMinSize===-1&&(this._mainAxisMinSize=this._getMainAxisMinSize()),this._mainAxisMinSize}get crossAxisMinSize(){return this._crossAxisMinSize===-1&&(this._crossAxisMinSize=this._getCrossAxisMinSize()),this._crossAxisMinSize}get mainAxisContentSize(){return this._mainAxisContentSize}layoutLines(){this._setup();const t=this._layout.items,n=this._layout.isWrapping();let o=0,u;const f=t.length;for(u=0;u<f;u++){const m=t[u];this._layoutFlexItem(m);const p=m.flexItem._getMainAxisLayoutSizeWithPaddingAndMargin();n&&u>o&&this._curMainAxisPos+p>this._mainAxisSize&&(this._layoutLine(o,u-1),this._curMainAxisPos=0,o=u),this._addToMainAxisPos(p)}o<u&&this._layoutLine(o,u-1)}_layoutFlexItem(t){t.isFlexEnabled()?t.flexLayout.updateTreeLayout():t.flexItem._resetLayoutSize()}_setup(){this._mainAxisSize=this._layout.mainAxisSize,this._curMainAxisPos=0,this._maxMainAxisPos=0,this._lines=[],this._mainAxisMinSize=-1,this._crossAxisMinSize=-1,this._mainAxisContentSize=0}_addToMainAxisPos(t){this._curMainAxisPos+=t,this._curMainAxisPos>this._maxMainAxisPos&&(this._maxMainAxisPos=this._curMainAxisPos)}_layoutLine(t,n){const o=this._getAvailableMainAxisLayoutSpace(),u=new vb(this._layout,t,n,o);u.performLayout(),this._lines.push(u),(this._mainAxisContentSize===0||this._curMainAxisPos>this._mainAxisContentSize)&&(this._mainAxisContentSize=this._curMainAxisPos)}_getAvailableMainAxisLayoutSpace(){return!this._layout.resizingMainAxis&&this._layout.isMainAxisFitToContents()?0:this._mainAxisSize-this._curMainAxisPos}_getCrossAxisMinSize(){let t=0;const n=this._layout.items;for(let o=0,u=n.length;o<u;o++){const m=n[o].flexItem._getCrossAxisMinSizeWithPaddingAndMargin();t=Math.max(t,m)}return t}_getMainAxisMinSize(){return this._lines.length===1?this._lines[0].getMainAxisMinSize():this._layout.mainAxisSize}}class lu{constructor(t){this._layout=t,this._isReverse=this._flexContainer._reverse,this._horizontalPaddingOffset=this._layout._getHorizontalPaddingOffset(),this._verticalPaddingOffset=this._layout._getVerticalPaddingOffset()}get _flexContainer(){return this._layout._flexContainer}finalize(){const t=this._layout.getParentFlexContainer();t?new lu(t._layout)._finalizeItemAndChildren(this._flexContainer.item):(this._finalizeRoot(),this._finalizeItems())}_finalizeRoot(){const t=this._flexContainer.item;let n=Re.getAxisLayoutPos(t,!0),o=Re.getAxisLayoutPos(t,!1),u=Re.getAxisLayoutSize(t,!0),f=Re.getAxisLayoutSize(t,!1);u+=this._layout._getHorizontalPadding(),f+=this._layout._getVerticalPadding(),t.clearRecalcFlag(),t.setLayout(n,o,u,f)}_finalizeItems(){const t=this._layout.items;for(let n=0,o=t.length;n<o;n++){const u=t[n],f=this._validateItemCache(u);this._finalizeItem(u),f||this._finalizeItemChildren(u)}}_validateItemCache(t){if(t.recalc===0&&t.isFlexEnabled()){const n=t._flex._layout;if(t.w===t.target.w&&t.h===t.target.h)return!0;{const u=n.crossAxisSize;n.performResizeMainAxis(n.mainAxisSize),n.performResizeCrossAxis(u)}}return!1}_finalizeItemAndChildren(t){this._finalizeItem(t),this._finalizeItemChildren(t)}_finalizeItem(t){this._isReverse&&this._reverseMainAxisLayoutPos(t);let n=Re.getAxisLayoutPos(t,!0),o=Re.getAxisLayoutPos(t,!1),u=Re.getAxisLayoutSize(t,!0),f=Re.getAxisLayoutSize(t,!1);n+=this._horizontalPaddingOffset,o+=this._verticalPaddingOffset,t.flex&&(u+=t._flex._layout._getHorizontalPadding(),f+=t._flex._layout._getVerticalPadding());const p=t.flexItem;p&&(n+=p._getHorizontalMarginOffset(),o+=p._getVerticalMarginOffset()),t.clearRecalcFlag(),t.setLayout(n,o,u,f)}_finalizeItemChildren(t){const n=t._flex;n&&new lu(n._layout)._finalizeItems()}_reverseMainAxisLayoutPos(t){const n=t.flexItem._getMainAxisLayoutPos()+t.flexItem._getMainAxisLayoutSizeWithPaddingAndMargin(),o=this._layout.mainAxisSize-n;t.flexItem._setMainAxisLayoutPos(o)}}class Tb{constructor(t){this._flexContainer=t,this._lineLayouter=new wb(this),this._resizingMainAxis=!1,this._resizingCrossAxis=!1,this._cachedMainAxisSizeAfterLayout=0,this._cachedCrossAxisSizeAfterLayout=0,this._shrunk=!1}get shrunk(){return this._shrunk}get recalc(){return this.item.recalc}layoutTree(){this.item.flexParent!==null?this._updateSubTreeLayout():this.updateTreeLayout(),this.updateItemCoords()}updateTreeLayout(){this.recalc?this._performUpdateLayoutTree():this._performUpdateLayoutTreeFromCache()}_performUpdateLayoutTree(){this._setInitialAxisSizes(),this._layoutAxes(),this._refreshLayoutCache()}_refreshLayoutCache(){this._cachedMainAxisSizeAfterLayout=this.mainAxisSize,this._cachedCrossAxisSizeAfterLayout=this.crossAxisSize}_performUpdateLayoutTreeFromCache(){this.item.funcW||this.item.funcH?(this.item.enableLocalRecalcFlag(),this._performUpdateLayoutTree()):(this.mainAxisSize=this._cachedMainAxisSizeAfterLayout,this.crossAxisSize=this._cachedCrossAxisSizeAfterLayout)}updateItemCoords(){new lu(this).finalize()}_updateSubTreeLayout(){const t=this.crossAxisSize;this._layoutMainAxis(),this.performResizeCrossAxis(t)}_setInitialAxisSizes(){this.item.isFlexItemEnabled()?this.item.flexItem._resetLayoutSize():(this.mainAxisSize=this._getMainAxisBasis(),this.crossAxisSize=this._getCrossAxisBasis()),this._resizingMainAxis=!1,this._resizingCrossAxis=!1,this._shrunk=!1}_layoutAxes(){this._layoutMainAxis(),this._layoutCrossAxis()}_layoutMainAxis(){this._layoutLines(),this._fitMainAxisSizeToContents()}_layoutLines(){this._lineLayouter.layoutLines()}get _lines(){return this._lineLayouter.lines}_fitMainAxisSizeToContents(){this._resizingMainAxis||this.isMainAxisFitToContents()&&(this.mainAxisSize=this._lineLayouter.mainAxisContentSize)}_layoutCrossAxis(){const t=new gb(this);t.init(),this._totalCrossAxisSize=t.totalCrossAxisSize,this._fitCrossAxisSizeToContents(),t.align()}_fitCrossAxisSizeToContents(){this._resizingCrossAxis||this.isCrossAxisFitToContents()&&(this.crossAxisSize=this._totalCrossAxisSize)}isWrapping(){return this._flexContainer.wrap}isAxisFitToContents(t){return this._horizontal===t?this.isMainAxisFitToContents():this.isCrossAxisFitToContents()}isMainAxisFitToContents(){return!this.isWrapping()&&!this._hasFixedMainAxisBasis()}isCrossAxisFitToContents(){return!this._hasFixedCrossAxisBasis()}_hasFixedMainAxisBasis(){return!Re.isZeroAxisSize(this.item,this._horizontal)}_hasFixedCrossAxisBasis(){return!Re.isZeroAxisSize(this.item,!this._horizontal)}getAxisMinSize(t){return this._horizontal===t?this._getMainAxisMinSize():this._getCrossAxisMinSize()}_getMainAxisMinSize(){return this._lineLayouter.mainAxisMinSize}_getCrossAxisMinSize(){return this._lineLayouter.crossAxisMinSize}resizeMainAxis(t){this.mainAxisSize!==t&&(this.recalc>0?this.performResizeMainAxis(t):this._checkValidCacheMainAxisResize()?(this.mainAxisSize=t,this._fitCrossAxisSizeToContents()):(this.item.enableLocalRecalcFlag(),this.performResizeMainAxis(t)))}_checkValidCacheMainAxisResize(t){return t===this.targetMainAxisSize||!this.isCrossAxisFitToContents()}performResizeMainAxis(t){const n=t<this.mainAxisSize;this._shrunk=n,this.mainAxisSize=t,this._resizingMainAxis=!0,this._layoutAxes(),this._resizingMainAxis=!1}resizeCrossAxis(t){this.crossAxisSize!==t&&(this.recalc>0?this.performResizeCrossAxis(t):this.crossAxisSize=t)}performResizeCrossAxis(t){this.crossAxisSize=t,this._resizingCrossAxis=!0,this._layoutCrossAxis(),this._resizingCrossAxis=!1}get targetMainAxisSize(){return this._horizontal?this.item.target.w:this.item.target.h}get targetCrossAxisSize(){return this._horizontal?this.item.target.h:this.item.target.w}getParentFlexContainer(){return this.item.isFlexItemEnabled()?this.item.flexItem.ctr:null}_getHorizontalPadding(){return Re.getTotalPadding(this.item,!0)}_getVerticalPadding(){return Re.getTotalPadding(this.item,!1)}_getHorizontalPaddingOffset(){return Re.getPaddingOffset(this.item,!0)}_getVerticalPaddingOffset(){return Re.getPaddingOffset(this.item,!1)}_getMainAxisBasis(){return Re.getRelAxisSize(this.item,this._horizontal)}_getCrossAxisBasis(){return Re.getRelAxisSize(this.item,!this._horizontal)}get _horizontal(){return this._flexContainer._horizontal}get _reverse(){return this._flexContainer._reverse}get item(){return this._flexContainer.item}get items(){return this.item.items}get resizingMainAxis(){return this._resizingMainAxis}get resizingCrossAxis(){return this._resizingCrossAxis}get numberOfItems(){return this.items.length}get mainAxisSize(){return Re.getAxisLayoutSize(this.item,this._horizontal)}get crossAxisSize(){return Re.getAxisLayoutSize(this.item,!this._horizontal)}set mainAxisSize(t){Re.setAxisLayoutSize(this.item,this._horizontal,t)}set crossAxisSize(t){Re.setAxisLayoutSize(this.item,!this._horizontal,t)}}class ni{constructor(t){this._item=t,this._layout=new Tb(this),this._horizontal=!0,this._reverse=!1,this._wrap=!1,this._alignItems="stretch",this._justifyContent="flex-start",this._alignContent="flex-start",this._paddingLeft=0,this._paddingTop=0,this._paddingRight=0,this._paddingBottom=0}get item(){return this._item}_changedDimensions(){this._item.changedDimensions()}_changedContents(){this._item.changedContents()}get direction(){return(this._horizontal?"row":"column")+(this._reverse?"-reverse":"")}set direction(t){this.direction!==t&&(this._horizontal=t==="row"||t==="row-reverse",this._reverse=t==="row-reverse"||t==="column-reverse",this._changedContents())}set wrap(t){this._wrap=t,this._changedContents()}get wrap(){return this._wrap}get alignItems(){return this._alignItems}set alignItems(t){if(this._alignItems!==t){if(ni.ALIGN_ITEMS.indexOf(t)===-1)throw new Error("Unknown alignItems, options: "+ni.ALIGN_ITEMS.join(","));this._alignItems=t,this._changedContents()}}get alignContent(){return this._alignContent}set alignContent(t){if(this._alignContent!==t){if(ni.ALIGN_CONTENT.indexOf(t)===-1)throw new Error("Unknown alignContent, options: "+ni.ALIGN_CONTENT.join(","));this._alignContent=t,this._changedContents()}}get justifyContent(){return this._justifyContent}set justifyContent(t){if(this._justifyContent!==t){if(ni.JUSTIFY_CONTENT.indexOf(t)===-1)throw new Error("Unknown justifyContent, options: "+ni.JUSTIFY_CONTENT.join(","));this._justifyContent=t,this._changedContents()}}set padding(t){this.paddingLeft=t,this.paddingTop=t,this.paddingRight=t,this.paddingBottom=t}get padding(){return this.paddingLeft}set paddingLeft(t){this._paddingLeft=t,this._changedDimensions()}get paddingLeft(){return this._paddingLeft}set paddingTop(t){this._paddingTop=t,this._changedDimensions()}get paddingTop(){return this._paddingTop}set paddingRight(t){this._paddingRight=t,this._changedDimensions()}get paddingRight(){return this._paddingRight}set paddingBottom(t){this._paddingBottom=t,this._changedDimensions()}get paddingBottom(){return this._paddingBottom}patch(t){Ot.patchObject(this,t)}}ni.ALIGN_ITEMS=["flex-start","flex-end","center","stretch"];ni.ALIGN_CONTENT=["flex-start","flex-end","center","space-between","space-around","space-evenly","stretch"];ni.JUSTIFY_CONTENT=["flex-start","flex-end","center","space-between","space-around","space-evenly"];class Vo{constructor(t){this._ctr=null,this._item=t,this._grow=0,this._shrink=Vo.SHRINK_AUTO,this._alignSelf=void 0,this._minWidth=0,this._minHeight=0,this._maxWidth=0,this._maxHeight=0,this._marginLeft=0,this._marginTop=0,this._marginRight=0,this._marginBottom=0}get item(){return this._item}get grow(){return this._grow}set grow(t){this._grow!==t&&(this._grow=parseInt(t)||0,this._changed())}get shrink(){return this._shrink===Vo.SHRINK_AUTO?this._getDefaultShrink():this._shrink}_getDefaultShrink(){return this.item.isFlexEnabled()?1:0}set shrink(t){this._shrink!==t&&(this._shrink=parseInt(t)||0,this._changed())}get alignSelf(){return this._alignSelf}set alignSelf(t){if(this._alignSelf!==t){if(t===void 0)this._alignSelf=void 0;else{if(ni.ALIGN_ITEMS.indexOf(t)===-1)throw new Error("Unknown alignSelf, options: "+ni.ALIGN_ITEMS.join(","));this._alignSelf=t}this._changed()}}get minWidth(){return this._minWidth}set minWidth(t){this._minWidth=Math.max(0,t),this._item.changedDimensions(!0,!1)}get minHeight(){return this._minHeight}set minHeight(t){this._minHeight=Math.max(0,t),this._item.changedDimensions(!1,!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=Math.max(0,t),this._item.changedDimensions(!0,!1)}get maxHeight(){return this._maxHeight}set maxHeight(t){this._maxHeight=Math.max(0,t),this._item.changedDimensions(!1,!0)}set margin(t){this.marginLeft=t,this.marginTop=t,this.marginRight=t,this.marginBottom=t}get margin(){return this.marginLeft}set marginLeft(t){this._marginLeft=t,this._changed()}get marginLeft(){return this._marginLeft}set marginTop(t){this._marginTop=t,this._changed()}get marginTop(){return this._marginTop}set marginRight(t){this._marginRight=t,this._changed()}get marginRight(){return this._marginRight}set marginBottom(t){this._marginBottom=t,this._changed()}get marginBottom(){return this._marginBottom}_changed(){this.ctr&&this.ctr._changedContents()}set ctr(t){this._ctr=t}get ctr(){return this._ctr}patch(t){Ot.patchObject(this,t)}_resetLayoutSize(){this._resetHorizontalAxisLayoutSize(),this._resetVerticalAxisLayoutSize()}_resetCrossAxisLayoutSize(){this.ctr._horizontal?this._resetVerticalAxisLayoutSize():this._resetHorizontalAxisLayoutSize()}_resetHorizontalAxisLayoutSize(){let t=Re.getRelAxisSize(this.item,!0);this._minWidth&&(t=Math.max(this._minWidth,t)),this._maxWidth&&(t=Math.min(this._maxWidth,t)),Re.setAxisLayoutSize(this.item,!0,t)}_resetVerticalAxisLayoutSize(){let t=Re.getRelAxisSize(this.item,!1);this._minHeight&&(t=Math.max(this._minHeight,t)),this._maxHeight&&(t=Math.min(this._maxHeight,t)),Re.setAxisLayoutSize(this.item,!1,t)}_getCrossAxisMinSizeSetting(){return this._getMinSizeSetting(!this.ctr._horizontal)}_getCrossAxisMaxSizeSetting(){return this._getMaxSizeSetting(!this.ctr._horizontal)}_getMainAxisMaxSizeSetting(){return this._getMaxSizeSetting(this.ctr._horizontal)}_getMinSizeSetting(t){return t?this._minWidth:this._minHeight}_getMaxSizeSetting(t){return t?this._maxWidth:this._maxHeight}_getMainAxisMinSize(){return Re.getAxisMinSize(this.item,this.ctr._horizontal)}_getCrossAxisMinSize(){return Re.getAxisMinSize(this.item,!this.ctr._horizontal)}_getMainAxisLayoutSize(){return Re.getAxisLayoutSize(this.item,this.ctr._horizontal)}_getMainAxisLayoutPos(){return Re.getAxisLayoutPos(this.item,this.ctr._horizontal)}_setMainAxisLayoutPos(t){return Re.setAxisLayoutPos(this.item,this.ctr._horizontal,t)}_setCrossAxisLayoutPos(t){return Re.setAxisLayoutPos(this.item,!this.ctr._horizontal,t)}_getCrossAxisLayoutSize(){return Re.getAxisLayoutSize(this.item,!this.ctr._horizontal)}_resizeCrossAxis(t){return Re.resizeAxis(this.item,!this.ctr._horizontal,t)}_resizeMainAxis(t){return Re.resizeAxis(this.item,this.ctr._horizontal,t)}_getMainAxisPadding(){return Re.getTotalPadding(this.item,this.ctr._horizontal)}_getCrossAxisPadding(){return Re.getTotalPadding(this.item,!this.ctr._horizontal)}_getMainAxisMargin(){return Re.getTotalMargin(this.item,this.ctr._horizontal)}_getCrossAxisMargin(){return Re.getTotalMargin(this.item,!this.ctr._horizontal)}_getHorizontalMarginOffset(){return Re.getMarginOffset(this.item,!0)}_getVerticalMarginOffset(){return Re.getMarginOffset(this.item,!1)}_getMainAxisMinSizeWithPaddingAndMargin(){return this._getMainAxisMinSize()+this._getMainAxisPadding()+this._getMainAxisMargin()}_getCrossAxisMinSizeWithPaddingAndMargin(){return this._getCrossAxisMinSize()+this._getCrossAxisPadding()+this._getCrossAxisMargin()}_getMainAxisLayoutSizeWithPaddingAndMargin(){return this._getMainAxisLayoutSize()+this._getMainAxisPadding()+this._getMainAxisMargin()}_getCrossAxisLayoutSizeWithPaddingAndMargin(){return this._getCrossAxisLayoutSize()+this._getCrossAxisPadding()+this._getCrossAxisMargin()}_hasFixedCrossAxisSize(){return!Re.isZeroAxisSize(this.item,!this.ctr._horizontal)}_hasRelCrossAxisSize(){return!!(this.ctr._horizontal?this.item.funcH:this.item.funcW)}}Vo.SHRINK_AUTO=-1;class Sb{constructor(t){this._target=t,this._recalc=0,this._enabled=!1,this.x=0,this.y=0,this.w=0,this.h=0,this._originalX=0,this._originalY=0,this._originalWidth=0,this._originalHeight=0,this._flex=null,this._flexItem=null,this._flexItemDisabled=!1,this._items=null}get flexLayout(){return this.flex?this.flex._layout:null}layoutFlexTree(){this.isFlexEnabled()&&this.isChanged()&&this.flexLayout.layoutTree()}get target(){return this._target}get flex(){return this._flex}set flex(t){t?(this.isFlexEnabled()||this._enableFlex(),this._flex.patch(t)):this.isFlexEnabled()&&this._disableFlex()}get flexItem(){return this._flexItemDisabled?!1:(this._ensureFlexItem(),this._flexItem)}set flexItem(t){if(t===!1){if(!this._flexItemDisabled){const n=this.flexParent;this._flexItemDisabled=!0,this._checkEnabled(),n&&(n._clearFlexItemsCache(),n.changedContents())}}else if(this._ensureFlexItem(),this._flexItem.patch(t),this._flexItemDisabled){this._flexItemDisabled=!1,this._checkEnabled();const n=this.flexParent;n&&(n._clearFlexItemsCache(),n.changedContents())}}_enableFlex(){this._flex=new ni(this),this._checkEnabled(),this.changedDimensions(),this._enableChildrenAsFlexItems()}_disableFlex(){this.changedDimensions(),this._flex=null,this._checkEnabled(),this._disableChildrenAsFlexItems()}_enableChildrenAsFlexItems(){const t=this._target._children;if(t)for(let n=0,o=t.length;n<o;n++)t[n].layout._enableFlexItem()}_disableChildrenAsFlexItems(){const t=this._target._children;if(t)for(let n=0,o=t.length;n<o;n++)t[n].layout._disableFlexItem()}_enableFlexItem(){this._ensureFlexItem();const t=this._target._parent._layout;this._flexItem.ctr=t._flex,t.changedContents(),this._checkEnabled()}_disableFlexItem(){this._flexItem&&(this._flexItem.ctr=null),this._checkEnabled(),this._resetOffsets()}_resetOffsets(){this.x=0,this.y=0}_ensureFlexItem(){this._flexItem||(this._flexItem=new Vo(this))}_checkEnabled(){const t=this.isEnabled();this._enabled!==t&&(t?this._enable():this._disable(),this._enabled=t)}_enable(){this._setupTargetForFlex(),this._target.enableFlexLayout()}_disable(){this._restoreTargetToNonFlex(),this._target.disableFlexLayout()}isEnabled(){return this.isFlexEnabled()||this.isFlexItemEnabled()}isFlexEnabled(){return this._flex!==null}isFlexItemEnabled(){return this.flexParent!==null}_restoreTargetToNonFlex(){const t=this._target;t.x=this._originalX,t.y=this._originalY,t.setDimensions(this._originalWidth,this._originalHeight)}_setupTargetForFlex(){const t=this._target;this._originalX=t._x,this._originalY=t._y,this._originalWidth=t._w,this._originalHeight=t._h}setParent(t,n){t&&t.isFlexContainer()&&t._layout._changedChildren(),n&&n.isFlexContainer()&&(this._enableFlexItem(),n._layout._changedChildren()),this._checkEnabled()}get flexParent(){if(this._flexItemDisabled)return null;const t=this._target._parent;return t&&t.isFlexContainer()?t._layout:null}setVisible(t){const n=this.flexParent;n&&n._changedChildren()}get items(){return this._items||(this._items=this._getFlexItems()),this._items}_getFlexItems(){const t=[],n=this._target._children;if(n)for(let o=0,u=n.length;o<u;o++){const f=n[o];f.visible&&f.isFlexItem()&&t.push(f.layout)}return t}_changedChildren(){this._clearFlexItemsCache(),this.changedContents()}_clearFlexItemsCache(){this._items=null}setLayout(t,n,o,u){let f=this._originalX,m=this._originalY;this.funcX&&(f=this.funcX(Re.getParentAxisSizeWithPadding(this,!0))),this.funcY&&(m=this.funcY(Re.getParentAxisSizeWithPadding(this,!1))),this.isFlexItemEnabled()?this.target.setLayout(t+f,n+m,o,u):this.target.setLayout(f,m,o,u)}changedDimensions(t=!0,n=!0){this._updateRecalc(t,n)}changedContents(){this._updateRecalc()}forceLayout(){this._updateRecalc()}isChanged(){return this._recalc>0}_updateRecalc(t=!1,n=!1){if(this.isFlexEnabled()){const f=this._flex._layout;t=t||f.isAxisFitToContents(!0),n=n||f.isAxisFitToContents(!1)}const o=1+(t?2:0)+(n?4:0),u=this.getNewRecalcFlags(o);this._recalc|=o,u>1?this.flexParent?this.flexParent._updateRecalcBottomUp(o):this._target.triggerLayout():this._target.triggerLayout()}getNewRecalcFlags(t){return 7-this._recalc&t}_updateRecalcBottomUp(t){const n=this._getRecalcFromChangedChildRecalc(t),o=this.getNewRecalcFlags(n);if(this._recalc|=n,o>1){const u=this.flexParent;u?u._updateRecalcBottomUp(n):this._target.triggerLayout()}else this._target.triggerLayout()}_getRecalcFromChangedChildRecalc(t){const n=this._flex._layout,o=n._horizontal?1:2,u=n._horizontal?2:1;t&u||t&o&&n.isWrapping()&&n.isCrossAxisFitToContents()&&(t+=u);let m=n.isAxisFitToContents(!0),p=n.isAxisFitToContents(!1);n.shrunk&&(n._horizontal?m=!0:p=!0);const v=1+(m?2:0)+(p?4:0);return t&v}get recalc(){return this._recalc}clearRecalcFlag(){this._recalc=0}enableLocalRecalcFlag(){this._recalc=1}get originalX(){return this._originalX}setOriginalXWithoutUpdatingLayout(t){this._originalX=t}get originalY(){return this._originalY}setOriginalYWithoutUpdatingLayout(t){this._originalY=t}get originalWidth(){return this._originalWidth}set originalWidth(t){this._originalWidth!==t&&(this._originalWidth=t,this.changedDimensions(!0,!1))}get originalHeight(){return this._originalHeight}set originalHeight(t){this._originalHeight!==t&&(this._originalHeight=t,this.changedDimensions(!1,!0))}get funcX(){return this._target.funcX}get funcY(){return this._target.funcY}get funcW(){return this._target.funcW}get funcH(){return this._target.funcH}}class bs{constructor(t,n=null){this.id=bs.id++,this.manager=t,this.stage=t.stage,this.textures=new Set,this._activeTextureCount=0,this.loader=n,this.lookupId=null,this._cancelCb=null,this.loadingSince=0,this.w=0,this.h=0,this._nativeTexture=null,this.permanent=!1,this.renderInfo=null,this._isResultTexture=!this.loader,this._loadError=null,this._imageRef=null,this._hasAlpha=!1}get hasAlpha(){return this._hasAlpha}get loadError(){return this._loadError}addTexture(t){this.textures.has(t)||this.textures.add(t)}removeTexture(t){this.textures.delete(t)}incActiveTextureCount(){this._activeTextureCount++,this._activeTextureCount===1&&this.becomesUsed()}decActiveTextureCount(){this._activeTextureCount--,this._activeTextureCount===0&&this.becomesUnused()}get isResultTexture(){return this._isResultTexture}set isResultTexture(t){this._isResultTexture=t}forEachEnabledElement(t){this.textures.forEach(n=>{n.elements.forEach(t)})}hasEnabledElements(){return this.textures.size>0}forEachActiveElement(t){this.textures.forEach(n=>{n.elements.forEach(o=>{o.active&&t(o)})})}getRenderWidth(){return this.w}getRenderHeight(){return this.h}allowCleanup(){return!this.permanent&&!this.isUsed()}becomesUsed(){this.load()}becomesUnused(){this.cancel()}cancel(){this.isLoading()&&(this._cancelCb&&(this._cancelCb(this),this._cancelCb=null),this.loadingSince=0)}isLoaded(){return!!this._nativeTexture}isLoading(){return this.loadingSince>0}isError(){return!!this._loadError}reload(){this.free(),this.isUsed()&&this.load()}load(t=!1){this.isResultTexture||!this._nativeTexture&&!this.isLoading()&&(this.loadingSince=new Date().getTime(),this._cancelCb=this.loader((n,o)=>{if(this.isLoading()){if(this._cancelCb=null,this.manager.stage.destroyed)return;if(n)this.onError(n);else if(o&&o.source)if(!this.stage.isUpdatingFrame()&&!t&&o.throttle!==!1){const u=this.stage.textureThrottler;this._cancelCb=u.genericCancelCb,u.add(this,o)}else this.processLoadedSource(o)}},this))}processLoadedSource(t){this.loadingSince=0,this.setSource(t)}setSource(t){const n=t.source;this._hasAlpha=t&&t.hasAlpha||!1,this.w=n.width||t&&t.w||0,this.h=n.height||t&&t.h||0,t&&t.renderInfo&&(this.renderInfo=t.renderInfo),this.permanent=!!t.permanent,t&&t.imageRef&&(this._imageRef=t.imageRef),t&&t.flipTextureY?this._flipTextureY=t.flipTextureY:this._flipTextureY=!1,this._isNativeTexture(n)?(this._nativeTexture=n,this.w=this.w||n.w,this.h=this.h||n.h,this.permanent=t.hasOwnProperty("permanent")?t.permanent:!0):this.manager.uploadTextureSource(this,t),this._loadError=null,this.onLoad()}isUsed(){return this._activeTextureCount>0}onLoad(){this.isUsed()&&this.textures.forEach(t=>{t.onLoad()})}forceRenderUpdate(){this._nativeTexture&&(this._nativeTexture.update=this.stage.frameCounter),this.forEachActiveElement(function(t){t.forceRenderUpdate()})}forceUpdateRenderCoords(){this.forEachActiveElement(function(t){t._updateTextureCoords()})}get nativeTexture(){return this._nativeTexture}clearNativeTexture(){this._nativeTexture=null,this._imageRef=null}replaceNativeTexture(t,n,o){let u=this._nativeTexture;this._nativeTexture=t,this.w=n,this.h=o,!u&&this._nativeTexture&&this.forEachActiveElement(f=>f.onTextureSourceLoaded()),this._nativeTexture||this.forEachActiveElement(f=>f._setDisplayedTexture(null)),this.forEachEnabledElement(f=>f._updateDimensions())}onError(t){this._loadError=t,this.loadingSince=0,console.error("[Lightning] texture load error",t,this.lookupId),this.forEachActiveElement(n=>n.onTextureSourceLoadError(t))}free(){this.isLoaded()&&this.manager.freeTextureSource(this)}_isNativeTexture(t){return $.isNode?t.constructor.name==="WebGLTexture":"WebGLTexture"in window?t instanceof WebGLTexture:!1}}bs.prototype.isTextureSource=!0;bs.id=1;class qv{constructor(t){this._element=t.element,this._core=t,this.ctx=this._core.ctx,this._enabled=!1,this.lazy=!1,this._colorize=!1,this._renderTexture=null,this._renderTextureReused=!1,this._resultTextureSource=null,this._renderOffscreen=!1,this.empty=!1}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._core.updateRenderToTextureEnabled()}get renderOffscreen(){return this._renderOffscreen}set renderOffscreen(t){this._renderOffscreen=t,this._core.setHasRenderUpdates(1),this._core._setRecalc(6)}get colorize(){return this._colorize}set colorize(t){this._colorize!==t&&(this._colorize=t,this._core.setHasRenderUpdates(1))}_getTextureSource(){return this._resultTextureSource||(this._resultTextureSource=new bs(this._element.stage.textureManager),this.updateResultTexture()),this._resultTextureSource}hasResultTexture(){return!!this._resultTextureSource}resultTextureInUse(){return this._resultTextureSource&&this._resultTextureSource.hasEnabledElements()}updateResultTexture(){let t=this.getResultTexture();if(this._resultTextureSource){if(this._resultTextureSource.nativeTexture!==t){let n=t?t.w:0,o=t?t.h:0;this._resultTextureSource.replaceNativeTexture(t,n,o)}this._resultTextureSource.forEachEnabledElement(n=>{n._updateDimensions(),n.core.setHasRenderUpdates(3)})}}mustRenderToTexture(){return this._enabled&&!this.lazy?!0:!!(this._enabled&&this.lazy&&this._core._hasRenderUpdates<3)}deactivate(){this.release()}get renderTextureReused(){return this._renderTextureReused}release(){this.releaseRenderTexture()}releaseRenderTexture(){this._renderTexture&&(this._renderTextureReused||this.ctx.releaseRenderTexture(this._renderTexture),this._renderTexture=null,this._renderTextureReused=!1,this.updateResultTexture())}reuseTextureAsRenderTexture(t){this._renderTexture!==t&&(this.releaseRenderTexture(),this._renderTexture=t,this._renderTextureReused=!0)}hasRenderTexture(){return!!this._renderTexture}getRenderTexture(){return this._renderTexture||(this._renderTexture=this.ctx.allocateRenderTexture(this._core._w,this._core._h),this._renderTextureReused=!1),this._renderTexture}getResultTexture(){return this._renderTexture}}class bn{constructor(t){this._element=t,this.ctx=t.stage.ctx,this._recalc=0,this._parent=null,this._onUpdate=null,this._pRecalc=0,this._worldContext=new Cn,this._hasUpdates=!1,this._localAlpha=1,this._onAfterCalcs=null,this._onAfterUpdate=null,this._localPx=0,this._localPy=0,this._localTa=1,this._localTb=0,this._localTc=0,this._localTd=1,this._isComplex=!1,this._dimsUnknown=!1,this._clipping=!1,this._zSort=!1,this._outOfBounds=0,this._displayedTextureSource=null,this._zContextUsage=0,this._children=null,this._hasRenderUpdates=0,this._zIndexedChildren=null,this._renderContext=this._worldContext,this.renderState=this.ctx.renderState,this._scissor=null,this._shaderOwner=null,this._updateTreeOrder=0,this._colorUl=this._colorUr=this._colorBl=this._colorBr=4294967295,this._x=0,this._y=0,this._w=0,this._h=0,this._optFlags=0,this._funcX=null,this._funcY=null,this._funcW=null,this._funcH=null,this._scaleX=1,this._scaleY=1,this._pivotX=.5,this._pivotY=.5,this._mountX=0,this._mountY=0,this._rotation=0,this._alpha=1,this._visible=!0,this._ulx=0,this._uly=0,this._brx=1,this._bry=1,this._zIndex=0,this._forceZIndexContext=!1,this._zParent=null,this._isRoot=!1,this._zIndexResort=!1,this._shader=null,this._renderToTextureEnabled=!1,this._texturizer=null,this._useRenderToTexture=!1,this._boundsMargin=null,this._recBoundsMargin=null,this._withinBoundsMargin=!1,this._viewport=null,this._clipbox=!0,this.render=this._renderSimple,this._layout=null}get offsetX(){return this._funcX?this._funcX:this.hasFlexLayout()?this._layout.originalX:this._x}set offsetX(t){$.isFunction(t)?this.funcX=t:(this._disableFuncX(),this.hasFlexLayout()?(this.x+=t-this._layout.originalX,this._layout.setOriginalXWithoutUpdatingLayout(t)):this.x=t)}get x(){return this._x}set x(t){t!==this._x&&(this._updateLocalTranslateDelta(t-this._x,0),this._x=t)}get funcX(){return this._optFlags&1?this._funcX:null}set funcX(t){this._funcX!==t&&(this._optFlags|=1,this._funcX=t,this.hasFlexLayout()?(this._layout.setOriginalXWithoutUpdatingLayout(0),this.layout.forceLayout()):(this._x=0,this._triggerRecalcTranslate()))}_disableFuncX(){this._optFlags=this._optFlags&65535-1,this._funcX=null}get offsetY(){return this._funcY?this._funcY:this.hasFlexLayout()?this._layout.originalY:this._y}set offsetY(t){$.isFunction(t)?this.funcY=t:(this._disableFuncY(),this.hasFlexLayout()?(this.y+=t-this._layout.originalY,this._layout.setOriginalYWithoutUpdatingLayout(t)):this.y=t)}get y(){return this._y}set y(t){t!==this._y&&(this._updateLocalTranslateDelta(0,t-this._y),this._y=t)}get funcY(){return this._optFlags&2?this._funcY:null}set funcY(t){this._funcY!==t&&(this._optFlags|=2,this._funcY=t,this.hasFlexLayout()?(this._layout.setOriginalYWithoutUpdatingLayout(0),this.layout.forceLayout()):(this._y=0,this._triggerRecalcTranslate()))}_disableFuncY(){this._optFlags=this._optFlags&65535-2,this._funcY=null}get funcW(){return this._optFlags&4?this._funcW:null}set funcW(t){this._funcW!==t&&(this._optFlags|=4,this._funcW=t,this.hasFlexLayout()?(this._layout._originalWidth=0,this.layout.changedDimensions(!0,!1)):(this._w=0,this._triggerRecalcTranslate()))}disableFuncW(){this._optFlags=this._optFlags&65535-4,this._funcW=null}get funcH(){return this._optFlags&8?this._funcH:null}set funcH(t){this._funcH!==t&&(this._optFlags|=8,this._funcH=t,this.hasFlexLayout()?(this._layout._originalHeight=0,this.layout.changedDimensions(!1,!0)):(this._h=0,this._triggerRecalcTranslate()))}disableFuncH(){this._optFlags=this._optFlags&65535-8,this._funcH=null}get w(){return this._w}getRenderWidth(){return this.hasFlexLayout()?this._layout.originalWidth:this._w}get h(){return this._h}getRenderHeight(){return this.hasFlexLayout()?this._layout.originalHeight:this._h}get scaleX(){return this._scaleX}set scaleX(t){this._scaleX!==t&&(this._scaleX=t,this._updateLocalTransform())}get scaleY(){return this._scaleY}set scaleY(t){this._scaleY!==t&&(this._scaleY=t,this._updateLocalTransform())}get scale(){return this.scaleX}set scale(t){(this._scaleX!==t||this._scaleY!==t)&&(this._scaleX=t,this._scaleY=t,this._updateLocalTransform())}get pivotX(){return this._pivotX}set pivotX(t){this._pivotX!==t&&(this._pivotX=t,this._updateLocalTranslate())}get pivotY(){return this._pivotY}set pivotY(t){this._pivotY!==t&&(this._pivotY=t,this._updateLocalTranslate())}get pivot(){return this._pivotX}set pivot(t){(this._pivotX!==t||this._pivotY!==t)&&(this._pivotX=t,this._pivotY=t,this._updateLocalTranslate())}get mountX(){return this._mountX}set mountX(t){this._mountX!==t&&(this._mountX=t,this._updateLocalTranslate())}get mountY(){return this._mountY}set mountY(t){this._mountY!==t&&(this._mountY=t,this._updateLocalTranslate())}get mount(){return this._mountX}set mount(t){(this._mountX!==t||this._mountY!==t)&&(this._mountX=t,this._mountY=t,this._updateLocalTranslate())}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._updateLocalTransform())}get alpha(){return this._alpha}set alpha(t){if(t=t>1?1:t<1e-14?0:t,this._alpha!==t){let n=this._alpha;this._alpha=t,this._updateLocalAlpha(),n===0!=(t===0)&&this._element._updateEnabledFlag()}}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateLocalAlpha(),this._element._updateEnabledFlag(),this.hasFlexLayout()&&this.layout.setVisible(t))}_updateLocalTransform(){if(this._rotation!==0&&this._rotation%(2*Math.PI)){let t=Math.sin(this._rotation),n=Math.cos(this._rotation);this._setLocalTransform(n*this._scaleX,-t*this._scaleY,t*this._scaleX,n*this._scaleY)}else this._setLocalTransform(this._scaleX,0,0,this._scaleY);this._updateLocalTranslate()}_updateLocalTranslate(){this._recalcLocalTranslate(),this._triggerRecalcTranslate()}_recalcLocalTranslate(){let t=this._pivotX*this._w,n=this._pivotY*this._h,o=this._x-(t*this._localTa+n*this._localTb)+t,u=this._y-(t*this._localTc+n*this._localTd)+n;o-=this._mountX*this._w,u-=this._mountY*this._h,this._localPx=o,this._localPy=u}_updateLocalTranslateDelta(t,n){this._addLocalTranslate(t,n)}_updateLocalAlpha(){this._setLocalAlpha(this._visible?this._alpha:0)}setHasRenderUpdates(t){if(this._worldContext.alpha){let n=this;for(n._hasRenderUpdates=Math.max(t,n._hasRenderUpdates);(n=n._parent)&&n._hasRenderUpdates!==3;)n._hasRenderUpdates=3}}_setRecalc(t){this._recalc|=t,this._setHasUpdates(),this._parent&&this._parent.setHasRenderUpdates(3)}_setHasUpdates(){let t=this;for(;t&&!t._hasUpdates;)t._hasUpdates=!0,t=t._parent}getParent(){return this._parent}setParent(t){if(t!==this._parent){let n=this.isZContext(),o=this._parent;if(this._parent=t,(this._layout||t&&t.isFlexContainer())&&this.layout.setParent(o,t),o&&o.setHasRenderUpdates(3),this._setRecalc(1+2+4),this._parent&&this._parent._setHasUpdates(),this._zIndex===0?this.setZParent(t):this.setZParent(t?t.findZContext():null),n!==this.isZContext()&&(this.isZContext()?this.enableZContext(o.findZContext()):this.disableZContext()),this._zIndexResort=!0,this._zParent&&this._zParent.enableZSort(),!this._shader){let u=t&&!t._renderToTextureEnabled?t._shaderOwner:null;u!==this._shaderOwner&&(this.setHasRenderUpdates(1),this._setShaderOwnerRecursive(u))}}}enableZSort(t=!1){!this._zSort&&this._zContextUsage>0&&(this._zSort=!0,t&&this.ctx.forceZSort(this))}addChildAt(t,n){this._children||(this._children=[]),this._children.splice(t,0,n),n.setParent(this)}setChildAt(t,n){this._children||(this._children=[]),this._children[t].setParent(null),this._children[t]=n,n.setParent(this)}removeChildAt(t){let n=this._children[t];this._children.splice(t,1),n.setParent(null)}removeChildren(){if(this._children){for(let t=0,n=this._children.length;t<n;t++)this._children[t].setParent(null);this._children.splice(0),this._zIndexedChildren&&this._zIndexedChildren.splice(0)}}syncChildren(t,n,o){this._children=o;for(let u=0,f=t.length;u<f;u++)t[u].setParent(null);for(let u=0,f=n.length;u<f;u++)n[u].setParent(this)}moveChild(t,n){let o=this._children[t];this._children.splice(t,1),this._children.splice(n,0,o),this._zIndexResort=!0,this._zParent&&this._zParent.enableZSort()}_setLocalTransform(t,n,o,u){this._setRecalc(4),this._localTa=t,this._localTb=n,this._localTc=o,this._localTd=u,this._isComplex=n!==0||o!==0||t<0||u<0}_addLocalTranslate(t,n){this._localPx+=t,this._localPy+=n,this._triggerRecalcTranslate()}_setLocalAlpha(t){!this._worldContext.alpha&&this._parent&&this._parent._worldContext.alpha&&t?this._setRecalc(1+128):this._setRecalc(1),t<1e-14&&(t=0),this._localAlpha=t}setDimensions(t,n,o=this._dimsUnknown){if(this._dimsUnknown=o,this.hasFlexLayout())this._layout.originalWidth=t,this._layout.originalHeight=n;else if(this._w!==t||this._h!==n)return this._updateDimensions(t,n),!0;return!1}_updateDimensions(t,n){(this._w!==t||this._h!==n)&&(this._w=t,this._h=n,this._triggerRecalcTranslate(),this._texturizer&&(this._texturizer.releaseRenderTexture(),this._texturizer.updateResultTexture()),this._updateLocalTranslate())}setTextureCoords(t,n,o,u){this.setHasRenderUpdates(3),this._ulx=t,this._uly=n,this._brx=o,this._bry=u}get displayedTextureSource(){return this._displayedTextureSource}setDisplayedTextureSource(t){this.setHasRenderUpdates(3),this._displayedTextureSource=t}get isRoot(){return this._isRoot}setAsRoot(){this._parent=new bn(this._element),this._parent._hasRenderUpdates=3,this._parent._hasUpdates=!0,this._isRoot=!0,this.ctx.root=this,this._parent._viewport=[0,0,this.ctx.stage.coordsWidth,this.ctx.stage.coordsHeight],this._parent._scissor=this._parent._viewport,this._parent._recBoundsMargin=null,this._setRecalc(1+2+4)}isAncestorOf(t){let n=t;for(;n=n._parent;)if(this===n)return!0;return!1}isZContext(){return this._forceZIndexContext||this._renderToTextureEnabled||this._zIndex!==0||this._isRoot||!this._parent}findZContext(){return this.isZContext()?this:this._parent.findZContext()}setZParent(t){if(this._zParent!==t){if(this._zParent!==null&&(this._zIndex!==0&&this._zParent.decZContextUsage(),this._zParent.enableZSort()),t!==null){let n=t._zContextUsage>0;this._zIndex!==0&&t.incZContextUsage(),t._zContextUsage>0&&(!n&&this._parent===t||t._zIndexedChildren.push(this),t.enableZSort())}this._zParent=t,this._zIndexResort=!0}}incZContextUsage(){if(this._zContextUsage++,this._zContextUsage===1&&(this._zIndexedChildren||(this._zIndexedChildren=[]),this._children)){for(let t=0,n=this._children.length;t<n;t++)this._zIndexedChildren.push(this._children[t]);this._zSort=!1}}decZContextUsage(){this._zContextUsage--,this._zContextUsage===0&&(this._zSort=!1,this._zIndexedChildren.splice(0))}get zIndex(){return this._zIndex}set zIndex(t){if(this._zIndex!==t){this.setHasRenderUpdates(1);let n=this._zParent,o=this.isZContext();t===0&&this._zIndex!==0?this._parent===this._zParent?this._zParent&&this._zParent.decZContextUsage():n=this._parent:t!==0&&this._zIndex===0?(n=this._parent?this._parent.findZContext():null,n===this._zParent&&this._zParent&&(this._zParent.incZContextUsage(),this._zParent.enableZSort())):t!==this._zIndex&&this._zParent&&this._zParent._zContextUsage&&this._zParent.enableZSort(),n!==this._zParent&&this.setZParent(null),this._zIndex=t,n!==this._zParent&&this.setZParent(n),o!==this.isZContext()&&(this.isZContext()?this.enableZContext(this._parent.findZContext()):this.disableZContext()),this._zIndexResort=!0,this._zParent&&this._zParent.enableZSort()}}get forceZIndexContext(){return this._forceZIndexContext}set forceZIndexContext(t){this.setHasRenderUpdates(1);let n=this.isZContext();this._forceZIndexContext=t,n!==this.isZContext()&&(this.isZContext()?this.enableZContext(this._parent.findZContext()):this.disableZContext())}enableZContext(t){t&&t._zContextUsage>0&&this._getZIndexedDescs().forEach(o=>{this.isAncestorOf(o)&&o._zIndex!==0&&o.setZParent(this)})}_getZIndexedDescs(){const t=[];if(this._children)for(let n=0,o=this._children.length;n<o;n++)this._children[n]._getZIndexedDescsRec(t);return t}_getZIndexedDescsRec(t){if(this._zIndex)t.push(this);else if(this._children&&!this.isZContext())for(let n=0,o=this._children.length;n<o;n++)this._children[n]._getZIndexedDescsRec(t)}disableZContext(){if(this._zContextUsage>0){let t=this._parent.findZContext();this._zSort&&this.sortZIndexedChildren(),this._zIndexedChildren.slice().forEach(function(n){n._zIndex!==0&&n.setZParent(t)})}}get colorUl(){return this._colorUl}set colorUl(t){this._colorUl!==t&&(this.setHasRenderUpdates(this._displayedTextureSource?3:1),this._colorUl=t)}get colorUr(){return this._colorUr}set colorUr(t){this._colorUr!==t&&(this.setHasRenderUpdates(this._displayedTextureSource?3:1),this._colorUr=t)}get colorBl(){return this._colorBl}set colorBl(t){this._colorBl!==t&&(this.setHasRenderUpdates(this._displayedTextureSource?3:1),this._colorBl=t)}get colorBr(){return this._colorBr}set colorBr(t){this._colorBr!==t&&(this.setHasRenderUpdates(this._displayedTextureSource?3:1),this._colorBr=t)}set onUpdate(t){this._onUpdate=t,this._setRecalc(7)}set onAfterUpdate(t){this._onAfterUpdate=t,this._setRecalc(7)}set onAfterCalcs(t){this._onAfterCalcs=t,this._setRecalc(7)}get shader(){return this._shader}set shader(t){this.setHasRenderUpdates(1);let n=this._shader;if(this._shader=t,!t&&n){let o=this._parent&&!this._parent._renderToTextureEnabled?this._parent._shaderOwner:null;this._setShaderOwnerRecursive(o)}else t&&this._setShaderOwnerRecursive(this)}get activeShader(){return this._shaderOwner?this._shaderOwner.shader:this.renderState.defaultShader}get activeShaderOwner(){return this._shaderOwner}get clipping(){return this._clipping}set clipping(t){this._clipping!==t&&(this._clipping=t,this._setRecalc(1+2))}get clipbox(){return this._clipbox}set clipbox(t){this._clipbox=t}_setShaderOwnerRecursive(t){if(this._shaderOwner=t,this._children&&!this._renderToTextureEnabled)for(let n=0,o=this._children.length;n<o;n++){let u=this._children[n];u._shader||(u._setShaderOwnerRecursive(t),u._hasRenderUpdates=3)}}_setShaderOwnerChildrenRecursive(t){if(this._children)for(let n=0,o=this._children.length;n<o;n++){let u=this._children[n];u._shader||(u._setShaderOwnerRecursive(t),u._hasRenderUpdates=3)}}_hasRenderContext(){return this._renderContext!==this._worldContext}get renderContext(){return this._renderContext}updateRenderToTextureEnabled(){this.texturizer._enabled?this._enableRenderToTexture():(this._disableRenderToTexture(),this._texturizer.releaseRenderTexture())}_enableRenderToTexture(){if(!this._renderToTextureEnabled){let t=this.isZContext();this._renderToTextureEnabled=!0,this._renderContext=new Cn,this._setShaderOwnerChildrenRecursive(null),t||this.enableZContext(this._parent?this._parent.findZContext():null),this.setHasRenderUpdates(3),this._setRecalc(7),this.render=this._renderAdvanced}}_disableRenderToTexture(){this._renderToTextureEnabled&&(this._renderToTextureEnabled=!1,this._setShaderOwnerChildrenRecursive(this._shaderOwner),this._renderContext=this._worldContext,this.isZContext()||this.disableZContext(),this._setRecalc(7),this.setHasRenderUpdates(3),this.render=this._renderSimple)}isWhite(){return this._colorUl===4294967295&&this._colorUr===4294967295&&this._colorBl===4294967295&&this._colorBr===4294967295}hasSimpleTexCoords(){return this._ulx===0&&this._uly===0&&this._brx===1&&this._bry===1}_stashTexCoords(){this._stashedTexCoords=[this._ulx,this._uly,this._brx,this._bry],this._ulx=0,this._uly=0,this._brx=1,this._bry=1}_unstashTexCoords(){this._ulx=this._stashedTexCoords[0],this._uly=this._stashedTexCoords[1],this._brx=this._stashedTexCoords[2],this._bry=this._stashedTexCoords[3],this._stashedTexCoords=null}_stashColors(){this._stashedColors=[this._colorUl,this._colorUr,this._colorBr,this._colorBl],this._colorUl=4294967295,this._colorUr=4294967295,this._colorBr=4294967295,this._colorBl=4294967295}_unstashColors(){this._colorUl=this._stashedColors[0],this._colorUr=this._stashedColors[1],this._colorBr=this._stashedColors[2],this._colorBl=this._stashedColors[3],this._stashedColors=null}isVisible(){return this._localAlpha>1e-14}get outOfBounds(){return this._outOfBounds}set boundsMargin(t){this._boundsMargin=t?t.slice():null,this._triggerRecalcTranslate()}get boundsMargin(){return this._boundsMargin}update(){this._recalc|=this._parent._pRecalc,this._layout&&this._layout.isEnabled()?this._recalc&256&&this._layout.layoutFlexTree():this._recalc&2&&this._optFlags&&this._applyRelativeDimFuncs(),this._onUpdate&&(this._hasUpdates=!0,this._onUpdate(this.element,this));const t=this._parent._worldContext;let n=this._worldContext;const o=t.alpha&&this._localAlpha;if(this._hasUpdates||this._recalc&&o||n.alpha&&!o){let u=this._recalc;u&1&&(!n.alpha&&o&&(this._hasRenderUpdates=3),n.alpha=t.alpha*this._localAlpha,n.alpha<1e-14&&(n.alpha=0)),u&6&&(n.px=t.px+this._localPx*t.ta,n.py=t.py+this._localPy*t.td,t.tb!==0&&(n.px+=this._localPy*t.tb),t.tc!==0&&(n.py+=this._localPx*t.tc)),u&4&&(n.ta=this._localTa*t.ta,n.tb=this._localTd*t.tb,n.tc=this._localTa*t.tc,n.td=this._localTd*t.td,this._isComplex&&(n.ta+=this._localTc*t.tb,n.tb+=this._localTb*t.ta,n.tc+=this._localTc*t.td,n.td+=this._localTb*t.tc));const f=this._parent._renderContext;if(this._parent._hasRenderContext()){const I=this._renderContext===this._worldContext;I&&(this._renderContext=new Cn);const U=this._renderContext;(I||u&1)&&(U.alpha=f.alpha*this._localAlpha,U.alpha<1e-14&&(U.alpha=0)),(I||u&6)&&(U.px=f.px+this._localPx*f.ta,U.py=f.py+this._localPy*f.td,f.tb!==0&&(U.px+=this._localPy*f.tb),f.tc!==0&&(U.py+=this._localPx*f.tc)),I&&(u|=2),(I||u&4)&&(U.ta=this._localTa*f.ta,U.tb=this._localTd*f.tb,U.tc=this._localTa*f.tc,U.td=this._localTd*f.td,this._isComplex&&(U.ta+=this._localTc*f.tb,U.tb+=this._localTb*f.ta,U.tc+=this._localTc*f.td,U.td+=this._localTb*f.tc))}else this._renderContext=this._worldContext;this.ctx.updateTreeOrder===-1?this.ctx.updateTreeOrder=this._updateTreeOrder+1:this._updateTreeOrder=this.ctx.updateTreeOrder++;const m=this._renderToTextureEnabled&&this._texturizer.mustRenderToTexture();this._useRenderToTexture!==m&&(this._recalc|=2+4,u|=2,this._useRenderToTexture||this._texturizer.release()),this._useRenderToTexture=m;const p=this._renderContext,v=this._dimsUnknown?2048:this._w,w=this._dimsUnknown?2048:this._h;let C,L,E,R;const y=p.tb!==0||p.tc!==0||p.ta<0||p.td<0;if(y?(C=Math.min(0,v*p.ta,v*p.ta+w*p.tb,w*p.tb)+p.px,E=Math.max(0,v*p.ta,v*p.ta+w*p.tb,w*p.tb)+p.px,L=Math.min(0,v*p.tc,v*p.tc+w*p.td,w*p.td)+p.py,R=Math.max(0,v*p.tc,v*p.tc+w*p.td,w*p.td)+p.py):(C=p.px,E=p.px+p.ta*v,L=p.py,R=p.py+p.td*w),this._dimsUnknown&&(y||this._localTa<1||this._localTb<1)){const I=this._x*f.ta+this._y*f.tb+f.px,U=this._x*f.tc+this._y*f.td+f.py;I<C&&(C=I),U<L&&(L=U),I>E&&(E=I),U>R&&(R=U)}if(u&6||!this._scissor)if(this._clipping&&p.isSquare()){const I=this._parent._useRenderToTexture?this._parent._viewport:this._parent._scissor;if(I){const U=Math.max(I[0],C),Z=Math.max(I[1],L);this._scissor=[U,Z,Math.min(I[2]+I[0],E)-U,Math.min(I[3]+I[1],R)-Z]}else this._scissor=[C,L,E-C,R-L]}else this._scissor=this._parent._useRenderToTexture?this._parent._viewport:this._parent._scissor;if(this._boundsMargin?this._recBoundsMargin=this._boundsMargin:this._recBoundsMargin=this._parent._recBoundsMargin,this._onAfterCalcs&&this._onAfterCalcs(this.element)&&(y?(C=Math.min(0,v*p.ta,v*p.ta+w*p.tb,w*p.tb)+p.px,E=Math.max(0,v*p.ta,v*p.ta+w*p.tb,w*p.tb)+p.px,L=Math.min(0,v*p.tc,v*p.tc+w*p.td,w*p.td)+p.py,R=Math.max(0,v*p.tc,v*p.tc+w*p.td,w*p.td)+p.py):(C=p.px,E=p.px+p.ta*v,L=p.py,R=p.py+p.td*w),this._dimsUnknown&&(y||this._localTa<1||this._localTb<1))){const I=this._x*f.ta+this._y*f.tb+f.px,U=this._x*f.tc+this._y*f.td+f.py;I<C&&(C=I),U<L&&(L=U),I>E&&(E=I),U>R&&(R=U)}if(this._parent._outOfBounds===2)this._outOfBounds=2,this._withinBoundsMargin&&(this._withinBoundsMargin=!1,this.element._disableWithinBoundsMargin());else if(u&6){this._outOfBounds=0;let I=!0;if((!this._renderToTextureEnabled||!this._texturizer||!this._texturizer.renderOffscreen)&&(this._scissor&&(this._scissor[2]<=0||this._scissor[3]<=0)?this._outOfBounds=2:((this._scissor[0]>E||this._scissor[1]>R||C>this._scissor[0]+this._scissor[2]||L>this._scissor[1]+this._scissor[3])&&(this._outOfBounds=1),this._outOfBounds&&(this._clipping||this._useRenderToTexture||this._clipbox&&v&&w)&&(this._outOfBounds=2)),I=this._outOfBounds===0,I||(this._recBoundsMargin?I=!(E<this._scissor[0]-this._recBoundsMargin[2]||R<this._scissor[1]-this._recBoundsMargin[3]||C>this._scissor[0]+this._scissor[2]+this._recBoundsMargin[0]||L>this._scissor[1]+this._scissor[3]+this._recBoundsMargin[1]):I=!(E<this._scissor[0]-100||R<this._scissor[1]-100||C>this._scissor[0]+this._scissor[2]+100||L>this._scissor[1]+this._scissor[3]+100),I&&this._outOfBounds===2&&(this._outOfBounds=1))),this._withinBoundsMargin!==I)if(this._withinBoundsMargin=I,this._withinBoundsMargin){this._hasUpdates=!0;const U=this._recalc;if(this._recalc=0,this.element._enableWithinBoundsMargin(),this._recalc)return this.update();this._recalc=U}else this.element._disableWithinBoundsMargin()}if(this._useRenderToTexture&&(this._viewport?(this._viewport[2]=v,this._viewport[3]=w):this._viewport=[0,0,v,w]),this._pRecalc=this._recalc&135,this._recalc=0,this._hasUpdates=!1,this._outOfBounds<2){if(this._useRenderToTexture&&(this._worldContext.isIdentity()?this._renderContext=this._worldContext:this._renderContext=Cn.IDENTITY),this._children)for(let I=0,U=this._children.length;I<U;I++)this._children[I].update();this._useRenderToTexture&&(this._renderContext=p)}else if(this._children)for(let I=0,U=this._children.length;I<U;I++)this._children[I]._hasUpdates?this._children[I].update():(this._children[I]._recalc|=this._pRecalc,this._children[I].updateOutOfBounds());this._onAfterUpdate&&this._onAfterUpdate(this.element)}else this.ctx.updateTreeOrder===-1||this._updateTreeOrder>=this.ctx.updateTreeOrder?this.ctx.updateTreeOrder=-1:this.updateTreeOrder()}_applyRelativeDimFuncs(){if(this._optFlags&1){const n=this._funcX(this._parent.w);n!==this._x&&(this._localPx+=n-this._x,this._x=n)}if(this._optFlags&2){const n=this._funcY(this._parent.h);n!==this._y&&(this._localPy+=n-this._y,this._y=n)}let t=!1;if(this._optFlags&4){const n=this._funcW(this._parent.w);n!==this._w&&(this._w=n,t=!0)}if(this._optFlags&8){const n=this._funcH(this._parent.h);n!==this._h&&(this._h=n,t=!0)}t&&(this._recalcLocalTranslate(),this.element.onDimensionsChanged(this._w,this._h))}updateOutOfBounds(){if(this._outOfBounds!==2&&this._renderContext.alpha>0&&(this._outOfBounds=2,this._withinBoundsMargin&&(this._withinBoundsMargin=!1,this.element._disableWithinBoundsMargin()),this._children))for(let t=0,n=this._children.length;t<n;t++)this._children[t].updateOutOfBounds()}updateTreeOrder(){if(this._localAlpha&&this._outOfBounds!==2&&(this._updateTreeOrder=this.ctx.updateTreeOrder++,this._children))for(let t=0,n=this._children.length;t<n;t++)this._children[t].updateTreeOrder()}_renderSimple(){if(this._hasRenderUpdates=0,this._zSort&&this.sortZIndexedChildren(),this._outOfBounds<2&&this._renderContext.alpha){let t=this.renderState;if(this._outOfBounds===0&&this._displayedTextureSource&&(t.setShader(this.activeShader,this._shaderOwner),t.setScissor(this._scissor),this.renderState.addQuad(this)),this._children)if(this._zContextUsage)for(let n=0,o=this._zIndexedChildren.length;n<o;n++)this._zIndexedChildren[n].render();else for(let n=0,o=this._children.length;n<o;n++)this._children[n]._zIndex===0&&this._children[n].render()}}_renderAdvanced(){const t=this._hasRenderUpdates;if(this._hasRenderUpdates=0,this._zSort&&this.sortZIndexedChildren(),this._outOfBounds<2&&this._renderContext.alpha){let n=this.renderState,o=!0,u,f;if(this._useRenderToTexture){if(this._w===0||this._h===0)return;if(!this._texturizer.hasRenderTexture()||t>=3){if(this.ctx.renderToTextureCount++,n.setShader(n.defaultShader,this),f=n.renderTextureInfo,u={nativeTexture:null,offset:0,w:this._w,h:this._h,empty:!0,cleared:!1,ignore:!1,cache:!1},(this._texturizer.hasResultTexture()||!n.isCachingTexturizer&&t<3)&&(u.cache=!0,n.isCachingTexturizer=!0),this._texturizer.hasResultTexture()||this._texturizer.releaseRenderTexture(),n.setRenderTextureInfo(u),n.setScissor(null),this._displayedTextureSource){let m=this._renderContext;this._renderContext=Cn.IDENTITY,this.renderState.addQuad(this),this._renderContext=m}}else o=!1}else this._outOfBounds===0&&this._displayedTextureSource&&(n.setShader(this.activeShader,this._shaderOwner),n.setScissor(this._scissor),this.renderState.addQuad(this));if(o&&this._children)if(this._zContextUsage)for(let m=0,p=this._zIndexedChildren.length;m<p;m++)this._zIndexedChildren[m].render();else for(let m=0,p=this._children.length;m<p;m++)this._children[m]._zIndex===0&&this._children[m].render();if(this._useRenderToTexture){let m=!1;if(o&&(n.finishedRenderTexture(),this._texturizer.empty=u.empty,u.empty?this._texturizer.releaseRenderTexture():u.nativeTexture?(this._texturizer.reuseTextureAsRenderTexture(u.nativeTexture),u.ignore=!0):(this._texturizer.renderTextureReused&&this._texturizer.releaseRenderTexture(),u.nativeTexture=this._texturizer.getRenderTexture()),n.setRenderTextureInfo(f),m=!0),!this._texturizer.empty){let p=this._texturizer.getResultTexture();if(m&&(p&&(p.update=n.stage.frameCounter),this._texturizer.updateResultTexture()),!this._texturizer.renderOffscreen){n.setShader(this.activeShader,this._shaderOwner),n.setScissor(this._scissor);const v=!u||u.cache;n.setTexturizer(this._texturizer,v),this._stashTexCoords(),this._texturizer.colorize||this._stashColors(),this.renderState.addQuad(this,!0),this._texturizer.colorize||this._unstashColors(),this._unstashTexCoords(),n.setTexturizer(null)}}}u&&u.cache&&(n.isCachingTexturizer=!1)}}get zSort(){return this._zSort}sortZIndexedChildren(){const t=this._zIndexedChildren.length;let n=0;const o=this._zIndexedChildren,u=[];for(let m=0;m<t;m++)o[m]._zParent===this&&(o[m]._zIndexResort?u.push(o[m]):(n!==m&&(o[n]=o[m]),n++));const f=u.length;if(f){for(let p=0;p<f;p++)u[p]._zIndexResort=!1;u.sort(bn.sortZIndexedChildren);const m=n;if(m){n=0;let p=0,v=0;const w=[];do{const L=(o[p]._zIndex===u[v]._zIndex?o[p]._updateTreeOrder-u[v]._updateTreeOrder:o[p]._zIndex-u[v]._zIndex)>0?u[v++]:o[p++];if((n===0||w[n-1]!==L)&&(w[n++]=L),p>=m){do{const E=u[v++];(n===0||w[n-1]!==E)&&(w[n++]=E)}while(v<f);break}else if(v>=f){do{const E=o[p++];(n===0||w[n-1]!==E)&&(w[n++]=E)}while(p<m);break}}while(!0);this._zIndexedChildren=w}else{n=0;let p=0;do o[n++]=u[p++];while(p<f);o.length>n&&o.splice(n)}}else o.length>n&&o.splice(n);this._zSort=!1}get localTa(){return this._localTa}get localTb(){return this._localTb}get localTc(){return this._localTc}get localTd(){return this._localTd}get element(){return this._element}get renderUpdates(){return this._hasRenderUpdates}get texturizer(){return this._texturizer||(this._texturizer=new qv(this)),this._texturizer}getCornerPoints(){let t=this._worldContext;return[t.px,t.py,t.px+this._w*t.ta,t.py+this._w*t.tc,t.px+this._w*t.ta+this._h*t.tb,t.py+this._w*t.tc+this._h*t.td,t.px+this._h*t.tb,t.py+this._h*t.td]}getRenderTextureCoords(t,n){let o=this._renderContext;return[o.px+o.ta*t+o.tb*n,o.py+o.tc*t+o.td*n]}getAbsoluteCoords(t,n){let o=this._renderContext;return[o.px+o.ta*t+o.tb*n,o.py+o.tc*t+o.td*n]}collectAtCoord(t,n,o){if(this._renderContext.alpha!==0){if(this.inBound(t,n)&&(this._scissor?this.inScissor()&&o.push(this):o.push(this)),this._children){const u=this._children.length;for(let f=0;f<u;f++)this._children[f].collectAtCoord(t,n,o)}return o.sort(bn.sortZIndexedChildren)}}inBound(t,n){const o=this.getCornerPoints();return t>o[0]&&t<o[2]&&n>o[1]&&n<o[7]}inScissor(){const t=this._scissor,n=this.getCornerPoints();return n[2]>=t[0]&&n[0]<=t[0]+t[2]&&n[7]>=t[1]&&n[1]<=t[1]+t[3]}get layout(){return this._ensureLayout(),this._layout}get flex(){return this._layout?this._layout.flex:null}set flex(t){this.layout.flex=t}get flexItem(){return this._layout?this._layout.flexItem:null}set flexItem(t){this.layout.flexItem=t}isFlexItem(){return!!this._layout&&this._layout.isFlexItemEnabled()}isFlexContainer(){return!!this._layout&&this._layout.isFlexEnabled()}enableFlexLayout(){this._ensureLayout()}_ensureLayout(){this._layout||(this._layout=new Sb(this))}disableFlexLayout(){this._triggerRecalcTranslate()}hasFlexLayout(){return this._layout&&this._layout.isEnabled()}setLayout(t,n,o,u){this.x=t,this.y=n,this._updateDimensions(o,u)}triggerLayout(){this._setRecalc(256)}_triggerRecalcTranslate(){this._setRecalc(2)}}class Cn{constructor(){this.alpha=1,this.px=0,this.py=0,this.ta=1,this.tb=0,this.tc=0,this.td=1}isIdentity(){return this.alpha===1&&this.px===0&&this.py===0&&this.ta===1&&this.tb===0&&this.tc===0&&this.td===1}isSquare(){return this.tb===0&&this.tc===0}}Cn.IDENTITY=new Cn;bn.sortZIndexedChildren=function(c,t){return c._zIndex===t._zIndex?c._updateTreeOrder-t._updateTreeOrder:c._zIndex-t._zIndex};class mt{constructor(){this._hasEventListeners=!1}on(t,n){this._hasEventListeners||(this._eventFunction={},this._eventListeners={},this._hasEventListeners=!0),this._eventFunction[t]?this._eventFunction[t]!==mt.combiner?(this._eventListeners[t]=[this._eventFunction[t],n],this._eventFunction[t]=mt.combiner):this._eventListeners[t].push(n):this._eventFunction[t]=n}once(t,n){const o=(u,f,m)=>{n(u,f,m),this.off(t,o)};o.__originalFunc=n,this.on(t,o)}has(t,n){if(this._hasEventListeners){const o=this._eventFunction[t];if(o){if(o===mt.combiner){const u=this._eventListeners[t];for(const f of u)if(f===n||f.__originalFunc==n)return!0}else if(this._eventFunction[t]===n||this._eventFunction[t].__originalFunc===n)return!0}}return!1}off(t,n){if(this._hasEventListeners){const o=this._eventFunction[t];if(o)if(o===mt.combiner){const u=this._eventListeners[t];let f=u.indexOf(n);f>=0&&u.splice(f,1),f=u.map(m=>m.__originalFunc).indexOf(n),f>=0&&u.splice(f,1),u.length===1&&(this._eventFunction[t]=u[0],this._eventListeners[t]=void 0)}else(this._eventFunction[t]===n||this._eventFunction[t].__originalFunc===n)&&(this._eventFunction[t]=void 0)}}removeListener(t,n){this.off(t,n)}emit(t,n,o,u){if(this._hasEventListeners){const f=this._eventFunction[t];f&&(f===mt.combiner?f(this,t,n,o,u):f(n,o,u))}}listenerCount(t){if(this._hasEventListeners){const n=this._eventFunction[t];if(n)return n===mt.combiner?this._eventListeners[t].length:1}return 0}removeAllListeners(t){this._hasEventListeners&&(delete this._eventFunction[t],delete this._eventListeners[t])}}mt.combiner=function(c,t,n,o,u){const f=c._eventListeners[t];if(f)for(const m of[...f])m(n,o,u)};mt.addAsMixin=function(c){c.prototype.on=mt.prototype.on,c.prototype.once=mt.prototype.once,c.prototype.has=mt.prototype.has,c.prototype.off=mt.prototype.off,c.prototype.removeListener=mt.prototype.removeListener,c.prototype.emit=mt.prototype.emit,c.prototype.listenerCount=mt.prototype.listenerCount,c.prototype.removeAllListeners=mt.prototype.removeAllListeners};class Qo{constructor(t){this._initialized=!1,this.ctx=t,this._elements=new Set}static create(t,n){let o;if($.isObjectLiteral(n))n.type?o=t.renderer.createShader(t.ctx,n):o=this.shader,o&&Ot.patchObject(o,n);else if(n===null)o=t.ctx.renderState.defaultShader;else if(n===void 0)o=null;else if(n.isShader)t.renderer.isValidShaderType(n.constructor)||(console.error("[Lightning] Invalid shader type"),n=null),o=n;else{console.error("[Lightning] Please specify a shader type.");return}return o}static getWebGL(){}static getC2d(){}addElement(t){this._elements.add(t)}removeElement(t){this._elements.delete(t),this._elements||this.cleanup()}redraw(){this._elements.forEach(t=>{t.setHasRenderUpdates(2)})}patch(t){Ot.patchObject(this,t)}useDefault(){return!1}addEmpty(){return!1}cleanup(){}get isShader(){return!0}}class ai{constructor(t){this.stage=t,this.manager=this.stage.textureManager,this.id=ai.id++,this.elements=new Set,this._activeCount=0,this._source=null,this._resizeMode=null,this._x=0,this._y=0,this._w=0,this._h=0,this._precision=1,this.mw=0,this.mh=0,this.clipping=!1,this._mustUpdate=!0}get source(){return(this._mustUpdate||this.stage.hasUpdateSourceTexture(this))&&(this._performUpdateSource(!0),this.stage.removeUpdateSourceTexture(this)),this._source}addElement(t){this.elements.has(t)||(this.elements.add(t),this.elements.size===1&&this._source&&this._source.addTexture(this),t.active&&this.incActiveCount())}removeElement(t){this.elements.delete(t)&&(this.elements.size===0&&this._source&&this._source.removeTexture(this),t.active&&this.decActiveCount())}incActiveCount(){this.source&&this._checkForNewerReusableTextureSource(),this._activeCount++,this._activeCount===1&&this.becomesUsed()}decActiveCount(){this.source,this._activeCount--,this._activeCount||this.becomesUnused()}becomesUsed(){this.source&&this.source.incActiveTextureCount()}onLoad(){this._resizeMode&&this._applyResizeMode(),this.elements.forEach(t=>{t.active&&t.onTextureSourceLoaded()})}_checkForNewerReusableTextureSource(){const t=this.source;if(t.isLoaded())this._resizeMode&&this._applyResizeMode();else{const n=this._getReusableTextureSource();n&&n.isLoaded()&&n!==t&&this._replaceTextureSource(n)}}becomesUnused(){this.source&&this.source.decActiveTextureCount()}isUsed(){return this._activeCount>0}_getLookupId(){return null}_getSourceLoader(){throw new Error("Texture.generate must be implemented.")}get isValid(){return this._getIsValid()}_getIsValid(){return!0}_changed(){this.isUsed()?this._updateSource():this._mustUpdate=!0}_updateSource(){this.stage.addUpdateSourceTexture(this)}_performUpdateSource(t=!1){if(t||this.isUsed()){this._mustUpdate=!1;let n=this._getTextureSource();this._replaceTextureSource(n)}}_getTextureSource(){let t=null;if(this._getIsValid()){const n=this._getLookupId();t=this._getReusableTextureSource(n),t||(t=this.manager.getTextureSource(this._getSourceLoader(),n))}return t}_getReusableTextureSource(t=this._getLookupId()){return this._getIsValid()&&t?this.manager.getReusableTextureSource(t):null}_replaceTextureSource(t=null){let n=this._source;if(this._source=t,this.elements.size&&(n&&(this._activeCount&&n.decActiveTextureCount(),n.removeTexture(this),this.text&&!n.isUsed()&&this.manager.freeTextureSource(n)),t&&(t.addTexture(this),this._activeCount&&t.incActiveTextureCount())),this.isUsed())if(t)if(t.isLoaded())this._resizeMode&&this._applyResizeMode(),this.elements.forEach(o=>{o.active&&o._setDisplayedTexture(this)});else{const o=t.loadError;o&&this.elements.forEach(u=>{u.active&&u.onTextureSourceLoadError(o)})}else this.elements.forEach(o=>{o.active&&o._setDisplayedTexture(null)})}load(){this.source&&(this.isLoaded()||this.source.load(!0))}isLoaded(){return this._source&&this._source.isLoaded()}get loadError(){return this._source&&this._source.loadError}free(){this._source&&this._source.free()}set resizeMode({type:t="cover",w:n=0,h:o=0,clipX:u=.5,clipY:f=.5}){this._resizeMode={type:t,w:n,h:o,clipX:u,clipY:f},this.isLoaded()&&this._applyResizeMode()}get resizeMode(){return this._resizeMode}_clearResizeMode(){this._resizeMode=null}_applyResizeMode(){this._resizeMode.type==="cover"?this._applyResizeCover():this._resizeMode.type==="contain"&&this._applyResizeContain(),this._updatePrecision(),this._updateClipping()}_applyResizeCover(){const t=this._resizeMode.w/this._source.w,n=this._resizeMode.h/this._source.h;let o=Math.max(t,n);if(o){if(this._precision=1/o,t&&t<o){const u=this._precision*this._resizeMode.w,f=this._source.w-u;this._x=f*this._resizeMode.clipX,this._w=this._source.w-f}if(n&&n<o){const u=this._precision*this._resizeMode.h,f=this._source.h-u;this._y=f*this._resizeMode.clipY,this._h=this._source.h-f}}}_applyResizeContain(){const t=this._resizeMode.w/this._source.w,n=this._resizeMode.h/this._source.h;let o=t;(!o||n<o)&&(o=n),o&&(this._precision=1/o)}enableClipping(t,n,o,u){this._clearResizeMode(),t*=this._precision,n*=this._precision,o*=this._precision,u*=this._precision,(this._x!==t||this._y!==n||this._w!==o||this._h!==u)&&(this._x=t,this._y=n,this._w=o,this._h=u,this._updateClipping(!0))}disableClipping(){this._clearResizeMode(),(this._x||this._y||this._w||this._h)&&(this._x=0,this._y=0,this._w=0,this._h=0,this._updateClipping())}_updateClipping(){this.clipping=!!(this._x||this._y||this._w||this._h);let t=this;this.elements.forEach(function(n){n.displayedTexture===t&&n.onDisplayedTextureClippingChanged()})}_updatePrecision(){let t=this;this.elements.forEach(function(n){n.displayedTexture===t&&n.onPrecisionChanged()})}getNonDefaults(){let t={};return t.type=this.constructor.name,this.x!==0&&(t.x=this.x),this.y!==0&&(t.y=this.y),this.w!==0&&(t.w=this.w),this.h!==0&&(t.h=this.h),this.precision!==1&&(t.precision=this.precision),t}get px(){return this._x}get py(){return this._y}get pw(){return this._w}get ph(){return this._h}get x(){return this._x/this._precision}set x(t){this._clearResizeMode(),t=t*this._precision,this._x!==t&&(this._x=t,this._updateClipping())}get y(){return this._y/this._precision}set y(t){this._clearResizeMode(),t=t*this._precision,this._y!==t&&(this._y=t,this._updateClipping())}get w(){return this._w/this._precision}set w(t){this._clearResizeMode(),t=t*this._precision,this._w!==t&&(this._w=t,this._updateClipping())}get h(){return this._h/this._precision}set h(t){this._clearResizeMode(),t=t*this._precision,this._h!==t&&(this._h=t,this._updateClipping())}get precision(){return this._precision}set precision(t){this._clearResizeMode(),this._precision!==t&&(this._precision=t,this._updatePrecision())}isAutosizeTexture(){return!0}getRenderWidth(){return this.isAutosizeTexture()?(this._w||(this._source?this._source.getRenderWidth()-this._x:0))/this._precision:0}getRenderHeight(){return this.isAutosizeTexture()?(this._h||(this._source?this._source.getRenderHeight()-this._y:0))/this._precision:0}patch(t){Ot.patchObject(this,t)}}ai.prototype.isTexture=!0;ai.id=0;class Nd extends ai{constructor(t){super(t),this._src=void 0,this._hasAlpha=!1}get src(){return this._src}set src(t){this._src!==t&&(this._src=t,this._changed())}get hasAlpha(){return this._hasAlpha}set hasAlpha(t){this._hasAlpha!==t&&(this._hasAlpha=t,this._changed())}_getIsValid(){return!!this._src}_getLookupId(){return this._src}_getSourceLoader(){let t=this._src,n=this._hasAlpha;if(this.stage.getOption("srcBasePath")){var o=t.charCodeAt(0);t.indexOf("//")===-1&&(o>=65&&o<=90||o>=97&&o<=122||o==46)&&(t=this.stage.getOption("srcBasePath")+t)}return u=>this.stage.platform.loadSrcTexture({src:t,hasAlpha:n},u)}getNonDefaults(){const t=super.getNonDefaults();return this._src&&(t.src=this._src),t}}function uu(c,t,n,o,u){let f=c;Array.isArray(f)||(f=[f]);let m=[];for(let p=0,v=f.length;p<v;p++){let w=f[p];w===null&&(w=u),w==="serif"||w==="sans-serif"?m.push(w):m.push(`"${w}"`)}return`${t} ${n*o}px ${m.join(",")}`}class sv{constructor(t,n,o){this._stage=t,this._canvas=n,this._context=this._canvas.getContext("2d"),this._settings=o}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=uu(this._settings.fontFace,this._settings.fontStyle,this._settings.fontSize,this.getPrecision(),this._stage.getOption("defaultFontFace")),this._context.textBaseline=this._settings.textBaseline}_load(){if($.isWeb&&document.fonts){const t=uu(this._settings.fontFace,this._settings.fontStyle,this._settings.fontSize,this.getPrecision(),this._stage.getOption("defaultFontFace"));try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(n=>{console.warn("[Lightning] Font load error",n,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("[Lightning] Font not found",t)})}catch(n){console.warn("[Lightning] Can't check font loading for "+t)}}}draw(){const t=this._load();return t?t.then(()=>$.isSpark?this._stage.platform.drawText(this):this._draw()):$.isSpark?this._stage.platform.drawText(this):this._draw()}_calculateRenderInfo(){let t={};const n=this.getPrecision(),o=this._settings.paddingLeft*n,u=this._settings.paddingRight*n,f=this._settings.fontSize*n;let m=this._settings.offsetY===null?null:this._settings.offsetY*n,p=this._settings.lineHeight*n;const v=this._settings.w*n,w=this._settings.h*n;let C=this._settings.wordWrapWidth*n;const L=this._settings.cutSx*n,E=this._settings.cutEx*n,R=this._settings.cutSy*n,y=this._settings.cutEy*n,I=(this._settings.letterSpacing||0)*n,U=this._settings.textIndent*n;this.setFontProperties();let Z=v||2048/this.getPrecision(),te=Z-o;if(te<10&&(Z+=10-te,te=10),C||(C=te),this._settings.textOverflow&&!this._settings.wordWrap){let ge;switch(this._settings.textOverflow){case"clip":ge="";break;case"ellipsis":ge=this._settings.maxLinesSuffix;break;default:ge=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,C-U,ge)}let q;if(this._settings.wordWrap)q=this.wrapText(this._settings.text,C,I,U);else{q={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};let ge=q.l.length;for(let ue=0;ue<ge-1;ue++)q.n.push(ue)}let H=q.l;if(this._settings.maxLines&&H.length>this._settings.maxLines){let ge=H.slice(0,this._settings.maxLines),ue=null;if(this._settings.maxLinesSuffix){let we=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,oe=this.wrapText(ge[ge.length-1],C-we,I,U);ge[ge.length-1]=oe.l[0]+this._settings.maxLinesSuffix,ue=[oe.l.length>1?oe.l[1]:""]}else ue=[""];let b,Q=H.length,fe=0,et=q.n.length;for(b=this._settings.maxLines;b<Q;b++)ue[fe]+=(ue[fe]?" ":"")+H[b],b+1<et&&q.n[b+1]&&fe++;t.remainingText=ue.join(`
`),t.moreTextLines=!0,H=ge}else t.moreTextLines=!1,t.remainingText="";let se=0,he=[];for(let ge=0;ge<H.length;ge++){let ue=this.measureText(H[ge],I)+(ge===0?U:0);he.push(ue),se=Math.max(se,ue)}t.lineWidths=he,v||(Z=se+o+u,te=se),p=p||f;let je;if(w)je=w;else{const ge=this._settings.textBaseline!="bottom"?.5*f:0;je=p*(H.length-1)+ge+Math.max(p,f)+m}return m===null&&(m=f),t.w=Z,t.h=je,t.lines=H,t.precision=n,Z||(Z=1),je||(je=1),(L||E)&&(Z=Math.min(Z,E-L)),(R||y)&&(je=Math.min(je,y-R)),t.width=Z,t.innerWidth=te,t.height=je,t.fontSize=f,t.cutSx=L,t.cutSy=R,t.cutEx=E,t.cutEy=y,t.lineHeight=p,t.lineWidths=he,t.offsetY=m,t.paddingLeft=o,t.paddingRight=u,t.letterSpacing=I,t.textIndent=U,t}_draw(){const t=this._calculateRenderInfo(),n=this.getPrecision();this._canvas.width=Math.ceil(t.width+this._stage.getOption("textRenderIssueMargin")),this._canvas.height=Math.ceil(t.height),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);let o,u,f=[];for(let p=0,v=t.lines.length;p<v;p++)o=p===0?t.textIndent:0,u=p*t.lineHeight+t.offsetY,this._settings.verticalAlign=="middle"?u+=(t.lineHeight-t.fontSize)/2:this._settings.verticalAlign=="bottom"&&(u+=t.lineHeight-t.fontSize),this._settings.textAlign==="right"?o+=t.innerWidth-t.lineWidths[p]:this._settings.textAlign==="center"&&(o+=(t.innerWidth-t.lineWidths[p])/2),o+=t.paddingLeft,f.push({text:t.lines[p],x:o,y:u,w:t.lineWidths[p]});if(this._settings.highlight){let p=this._settings.highlightColor||0,v=this._settings.highlightHeight*n||t.fontSize*1.5;const w=this._settings.highlightOffset*n,C=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*n:t.paddingLeft,L=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*n:t.paddingRight;this._context.fillStyle=Te.getRgbaString(p);for(let E=0;E<f.length;E++){let R=f[E];this._context.fillRect(R.x-C,R.y-t.offsetY+w,R.w+L+C,v)}}let m=null;this._settings.shadow&&(m=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Te.getRgbaString(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*n,this._context.shadowOffsetY=this._settings.shadowOffsetY*n,this._context.shadowBlur=this._settings.shadowBlur*n),this._context.fillStyle=Te.getRgbaString(this._settings.textColor);for(let p=0,v=f.length;p<v;p++){let w=f[p];if(t.letterSpacing===0)this._context.fillText(w.text,w.x,w.y);else{const C=w.text.split("");let L=w.x;for(let E=0,R=C.length;E<R;E++)this._context.fillText(C[E],L,w.y),L+=this.measureText(C[E],t.letterSpacing)}}m&&(this._context.shadowColor=m[0],this._context.shadowOffsetX=m[1],this._context.shadowOffsetY=m[2],this._context.shadowBlur=m[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy),this.renderInfo=t}wrapWord(t,n,o){const u=this._context.measureText(o).width,f=t.length,m=this._context.measureText(t).width;if(m<=n)return t;let p=Math.floor(n*f/m),v=this._context.measureText(t.substring(0,p)).width+u;if(v>n)for(;p>0&&(v=this._context.measureText(t.substring(0,p)).width+u,v>n);)p-=1;else for(;p<f;)if(v=this._context.measureText(t.substring(0,p)).width+u,v<n)p+=1;else{p-=1;break}return t.substring(0,p)+(n>=u?o:"")}wrapText(t,n,o,u=0){let f=t.split(/\r?\n/g),m=[],p=[];for(let v=0;v<f.length;v++){let w=[],C="",L=n-u,E=f[v].split(" ");for(let R=0;R<E.length;R++){const y=this.measureText(E[R],o),I=y+this.measureText(" ",o);R===0||I>L?(R>0&&(w.push(C),C=""),C+=E[R],L=n-y-(R===0?u:0)):(L-=I,C+=" "+E[R])}w.push(C),C="",m=m.concat(w),v<f.length-1&&p.push(m.length)}return{l:m,n:p}}measureText(t,n=0){return n?t.split("").reduce((o,u)=>o+this._context.measureText(u).width+n,0):this._context.measureText(t).width}}class ov{constructor(t,n,o){this._stage=t,this._canvas=n,this._context=this._canvas.getContext("2d"),this._settings=o}getPrecision(){return this._settings.precision}setFontProperties(){const t=uu(this._settings.fontFace,this._settings.fontStyle,this._settings.fontSize,this.getPrecision(),this._stage.getOption("defaultFontFace"));return this._context.font=t,this._context.textBaseline=this._settings.textBaseline,t}_load(){if($.isWeb&&document.fonts){const t=uu(this._settings.fontFace,this._settings.fontStyle,this._settings.fontSize,this.getPrecision(),this._stage.getOption("defaultFontFace"));try{if(!document.fonts.check(t,this._settings.text))return document.fonts.load(t,this._settings.text).catch(n=>{console.warn("Font load error",n,t)}).then(()=>{document.fonts.check(t,this._settings.text)||console.warn("Font not found",t)})}catch(n){console.warn("Can't check font loading for "+t)}}}draw(){const t=this._load();return t?t.then(()=>$.isSpark?this._stage.platform.drawText(this):this._draw()):$.isSpark?this._stage.platform.drawText(this):this._draw()}_calculateRenderInfo(){let t={};const n=this.getPrecision(),o=this._settings.paddingLeft*n,u=this._settings.paddingRight*n,f=this._settings.fontSize*n,m=this._settings.lineHeight*n||f,p=this._settings.w!=0?this._settings.w*n:2048/n,v=this._settings.wordWrapWidth*n,w=this._settings.cutSx*n,C=this._settings.cutEx*n,L=this._settings.cutSy*n,E=this._settings.cutEy*n,R=this._settings.letterSpacing||0;t.baseFont=this.setFontProperties(),t.w=p,t.width=p,t.text=this._settings.text,t.precision=n,t.fontSize=f,t.fontBaselineRatio=this._settings.fontBaselineRatio,t.lineHeight=m,t.letterSpacing=R,t.textAlign=this._settings.textAlign,t.textColor=this._settings.textColor,t.verticalAlign=this._settings.verticalAlign,t.highlight=this._settings.highlight,t.highlightColor=this._settings.highlightColor,t.highlightHeight=this._settings.highlightHeight,t.highlightPaddingLeft=this._settings.highlightPaddingLeft,t.highlightPaddingRight=this._settings.highlightPaddingRight,t.highlightOffset=this._settings.highlightOffset,t.paddingLeft=this._settings.paddingLeft,t.paddingRight=this._settings.paddingRight,t.maxLines=this._settings.maxLines,t.maxLinesSuffix=this._settings.maxLinesSuffix,t.textOverflow=this._settings.textOverflow,t.wordWrap=this._settings.wordWrap,t.wordWrapWidth=v,t.shadow=this._settings.shadow,t.shadowColor=this._settings.shadowColor,t.shadowOffsetX=this._settings.shadowOffsetX,t.shadowOffsetY=this._settings.shadowOffsetY,t.shadowBlur=this._settings.shadowBlur,t.cutSx=w,t.cutEx=C,t.cutSy=L,t.cutEy=E,t.textIndent=this._settings.textIndent*n,t.wordBreak=this._settings.wordBreak;let y=t.text,I=t.wordWrap&&t.wordWrapWidth||t.width;if(t.textOverflow&&!t.wordWrap){let H;switch(this._settings.textOverflow){case"clip":H="";break;case"ellipsis":H=this._settings.maxLinesSuffix;break;default:H=this._settings.textOverflow}y=this.wrapWord(y,v||t.w,H)}y=this.tokenize(y),y=this.parse(y),y=this.measure(y,R,t.baseFont),t.textIndent&&(y=this.indent(y,t.textIndent)),t.wordBreak&&(y=y.reduce((H,se)=>H.concat(this.wordBreak(se,I,t.baseFont)),[]),this.resetFontStyle());let U=o,Z=0;for(const H of y)(t.wordWrap&&U+H.width>I||H.text==`
`)&&(U=o,Z+=1),H.lineNo=Z,H.text!=`
`&&(H.x=U,U+=H.width);t.lineNum=Z+1,this._settings.h?t.h=this._settings.h:t.maxLines&&t.maxLines<t.lineNum?t.h=t.maxLines*t.lineHeight+f/2:t.h=t.lineNum*t.lineHeight+f/2;const te=t.fontBaselineRatio*t.fontSize;let q=0;t.verticalAlign=="top"&&this._context.textBaseline=="alphabetic"?q=-te:t.verticalAlign=="middle"?q=(t.lineHeight-t.fontSize-te)/2:this._settings.verticalAlign=="bottom"&&(q=t.lineHeight-t.fontSize),t.lines=[];for(let H=0;H<t.lineNum;H++)t.lines[H]={width:0,x:0,y:t.lineHeight*H+q,text:[]};for(let H of y)t.lines[H.lineNo].text.push(H);for(const H of t.lines){if(H.text.length==0)continue;const se=H.text[0].text,he=H.text[H.text.length-1].text;se==`
`&&H.text.shift(),(he==" "||he==`
`)&&H.text.pop()}for(let H of t.lines)H.width=H.text.reduce((se,he)=>se+he.width,0);if(t.width=this._settings.w!=0?this._settings.w*n:Math.max(...t.lines.map(H=>H.width))+u,t.w=t.width,t.maxLines&&t.lineNum>t.maxLines&&t.maxLinesSuffix){const H=t.maxLines-1;let se=y.filter(ue=>ue.lineNo==H),he=t.maxLinesSuffix;he=this.tokenize(he),he=this.parse(he),he=this.measure(he,t.letterSpacing,t.baseFont);for(const ue of he)ue.lineNo=H,ue.x=0,se.push(ue);const je=he.length+1;let ge=se.reduce((ue,b)=>ue+b.width,0);for(;(ge>t.width||se[se.length-je].text==" ")&&(se.splice(se.length-je,1),ge=se.reduce((ue,b)=>ue+b.width,0),!(se.length<je)););this.alignLine(se,se[0].x),t.lines[H].text=se,t.lines[H].width=ge}if(t.textAlign=="center")for(let H of t.lines)H.x=(t.width-H.width-o)/2;else if(t.textAlign=="right")for(let H of t.lines)H.x=t.width-H.width-o;return t}_draw(){const t=this._calculateRenderInfo(),n=this.getPrecision(),o=t.paddingLeft*n;let u=t.w||t.width;(t.cutSx||t.cutEx)&&(u=Math.min(t.w,t.cutEx-t.cutSx));let f=t.h;if((t.cutSy||t.cutEy)&&(f=Math.min(t.h,t.cutEy-t.cutSy)),this._canvas.width=Math.ceil(u+this._stage.getOption("textRenderIssueMargin")),this._canvas.height=Math.ceil(f),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy),t.highlight){const w=t.highlightColor||0,C=t.highlightHeight?t.highlightHeight*n:t.fontSize*1.5,L=t.highlightOffset?t.highlightOffset*n:0,E=t.highlightPaddingLeft!==null?t.highlightPaddingLeft*n:t.paddingLeft,R=t.highlightPaddingRight!==null?t.highlightPaddingRight*n:t.paddingRight;this._context.fillStyle=Te.getRgbaString(w);const y=t.maxLines?Math.min(t.maxLines,t.lineNum):t.lineNum;for(let I=0;I<y;I++){const U=t.lines[I];this._context.fillRect(U.x-E+o,U.y+L,U.width+E+R,C)}}let m=null;this._settings.shadow&&(m=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Te.getRgbaString(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*n,this._context.shadowOffsetY=this._settings.shadowOffsetY*n,this._context.shadowBlur=this._settings.shadowBlur*n);const p=Te.getRgbaString(this._settings.textColor);let v=p;this._context.fillStyle=p;for(const w of t.lines)for(const C of w.text){let L=0;if(C.text!=`
`&&!(t.maxLines&&C.lineNo>=t.maxLines))if(C.color!=v&&(v=C.color,this._context.fillStyle=v),this._context.font=C.fontStyle,C.letters)for(let E of C.letters){const R=t.lines[C.lineNo].x+C.x+L;this._context.fillText(E.text,R,t.lines[C.lineNo].y+t.fontSize),L+=E.width}else{const E=t.lines[C.lineNo].x+C.x;this._context.fillText(C.text,E,t.lines[C.lineNo].y+t.fontSize)}}m&&(this._context.shadowColor=m[0],this._context.shadowOffsetX=m[1],this._context.shadowOffsetY=m[2],this._context.shadowBlur=m[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy),t.lines=t.lines.map(w=>w.text.reduce((C,L)=>C+L.text,"")),t.maxLines&&(t.lines=t.lines.slice(0,t.maxLines)),this.renderInfo=t}measureText(t,n=0){return n?t.split("").reduce((o,u)=>o+this._context.measureText(u).width+n,0):this._context.measureText(t).width}tokenize(t){const n=/ |\n|<i>|<\/i>|<b>|<\/b>|<color=0[xX][0-9a-fA-F]{8}>|<\/color>/g,o=t.match(n)||[],u=t.split(n)||[];let f=[];for(let m=0;m<u.length;m++)f.push(u[m],o[m]);return f.pop(),f.filter(m=>m!="")}parse(t){let n=0,o=0,u=[Te.getRgbaString(this._settings.textColor)],f=0;const m=/<color=(0[xX][0-9a-fA-F]{8})>/;return t.map(p=>{if(p=="<i>")n+=1,p="";else if(p=="</i>"&&n>0)n-=1,p="";else if(p=="<b>")o+=1,p="";else if(p=="</b>"&&o>0)o-=1,p="";else if(p=="</color>")u.length>1&&(f-=1,u.pop()),p="";else if(m.test(p)){const v=m.exec(p);u.push(Te.getRgbaString(parseInt(v[1]))),f+=1,p=""}return{text:p,italic:n,bold:o,color:u[f]}}).filter(p=>p.text!="")}applyFontStyle(t,n){let o=n;t.bold&&(o="bold "+o),t.italic&&(o="italic "+o),this._context.font=o,t.fontStyle=o}resetFontStyle(t){this._context.font=t}measure(t,n=0,o){for(const u of t)if(this.applyFontStyle(u,o),u.width=this.measureText(u.text,n),n>0){u.letters=u.text.split("").map(f=>({text:f}));for(let f of u.letters)f.width=this.measureText(f.text,n)}return this.resetFontStyle(o),t}indent(t,n){return t.splice(0,0,{text:"",width:n}),t}wrapWord(t,n,o){const u=this._context.measureText(o).width,f=t.length,m=this._context.measureText(t).width;if(m<=n)return t;let p=Math.floor(n*f/m),v=this._context.measureText(t.substring(0,p)).width+u;if(v>n)for(;p>0&&(v=this._context.measureText(t.substring(0,p)).width+u,v>n);)p-=1;else for(;p<f;)if(v=this._context.measureText(t.substring(0,p)).width+u,v<n)p+=1;else{p-=1;break}return t.substring(0,p)+(n>=u?o:"")}_getBreakIndex(t,n){const o=t.length,u=this.measureText(t);if(u<=n)return{breakIndex:t.length,truncWordWidth:u};let f=Math.floor(n*o/u),m=this.measureText(t.substring(0,f));if(m>n)for(;f>0&&(m=this.measureText(t.substring(0,f)),m>n);)f-=1;else for(;f<o;)if(m=this.measureText(t.substring(0,f)),m<n)f+=1;else{f-=1,m=this.measureText(t.substring(0,f));break}return{breakIndex:f,truncWordWidth:m}}wordBreak(t,n,o){if(!t.text)return t;this.applyFontStyle(t,o);const u=[];let f=t.text;if(t.letters){let m=0,p=[],v=0;for(const w of t.letters)m+w.width>=n?(u.push({...t}),u[u.length-1].text=f.slice(0,v),u[u.length-1].width=m,u[u.length-1].letters=p,f=f.slice(v),m=0,p=[],v=0):(v+=1,p.push(w),m+=w.width);m>0&&(u.push({...t}),u[u.length-1].text=f.slice(0,v),u[u.length-1].width=m,u[u.length-1].letters=p)}else for(;;){const{breakIndex:m,truncWordWidth:p}=this._getBreakIndex(f,n);if(u.push({...t}),u[u.length-1].text=f.slice(0,m),u[u.length-1].width=p,m===f.length)break;f=f.slice(m)}return u}alignLine(t,n=0){let o=0,u=n;for(const f of t)f.text!=`
`&&(f.x=u+o,u=f.x,o=f.width)}}class An extends ai{constructor(t){super(t),this._precision=this.stage.getOption("precision")}static renderer(t,n,o){return this.advancedRenderer?new ov(t,n,o):new sv(t,n,o)}get text(){return this._text}set text(t){this._text!==t&&(this._text=""+t,this._changed())}get w(){return this._w}set w(t){this._w!==t&&(this._w=t,this._changed())}get h(){return this._h}set h(t){this._h!==t&&(this._h=t,this._changed())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this._changed())}get fontBaselineRatio(){return this._fontBaselineRatio}set fontBaselineRatio(t){this._fontBaselineRatio!==t&&(this._fontBaselineRatio=t,this._changed())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this._changed())}get fontFace(){return this._fontFace}set fontFace(t){this._fontFace!==t&&(this._fontFace=t,this._changed())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this._changed())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this._changed())}get wordBreak(){return this._wordBreak}set wordBreak(t){this._wordBreak!==t&&(this._wordBreak=t,this._changed())}get textOverflow(){return this._textOverflow}set textOverflow(t){t!=this._textOverflow&&(this._textOverflow=t,this._changed())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this._changed())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this._changed())}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign!==t&&(this._textAlign=t,this._changed())}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){this._verticalAlign!==t&&(this._verticalAlign=t,this._changed())}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._changed())}get maxLines(){return this._maxLines}set maxLines(t){this._maxLines!==t&&(this._maxLines=t,this._changed())}get maxLinesSuffix(){return this._maxLinesSuffix}set maxLinesSuffix(t){this._maxLinesSuffix!==t&&(this._maxLinesSuffix=t,this._changed())}get textColor(){return this._textColor}set textColor(t){this._textColor!==t&&(this._textColor=t,this._changed())}get paddingLeft(){return this._paddingLeft}set paddingLeft(t){this._paddingLeft!==t&&(this._paddingLeft=t,this._changed())}get paddingRight(){return this._paddingRight}set paddingRight(t){this._paddingRight!==t&&(this._paddingRight=t,this._changed())}get shadow(){return this._shadow}set shadow(t){this._shadow!==t&&(this._shadow=t,this._changed())}get shadowColor(){return this._shadowColor}set shadowColor(t){this._shadowColor!==t&&(this._shadowColor=t,this._changed())}get shadowOffsetX(){return this._shadowOffsetX}set shadowOffsetX(t){this._shadowOffsetX!==t&&(this._shadowOffsetX=t,this._changed())}get shadowOffsetY(){return this._shadowOffsetY}set shadowOffsetY(t){this._shadowOffsetY!==t&&(this._shadowOffsetY=t,this._changed())}get shadowBlur(){return this._shadowBlur}set shadowBlur(t){this._shadowBlur!==t&&(this._shadowBlur=t,this._changed())}get highlight(){return this._highlight}set highlight(t){this._highlight!==t&&(this._highlight=t,this._changed())}get highlightHeight(){return this._highlightHeight}set highlightHeight(t){this._highlightHeight!==t&&(this._highlightHeight=t,this._changed())}get highlightColor(){return this._highlightColor}set highlightColor(t){this._highlightColor!==t&&(this._highlightColor=t,this._changed())}get highlightOffset(){return this._highlightOffset}set highlightOffset(t){this._highlightOffset!==t&&(this._highlightOffset=t,this._changed())}get highlightPaddingLeft(){return this._highlightPaddingLeft}set highlightPaddingLeft(t){this._highlightPaddingLeft!==t&&(this._highlightPaddingLeft=t,this._changed())}get highlightPaddingRight(){return this._highlightPaddingRight}set highlightPaddingRight(t){this._highlightPaddingRight!==t&&(this._highlightPaddingRight=t,this._changed())}get cutSx(){return this._cutSx}set cutSx(t){this._cutSx!==t&&(this._cutSx=t,this._changed())}get cutEx(){return this._cutEx}set cutEx(t){this._cutEx!==t&&(this._cutEx=t,this._changed())}get cutSy(){return this._cutSy}set cutSy(t){this._cutSy!==t&&(this._cutSy=t,this._changed())}get cutEy(){return this._cutEy}set cutEy(t){this._cutEy!==t&&(this._cutEy=t,this._changed())}get advancedRenderer(){return this._advancedRenderer}set advancedRenderer(t){this._advancedRenderer!==t&&(this._advancedRenderer=t,this._changed())}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this._changed())}get letterSpacing(){return this._letterSpacing}set textIndent(t){this._textIndent!==t&&(this._textIndent=t,this._changed())}get textIndent(){return this._textIndent}get precision(){return super.precision}set precision(t){this.precision!==t&&(super.precision=t,this._changed())}_getIsValid(){return!!this.text}_getLookupId(){let t=[];return this.w!==0&&t.push("w "+this.w),this.h!==0&&t.push("h "+this.h),this.fontStyle!=="normal"&&t.push("fS"+this.fontStyle),this.fontSize!==40&&t.push("fs"+this.fontSize),this.fontBaselineRatio!==0&&t.push("fb"+this.fontBaselineRatio),this.fontFace!==null&&t.push("ff"+(Array.isArray(this.fontFace)?this.fontFace.join(","):this.fontFace)),this.wordWrap!==!0&&t.push("wr"+(this.wordWrap?1:0)),this.wordWrapWidth!==0&&t.push("ww"+this.wordWrapWidth),this.wordBreak!==!1&&t.push("wb"+this.wordBreak?1:0),this.textOverflow!=""&&t.push("to"+this.textOverflow),this.lineHeight!==null&&t.push("lh"+this.lineHeight),this.textBaseline!=="alphabetic"&&t.push("tb"+this.textBaseline),this.textAlign!=="left"&&t.push("ta"+this.textAlign),this.verticalAlign!=="top"&&t.push("va"+this.verticalAlign),this.offsetY!==null&&t.push("oy"+this.offsetY),this.maxLines!==0&&t.push("ml"+this.maxLines),this.maxLinesSuffix!==".."&&t.push("ms"+this.maxLinesSuffix),t.push("pc"+this.precision),this.textColor!==4294967295&&t.push("co"+this.textColor.toString(16)),this.paddingLeft!==0&&t.push("pl"+this.paddingLeft),this.paddingRight!==0&&t.push("pr"+this.paddingRight),this.shadow!==!1&&t.push("sh"+(this.shadow?1:0)),this.shadowColor!==4278190080&&t.push("sc"+this.shadowColor.toString(16)),this.shadowOffsetX!==0&&t.push("sx"+this.shadowOffsetX),this.shadowOffsetY!==0&&t.push("sy"+this.shadowOffsetY),this.shadowBlur!==5&&t.push("sb"+this.shadowBlur),this.highlight!==!1&&t.push("hL"+(this.highlight?1:0)),this.highlightHeight!==0&&t.push("hh"+this.highlightHeight),this.highlightColor!==4278190080&&t.push("hc"+this.highlightColor.toString(16)),this.highlightOffset!==null&&t.push("ho"+this.highlightOffset),this.highlightPaddingLeft!==null&&t.push("hl"+this.highlightPaddingLeft),this.highlightPaddingRight!==null&&t.push("hr"+this.highlightPaddingRight),this.letterSpacing!==null&&t.push("ls"+this.letterSpacing),this.textIndent!==null&&t.push("ti"+this.textIndent),this.cutSx&&t.push("csx"+this.cutSx),this.cutEx&&t.push("cex"+this.cutEx),this.cutSy&&t.push("csy"+this.cutSy),this.cutEy&&t.push("cey"+this.cutEy),this.advancedRenderer&&t.push("aR"+this.advancedRenderer?1:0),"TX$"+t.join("|")+":"+this.text}_getSourceLoader(){const t=this.cloneArgs(),n=this.stage.gl;return function(o){const u=this.stage.platform.getDrawingCanvas(),f=t.advancedRenderer?new ov(this.stage,u,t):new sv(this.stage,u,t),m=f.draw(),p={},v=this.stage.getOption("fontSharp");let w=!1;$.isBoolean(v)?w=v:$.isObject(v)&&(w=this.stage.getRenderPrecision()<=v.precision&&t.fontSize<=v.fontSize),n&&w&&(p[n.TEXTURE_MAG_FILTER]=n.NEAREST),m?m.then(()=>{o(null,Object.assign({renderInfo:f.renderInfo,throttle:!1,texParams:p},this.stage.platform.getTextureOptionsForDrawingCanvas(u)))}).catch(C=>{o(C)}):o(null,Object.assign({renderInfo:f.renderInfo,throttle:!1,texParams:p},this.stage.platform.getTextureOptionsForDrawingCanvas(u)))}}getNonDefaults(){const t=super.getNonDefaults();return this.text!==""&&(t.text=this.text),this.w!==0&&(t.w=this.w),this.h!==0&&(t.h=this.h),this.fontStyle!=="normal"&&(t.fontStyle=this.fontStyle),this.fontSize!==40&&(t.fontSize=this.fontSize),this.fontBaselineRatio!==0&&(t.fontBaselineRatio=this.fontBaselineRatio),this.fontFace!==null&&(t.fontFace=this.fontFace),this.wordWrap!==!0&&(t.wordWrap=this.wordWrap),this.wordWrapWidth!==0&&(t.wordWrapWidth=this.wordWrapWidth),this.wordBreak!==!1&&(t.wordBreak=this.wordBreak),this.textOverflow!=""&&(t.textOverflow=this.textOverflow),this.lineHeight!==null&&(t.lineHeight=this.lineHeight),this.textBaseline!=="alphabetic"&&(t.textBaseline=this.textBaseline),this.textAlign!=="left"&&(t.textAlign=this.textAlign),this.verticalAlign!=="top"&&(t.verticalAlign=this.verticalAlign),this.offsetY!==null&&(t.offsetY=this.offsetY),this.maxLines!==0&&(t.maxLines=this.maxLines),this.maxLinesSuffix!==".."&&(t.maxLinesSuffix=this.maxLinesSuffix),this.precision!==this.stage.getOption("precision")&&(t.precision=this.precision),this.textColor!==4294967295&&(t.textColor=this.textColor),this.paddingLeft!==0&&(t.paddingLeft=this.paddingLeft),this.paddingRight!==0&&(t.paddingRight=this.paddingRight),this.shadow!==!1&&(t.shadow=this.shadow),this.shadowColor!==4278190080&&(t.shadowColor=this.shadowColor),this.shadowOffsetX!==0&&(t.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY!==0&&(t.shadowOffsetY=this.shadowOffsetY),this.shadowBlur!==5&&(t.shadowBlur=this.shadowBlur),this.highlight!==!1&&(t.highlight=this.highlight),this.highlightHeight!==0&&(t.highlightHeight=this.highlightHeight),this.highlightColor!==4278190080&&(t.highlightColor=this.highlightColor),this.highlightOffset!==0&&(t.highlightOffset=this.highlightOffset),this.highlightPaddingLeft!==0&&(t.highlightPaddingLeft=this.highlightPaddingLeft),this.highlightPaddingRight!==0&&(t.highlightPaddingRight=this.highlightPaddingRight),this.letterSpacing!==0&&(t.letterSpacing=this.letterSpacing),this.textIndent!==0&&(t.textIndent=this.textIndent),this.cutSx&&(t.cutSx=this.cutSx),this.cutEx&&(t.cutEx=this.cutEx),this.cutSy&&(t.cutSy=this.cutSy),this.cutEy&&(t.cutEy=this.cutEy),this.advancedRenderer&&(t.renderer=this.advancedRenderer),t}cloneArgs(){let t={};return t.text=this._text,t.w=this._w,t.h=this._h,t.fontStyle=this._fontStyle,t.fontSize=this._fontSize,t.fontBaselineRatio=this._fontBaselineRatio,t.fontFace=this._fontFace,t.wordWrap=this._wordWrap,t.wordWrapWidth=this._wordWrapWidth,t.wordBreak=this._wordBreak,t.textOverflow=this._textOverflow,t.lineHeight=this._lineHeight,t.textBaseline=this._textBaseline,t.textAlign=this._textAlign,t.verticalAlign=this._verticalAlign,t.offsetY=this._offsetY,t.maxLines=this._maxLines,t.maxLinesSuffix=this._maxLinesSuffix,t.precision=this._precision,t.textColor=this._textColor,t.paddingLeft=this._paddingLeft,t.paddingRight=this._paddingRight,t.shadow=this._shadow,t.shadowColor=this._shadowColor,t.shadowOffsetX=this._shadowOffsetX,t.shadowOffsetY=this._shadowOffsetY,t.shadowBlur=this._shadowBlur,t.highlight=this._highlight,t.highlightHeight=this._highlightHeight,t.highlightColor=this._highlightColor,t.highlightOffset=this._highlightOffset,t.highlightPaddingLeft=this._highlightPaddingLeft,t.highlightPaddingRight=this._highlightPaddingRight,t.letterSpacing=this._letterSpacing,t.textIndent=this._textIndent,t.cutSx=this._cutSx,t.cutEx=this._cutEx,t.cutSy=this._cutSy,t.cutEy=this._cutEy,t.advancedRenderer=this._advancedRenderer,t}}let ke=An.prototype;ke._text="";ke._w=0;ke._h=0;ke._fontStyle="normal";ke._fontSize=40;ke._fontFace=null;ke._wordWrap=!0;ke._wordWrapWidth=0;ke._wordBreak=!1;ke._textOverflow="";ke._lineHeight=null;ke._textBaseline="alphabetic";ke._textAlign="left";ke._verticalAlign="top";ke._offsetY=null;ke._maxLines=0;ke._maxLinesSuffix="..";ke._textColor=4294967295;ke._paddingLeft=0;ke._paddingRight=0;ke._shadow=!1;ke._shadowColor=4278190080;ke._shadowOffsetX=0;ke._shadowOffsetY=0;ke._shadowBlur=5;ke._highlight=!1;ke._highlightHeight=0;ke._highlightColor=4278190080;ke._highlightOffset=0;ke._highlightPaddingLeft=0;ke._highlightPaddingRight=0;ke._letterSpacing=0;ke._textIndent=0;ke._cutSx=0;ke._cutEx=0;ke._cutSy=0;ke._cutEy=0;ke._advancedRenderer=!1;ke._fontBaselineRatio=0;class $v extends ai{constructor(t){super(t),this._textureSource=void 0}get textureSource(){return this._textureSource}set textureSource(t){t!==this._textureSource&&(t.isResultTexture&&(this._precision=this.stage.getRenderPrecision()),this._textureSource=t,this._changed())}_getTextureSource(){return this._textureSource}}class Ud extends mt{constructor(t,n,o,u){super(),this.manager=t,this._settings=n,this._element=o,this._getter=o.constructor.getGetter(u),this._setter=o.constructor.getSetter(u),this._merger=n.merger,this._merger||(this._merger=o.constructor.getMerger(u)),this._startValue=this._getter(this._element),this._targetValue=this._startValue,this._p=1,this._delayLeft=0}start(t){this._startValue=this._getter(this._element),this.isAttached()?t===this._startValue?this.reset(t,1):(this._targetValue=t,this._p=0,this._delayLeft=this._settings.delay,this.emit("start"),this.add()):(this._targetValue=t,this._p=1,this._updateDrawValue())}finish(){this._p<1&&(this._p=1)}stop(){this.emit("stop"),this.manager.removeActive(this)}pause(){this.stop()}play(){this.manager.addActive(this)}reset(t,n){this.isAttached()?(this._startValue=this._getter(this._element),this._targetValue=t,this._p=n,this.add()):(this._startValue=this._getter(this._element),this._targetValue=t,this._p=1,this._updateDrawValue())}_updateDrawValue(){this._setter(this._element,this.getDrawValue())}add(){this.manager.addActive(this)}isAttached(){return this._element.attached}isRunning(){return this._p<1}progress(t){if(this.isAttached()||(this._p=1),this.p<1){if(this.delayLeft>0)if(this._delayLeft-=t,this.delayLeft<0)t=-this.delayLeft,this._delayLeft=0,this.emit("delayEnd");else return;this._settings.duration==0?this._p=1:this._p+=t/this._settings.duration,this._p>=1&&(this._p=1)}this._updateDrawValue(),this.invokeListeners()}invokeListeners(){this.emit("progress",this.p),this.p===1&&this.emit("finish")}updateTargetValue(t){let n=this._settings.timingFunctionImpl(this.p);n===1?this._targetValue=t:n===0?(this._startValue=this._targetValue,this._targetValue=t):(this._startValue=t-(t-this._targetValue)/(1-n),this._targetValue=t)}getDrawValue(){if(this.p>=1)return this.targetValue;{let t=this._settings._timingFunctionImpl(this.p);return this._merger(this.targetValue,this.startValue,t)}}skipDelay(){this._delayLeft=0}get startValue(){return this._startValue}get targetValue(){return this._targetValue}get p(){return this._p}get delayLeft(){return this._delayLeft}get element(){return this._element}get settings(){return this._settings}set settings(t){this._settings=t}}Ud.prototype.isTransition=!0;class Yv{constructor(){this._items=[],this._refs={}}get(){return this._items}get first(){return this._items[0]}get last(){return this._items.length?this._items[this._items.length-1]:void 0}add(t){this.addAt(t,this._items.length)}addAt(t,n){if(n>=0&&n<=this._items.length){let o=this._items.indexOf(t);if(o===n)return t;if($.isObjectLiteral(t)){const u=t;t=this.createItem(u),t.patch(u)}o!=-1?this.setAt(t,n):(t.ref&&(this._refs[t.ref]=t),this._items.splice(n,0,t),this.onAdd(t,n))}else throw new Error("addAt: The index "+n+" is out of bounds "+this._items.length)}replaceByRef(t){if(t.ref){const n=this.getByRef(t.ref);if(!n)throw new Error("replaceByRef: no item found with reference: "+t.ref);this.replace(t,n)}else throw new Error("replaceByRef: no ref specified in item");this.addAt(t,this._items.length)}replace(t,n){const o=this.getIndex(n);if(o===-1)throw new Error("replace: The previous item does not exist");this.setAt(t,o)}setAt(t,n){if(n>=0&&n<this._items.length){if($.isObjectLiteral(t)){const u=t;t=this.createItem(u),t.patch(u)}let o=this._items.indexOf(t);if(o!=-1){if(o!==n){const u=o;u!==n&&(this._items.splice(u,1),this._items.splice(n,0,t),this.onMove(t,u,n))}}else{n<this._items.length&&this._items[n].ref&&(this._refs[this._items[n].ref]=void 0);const u=this._items[n];this._items[n]=t,t.ref&&(this._refs[t.ref]=t),this.onSet(t,n,u)}}else throw new Error("setAt: The index "+n+" is out of bounds "+this._items.length)}getAt(t){return this._items[t]}getIndex(t){return this._items.indexOf(t)}remove(t){let n=this._items.indexOf(t);n!==-1&&this.removeAt(n)}removeAt(t){if(t>=0&&t<this._items.length){const n=this._items[t];return n.ref&&(this._refs[n.ref]=void 0),this._items.splice(t,1),this.onRemove(n,t),n}else throw new Error(`removeAt: The index ${t} is out of bounds ${this._items.length-1}`)}clear(){if(this._items.length){let n=this._items;this._items=[],this._refs={},this.onSync(n,[],[])}}a(t){if($.isObjectLiteral(t)){let n=this.createItem(t);return n.patch(t),this.add(n),n}else if(Array.isArray(t)){for(let n=0,o=t.length;n<o;n++)this.a(t[n]);return null}else if(this.isItem(t))return this.add(t),t}get length(){return this._items.length}_getRefs(){return this._refs}getByRef(t){return this._refs[t]}clearRef(t){delete this._refs[t]}setRef(t,n){this._refs[t]=n}patch(t){$.isObjectLiteral(t)?this._setByObject(t):Array.isArray(t)&&this._setByArray(t)}_setByObject(t){let n=this._getRefs(),o=Object.keys(t);for(let u=0,f=o.length;u<f;u++){let m=o[u],p=t[m],v=n[m];if(!v)this.isItem(p)?(p.ref=m,this.add(p)):(v=this.createItem(p),v.ref=m,v.patch(p),this.add(v));else if(this.isItem(p)){if(v!==p){let w=this.getIndex(v);p.ref=m,this.setAt(p,w)}}else v.patch(p)}}_equalsArray(t){let n=!0;if(t.length===this._items.length)for(let o=0,u=this._items.length;o<u&&n;o++)n=n&&this._items[o]===t[o];else n=!1;return n}_setByArray(t){if(this._equalsArray(t))return;for(let u=0,f=this._items.length;u<f;u++)this._items[u].marker=!0;let n,o=[];for(let u=0,f=t.length;u<f;u++){let m=t[u];if(this.isItem(m))m.marker=!1,o.push(m);else{let p=m.ref,v;p&&(n||(n=this._getRefs()),v=n[p]),v?v.marker=!1:v=this.createItem(m),$.isObjectLiteral(m)&&v.patch(m),o.push(v)}}this._setItems(o)}_setItems(t){let n=this._items;this._items=t;let o=n.filter(f=>{let m=f.marker;return delete f.marker,m}),u=t.filter(f=>n.indexOf(f)===-1);if(o.length||u.length){this._refs={};for(let f=0,m=this._items.length;f<m;f++){let p=this._items[f].ref;p&&(this._refs[p]=this._items[f])}}this.onSync(o,u,t)}sort(t){const n=this._items.slice();n.sort(t),this._setByArray(n)}onAdd(t,n){}onRemove(t,n){}onSync(t,n,o){}onSet(t,n,o){}onMove(t,n,o){}createItem(t){throw new Error("ObjectList.createItem must create and return a new object")}isItem(t){return!1}forEach(t){this.get().forEach(t)}}class Cb extends Yv{constructor(t){super(),this._element=t}_connectParent(t){const n=t.parent;if(n&&n!==this._element){const o=t.parent.childList,u=o.getIndex(t);t.ref&&(o._refs[t.ref]=void 0),o._items.splice(u,1),n.core.removeChildAt(u)}t._setParent(this._element)}onAdd(t,n){this._connectParent(t),this._element.core.addChildAt(n,t.core)}onRemove(t,n){t._setParent(null),this._element.core.removeChildAt(n)}onSync(t,n,o){for(let f=0,m=t.length;f<m;f++)t[f]._setParent(null);for(let f=0,m=n.length;f<m;f++)this._connectParent(n[f]);let u=f=>f.core;this._element.core.syncChildren(t.map(u),n.map(u),o.map(u))}onSet(t,n,o){o._setParent(null),this._connectParent(t),this._element.core.setChildAt(n,t.core)}onMove(t,n,o){this._element.core.moveChild(n,o)}createItem(t){return t.type?new t.type(this._element.stage):this._element.stage.createElement()}isItem(t){return t.isElement}}let si=class ri{constructor(t){this.stage=t,this.__id=ri.id++,this.__start(),this._hasEventListeners=!1,this.__core=new bn(this),this.__ref=null,this.__attached=!1,this.__enabled=!1,this.__active=!1,this.__parent=null,this.__texture=null,this.__displayedTexture=null,this.__tags=null,this.__treeTags=null,this.__tagRoot=!1,this.__childList=null,this._w=0,this._h=0}__start(){}get id(){return this.__id}set ref(t){if(this.__ref!==t){const n=t.charCodeAt(0);$.isUcChar(n)||this._throwError("Ref must start with an upper case character: "+t),this.__ref!==null&&(this.removeTag(this.__ref),this.__parent&&this.__parent.__childList.clearRef(this.__ref)),this.__ref=t,this.__ref&&(this._addTag(this.__ref),this.__parent&&this.__parent.__childList.setRef(this.__ref,this))}}get ref(){return this.__ref}get core(){return this.__core}setAsRoot(){this.__core.setAsRoot(),this._updateAttachedFlag(),this._updateEnabledFlag()}get isRoot(){return this.__core.isRoot}_setParent(t){this.__parent!==t&&(this.__parent&&this._unsetTagsParent(),this.__parent=t,t&&this._setTagsParent(),this._updateAttachedFlag(),this._updateEnabledFlag(),this._updateCollision(),this.isRoot&&t&&this._throwError("Root should not be added as a child! Results are unspecified!"))}getDepth(){let t=0,n=this.__parent;for(;n;)t++,n=n.__parent;return t}getAncestor(t){let n=this;for(;t>0&&n.__parent;)n=n.__parent,t--;return n}getAncestors(){const t=[];let n=this;for(;n;)t.push(n),n=n.__parent;return t}getAncestorAtDepth(t){let n=this.getDepth()-t;return n<0?null:this.getAncestor(n)}isAncestorOf(t){let n=t;for(;n=n.parent;)if(this===n)return!0;return!1}getSharedAncestor(t){let n=this,o=t,u=n.getDepth(),f=o.getDepth();u>f?n=n.getAncestor(u-f):f>u&&(o=o.getAncestor(f-u));do{if(n===o)return n;n=n.__parent,o=o.__parent}while(n&&o);return null}get attached(){return this.__attached}get enabled(){return this.__enabled}get active(){return this.__active}_isAttached(){return this.__parent?this.__parent.__attached:this.stage.root===this}_isEnabled(){return this.__core.visible&&this.__core.alpha>0&&(this.__parent?this.__parent.__enabled:this.stage.root===this)}_isActive(){return this._isEnabled()&&this.withinBoundsMargin}_updateAttachedFlag(){let t=this._isAttached();if(this.__attached!==t){this.__attached=t,t&&this._onSetup();let n=this._children.get();if(n){let o=n.length;if(o>0)for(let u=0;u<o;u++)n[u]._updateAttachedFlag()}t?this._onAttach():this._onDetach()}}_updateEnabledFlag(){let t=this._isEnabled();if(this.__enabled!==t){t?(this._onEnabled(),this._setEnabledFlag()):(this._onDisabled(),this._unsetEnabledFlag());let n=this._children.get();if(n){let o=n.length;if(o>0)for(let u=0;u<o;u++)n[u]._updateEnabledFlag()}}}_setEnabledFlag(){this.__enabled=!0,this._updateDimensions(),this._updateTextureCoords(),this.__texture&&this.__texture.addElement(this),this.withinBoundsMargin&&this._setActiveFlag(),this.__core.shader&&this.__core.shader.addElement(this.__core)}_unsetEnabledFlag(){this.__active&&this._unsetActiveFlag(),this.__texture&&this.__texture.removeElement(this),this.__core.shader&&this.__core.shader.removeElement(this.__core),this._texturizer&&this.texturizer.filters.forEach(t=>t.removeElement(this.__core)),this.__enabled=!1}_setActiveFlag(){this.__active=!0,this.__texture&&this.__texture.incActiveCount(),this.__texture&&this._enableTexture(),this._onActive()}_unsetActiveFlag(){this.__texture&&this.__texture.decActiveCount(),this.__active=!1,this.__texture&&this._disableTexture(),this._hasTexturizer()&&this.texturizer.deactivate(),this._onInactive()}_onSetup(){}_onAttach(){}_onDetach(){}_onEnabled(){}_onDisabled(){}_onActive(){}_onInactive(){}_onResize(){}_getRenderWidth(){return this._w?this._w:this.__displayedTexture?this.__displayedTexture.getRenderWidth():this.__texture?this.__texture.getRenderWidth():0}_getRenderHeight(){return this._h?this._h:this.__displayedTexture?this.__displayedTexture.getRenderHeight():this.__texture?this.__texture.getRenderHeight():0}get renderWidth(){return this.__enabled?this.__core.getRenderWidth():this._getRenderWidth()}get renderHeight(){return this.__enabled?this.__core.getRenderHeight():this._getRenderHeight()}get finalX(){return this.__core.x}get finalY(){return this.__core.y}get finalW(){return this.__core.w}get finalH(){return this.__core.h}textureIsLoaded(){return this.__texture&&this.__texture.isLoaded()}loadTexture(){this.__texture&&(this.__texture.load(),(!this.__texture.isUsed()||!this._isEnabled())&&this._updateDimensions())}_enableTextureError(){const t=this.__texture.loadError;t&&this.emit("txError",t,this.__texture._source)}_enableTexture(){this.__texture.isLoaded()?this._setDisplayedTexture(this.__texture):(this._setDisplayedTexture(null),this._enableTextureError())}_disableTexture(){this._setDisplayedTexture(null)}get texture(){return this.__texture}set texture(t){let n;if($.isObjectLiteral(t))t.type?n=new t.type(this.stage):n=this.texture,n&&Ot.patchObject(n,t);else if(!t)n=null;else if(t.isTexture)n=t;else if(t.isTextureSource)n=new $v(this.stage),n.textureSource=t;else{console.error("[Lightning] Please specify a texture type.");return}const o=this.__texture;n!==o&&(this.__texture=n,this.__texture?this.__enabled&&(this.__texture.addElement(this),this.withinBoundsMargin&&(this.__texture.isLoaded()?this._setDisplayedTexture(this.__texture):this._enableTextureError())):this._setDisplayedTexture(null),o&&o!==this.__displayedTexture&&o.removeElement(this),this._updateDimensions())}get displayedTexture(){return this.__displayedTexture}_setDisplayedTexture(t){let n=this.__displayedTexture;n&&t!==n&&this.__texture!==n&&n.removeElement(this);const o=this.__core.displayedTextureSource?this.__core.displayedTextureSource._source:null,u=(t?t._source:null)!==o;this.__displayedTexture=t,this._updateDimensions(),this.__displayedTexture?u&&(this._updateTextureCoords(),this.__core.setDisplayedTextureSource(this.__displayedTexture._source)):this.__core.setDisplayedTextureSource(null),u&&(this.__displayedTexture?this.emit("txLoaded",this.__displayedTexture):this.emit("txUnloaded",this.__displayedTexture))}onTextureSourceLoaded(){this.active&&this._setDisplayedTexture(this.__texture)}onTextureSourceLoadError(t){this.emit("txError",t,this.__texture._source)}forceRenderUpdate(){this.__core.setHasRenderUpdates(3)}onDisplayedTextureClippingChanged(){this._updateDimensions(),this._updateTextureCoords()}onPrecisionChanged(){this._updateDimensions()}onDimensionsChanged(t,n){this.texture instanceof An&&(this.texture.w=t,this.texture.h=n,this.w=t,this.h=n)}_updateDimensions(){let t=this._getRenderWidth(),n=this._getRenderHeight(),o=!1;(!t||!n)&&!this.__displayedTexture&&this.__texture&&(t=t||this.__texture.mw,n=n||this.__texture.mh,(!t||!n)&&this.__texture.isAutosizeTexture()&&(o=!0)),this.__core.setDimensions(t,n,o)&&this._onResize()}_updateTextureCoords(){if(this.displayedTexture&&this.displayedTexture._source){let t=this.displayedTexture,n=this.displayedTexture._source,o=0,u=0,f=1,m=1;if(t.clipping){let p=n.getRenderWidth(),v=n.getRenderHeight(),w,C,L,E;w=1/p,C=1/v,t.pw?L=t.pw*w:L=(p-t.px)*w,t.ph?E=t.ph*C:E=(v-t.py)*C,w*=t.px,C*=t.py,o=w,u=C,f=f*L+w,m=m*E+C,o=Math.max(0,o),u=Math.max(0,u),f=Math.min(1,f),m=Math.min(1,m)}if(n._flipTextureY){let p=m;m=u,u=p}this.__core.setTextureCoords(o,u,f,m)}}getCornerPoints(){return this.__core.getCornerPoints()}_unsetTagsParent(){this.__tags&&this.__tags.forEach(o=>{let u=this;for(;(u=u.__parent)&&(u.__treeTags.get(o).delete(this),!u.__tagRoot););});let t=null,n=0;if(this.__treeTags&&!this.__tagRoot&&(t=$.iteratorToArray(this.__treeTags.keys()),n=t.length,n>0))for(let o=0;o<n;o++){let u=this.__treeTags.get(t[o]),f=this;for(;f=f.__parent;){let m=f.__treeTags.get(t[o]);if(u.forEach(function(p){m.delete(p)}),f.__tagRoot)break}}}_setTagsParent(){this.__tags&&this.__tags.forEach(t=>{let n=this;for(;n=n.__parent;){n.__treeTags||(n.__treeTags=new Map);let o=n.__treeTags.get(t);if(o||(o=new Set,n.__treeTags.set(t,o)),o.add(this),n.__tagRoot)break}}),this.__treeTags&&this.__treeTags.size&&(this.__tagRoot||this.__treeTags.forEach((t,n)=>{let o=this;for(;!o.__tagRoot&&(o=o.__parent);){o.__tagRoot,o.__treeTags||(o.__treeTags=new Map);let u=o.__treeTags.get(n);u||(u=new Set,o.__treeTags.set(n,u)),t.forEach(function(f){u.add(f)})}}))}_getByTag(t){if(!this.__treeTags)return[];let n=this.__treeTags.get(t);return n?$.setToArray(n):[]}getTags(){return this.__tags?this.__tags:[]}setTags(t){t=t.reduce((p,v)=>p.concat(v.split(" ")),[]),this.__ref&&t.push(this.__ref);let n,o=t.length,u=[],f=[];for(n=0;n<o;n++)this.hasTag(t[n])||f.push(t[n]);let m=this.tags||[];for(o=m.length,n=0;n<o;n++)t.indexOf(m[n])==-1&&u.push(m[n]);for(n=0;n<u.length;n++)this.removeTag(u[n]);for(n=0;n<f.length;n++)this.addTag(f[n])}addTag(t){if(t.indexOf(" ")===-1)$.isUcChar(t.charCodeAt(0))&&this._throwError("Tag may not start with an upper case character."),this._addTag(t);else{const n=t.split(" ");for(let o=0,u=n.length;o<u;o++){const f=n[o];$.isUcChar(f.charCodeAt(0))&&this._throwError("Tag may not start with an upper case character."),this._addTag(f)}}}_addTag(t){if(this.__tags||(this.__tags=[]),this.__tags.indexOf(t)===-1){this.__tags.push(t);let n=this.__parent;if(n)do{n.__treeTags||(n.__treeTags=new Map);let o=n.__treeTags.get(t);o||(o=new Set,n.__treeTags.set(t,o)),o.add(this)}while(!n.__tagRoot&&(n=n.__parent))}}removeTag(t){let n=this.__tags.indexOf(t);if(n!==-1){this.__tags.splice(n,1);let o=this.__parent;if(o)do{let u=o.__treeTags.get(t);u&&u.delete(this)}while(!o.__tagRoot&&(o=o.__parent))}}hasTag(t){return this.__tags&&this.__tags.indexOf(t)!==-1}_tag(t){if(t.indexOf(".")!==-1)return this.mtag(t)[0];if(this.__treeTags){let n=this.__treeTags.get(t);if(n){const o=n.values().next();return o?o.value:void 0}}}get tag(){return this._tag}set tag(t){this.tags=t}mtag(t){if(t.indexOf(".")>=0){let o=t.split("."),u=this._getByTag(o[0]),f=1,m=o.length;for(;u.length&&f<m;){let p=[];for(let v=0,w=u.length;v<w;v++)p=p.concat(u[v]._getByTag(o[f]));u=p,f++}return u}else return this._getByTag(t)}stag(t,n){let o=this.mtag(t),u=o.length;for(let f=0;f<u;f++)Ot.patchObject(o[f],n)}get tagRoot(){return this.__tagRoot}set tagRoot(t){this.__tagRoot!==t&&(t?this._unsetTagsParent():this._setTagsParent(),this.__tagRoot=t)}sel(t){const n=this.select(t);if(n.length)return n[0]}select(t){if(t.indexOf(",")!==-1){let n=t.split(","),o=[];for(let u=0;u<n.length;u++)o=o.concat(this._select(n[u]));return o}else return this._select(t)}_select(t){if(t==="")return[this];let n=t.indexOf("."),o=t.indexOf(">");if(n===-1&&o===-1)return this.mtag(t);let u;return o===0?(u=!0,t=t.substr(1)):n===0?(u=!1,t=t.substr(1)):u=!1,this._selectChilds(t,u)}_selectChilds(t,n){const o=t.indexOf("."),u=t.indexOf(">");if(o===-1&&u===-1)if(n){const f=this.getByRef(t);return f?[f]:[]}else return this.mtag(t);if(u===-1||o!==-1&&o<u){let f;const m=t.substr(0,o);if(n){const w=this.getByRef(m);f=w?[w]:[]}else f=this.mtag(m);let p=[];const v=t.substr(o+1);for(let w=0,C=f.length;w<C;w++)p=p.concat(f[w]._selectChilds(v,!1));return p}else{let f;const m=t.substr(0,u);if(n){const w=this.getByRef(m);f=w?[w]:[]}else f=this.mtag(m);let p=[];const v=t.substr(u+1);for(let w=0,C=f.length;w<C;w++)p=p.concat(f[w]._selectChilds(v,!0));return p}}getByRef(t){return this.childList.getByRef(t)}getLocationString(){let t;t=this.__parent?this.__parent._children.getIndex(this):"R";let n=this.getTags(),o=this.__parent?this.__parent.getLocationString():"";return this.ref?o+=":["+t+"]"+this.ref:n.length?o+=":["+t+"]"+n.join(","):o+=":["+t+"]#"+this.id,o}toString(){let t=this.getSettings();return ri.getPrettyString(t,"")}static getPrettyString(t,n){let o=t.children;delete t.children;let u=["color","colorUl","colorUr","colorBl","colorBr"],f=JSON.stringify(t,function(m,p){return u.indexOf(m)!==-1?"COLOR["+p.toString(16)+"]":p});if(f=f.replace(/"COLOR\[([a-f0-9]{1,8})\]"/g,"0x$1"),o){let m="";if($.isObjectLiteral(o)){let p=Object.keys(o);m="";for(let w=0,C=p.length;w<C;w++)m+=`
${n}  "${p[w]}":`,delete o[p[w]].ref,m+=ri.getPrettyString(o[p[w]],n+"  ")+(w<C-1?",":"");let v=f==="{}";f=f.substr(0,f.length-1)+(v?"":",")+m+`
`+n+"}"}else{let p=o.length;m="[";for(let w=0;w<p;w++)m+=ri.getPrettyString(o[w],n+"  ")+(w<p-1?",":"")+`
`;m+=n+"]}";let v=f==="{}";f=f.substr(0,f.length-1)+(v?"":",")+`"children":
`+n+m+"}"}}return f}getSettings(){let t=this.getNonDefaults(),n=this._children.get();if(n){let o=n.length;if(o){const u=[];let f=!1;for(let m=0;m<o;m++)u.push(n[m].getSettings()),f=f||!n[m].ref;f?t.children=u:(t.children={},u.forEach(m=>{t.children[m.ref]=m}))}}return t.id=this.id,t}getNonDefaults(){let t={};if(this.constructor!==ri&&(t.type=this.constructor.name),this.__ref&&(t.ref=this.__ref),this.__tags&&this.__tags.length&&(t.tags=this.__tags),this.x!==0&&(t.x=this.x),this.y!==0&&(t.y=this.y),this.w!==0&&(t.w=this.w),this.h!==0&&(t.h=this.h),this.scaleX===this.scaleY?this.scaleX!==1&&(t.scale=this.scaleX):(this.scaleX!==1&&(t.scaleX=this.scaleX),this.scaleY!==1&&(t.scaleY=this.scaleY)),this.pivotX===this.pivotY?this.pivotX!==.5&&(t.pivot=this.pivotX):(this.pivotX!==.5&&(t.pivotX=this.pivotX),this.pivotY!==.5&&(t.pivotY=this.pivotY)),this.mountX===this.mountY?this.mountX!==0&&(t.mount=this.mountX):(this.mountX!==0&&(t.mountX=this.mountX),this.mountY!==0&&(t.mountY=this.mountY)),this.alpha!==1&&(t.alpha=this.alpha),this.visible||(t.visible=!1),this.rotation!==0&&(t.rotation=this.rotation),this.colorUl===this.colorUr&&this.colorBl===this.colorBr&&this.colorUl===this.colorBl?this.colorUl!==4294967295&&(t.color=this.colorUl.toString(16)):(this.colorUl!==4294967295&&(t.colorUl=this.colorUl.toString(16)),this.colorUr!==4294967295&&(t.colorUr=this.colorUr.toString(16)),this.colorBl!==4294967295&&(t.colorBl=this.colorBl.toString(16)),this.colorBr!==4294967295&&(t.colorBr=this.colorBr.toString(16))),this.zIndex&&(t.zIndex=this.zIndex),this.forceZIndexContext&&(t.forceZIndexContext=!0),this.clipping&&(t.clipping=this.clipping),this.clipbox||(t.clipbox=this.clipbox),this.__texture){let n=this.__texture.getNonDefaults();Object.keys(n).length&&(t.texture=n)}if(this.shader&&$.isFunction(this.shader.getNonDefaults)){let n=this.shader.getNonDefaults();Object.keys(n).length&&(t.shader=n)}return this._hasTexturizer()&&(this.texturizer.enabled&&(t.renderToTexture=this.texturizer.enabled),this.texturizer.lazy&&(t.renderToTextureLazy=this.texturizer.lazy),this.texturizer.colorize&&(t.colorizeResultTexture=this.texturizer.colorize),this.texturizer.renderOffscreen&&(t.renderOffscreen=this.texturizer.renderOffscreen)),t}static getGetter(t){let n=ri.PROP_GETTERS.get(t);return n||(n=new Function("obj","return obj."+t),ri.PROP_GETTERS.set(t,n)),n}static getSetter(t){let n=ri.PROP_SETTERS.get(t);return n||(n=new Function("obj","v","obj."+t+" = v"),ri.PROP_SETTERS.set(t,n)),n}get withinBoundsMargin(){return this.__core._withinBoundsMargin}_enableWithinBoundsMargin(){this.__enabled&&this._setActiveFlag()}_disableWithinBoundsMargin(){this.__active&&this._unsetActiveFlag()}set boundsMargin(t){if(!Array.isArray(t)&&t!==null)throw new Error("boundsMargin should be an array of left-top-right-bottom values or null (inherit margin)");this.__core.boundsMargin=t}get boundsMargin(){return this.__core.boundsMargin}get x(){return this.__core.offsetX}set x(t){this.__core.offsetX=t}get y(){return this.__core.offsetY}set y(t){this.__core.offsetY=t}get w(){return this._w}set w(t){$.isFunction(t)?(this._w=0,this.__core.funcW=t):(t=Math.max(t,0),this._w!==t&&(this.__core.disableFuncW(),this._w=t,this._updateDimensions()))}get h(){return this._h}set h(t){$.isFunction(t)?(this._h=0,this.__core.funcH=t):(t=Math.max(t,0),this._h!==t&&(this.__core.disableFuncH(),this._h=t,this._updateDimensions()))}get collision(){return this._collision}set collision(t){this._collision=t}_updateCollision(){this.collision&&this.__parent&&this.__parent.collision===void 0&&(this.__parent.collision=2)}get scaleX(){return this.__core.scaleX}set scaleX(t){this.__core.scaleX=t}get scaleY(){return this.__core.scaleY}set scaleY(t){this.__core.scaleY=t}get scale(){return this.__core.scale}set scale(t){this.__core.scale=t}get pivotX(){return this.__core.pivotX}set pivotX(t){this.__core.pivotX=t}get pivotY(){return this.__core.pivotY}set pivotY(t){this.__core.pivotY=t}get pivot(){return this.__core.pivot}set pivot(t){this.__core.pivot=t}get mountX(){return this.__core.mountX}set mountX(t){this.__core.mountX=t}get mountY(){return this.__core.mountY}set mountY(t){this.__core.mountY=t}get mount(){return this.__core.mount}set mount(t){this.__core.mount=t}get rotation(){return this.__core.rotation}set rotation(t){this.__core.rotation=t}get alpha(){return this.__core.alpha}set alpha(t){this.__core.alpha=t}get visible(){return this.__core.visible}set visible(t){this.__core.visible=t}get colorUl(){return this.__core.colorUl}set colorUl(t){this.__core.colorUl=t}get colorUr(){return this.__core.colorUr}set colorUr(t){this.__core.colorUr=t}get colorBl(){return this.__core.colorBl}set colorBl(t){this.__core.colorBl=t}get colorBr(){return this.__core.colorBr}set colorBr(t){this.__core.colorBr=t}get color(){return this.__core.colorUl}set color(t){(this.colorUl!==t||this.colorUr!==t||this.colorBl!==t||this.colorBr!==t)&&(this.colorUl=t,this.colorUr=t,this.colorBl=t,this.colorBr=t)}get colorTop(){return this.colorUl}set colorTop(t){(this.colorUl!==t||this.colorUr!==t)&&(this.colorUl=t,this.colorUr=t)}get colorBottom(){return this.colorBl}set colorBottom(t){(this.colorBl!==t||this.colorBr!==t)&&(this.colorBl=t,this.colorBr=t)}get colorLeft(){return this.colorUl}set colorLeft(t){(this.colorUl!==t||this.colorBl!==t)&&(this.colorUl=t,this.colorBl=t)}get colorRight(){return this.colorUr}set colorRight(t){(this.colorUr!==t||this.colorBr!==t)&&(this.colorUr=t,this.colorBr=t)}get zIndex(){return this.__core.zIndex}set zIndex(t){this.__core.zIndex=t}get forceZIndexContext(){return this.__core.forceZIndexContext}set forceZIndexContext(t){this.__core.forceZIndexContext=t}get clipping(){return this.__core.clipping}set clipping(t){this.__core.clipping=t}get clipbox(){return this.__core.clipbox}set clipbox(t){this.__core.clipbox=t}get tags(){return this.getTags()}set tags(t){Array.isArray(t)||(t=[t]),this.setTags(t)}set t(t){this.tags=t}get _children(){return this.__childList||(this.__childList=new Cb(this,!1)),this.__childList}get childList(){return this._allowChildrenAccess()||this._throwError("Direct access to children is not allowed in "+this.getLocationString()),this._children}hasChildren(){return this._allowChildrenAccess()&&this.__childList&&this.__childList.length>0}_allowChildrenAccess(){return!0}get children(){return this.childList.get()}set children(t){this.childList.patch(t)}add(t){return this.childList.a(t)}get p(){return this.__parent}get parent(){return this.__parent}get src(){if(this.texture&&this.texture instanceof Nd)return this.texture._src}set src(t){const n=new Nd(this.stage);n.src=t,this.texture=n}set mw(t){this.texture?(this.texture.mw=t,this._updateDimensions()):this._throwError("Please set mw after setting a texture.")}set mh(t){this.texture?(this.texture.mh=t,this._updateDimensions()):this._throwError("Please set mh after setting a texture.")}get rect(){return this.texture===this.stage.rectangleTexture}set rect(t){t?this.texture=this.stage.rectangleTexture:this.texture=null}enableTextTexture(){return(!this.texture||!(this.texture instanceof An))&&(this.texture=new An(this.stage),!this.texture.w&&!this.texture.h&&(this.texture.w=this.w,this.texture.h=this.h)),this.texture}get text(){return this.texture&&this.texture instanceof An?this.texture:null}set text(t){(!this.texture||!(this.texture instanceof An))&&this.enableTextTexture(),$.isString(t)?this.texture.text=t:this.texture.patch(t)}set onUpdate(t){this.__core.onUpdate=t}set onAfterCalcs(t){this.__core.onAfterCalcs=t}set onAfterUpdate(t){this.__core.onAfterUpdate=t}forceUpdate(){this.__core._setHasUpdates()}get shader(){return this.__core.shader}set shader(t){if($.isObjectLiteral(t)&&!t.type)this.shader&&this.shader.patch(t);else{const n=Qo.create(this.stage,t);this.__enabled&&this.__core.shader&&this.__core.shader.removeElement(this.__core),this.__core.shader=n,this.__enabled&&this.__core.shader&&this.__core.shader.addElement(this.__core)}}_hasTexturizer(){return!!this.__core._texturizer}get renderToTexture(){return this.rtt}set renderToTexture(t){this.rtt=t}get rtt(){return this._hasTexturizer()&&this.texturizer.enabled}set rtt(t){this.texturizer.enabled=t}get rttLazy(){return this._hasTexturizer()&&this.texturizer.lazy}set rttLazy(t){this.texturizer.lazy=t}get renderOffscreen(){return this._hasTexturizer()&&this.texturizer.renderOffscreen}set renderOffscreen(t){this.texturizer.renderOffscreen=t}get colorizeResultTexture(){return this._hasTexturizer()&&this.texturizer.colorize}set colorizeResultTexture(t){this.texturizer.colorize=t}getTexture(){return this.texturizer._getTextureSource()}get texturizer(){return this.__core.texturizer}patch(t){let n=Object.keys(t);for(let o=0,u=n.length;o<u;o++){let f=n[o];const m=t[f],p=f.charCodeAt(0);if($.isUcChar(p)){const v=this.getByRef(f);if(v)m===void 0?v.parent&&v.parent.childList.remove(v):$.isObjectLiteral(m)?v.patch(m):m.isElement?(m.ref=f,this.childList.replace(m,v)):this._throwError("Unexpected value for path: "+f);else if(m!==void 0){let w;$.isObjectLiteral(m)?(w=this.childList.createItem(m),w.patch(m)):$.isObject(m)&&(w=m),w.isElement&&(w.ref=f),this.childList.a(w)}}else Ot.patchObjectProperty(this,f,m)}}_throwError(t){throw new Error(this.constructor.name+" ("+this.getLocationString()+"): "+t)}animation(t){return this.stage.animations.createAnimation(this,t)}transition(t,n=null){return n===null?this._getTransition(t):(this._setTransition(t,n),null)}set transitions(t){Object.keys(t).forEach(o=>{this.transition(o,t[o])})}set smooth(t){Object.keys(t).forEach(o=>{let u=t[o];Array.isArray(u)?this.setSmooth(o,u[0],u[1]):this.setSmooth(o,u)})}fastForward(t){if(this._transitions){let n=this._transitions[t];n&&n.isTransition&&n.finish()}}_getTransition(t){this._transitions||(this._transitions={});let n=this._transitions[t];return n?n.isTransitionSettings&&(n=new Ud(this.stage.transitions,n,this,t)):n=new Ud(this.stage.transitions,this.stage.transitions.defaultTransitionSettings,this,t),this._transitions[t]=n,n}_setTransition(t,n){if(!n)this._removeTransition(t);else{$.isObjectLiteral(n)&&(n=this.stage.transitions.createSettings(n)),this._transitions||(this._transitions={});let o=this._transitions[t];if(o&&o.isTransition)return o.settings=n,o;this._transitions[t]=n}}_removeTransition(t){this._transitions&&delete this._transitions[t]}getSmooth(t,n){let o=this._getTransition(t);return o&&o.isAttached()?o.targetValue:n}setSmooth(t,n,o){o&&this._setTransition(t,o);let u=this._getTransition(t);return u.start(n),u}get flex(){return this.__core.flex}set flex(t){this.__core.flex=t}get flexItem(){return this.__core.flexItem}set flexItem(t){this.__core.flexItem=t}static isColorProperty(t){return t.toLowerCase().indexOf("color")>=0}static getMerger(t){return ri.isColorProperty(t)?Te.mergeColors:Te.mergeNumbers}toJSON(){const t=[`${this.constructor.name}`],n={};return n[t]={},this.hasChildren()?ri.collectChildren(n[t],this.__childList):n[t]={...ri.getProperties(this)},n}static collectChildren(t,n){const o=n;for(let u=0,f=o.length;u<f;u++){const m=o.getAt(u),p=`${m.__ref||`Element-${m.id}`}`,v=this.getProperties(m);t[p]={...v},m.hasChildren()&&(t[p].children={},this.collectChildren(t[p].children,m.__childList))}}static getProperties(t){const n={},o=["alpha","active","attached","boundsMargin","color","clipping","enabled","h","id","isComponent","mount","mountY","mountX","pivot","pivotX","pivotY","ref","renderOfScreen","renderToTexture","scale","scaleX","scaleY","state","tag","visible","w","x","y","zIndex","!!flex","!!flexItem","hasFocus()","hasFinalFocus()"];let u=o.length;for(;u--;){let f=o[u];const m=/^!{2}/,p=/\(\)$/;m.test(f)?(f=f.substring(2,f.length),n[f]=!!t[f]):p.test(f)?(f=f.substring(0,f.length-2),typeof t[f]=="function"&&(n[f]=t[f]())):n[f]=t[f]}return{...n,...t.getNonDefaults()}}};mt.addAsMixin(si);si.prototype.isElement=1;si.id=1;si.PROP_GETTERS=new Map;si.PROP_SETTERS=new Map;class Ci{constructor(){Ci.setupStateMachine(this)}static setupStateMachine(t){const n=t.constructor,o=Ci.create(n);Object.setPrototypeOf(t,o.prototype),t.constructor=n,t._initStateMachine()}static create(t){if(!t.hasOwnProperty("_sm")){const n=new wr(t);t._sm=n}return t._sm.router}fire(t,...n){if(this._hasMethod(t))return this[t](...n)}_getState(){return this._state.__path}_inState(t,n=this._state.__path){const o=this._sm.getStateByPath(t),u=this._sm.getStateByPath(n),f=o.__level;return Ci._getStateAtLevel(u,f)===o}_hasMember(t){return!!this.constructor.prototype[t]}_hasMethod(t){const n=this.constructor.prototype[t];return!!n&&typeof n=="function"}_setState(t,n){const o=++this._setStateCounter;if(this._setStateId=o,this._state.__path!==t){let u=this._sm._stateMap[t];u||(u=this._sm.getStateByPath(t));const f=this._state,m=u.prototype.$enter!==this._state.prototype.$enter,p=u.prototype.$exit!==this._state.prototype.$exit;if(m||p){const v=Ci._getSharedState(this._state,u),w={newState:u.__path,prevState:f.__path,sharedState:v.__path},C=v.__level;if(p){const L=Ci._getStatesUntilLevel(this._state,C);for(let E=0,R=L.length;E<R;E++)if(this.__setState(L[E]),this._callExit(this._state,n,w),this._setStateId!==o)return}if(m){const L=Ci._getStatesUntilLevel(u,C).reverse();for(let E=0,R=L.length;E<R;E++)if(this.__setState(L[E]),this._callEnter(this._state,n,w),this._setStateId!==o)return}}if(this.__setState(u),this._changedState){const v={newState:u.__path,prevState:f.__path};n?this._changedState(v,...n):this._changedState(v)}if(this._onStateChange){const v={newState:u.__path,prevState:f.__path};this._onStateChange(v)}}}_callEnter(t,n=[],o){const u=!!t.__parent;t.prototype.$enter&&(!u||t.__parent.prototype.$enter!==t.prototype.$enter)&&t.prototype.$enter.apply(this,[o,...n])}_callExit(t,n=[],o){const u=!!t.__parent;t.prototype.$exit&&(!u||t.__parent.prototype.$exit!==t.prototype.$exit)&&t.prototype.$exit.apply(this,[o,...n])}__setState(t){this._state=t,this._stateIndex=t.__index,this.constructor=t}_initStateMachine(){this._state=null,this._stateIndex=0,this._setStateCounter=0,this._sm=this._routedType._sm,this.__setState(this._sm.getStateByPath(""));const t={newState:"",prevState:void 0,sharedState:void 0};this._callEnter(this._state,[],t),this._onStateChange=void 0}_getMostSpecificHandledMember(t){let n=this._state;do{for(let o=0,u=t.length;o<u;o++){const f=t[o];if(n.__parent){const m=wr.getStateMemberAlias(n.__path,f);if(this[m])return f}else if(n.prototype[f])return f}n=n.__parent}while(n)}static _getStatesUntilLevel(t,n){const o=[];for(;t.__level>n;)o.push(t),t=t.__parent;return o}static _getSharedState(t,n){const o=Ci._getAncestorStates(t),u=Ci._getAncestorStates(n),f=Math.min(o.length,u.length);for(let m=0;m<f;m++)if(o[m]!==u[m])return o[m-1];return o[f-1]}static _getAncestorStates(t){const n=[];do n.push(t);while(t=t.__parent);return n.reverse()}static _getStateAtLevel(t,n){if(!(n>t.__level)){for(;n<t.__level;)t=t.__parent;return t}}}class wr{constructor(t){this._type=t,this._router=null,this.init()}get router(){return this._router}init(){this._router=this._createRouter(),this._stateMap=this._getStateMap(),this._addStateMemberDelegatorsToRouter()}_createRouter(){const t=this._type,n=class extends t{constructor(){if(super(...arguments),!this.constructor.hasOwnProperty("_isRouter"))throw new Error(`You need to extend ${t.name}.original instead of ${t.name}.`)}};return n._isRouter=!0,n.prototype._routedType=t,n.original=t,this._mixinStateMachineMethods(n),n}_mixinStateMachineMethods(t){const n=Object.getOwnPropertyNames(Ci.prototype);for(let o=0,u=n.length;o<u;o++){const f=n[o];if(f!=="constructor"){const m=Object.getOwnPropertyDescriptor(Ci.prototype,f);Object.defineProperty(t.prototype,f,m)}}}_addStateMemberDelegatorsToRouter(){this._getAllMemberNames().forEach(n=>{this._addMemberRouter(n)})}_addMemberRouter(t){const n=Object.keys(this._stateMap),o=[],u=[];n.forEach((m,p)=>{const v=this._stateMap[m],w=this._getDescriptor(v,t);if(w){o[p]=w;const C=wr.getStateMemberAlias(w._source.__path,t);u[p]=C,this._router.prototype.hasOwnProperty(C)||Object.defineProperty(this._router.prototype,C,w)}else o[p]=null,u[p]=null});let f;switch(o.forEach(m=>{if(m){const p=this._getDescriptorType(m);if(f&&f!==p){console.warn(`[Lightning] Member ${t} in ${this._type.name} has inconsistent types.`);return}f=p}}),f){case"method":this._addMethodRouter(t,o,u);break;case"getter":this._addGetterSetterRouters(t);break;case"property":console.warn("[Lightning] Fixed properties are not supported; please use a getter instead!");break}}_getDescriptor(t,n,o=()=>!0){let u=t,f=t;do{const m=Object.getOwnPropertyDescriptor(u.prototype,n);if(m&&o(m))return m._source=f,m;u=Object.getPrototypeOf(u),u&&u.hasOwnProperty("__state")&&(f=u)}while(u&&u.prototype)}_getDescriptorType(t){return t.get||t.set?"getter":typeof t.value=="function"?"method":"property"}static _supportsSpread(){if(this.__supportsSpread===void 0){this.__supportsSpread=!1;try{new Function("return [].concat(...arguments);")(),this.__supportsSpread=!0}catch(t){}}return this.__supportsSpread}_addMethodRouter(t,n,o){const u=["//@ sourceURL=StateMachineRouter.js","var i = this._stateIndex;"];let f=o[0];const m=wr._supportsSpread();for(let C=1,L=o.length;C<L;C++){const E=o[C];E!==f&&(f?m?u.push(`if (i < ${C}) return this["${f}"](...arguments); else`):u.push(`if (i < ${C}) return this["${f}"].apply(this, arguments); else`):u.push(`if (i < ${C}) return ; else`)),f=E}f?m?u.push(`return this["${f}"](...arguments);`):u.push(`return this["${f}"].apply(this, arguments);`):u.push(";");const p=u.join(`
`),w={value:new Function([],p)};Object.defineProperty(this._router.prototype,t,w)}_addGetterSetterRouters(t){const n=this._getGetterRouter(t),o=this._getSetterRouter(t),u={get:n,set:o};Object.defineProperty(this._router.prototype,t,u)}_getGetterRouter(t){const n=Object.keys(this._stateMap),o=[];n.forEach((v,w)=>{const C=this._stateMap[v],L=this._getDescriptor(C,t,E=>E.get);if(L){const E=wr.getStateMemberAlias(L._source.__path,t);o[w]=E,this._router.prototype.hasOwnProperty(E)||Object.defineProperty(this._router.prototype,E,L)}else o[w]=null});const u=["//@ sourceURL=StateMachineRouter.js","var i = this._stateIndex;"];let f=o[0];for(let v=1,w=o.length;v<w;v++){const C=o[v];C!==f&&(f?u.push(`if (i < ${v}) return this["${f}"]; else`):u.push(`if (i < ${v}) return ; else`)),f=C}f?u.push(`return this["${f}"];`):u.push(";");const m=u.join(`
`);return new Function([],m)}_getSetterRouter(t){const n=Object.keys(this._stateMap),o=[];n.forEach((v,w)=>{const C=this._stateMap[v],L=this._getDescriptor(C,t,E=>E.set);if(L){const E=wr.getStateMemberAlias(L._source.__path,t);o[w]=E,this._router.prototype.hasOwnProperty(E)||Object.defineProperty(this._router.prototype,E,L)}else o[w]=null});const u=["//@ sourceURL=StateMachineRouter.js","var i = this._stateIndex;"];let f=o[0];for(let v=1,w=o.length;v<w;v++){const C=o[v];C!==f&&(f?u.push(`if (i < ${v}) this["${f}"] = arg; else`):u.push(`if (i < ${v}) ; else`)),f=C}f?u.push(`this["${f}"] = arg;`):u.push(";");const m=u.join(`
`);return new Function(["arg"],m)}static getStateMemberAlias(t,n){return"$"+(t?t+".":"")+n}_getAllMemberNames(){const t=this._stateMap,n=Object.keys(t);let o=new Set;return n.forEach(u=>{if(u==="")return;const f=t[u];this._getStateMemberNames(f).forEach(p=>{o.add(p)})}),[...o]}_getStateMemberNames(t){let n=t,o=new Set;const u=this._type===t;do this._getStateMemberNamesForType(n).forEach(m=>{o.add(m)}),n=Object.getPrototypeOf(n);while(n&&n.prototype&&(!n.hasOwnProperty("__state")||u));return o}_getStateMemberNamesForType(t){return Object.getOwnPropertyNames(t.prototype).filter(o=>o!=="constructor"&&!wr._isStateLocalMember(o))}static _isStateLocalMember(t){return t==="$enter"||t==="$exit"}getStateByPath(t){if(this._stateMap[t])return this._stateMap[t];const n=t.split(".");for(;n.pop();){const o=n.join(".");if(this._stateMap[o])return this._stateMap[o]}}_getStateMap(){return this._stateMap||(this._stateMap=this._createStateMap()),this._stateMap}_createStateMap(){const t={};return this._addState(this._type,null,"",t),t}_addState(t,n,o,u){t.__state=!0,t.__name=o,this._addStaticStateProperty(t,n);const f=n?n.__path:"";let m=(f?f+".":"")+o;t.__path=m,t.__level=n?n.__level+1:0,t.__parent=n,t.__index=Object.keys(u).length,u[m]=t;const p=t._states;p&&(n&&n._states===p||t._states().forEach(C=>{const L=wr._getStateName(C);this._addState(C,t,L,u)}))}static _getStateName(t){const n=t.name,o=n.indexOf("$");return o>0?n.substr(0,o):n}_addStaticStateProperty(t,n){n&&(n&&!n.__parent?this._router[t.__name]=t:n[t.__name]=t)}}class Ct extends si{constructor(t,n){super(t),this.tagRoot=!0,$.isObjectLiteral(n)&&Object.assign(this,n),this.__initialized=!1,this.__firstActive=!1,this.__firstEnable=!1,this.__signals=void 0,this.__passSignals=void 0,this.__construct();const o=this.constructor.getTemplateFunc(this);o.f(this,o.a),this._build()}__start(){Ci.setupStateMachine(this),this._onStateChange=Ct.prototype.__onStateChange}get state(){return this._getState()}__onStateChange(){this.application&&this.application.updateFocusPath()}_refocus(){this.application&&this.application.updateFocusPath()}static bindProp(t,n=null){return{__propertyBinding:!0,__name:t,__func:n}}__bindProperty(t,n,o){const u=n,f=o,m=Array.isArray(t.__name)?t.__name:[t.__name];for(let p=0;p<m.length;p++){const v=m[p],w=t.__func?t.__func:C=>C[v];this.hasOwnProperty(v)?this[`__prop_bindings_${v}`].push({__obj:u,__prop:f,__func:w}):(this[`__prop_bindings_${v}`]=[{__obj:u,__prop:f,__func:w}],Object.defineProperty(this,v,{set:C=>{this[`__prop_${v}`]=C;for(const{__obj:L,__prop:E,__func:R}of this[`__prop_bindings_${v}`])L[E]=R(this)},get:()=>this[`__prop_${v}`]}))}}static getTemplateFunc(t){const n="_templateFunc",o="__has"+n;return this[o]!==this&&(this[o]=this,this[n]=this.parseTemplate(this._template(t))),this[n]}static parseTemplate(t){const n={loc:[],store:[],rid:0};this.parseTemplateRec(t,n,"element");const o=n.loc.join(`;
`);return{f:new Function("element","store",o),a:n.store}}static parseTemplateRec(t,n,o){const u=n.store,f=n.loc;Object.keys(t).forEach(p=>{let v=t[p];if($.isUcChar(p.charCodeAt(0)))if($.isObjectLiteral(v)){const w=`r${p.replace(/[^a-z0-9]/gi,"")+n.rid}`;let C=v.type?v.type:si;C===si?f.push(`var ${w} = element.stage.createElement()`):(u.push(C),f.push(`var ${w} = new store[${u.length-1}](${o}.stage)`)),f.push(`${w}.ref = "${p}"`),n.rid++,this.parseTemplateRec(v,n,w),f.push(`${o}.childList.add(${w})`)}else $.isObject(v)&&(u.push(v),f.push(`${o}.childList.add(store[${u.length-1}])`));else if(p==="text"){const w=o+"__text";f.push(`var ${w} = ${o}.enableTextTexture()`),v.__propertyBinding===!0?(u.push(v),f.push(`element.__bindProperty(store[${u.length-1}], ${o}, "${p}")`)):this.parseTemplatePropRec(v,n,w)}else if(p==="shader"&&$.isObjectLiteral(v)){const w=`${o}["shader"]`;u.push(v),f.push(`${o}["${p}"] = store[${u.length-1}]`),this.parsePropertyBindings(v,n,w)}else if(p==="texture"&&$.isObjectLiteral(v)){const w=o+"__texture",C=v.type;C?(u.push(C),f.push(`var ${w} = new store[${u.length-1}](${o}.stage)`),this.parseTemplatePropRec(v,n,w),f.push(`${o}["${p}"] = ${w}`)):(f.push(`${w} = ${o}.texture`),this.parseTemplatePropRec(v,n,w))}else $.isObjectLiteral(v)&&v.__propertyBinding===!0?(u.push(v),f.push(`element.__bindProperty(store[${u.length-1}], ${o}, "${p}")`)):$.isNumber(v)?f.push(`${o}["${p}"] = ${v}`):$.isBoolean(v)?f.push(`${o}["${p}"] = ${v?"true":"false"}`):$.isObject(v)||Array.isArray(v)?(u.push(v),f.push(`${o}["${p}"] = store[${u.length-1}]`)):f.push(`${o}["${p}"] = ${JSON.stringify(v)}`)})}static parseTemplatePropRec(t,n,o){const u=n.store,f=n.loc;Object.keys(t).forEach(p=>{if(p!=="type"){const v=t[p];$.isNumber(v)?f.push(`${o}["${p}"] = ${v}`):$.isBoolean(v)?f.push(`${o}["${p}"] = ${v?"true":"false"}`):$.isObject(v)&&v.__propertyBinding===!0?(u.push(v),f.push(`element.__bindProperty(store[${u.length-1}], ${o}, "${p}")`)):$.isObject(v)||Array.isArray(v)?(u.push(v),f.push(`${o}["${p}"] = store[${u.length-1}]`)):f.push(`${o}["${p}"] = ${JSON.stringify(v)}`)}})}static parsePropertyBindings(t,n,o){const u=n.store,f=n.loc;Object.keys(t).forEach(p=>{if(p!=="type"){const v=t[p];$.isObjectLiteral(v)&&v.__propertyBinding===!0&&(u.push(v),f.push(`element.__bindProperty(store[${u.length-1}], ${o}, "${p}")`))}})}_onSetup(){this.__initialized||this._setup()}_setup(){}_onAttach(){this.__initialized||(this.__init(),this.__initialized=!0),this._attach()}_attach(){}_onDetach(){this._detach()}_detach(){}_onEnabled(){this.__firstEnable||(this._firstEnable(),this.__firstEnable=!0),this._enable()}_firstEnable(){}_enable(){}_onDisabled(){this._disable()}_disable(){}_onActive(){this.__firstActive||(this._firstActive(),this.__firstActive=!0),this._active()}_firstActive(){}_active(){}_onInactive(){this._inactive()}_inactive(){}get application(){return this.stage.application}__construct(){this._construct()}_construct(){}_build(){}__init(){this._init()}_init(){}_focus(t,n){}_unfocus(t){}_focusChange(t,n){}_getFocused(){return this}_setFocusSettings(t){}_handleFocusSettings(t){}static _template(){return{}}hasFinalFocus(){let t=this.application._focusPath;return t&&t.length&&t[t.length-1]===this}hasFocus(){let t=this.application._focusPath;return t&&t.indexOf(this)>=0}get cparent(){return Ct.getParent(this)}seekAncestorByType(t){let n=this.cparent;for(;n;){if(n.constructor===t)return n;n=n.cparent}}getSharedAncestorComponent(t){let n=this.getSharedAncestor(t);for(;n&&!n.isComponent;)n=n.parent;return n}get signals(){return this.__signals}set signals(t){$.isObjectLiteral(t)||this._throwError("Signals: specify an object with signal-to-fire mappings"),this.__signals=t}set alterSignals(t){$.isObjectLiteral(t)||this._throwError("Signals: specify an object with signal-to-fire mappings"),this.__signals||(this.__signals={});for(let n in t)t[n]===void 0?delete this.__signals[n]:this.__signals[n]=t}get passSignals(){return this.__passSignals||{}}set passSignals(t){this.__passSignals=Object.assign(this.__passSignals||{},t)}set alterPassSignals(t){$.isObjectLiteral(t)||this._throwError("Signals: specify an object with signal-to-fire mappings"),this.__passSignals||(this.__passSignals={});for(let n in t)t[n]===void 0?delete this.__passSignals[n]:this.__passSignals[n]=t}signal(t,...n){return this._signal(t,n)}_signal(t,n){const o=this._getParentSignalHandler();if(o){if(this.__signals){let f=this.__signals[t];if(f===!1)return;if(f){if(f===!0&&(f=t),$.isFunction(f))return f(...n);if(o._hasMethod(f))return o[f](...n)}}let u=this.__passSignals&&this.__passSignals[t];if(u)return u&&u!==!0&&(t=u),o._signal(t,n)}}_getParentSignalHandler(){return this.cparent?this.cparent._getSignalHandler():null}_getSignalHandler(){return this._signalProxy?this.cparent?this.cparent._getSignalHandler():null:this}get _signalProxy(){return!1}fireAncestors(t,...n){if(!t.startsWith("$"))throw new Error("Ancestor event name must be prefixed by dollar sign.");const o=this._getParentSignalHandler();if(o)return o._doFireAncestors(t,n)}_doFireAncestors(t,n){if(this._hasMethod(t))return this.fire(t,...n);{const o=this._getParentSignalHandler();if(o)return o._doFireAncestors(t,n)}}static collectSubComponents(t,n){if(n.hasChildren()){const o=n.__childList;for(let u=0,f=o.length;u<f;u++){const m=o.getAt(u);m.isComponent?t.push(m):Ct.collectSubComponents(t,m)}}}static getComponent(t){let n=t;for(;n&&!n.isComponent;)n=n.parent;return n}static getParent(t){return Ct.getComponent(t.parent)}}Ct.prototype.isComponent=!0;class Kv{constructor(t){this.ctx=t,this.quadTextures=[],this.quadElements=[]}get length(){return this.quadTextures.length}reset(){this.quadTextures=[],this.quadElements=[],this.dataLength=0}getElement(t){return this.quadElements[t]._element}getElementCore(t){return this.quadElements[t]}getTexture(t){return this.quadTextures[t]}getTextureWidth(t){let n=this.quadTextures[t];return n.w?n.w:this.quadElements[t]._displayedTextureSource.w}getTextureHeight(t){let n=this.quadTextures[t];return n.h?n.h:this.quadElements[t]._displayedTextureSource.h}}class Ab extends Kv{constructor(t){super(t);const n=t.stage.getOption("bufferMemory");this.dataLength=0,this.data=new ArrayBuffer(n),this.floats=new Float32Array(this.data),this.uints=new Uint32Array(this.data)}getAttribsDataByteOffset(t){return t*80}getQuadContents(){let t=this.floats,n=this.uints,o=[];for(let u=1;u<=this.length;u++){let f="entry "+u+": ";for(let m=0;m<4;m++){let p=u*20+m*4;f+=t[p]+","+t[p+1]+":"+t[p+2]+","+t[p+3]+"["+n[p+4].toString(16)+"] "}o.push(f)}return o}}class Zv{constructor(t,n,o,u,f,m){this.ctx=t,this.shader=n,this.shaderOwner=o,this.renderTextureInfo=u,this.scissor=f,this.index=m,this.length=0}get quads(){return this.ctx.renderState.quads}getTexture(t){return this.quads.getTexture(this.index+t)}getElementCore(t){return this.quads.getElementCore(this.index+t)}getElement(t){return this.quads.getElement(this.index+t)}getElementWidth(t){return this.getElement(t).renderWidth}getElementHeight(t){return this.getElement(t).renderHeight}getTextureWidth(t){return this.quads.getTextureWidth(this.index+t)}getTextureHeight(t){return this.quads.getTextureHeight(this.index+t)}getRenderWidth(){return this.renderTextureInfo?this.renderTextureInfo.w:this.ctx.stage.w}getRenderHeight(){return this.renderTextureInfo?this.renderTextureInfo.h:this.ctx.stage.h}}class Eb extends Zv{constructor(t,n,o,u,f,m){super(t,n,o,u,f,m),this.extraAttribsDataByteOffset=0}getAttribsDataByteOffset(t){return this.quads.getAttribsDataByteOffset(this.index+t)}getNormalRenderTextureCoords(t,n){let o=this.shaderOwner.getRenderTextureCoords(t,n);return o[0]/=this.getRenderWidth(),o[1]/=this.getRenderHeight(),o[0]=o[0]*2-1,o[1]=1-o[1]*2,o}getProjection(){return this.renderTextureInfo===null?this.ctx.renderExec._projection:this.renderTextureInfo.nativeTexture.projection}}class Qv{constructor(t){this.ctx=t,this.renderState=t.renderState,this.gl=this.ctx.stage.gl}destroy(){}_reset(){this._bindRenderTexture(null),this._setScissor(null),this._clearRenderTexture()}execute(){this._reset();let t=this.renderState.quadOperations,n=0,o=t.length;for(;n<o;)this._processQuadOperation(t[n]),n++}_processQuadOperation(t){t.renderTextureInfo&&t.renderTextureInfo.ignore||(this._setupQuadOperation(t),this._execQuadOperation(t))}_setupQuadOperation(t){}_execQuadOperation(t){let n=t.renderTextureInfo?t.renderTextureInfo.nativeTexture:null;this._renderTexture!==n&&this._bindRenderTexture(n),t.renderTextureInfo&&!t.renderTextureInfo.cleared?(this._setScissor(null),this._clearRenderTexture(),t.renderTextureInfo.cleared=!0,this._setScissor(t.scissor)):this._setScissor(t.scissor),this._renderQuadOperation(t)}_renderQuadOperation(t){}_bindRenderTexture(t){this._renderTexture=t}_clearRenderTexture(t){}_setScissor(t){}}class bb extends Qv{constructor(t){super(t),this.gl=this.ctx.stage.gl,this.init()}init(){let t=this.gl;this._attribsBuffer=t.createBuffer();let n=Math.floor(this.renderState.quads.data.byteLength/80),o=new Uint16Array(n*6);for(let u=0,f=0;u<n;u+=6,f+=4)o[u]=f,o[u+1]=f+1,o[u+2]=f+2,o[u+3]=f,o[u+4]=f+2,o[u+5]=f+3;this._quadsBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._quadsBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,o,t.STATIC_DRAW),this._projection=new Float32Array([2/this.ctx.stage.coordsWidth,-2/this.ctx.stage.coordsHeight])}destroy(){super.destroy(),this.gl.deleteBuffer(this._attribsBuffer),this.gl.deleteBuffer(this._quadsBuffer)}_reset(){super._reset();let t=this.gl;t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),this._stopShaderProgram(),this._setupBuffers()}_setupBuffers(){let t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._quadsBuffer);let n=new Float32Array(this.renderState.quads.data,0,this.renderState.quads.dataLength);t.bindBuffer(t.ARRAY_BUFFER,this._attribsBuffer),t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW)}_setupQuadOperation(t){super._setupQuadOperation(t),this._useShaderProgram(t.shader,t)}_renderQuadOperation(t){let n=t.shader;(t.length||t.shader.addEmpty())&&(n.beforeDraw(t),n.draw(t),n.afterDraw(t))}_useShaderProgram(t,n){t.hasSameProgram(this._currentShaderProgram)||(this._currentShaderProgram&&this._currentShaderProgram.stopProgram(),t.useProgram(),this._currentShaderProgram=t),t.setupUniforms(n)}_stopShaderProgram(){this._currentShaderProgram&&(this._currentShaderProgram.stopProgram(),this._currentShaderProgram=null)}_bindRenderTexture(t){super._bindRenderTexture(t);let n=this.gl;this._renderTexture?(n.bindFramebuffer(n.FRAMEBUFFER,this._renderTexture.framebuffer),n.viewport(0,0,this._renderTexture.w,this._renderTexture.h)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,this.ctx.stage.w,this.ctx.stage.h))}_clearRenderTexture(){super._clearRenderTexture();let t=this.gl;if(this._renderTexture)t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT);else{let n=this.ctx.stage.getClearColor();n&&(t.clearColor(n[0]*n[3],n[1]*n[3],n[2]*n[3],n[3]),t.clear(t.COLOR_BUFFER_BIT))}}_setScissor(t){if(super._setScissor(t),this._scissor===t)return;this._scissor=t;let n=this.gl;if(!t)n.disable(n.SCISSOR_TEST);else{n.enable(n.SCISSOR_TEST);let o=this.ctx.stage.getRenderPrecision(),u=t[1];this._renderTexture===null&&(u=this.ctx.stage.h/o-(t[1]+t[3])),n.scissor(Math.round(t[0]*o),Math.round(u*o),Math.round(t[2]*o),Math.round(t[3]*o))}}}class Jv{constructor(t){this.ctx=t,this.stage=t.stage,this.defaultShader=this.stage.renderer.getDefaultShader(t),this.renderer=t.stage.renderer,this.quads=this.renderer.createCoreQuadList(t)}reset(){this._renderTextureInfo=null,this._scissor=null,this._shader=null,this._shaderOwner=null,this._realShader=null,this._check=!1,this.quadOperations=[],this._texturizer=null,this._texturizerTemporary=!1,this._quadOperation=null,this.quads.reset(),this._temporaryTexturizers=[],this._isCachingTexturizer=!1}get length(){return this.quads.quadTextures.length}setShader(t,n){(this._shaderOwner!==n||this._realShader!==t)&&(this._realShader=t,t.useDefault()&&(t=this.defaultShader),(this._shader!==t||this._shaderOwner!==n)&&(this._shader=t,this._shaderOwner=n,this._check=!0))}get renderTextureInfo(){return this._renderTextureInfo}setScissor(t){this._scissor!==t&&(t?this._scissor=t:this._scissor=null,this._check=!0)}getScissor(){return this._scissor}setRenderTextureInfo(t){this._renderTextureInfo!==t&&(this._renderTextureInfo=t,this._scissor=null,this._check=!0)}setTexturizer(t,n=!1){this._texturizer=t,this._cacheTexturizer=n}set isCachingTexturizer(t){this._isCachingTexturizer=t}get isCachingTexturizer(){return this._isCachingTexturizer}addQuad(t){this._quadOperation?this._check&&this._hasChanges()&&(this._finishQuadOperation(),this._check=!1):this._createQuadOperation();let n=null;this._texturizer&&(n=this._texturizer.getResultTexture(),this._cacheTexturizer||this._temporaryTexturizers.push(this._texturizer)),n||(n=t._displayedTextureSource.nativeTexture),this._renderTextureInfo&&(this._shader===this.defaultShader&&this._renderTextureInfo.empty?(this._renderTextureInfo.nativeTexture=n,this._renderTextureInfo.offset=this.length):this._renderTextureInfo.nativeTexture=null,this._renderTextureInfo.empty=!1),this.quads.quadTextures.push(n),this.quads.quadElements.push(t),this._quadOperation.length++,this.renderer.addQuad(this,this.quads,this.length-1)}finishedRenderTexture(){this._renderTextureInfo.nativeTexture&&(this._isRenderTextureReusable()||(this._renderTextureInfo.nativeTexture=null))}_isRenderTextureReusable(){const t=this._renderTextureInfo.offset;return this.quads.quadTextures[t].w===this._renderTextureInfo.w&&this.quads.quadTextures[t].h===this._renderTextureInfo.h&&this.renderer.isRenderTextureReusable(this,this._renderTextureInfo)}_hasChanges(){let t=this._quadOperation;return this._shader!==t.shader||this._shaderOwner!==t.shaderOwner||this._renderTextureInfo!==t.renderTextureInfo||this._scissor!==t.scissor&&(this._scissor[0]!==t.scissor[0]||this._scissor[1]!==t.scissor[1]||this._scissor[2]!==t.scissor[2]||this._scissor[3]!==t.scissor[3])}_finishQuadOperation(t=!0){if(this._quadOperation){if((this._quadOperation.length||this._shader.addEmpty())&&(!this._quadOperation.scissor||this._quadOperation.scissor[2]>0&&this._quadOperation.scissor[3]>0)&&this.quadOperations.push(this._quadOperation),this._temporaryTexturizers.length){for(let n=0,o=this._temporaryTexturizers.length;n<o;n++)this._temporaryTexturizers[n].releaseRenderTexture();this._temporaryTexturizers=[]}this._quadOperation=null}t&&this._createQuadOperation()}_createQuadOperation(){this._quadOperation=this.renderer.createCoreQuadOperation(this.ctx,this._shader,this._shaderOwner,this._renderTextureInfo,this._scissor,this.length),this._check=!1}finish(){this._quadOperation&&this._finishQuadOperation(!1),this.renderer.finishRenderState(this)}}class Ib{constructor(t,n){this.vertexShaderSource=t,this.fragmentShaderSource=n,this._program=null,this._uniformLocations=new Map,this._attributeLocations=new Map,this._currentUniformValues={}}compile(t){if(this._program)return;this.gl=t,this._program=t.createProgram();let n=this._glCompile(t.VERTEX_SHADER,this.vertexShaderSource),o=this._glCompile(t.FRAGMENT_SHADER,this.fragmentShaderSource);t.attachShader(this._program,n),t.attachShader(this._program,o),t.linkProgram(this._program),t.getProgramParameter(this._program,t.LINK_STATUS)||(console.error("[Lightning] Error: Could not initialize shader."),console.error("[Lightning] gl.VALIDATE_STATUS",t.getProgramParameter(this._program,t.VALIDATE_STATUS)),console.error("[Lightning] gl.getError()",t.getError()),t.getProgramInfoLog(this._program)!==""&&console.warn("[Lightning] Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(this._program)),t.deleteProgram(this._program),this._program=null),t.deleteShader(n),t.deleteShader(o)}_glCompile(t,n){let o=this.gl.createShader(t);if(this.gl.shaderSource(o,n),this.gl.compileShader(o),!this.gl.getShaderParameter(o,this.gl.COMPILE_STATUS)){console.error("[Lightning]",this.constructor.name,"Type: "+(t===this.gl.VERTEX_SHADER?"vertex shader":"fragment shader")),console.error("[Lightning]",this.gl.getShaderInfoLog(o));let u=0;return console.error("[Lightning]",`========== source ==========
`+n.split(`
`).map(f=>""+ ++u+": "+f).join(`
`)),null}return o}getUniformLocation(t){let n=this._uniformLocations.get(t);return n===void 0&&(n=this.gl.getUniformLocation(this._program,t),this._uniformLocations.set(t,n)),n}getAttribLocation(t){let n=this._attributeLocations.get(t);return n===void 0&&(n=this.gl.getAttribLocation(this._program,t),this._attributeLocations.set(t,n)),n}destroy(){this._program&&(this.gl.deleteProgram(this._program),this._program=null)}get glProgram(){return this._program}get compiled(){return!!this._program}_valueEquals(t,n){if(t.length&&n.length){for(let o=0,u=t.length;o<u;o++)if(t[o]!==n[o])return!1;return!0}else return t===n}_valueClone(t){return t.length?t.slice(0):t}setUniformValue(t,n,o){let u=this._currentUniformValues[t];if(u===void 0||!this._valueEquals(u,n)){let f=this._valueClone(n);this._currentUniformValues[t]=f;let m=this.getUniformLocation(t);m&&(o===this.gl.uniformMatrix2fv||o===this.gl.uniformMatrix3fv||o===this.gl.uniformMatrix4fv?o.call(this.gl,m,!1,f):o.call(this.gl,m,f))}}}class xu extends Qo{constructor(t){super(t);const n=t.stage;this._program=n.renderer.shaderPrograms.get(this.constructor),this._program||(this._program=new Ib(this.constructor.vertexShaderSource,this.constructor.fragmentShaderSource),n.renderer.shaderPrograms.set(this.constructor,this._program)),this.gl=n.gl}get glProgram(){return this._program.glProgram}_init(){this._initialized||(this.initialize(),this._initialized=!0)}initialize(){this._program.compile(this.gl)}get initialized(){return this._initialized}_uniform(t){return this._program.getUniformLocation(t)}_attrib(t){return this._program.getAttribLocation(t)}_setUniform(t,n,o){this._program.setUniformValue(t,n,o)}useProgram(){this._init(),this.gl.useProgram(this.glProgram),this.beforeUsage(),this.enableAttribs()}stopProgram(){this.afterUsage(),this.disableAttribs()}hasSameProgram(t){return t&&(t===this||t._program===this._program)}beforeUsage(){}afterUsage(){}enableAttribs(){}disableAttribs(){}getExtraAttribBytesPerVertex(){return 0}getVertexAttribPointerOffset(t){return t.extraAttribsDataByteOffset-t.index*4*this.getExtraAttribBytesPerVertex()}setExtraAttribsInBuffer(t){}setupUniforms(t){}_getProjection(t){return t.getProjection()}getFlipY(t){return this._getProjection(t)[1]<0}beforeDraw(t){}draw(t){}afterDraw(t){}cleanup(){this._initialized=!1}}let Je=class extends xu{enableAttribs(){let t=this.gl;t.vertexAttribPointer(this._attrib("aVertexPosition"),2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(this._attrib("aVertexPosition")),this._attrib("aTextureCoord")!==-1&&(t.vertexAttribPointer(this._attrib("aTextureCoord"),2,t.FLOAT,!1,20,2*4),t.enableVertexAttribArray(this._attrib("aTextureCoord"))),this._attrib("aColor")!==-1&&(t.vertexAttribPointer(this._attrib("aColor"),4,t.UNSIGNED_BYTE,!0,20,4*4),t.enableVertexAttribArray(this._attrib("aColor")))}disableAttribs(){let t=this.gl;t.disableVertexAttribArray(this._attrib("aVertexPosition")),this._attrib("aTextureCoord")!==-1&&t.disableVertexAttribArray(this._attrib("aTextureCoord")),this._attrib("aColor")!==-1&&t.disableVertexAttribArray(this._attrib("aColor"))}setupUniforms(t){this._setUniform("projection",this._getProjection(t),this.gl.uniform2fv,!1)}draw(t){let n=this.gl,o=t.length;if(o){let u=t.getTexture(0),f=0;for(let m=0;m<o;m++){let p=t.getTexture(m);u!==p&&(n.bindTexture(n.TEXTURE_2D,u),n.drawElements(n.TRIANGLES,6*(m-f),n.UNSIGNED_SHORT,(f+t.index)*6*2),u=p,f=m)}f<o&&(n.bindTexture(n.TEXTURE_2D,u),n.drawElements(n.TRIANGLES,6*(o-f),n.UNSIGNED_SHORT,(f+t.index)*6*2))}}};Je.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;Je.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    void main(void){
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;
    }
`;class e0{constructor(t){this.stage=t,this._defaultShader=void 0}gc(t){}destroy(){}getDefaultShader(t=this.stage.ctx){return this._defaultShader||(this._defaultShader=this._createDefaultShader(t)),this._defaultShader}_createDefaultShader(t){}isValidShaderType(t){return t.prototype instanceof this._getShaderBaseType()}createShader(t,n){const o=n.type;if(this.isValidShaderType(o)){const u=new o(t);return Ot.patchObject(this,n),u}else{const u=this._getShaderAlternative(o);return u?new u(t):(console.warn("[Lightning] Shader has no implementation for render target: "+o.name),this._createDefaultShader(t))}}_getShaderBaseType(){}_getShaderAlternative(t){return this.getDefaultShader()}copyRenderTexture(t,n,o){console.warn("[Lightning] copyRenderTexture not supported by renderer")}}class t0 extends e0{constructor(t){super(t),this.shaderPrograms=new Map,this._compressedTextureExtensions={astc:t.gl.getExtension("WEBGL_compressed_texture_astc"),etc1:t.gl.getExtension("WEBGL_compressed_texture_etc1"),s3tc:t.gl.getExtension("WEBGL_compressed_texture_s3tc"),pvrtc:t.gl.getExtension("WEBGL_compressed_texture_pvrtc")}}getCompressedTextureExtensions(){return this._compressedTextureExtensions}destroy(){this.shaderPrograms.forEach(t=>t.destroy())}_createDefaultShader(t){return new Je(t)}_getShaderBaseType(){return xu}_getShaderAlternative(t){return t.getWebGL&&t.getWebGL()}createCoreQuadList(t){return new Ab(t)}createCoreQuadOperation(t,n,o,u,f,m){return new Eb(t,n,o,u,f,m)}createCoreRenderExecutor(t){return new bb(t)}createCoreRenderState(t){return new Jv(t)}createRenderTexture(t,n,o,u){const f=this.stage.gl,m=f.createTexture();return f.bindTexture(f.TEXTURE_2D,m),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,o,u,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),m.params={},m.params[f.TEXTURE_MAG_FILTER]=f.LINEAR,m.params[f.TEXTURE_MIN_FILTER]=f.LINEAR,m.params[f.TEXTURE_WRAP_S]=f.CLAMP_TO_EDGE,m.params[f.TEXTURE_WRAP_T]=f.CLAMP_TO_EDGE,m.options={format:f.RGBA,internalFormat:f.RGBA,type:f.UNSIGNED_BYTE},m.framebuffer=f.createFramebuffer(),m.projection=new Float32Array([2/t,2/n]),f.bindFramebuffer(f.FRAMEBUFFER,m.framebuffer),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,m,0),m}freeRenderTexture(t){let n=this.stage.gl;n.deleteFramebuffer(t.framebuffer),n.deleteTexture(t)}_getBytesPerPixel(t,n){const o=this.stage.gl;if(t===o.RGBA)switch(n){case o.UNSIGNED_BYTE:return 4;case o.UNSIGNED_SHORT_4_4_4_4:return 2;case o.UNSIGNED_SHORT_5_5_5_1:return 2;default:throw new Error("Invalid type specified for GL_RGBA format")}else if(t===o.RGB)switch(n){case o.UNSIGNED_BYTE:return 3;case o.UNSIGNED_BYTE_5_6_5:return 2;default:throw new Error("Invalid type specified for GL_RGB format")}else throw new Error("Invalid format specified in call to _getBytesPerPixel()")}uploadTextureSource(t,n){const o=this.stage.gl,u=n.source;let f=!1;n.renderInfo&&(f=n.renderInfo.compressed||!1);const m={premultiplyAlpha:!0,hasAlpha:!0};n&&n.hasOwnProperty("premultiplyAlpha")&&(m.premultiplyAlpha=n.premultiplyAlpha),n&&n.hasOwnProperty("flipBlueRed")&&(m.flipBlueRed=n.flipBlueRed),n&&n.hasOwnProperty("hasAlpha")&&(m.hasAlpha=n.hasAlpha),m.hasAlpha||(m.premultiplyAlpha=!1),m.texParams=n.texParams||{},m.texOptions=n.texOptions||{};let p=o.createTexture();o.bindTexture(o.TEXTURE_2D,p),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m.premultiplyAlpha),$.isNode&&o.pixelStorei(o.UNPACK_FLIP_BLUE_RED,!!m.flipBlueRed);const v=m.texParams;if(v[o.TEXTURE_MAG_FILTER]||(v[o.TEXTURE_MAG_FILTER]=o.LINEAR),v[o.TEXTURE_MIN_FILTER]||(v[o.TEXTURE_MIN_FILTER]=o.LINEAR),v[o.TEXTURE_WRAP_S]||(v[o.TEXTURE_WRAP_S]=o.CLAMP_TO_EDGE),v[o.TEXTURE_WRAP_T]||(v[o.TEXTURE_WRAP_T]=o.CLAMP_TO_EDGE),Object.keys(v).forEach(C=>{const L=v[C];o.texParameteri(o.TEXTURE_2D,parseInt(C),L)}),f)return this.stage.platform.uploadCompressedGlTexture(o,t,u),p;const w=m.texOptions;return w.format=w.format||(m.hasAlpha?o.RGBA:o.RGB),w.type=w.type||o.UNSIGNED_BYTE,w.internalFormat=w.internalFormat||w.format,n&&n.imageRef&&(w.imageRef=n.imageRef),this.stage.platform.uploadGlTexture(o,t,u,w),p.params=$.cloneObjShallow(v),p.options=$.cloneObjShallow(w),p.bytesPerPixel=this._getBytesPerPixel(w.format,w.type),p}freeTextureSource(t){this.stage.gl.deleteTexture(t.nativeTexture)}addQuad(t,n,o){let u=o*20;const f=n.quadElements[o];let m=f._renderContext,p=t.quads.floats,v=t.quads.uints;const w=Te.mergeColorAlpha;if(m.tb!==0||m.tc!==0)p[u++]=m.px,p[u++]=m.py,p[u++]=f._ulx,p[u++]=f._uly,v[u++]=w(f._colorUl,m.alpha),p[u++]=m.px+f._w*m.ta,p[u++]=m.py+f._w*m.tc,p[u++]=f._brx,p[u++]=f._uly,v[u++]=w(f._colorUr,m.alpha),p[u++]=m.px+f._w*m.ta+f._h*m.tb,p[u++]=m.py+f._w*m.tc+f._h*m.td,p[u++]=f._brx,p[u++]=f._bry,v[u++]=w(f._colorBr,m.alpha),p[u++]=m.px+f._h*m.tb,p[u++]=m.py+f._h*m.td,p[u++]=f._ulx,p[u++]=f._bry,v[u]=w(f._colorBl,m.alpha);else{let C=m.px+f._w*m.ta,L=m.py+f._h*m.td;p[u++]=m.px,p[u++]=m.py,p[u++]=f._ulx,p[u++]=f._uly,v[u++]=w(f._colorUl,m.alpha),p[u++]=C,p[u++]=m.py,p[u++]=f._brx,p[u++]=f._uly,v[u++]=w(f._colorUr,m.alpha),p[u++]=C,p[u++]=L,p[u++]=f._brx,p[u++]=f._bry,v[u++]=w(f._colorBr,m.alpha),p[u++]=m.px,p[u++]=L,p[u++]=f._ulx,p[u++]=f._bry,v[u]=w(f._colorBl,m.alpha)}}isRenderTextureReusable(t,n){let o=t._renderTextureInfo.offset*80/4,u=t.quads.floats,f=t.quads.uints;return u[o]===0&&u[o+1]===0&&u[o+2]===0&&u[o+3]===0&&f[o+4]===4294967295&&u[o+5]===n.w&&u[o+6]===0&&u[o+7]===1&&u[o+8]===0&&f[o+9]===4294967295&&u[o+10]===n.w&&u[o+11]===n.h&&u[o+12]===1&&u[o+13]===1&&f[o+14]===4294967295&&u[o+15]===0&&u[o+16]===n.h&&u[o+17]===0&&u[o+18]===1&&f[o+19]===4294967295}finishRenderState(t){let n=t.length*80;for(let o=0,u=t.quadOperations.length;o<u;o++){t.quadOperations[o].extraAttribsDataByteOffset=n;let f=t.quadOperations[o].shader.getExtraAttribBytesPerVertex()*4*t.quadOperations[o].length;n+=f,f&&t.quadOperations[o].shader.setExtraAttribsInBuffer(t.quadOperations[o],t.quads)}t.quads.dataLength=n}copyRenderTexture(t,n,o){const u=this.stage.gl;u.bindTexture(u.TEXTURE_2D,n),u.bindFramebuffer(u.FRAMEBUFFER,t.framebuffer);const f=t.precision;u.copyTexSubImage2D(u.TEXTURE_2D,0,f*(o.sx||0),f*(o.sy||0),f*(o.x||0),f*(o.y||0),f*(o.w||t.ow),f*(o.h||t.oh))}}class Rb extends Kv{constructor(t){super(t),this.renderContexts=[],this.modes=[]}setRenderContext(t,n){this.renderContexts[t]=n}setSimpleTc(t,n){n?this.modes[t]|=1:this.modes[t]-=this.modes[t]&1}setWhite(t,n){n?this.modes[t]|=2:this.modes[t]-=this.modes[t]&2}getRenderContext(t){return this.renderContexts[t]}getSimpleTc(t){return this.modes[t]&1}getWhite(t){return this.modes[t]&2}}class Lb extends Zv{getRenderContext(t){return this.quads.getRenderContext(this.index+t)}getSimpleTc(t){return this.quads.getSimpleTc(this.index+t)}getWhite(t){return this.quads.getWhite(this.index+t)}}class nf extends Qv{init(){this._mainRenderTexture=this.ctx.stage.getCanvas()}_renderQuadOperation(t){let n=t.shader;if(t.length||t.shader.addEmpty()){const o=this._renderTexture||this._mainRenderTexture;n.beforeDraw(t,o),n.draw(t,o),n.afterDraw(t,o)}}_clearRenderTexture(){const t=this._getContext();let n=[0,0,0,0];this._mainRenderTexture.ctx===t&&(n=this.ctx.stage.getClearColor());const o=t.canvas;t.setTransform(1,0,0,1,0,0),!n[0]&&!n[1]&&!n[2]&&!n[3]?t.clearRect(0,0,o.width,o.height):(t.fillStyle=Te.getRgbaStringFromArray(n),t.globalCompositeOperation="copy",t.beginPath(),t.rect(0,0,o.width,o.height),t.closePath(),t.fill(),t.globalCompositeOperation="source-over")}_getContext(){return this._renderTexture?this._renderTexture.ctx:this._mainRenderTexture.ctx}_restoreContext(){const t=this._getContext();t.restore(),t.save(),t._scissor=null}_setScissor(t){const n=this._getContext();if(!nf._equalScissorAreas(n.canvas,n._scissor,t)){this._restoreContext();let o=this.ctx.stage.getRenderPrecision();t&&(n.beginPath(),n.rect(Math.round(t[0]*o),Math.round(t[1]*o),Math.round(t[2]*o),Math.round(t[3]*o)),n.closePath(),n.clip()),n._scissor=t}}static _equalScissorAreas(t,n,o){return n||(n=[0,0,t.width,t.height]),o||(o=[0,0,t.width,t.height]),$.equalValues(n,o)}}class sf extends Qo{beforeDraw(t){}draw(t){}afterDraw(t){}}class vu extends sf{constructor(t){super(t),this._rectangleTexture=t.stage.rectangleTexture.source.nativeTexture,this._tintManager=this.ctx.stage.renderer.tintManager}draw(t,n){const o=n.ctx;let u=t.length;for(let f=0;f<u;f++){const m=t.getTexture(f),p=t.getElementCore(f),v=t.getRenderContext(f),w=t.getWhite(f),C=t.getSimpleTc(f),L=this.ctx.stage.getRenderPrecision();o.setTransform(v.ta*L,v.tc*L,v.tb*L,v.td*L,v.px*L,v.py*L);const E=m===this._rectangleTexture,R={operation:t,target:n,index:f,rect:E};if(E)w?o.fillStyle="white":this._setColorGradient(o,p),o.globalAlpha=v.alpha,this._beforeDrawEl(R),o.fillRect(0,0,p.w,p.h),this._afterDrawEl(R),o.globalAlpha=1;else{o.globalAlpha=v.alpha,this._beforeDrawEl(R);const y=C?0:p._ulx*m.w,I=C?0:p._uly*m.h,U=(C?1:p._brx-p._ulx)*m.w,Z=(C?1:p._bry-p._uly)*m.h;if(!w){let q=p._colorUl;(p._colorUl!==p._colorUr||p._colorUr!==p._colorBl||p._colorBr!==p._colorBl)&&(q=Te.mergeMultiColorsEqual([p._colorUl,p._colorUr,p._colorBl,p._colorBr]));const H=(q/16777216|0)/255;o.globalAlpha*=H;const se=q&16777215,he=this._tintManager.getTintTexture(m,se);o.fillStyle="white",o.drawImage(he,y,I,U,Z,0,0,p.w,p.h)}else o.fillStyle="white",o.drawImage(m,y,I,U,Z,0,0,p.w,p.h);this._afterDrawEl(R),o.globalAlpha=1}}}_setColorGradient(t,n,o=n.w,u=n.h,f=!0){let m=n._colorUl,p;n._colorUl===n._colorUr?n._colorBl===n._colorBr&&(n._colorUl===n.colorBl||(p=t.createLinearGradient(0,0,0,u),f?(p.addColorStop(0,Te.getRgbaString(n._colorUl)),p.addColorStop(1,Te.getRgbaString(n._colorBl))):(p.addColorStop(0,Te.getRgbString(n._colorUl)),p.addColorStop(1,Te.getRgbString(n._colorBl))))):n._colorUl===n._colorBl&&n._colorUr===n._colorBr&&(p=t.createLinearGradient(0,0,o,0),f?(p.addColorStop(0,Te.getRgbaString(n._colorUl)),p.addColorStop(1,Te.getRgbaString(n._colorBr))):(p.addColorStop(0,Te.getRgbString(n._colorUl)),p.addColorStop(1,Te.getRgbString(n._colorBr)))),p?t.fillStyle=p:t.fillStyle=f?Te.getRgbaString(m):Te.getRgbString(m)}_beforeDrawEl(t){}_afterDrawEl(t){}}class Mb{constructor(t){this.stage=t,this._usedMemory=0,this._cachedNativeTextures=new Set}destroy(){this.gc(!0)}_addMemoryUsage(t){this._usedMemory+=t,this.stage.addMemoryUsage(t)}delete(t){if(this._hasCache(t)){const n=this._getCache(t),o=n.memoryUsage;n.clear(),this._cachedNativeTextures.delete(t),this._addMemoryUsage(n.memoryUsage-o)}}getTintTexture(t,n){const o=this.stage.frameCounter;this._cachedNativeTextures.add(t);const u=this._getCache(t),f=u.get(n);if(f.lf=o,f.tx)return t.update>f.u&&this._tintTexture(f.tx,t,n),f.tx;{const m=u.memoryUsage;let p=u.reuseTexture(o);p?p.ctx.clearRect(0,0,p.width,p.height):(p=document.createElement("canvas"),p.width=t.w,p.height=t.h,p.ctx=p.getContext("2d")),this._tintTexture(p,t,n),u.set(n,p,o);const v=u.memoryUsage;return v!==m&&this._addMemoryUsage(v-m),p}}_tintTexture(t,n,o){let u=o.toString(16);for(;u.length<6;)u="0"+u;t.ctx.fillStyle="#"+u,t.ctx.globalCompositeOperation="copy",t.ctx.fillRect(0,0,n.w,n.h),t.ctx.globalCompositeOperation="multiply",t.ctx.drawImage(n,0,0,n.w,n.h,0,0,t.width,t.height),t.ctx.globalCompositeOperation="destination-in",t.ctx.drawImage(n,0,0,n.w,n.h,0,0,t.width,t.height)}_hasCache(t){return!!t._tintCache}_getCache(t){return t._tintCache||(t._tintCache=new Pb(t)),t._tintCache}gc(t=!1){const n=this.stage.frameCounter;let o=0;this._cachedNativeTextures.forEach(u=>{const f=this._getCache(u);if(t)o+=f.memoryUsage,f.clear();else{const m=f.memoryUsage;f.cleanup(n),f.releaseBlancoTextures(),o+=f.memoryUsage-m}}),t&&this._cachedNativeTextures.clear(),o&&this._addMemoryUsage(o)}}class Pb{constructor(t){this._tx=t,this._colors=new Map,this._blancoTextures=null,this._lastCleanupFrame=0,this._memTextures=0}get memoryUsage(){return this._memTextures*this._tx.w*this._tx.h}releaseBlancoTextures(){this._memTextures-=this._blancoTextures.length,this._blancoTextures=[]}clear(){this._blancoTextures=null,this._colors.clear(),this._memTextures=0}get(t){let n=this._colors.get(t);return n||(n={lf:-1,tx:void 0,u:-1},this._colors.set(t,n)),n}set(t,n,o){const u=this.get(t);u.lf=o,u.tx=n,u.u=o,this._memTextures++}cleanup(t){this._lastCleanupFrame!==t&&(this._blancoTextures=[],this._colors.forEach((n,o)=>{n.lf<t-1&&(n.tx&&this._blancoTextures.push(n.tx),this._colors.delete(o))}),this._lastCleanupFrame=t)}reuseTexture(t){if(this.cleanup(t),this._blancoTextures&&this._blancoTextures.length)return this._memTextures--,this._blancoTextures.pop()}}class kb extends e0{constructor(t){super(t),this.tintManager=new Mb(t),this.setupC2d(this.stage.c2d.canvas)}destroy(){this.tintManager.destroy()}_createDefaultShader(t){return new vu(t)}_getShaderBaseType(){return sf}_getShaderAlternative(t){return t.getC2d&&t.getC2d()}createCoreQuadList(t){return new Rb(t)}createCoreQuadOperation(t,n,o,u,f,m){return new Lb(t,n,o,u,f,m)}createCoreRenderExecutor(t){return new nf(t)}createCoreRenderState(t){return new Jv(t)}createRenderTexture(t,n,o,u){const f=document.createElement("canvas");return f.width=o,f.height=u,this.setupC2d(f),f}freeRenderTexture(t){this.tintManager.delete(t)}gc(t){this.tintManager.gc(t)}uploadTextureSource(t,n){if(n.source.buffer){const o=document.createElement("canvas");o.width=n.w,o.height=n.h;const u=new ImageData(new Uint8ClampedArray(n.source.buffer),n.w,n.h);return o.getContext("2d").putImageData(u,0,0),o}return n.source}freeTextureSource(t){this.tintManager.delete(t.nativeTexture)}addQuad(t,n,o){const u=n.quadElements[o];n.setRenderContext(o,u._renderContext),n.setWhite(o,u.isWhite()),n.setSimpleTc(o,u.hasSimpleTexCoords())}isRenderTextureReusable(t,n){return!1}finishRenderState(t){}setupC2d(t){const n=t.getContext("2d");t.ctx=n,n._scissor=null,t.ctx.save()}}class of extends xu{enableAttribs(){let t=this.gl;t.vertexAttribPointer(this._attrib("aVertexPosition"),2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(this._attrib("aVertexPosition")),this._attrib("aTextureCoord")!==-1&&(t.vertexAttribPointer(this._attrib("aTextureCoord"),2,t.FLOAT,!1,20,2*4),t.enableVertexAttribArray(this._attrib("aTextureCoord"))),this._attrib("aColor")!==-1&&(t.vertexAttribPointer(this._attrib("aColor"),4,t.UNSIGNED_BYTE,!0,20,4*4),t.enableVertexAttribArray(this._attrib("aColor")))}disableAttribs(){let t=this.gl;t.disableVertexAttribArray(this._attrib("aVertexPosition")),this._attrib("aTextureCoord")!==-1&&t.disableVertexAttribArray(this._attrib("aTextureCoord")),this._attrib("aColor")!==-1&&t.disableVertexAttribArray(this._attrib("aColor"))}setupUniforms(t){this._setUniform("projection",this._getProjection(t),this.gl.uniform2fv,!1)}draw(t){let n=this.gl,o=t.length;if(o){let u=t.getTexture(0),f=0;for(let m=0;m<o;m++){let p=t.getTexture(m);if(u!==p){if(u.options&&u.options.imageRef){let v=m>0?m-1:m;const w=this.ctx.stage.getOption("precision");let C=t.getElementCore(v);this.ctx.stage.platform.paint(n,u.options.imageRef,C._worldContext.px*w,C._worldContext.py*w,C._colorUl,C)}else n.bindTexture(n.TEXTURE_2D,u),n.drawElements(n.TRIANGLES,6*(m-f),n.UNSIGNED_SHORT,(f+t.index)*6*2);u=p,f=m}}if(f<o)if(u.options&&u.options.imageRef){const m=this.ctx.stage.getOption("precision");let p=t.getElementCore(f);this.ctx.stage.platform.paint(n,u.options.imageRef,p._worldContext.px*m,p._worldContext.py*m,p._colorUl,p)}else n.bindTexture(n.TEXTURE_2D,u),n.drawElements(n.TRIANGLES,6*(o-f),n.UNSIGNED_SHORT,(f+t.index)*6*2)}}}of.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;of.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    void main(void){
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;
    }
`;class Ob extends t0{constructor(t){super(t)}_createDefaultShader(t){return new of(t)}createCoreRenderExecutor(t){global.beginDrawing();let n=super.createCoreRenderExecutor(t);return global.endDrawing(),n}}class Db{constructor(t={}){this._items=new Map,this._id=0,this._initWorker()}destroy(){this._worker&&this._worker.terminate()}_initWorker(){const t=`(${Nb.toString()})()`,n=new Blob([t.replace('"use strict";',"")]),o=(window.URL?URL:webkitURL).createObjectURL(n,{type:"application/javascript; charset=utf-8"});this._worker=new Worker(o),this._worker.postMessage({type:"config",config:{path:window.location.href,protocol:window.location.protocol}}),this._worker.onmessage=u=>{if(u.data&&u.data.id){const f=u.data.id,m=this._items.get(f);m&&(u.data.type=="data"?this.finish(m,u.data.info):this.error(m,u.data.info))}}}create(t){const n=++this._id,o=new Fb(this,n,t);return this._items.set(n,o),this._worker.postMessage({type:"add",id:n,src:t}),o}cancel(t){this._worker.postMessage({type:"cancel",id:t.id}),this._items.delete(t.id)}error(t,n){t.error(n),this._items.delete(t.id)}finish(t,n){t.load(n),this._items.delete(t.id)}}class Fb{constructor(t,n,o){this._manager=t,this._id=n,this._src=o,this._onError=null,this._onLoad=null}get id(){return this._id}get src(){return this._src}set onError(t){this._onError=t}set onLoad(t){this._onLoad=t}cancel(){this._manager.cancel(this)}load(t){this._onLoad&&this._onLoad(t)}error(t){this._onError&&this._onError(t)}}const Nb=function(){function c(){this.items=new Map;var n=this;onmessage=function(o){n._receiveMessage(o)}}c.isPathAbsolute=function(n){return/^(?:\/|[a-z]+:\/\/)/.test(n)||n.substr(0,5)=="data:"},c.prototype._receiveMessage=function(n){if(n.data.type==="config"){this.config=n.data.config;var o=this.config.path,u=/#.*?\//;u.test(o)&&(o=o.replace(/#.*$/,""));var f=o.split("/");f.pop(),this._relativeBase=f.join("/")+"/"}else n.data.type==="add"?this.add(n.data.id,n.data.src):n.data.type==="cancel"&&this.cancel(n.data.id)},c.prototype.add=function(n,o){c.isPathAbsolute(o)||(o=this._relativeBase+o),o.substr(0,2)==="//"&&(o=this.config.protocol+o);var u=new t(n,o),f=this;u.onFinish=function(m){f.finish(u,m)},u.onError=function(m){f.error(u,m)},this.items.set(n,u),u.start()},c.prototype.cancel=function(n){var o=this.items.get(n);o&&(o.cancel(),this.items.delete(n))},c.prototype.finish=function(n,{imageBitmap:o,hasAlphaChannel:u}){postMessage({type:"data",id:n.id,info:{imageBitmap:o,hasAlphaChannel:u}},[o]),this.items.delete(n.id)},c.prototype.error=function(n,{type:o,message:u}){postMessage({type:"error",id:n.id,info:{type:o,message:u}}),this.items.delete(n.id)},c.isWPEBrowser=function(){return navigator.userAgent.indexOf("WPE")!==-1};function t(n,o){this._onError=void 0,this._onFinish=void 0,this._id=n,this._src=o,this._xhr=void 0,this._mimeType=void 0,this._canceled=!1}Object.defineProperty(t.prototype,"id",{get:function(){return this._id}}),Object.defineProperty(t.prototype,"onFinish",{get:function(){return this._onFinish},set:function(n){this._onFinish=n}}),Object.defineProperty(t.prototype,"onError",{get:function(){return this._onError},set:function(n){this._onError=n}}),t.prototype.start=function(){this._xhr=new XMLHttpRequest,this._xhr.open("GET",this._src,!0),this._xhr.responseType="blob";var n=this;this._xhr.onerror=function(o){n.error({type:"connection",message:"Connection error"})},this._xhr.onload=function(o){var u=n._xhr.response;n._mimeType=u.type,n._createImageBitmap(u)},this._xhr.send()},t.prototype._createImageBitmap=function(n){var o=this;createImageBitmap(n,{premultiplyAlpha:"premultiply",colorSpaceConversion:"none",imageOrientation:"none"}).then(function(u){o.finish({imageBitmap:u,hasAlphaChannel:o._hasAlphaChannel()})}).catch(function(u){o.error({type:"parse",message:"Error parsing image data"})})},t.prototype._hasAlphaChannel=function(){return c.isWPEBrowser()?!0:this._mimeType.indexOf("image/png")!==-1},t.prototype.cancel=function(){this._canceled||(this._xhr&&this._xhr.abort(),this._canceled=!0)},t.prototype.error=function(n,o){!this._canceled&&this._onError&&this._onError({type:n,message:o})},t.prototype.finish=function(n){!this._canceled&&this._onFinish&&this._onFinish(n)},new c};class Ub{init(t){this.stage=t,this._looping=!1,this._awaitingLoop=!1,this._loopHandler=null,this._idleLoopCounter=0,this._idleLoopDelay=60,this.stage.getOption("useImageWorker")&&(!window.createImageBitmap||!window.Worker?console.warn("[Lightning] Can't use image worker because browser does not have createImageBitmap and Web Worker support"):this._imageWorker=new Db),this._registerVisibilityChangeHandler()}destroy(){this._imageWorker&&this._imageWorker.destroy(),this._removeKeyHandler(),this._removeClickHandler(),this._removeHoverHandler(),this._removeScrollWheelHandler(),this._removeVisibilityChangeHandler()}startLoop(){this._looping=!0,this._awaitingLoop||this.loop()}stopLoop(){this._looping=!1}switchLoop(){if(this._idleLoopCounter<this._idleLoopDelay){this._idleLoopCounter++;return}this.stage.ctx.hasRenderUpdates()?this._idleLoopCounter=0:(this.stopLoop(),this._loopHandler=setInterval(()=>{this.stage.updateFrame(),this.stage.idleFrame(),this.stage.ctx.hasRenderUpdates()&&(clearInterval(this._loopHandler),this.startLoop())},1e3/60))}loop(){let t=this,n=function(){t._awaitingLoop=!1,t._looping&&(t.stage.updateFrame(),t.stage.getOption("pauseRafLoopOnIdle")&&t.switchLoop(),t.stage.renderFrame(),requestAnimationFrame(n),t._awaitingLoop=!0)};requestAnimationFrame(n)}uploadCompressedGlTexture(t,n,o,u){const f=o.pvr?o.mipmaps[0]:new DataView(o.mipmaps[0]);t.compressedTexImage2D(t.TEXTURE_2D,0,o.glInternalFormat,o.pixelWidth,o.pixelHeight,0,f),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR)}uploadGlTexture(t,n,o,u){if(o instanceof ImageData||o instanceof HTMLImageElement||o instanceof HTMLVideoElement||window.ImageBitmap&&o instanceof ImageBitmap)t.texImage2D(t.TEXTURE_2D,0,u.internalFormat,u.format,u.type,o);else if(o instanceof HTMLCanvasElement){if($.isZiggo||this.stage.getOption("forceTxCanvasSource"))t.texImage2D(t.TEXTURE_2D,0,u.internalFormat,u.format,u.type,o);else if(o.width>0&&o.height>0){const f=o.getContext("2d");t.texImage2D(t.TEXTURE_2D,0,u.internalFormat,u.format,u.type,f.getImageData(0,0,o.width,o.height))}}else t.texImage2D(t.TEXTURE_2D,0,u.internalFormat,n.w,n.h,0,u.format,u.type,o)}handleKtxLoad(t,n){var o=this;return function(){var u=this.response,f=new DataView(u),m=3632701469;m!==f.getUint32(0)+f.getUint32(4)+f.getUint32(8)&&t("Parsing failed: identifier ktx mismatch:",n);var p=f.getUint32(12)===16909060,v={glType:f.getUint32(16,p),glTypeSize:f.getUint32(20,p),glFormat:f.getUint32(24,p),glInternalFormat:f.getUint32(28,p),glBaseInternalFormat:f.getUint32(32,p),pixelWidth:f.getUint32(36,p),pixelHeight:f.getUint32(40,p),pixelDepth:f.getUint32(44,p),numberOfArrayElements:f.getUint32(48,p),numberOfFaces:f.getUint32(52,p),numberOfMipmapLevels:f.getUint32(56,p),bytesOfKeyValueData:f.getUint32(60,p),kvps:[],mipmaps:[],get width(){return this.pixelWidth},get height(){return this.pixelHeight}};const w=y=>{const I=[];for(let U in y)I.push(y[U]);return I};Object.values(o.stage.renderer.getCompressedTextureExtensions()).filter(y=>y!=null).map(y=>w(y)).reduce((y,I)=>y.concat(I)).includes(v.glInternalFormat)||console.warn("[Lightning] Unrecognized texture extension format:",n,v.glInternalFormat,o.stage.renderer.getCompressedTextureExtensions());var L=64;L+=v.bytesOfKeyValueData;for(var E=0;E<v.numberOfMipmapLevels;E++){var R=f.getUint32(L);L+=4,v.mipmaps.push(f.buffer.slice(L,R)),L+=R}t(null,{source:v,renderInfo:{src:n,compressed:!0}})}}handlePvrLoad(t,n){return function(){const w=this.response,C=new Int32Array(w,0,13),L=C[12]+52,E=new Uint8Array(w,L);var R={glInternalFormat:36196,pixelWidth:C[7],pixelHeight:C[6],numberOfMipmapLevels:C[11],mipmaps:[],pvr:!0,get width(){return this.pixelWidth},get height(){return this.pixelHeight}};let y=0,I=R.pixelWidth,U=R.pixelHeight;for(var Z=0;Z<R.numberOfMipmapLevels;Z++){const te=(I+3>>2)*(U+3>>2)*8,q=new Uint8Array(w,E.byteOffset+y,te);R.mipmaps.push(q),y+=te,I=I>>1,U=U>>1}t(null,{source:R,renderInfo:{src:n,compressed:!0}})}}loadSrcTexture({src:t,hasAlpha:n},o){let u,f=t.indexOf(".png")>=0||t.substr(0,21)=="data:image/png;base64",m=t.indexOf(".ktx")>=0,p=t.indexOf(".pvr")>=0;if(m||p){let v=new XMLHttpRequest;v.addEventListener("load",m?this.handleKtxLoad(o,t):this.handlePvrLoad(o,t)),v.open("GET",t),v.responseType="arraybuffer",v.send(),u=function(){v.abort()}}else if(this._imageWorker){const v=this._imageWorker.create(t);v.onError=function(w){return o("Image load error")},v.onLoad=function({imageBitmap:w,hasAlphaChannel:C}){o(null,{source:w,renderInfo:{src:t,compressed:!1},hasAlpha:C,premultiplyAlpha:!0})},u=function(){v.cancel()}}else{let v=new Image;t.substr(0,5)!="data:"&&!$.isPS4&&(v.crossOrigin="Anonymous"),v.onerror=function(w){if(v.src)return o("Image load error")},v.onload=function(){o(null,{source:v,renderInfo:{src:t,compressed:!1},hasAlpha:f||n})},v.src=t,u=function(){v.onerror=null,v.onload=null,v.removeAttribute("src")}}return u}createWebGLContext(t,n){let o=this.stage.getOption("canvas")||document.createElement("canvas");t&&n&&(o.width=t,o.height=n);let u={alpha:!0,antialias:!1,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1},f=o.getContext("webgl",u)||o.getContext("experimental-webgl",u);if(!f)throw new Error("This browser does not support webGL.");return f}createCanvasContext(t,n){let o=this.stage.getOption("canvas")||document.createElement("canvas");t&&n&&(o.width=t,o.height=n);let u=o.getContext("2d");if(!u)throw new Error("This browser does not support 2d canvas.");return u}getHrTime(){return window.performance?window.performance.now():new Date().getTime()}getDrawingCanvas(){return document.createElement("canvas")}getTextureOptionsForDrawingCanvas(t){let n={};return n.source=t,n}nextFrame(t){}registerKeydownHandler(t){this._keydownListener=n=>{t(n)},window.addEventListener("keydown",this._keydownListener)}registerKeyupHandler(t){this._keyupListener=n=>{t(n)},window.addEventListener("keyup",this._keyupListener)}_removeKeyHandler(){this._keydownListener&&window.removeEventListener("keydown",this._keydownListener),this._keyupListener&&window.removeEventListener("keyup",this._keyupListener)}registerClickHandler(t){this._clickListener=n=>{t(n)},window.addEventListener("mousedown",this._clickListener)}_removeClickHandler(){this._clickListener&&window.removeEventListener("mousedown",this._clickListener)}registerHoverHandler(t){this._hoverListener=n=>{t(n)},window.addEventListener("mousemove",this._hoverListener)}_removeHoverHandler(){this._hoverListener&&window.removeEventListener("mousemove",this._hoverListener)}registerScrollWheelHandler(t){this._scrollWheelListener=n=>{t(n)},window.addEventListener("wheel",this._scrollWheelListener)}_removeScrollWheelHandler(){this._scrollWheelListener&&window.removeEventListener("wheel",this._scrollWheelListener)}_registerVisibilityChangeHandler(){this._visibilityChangeHandler=()=>{document.visibilityState==="visible"&&(this.stage.root.core.setHasRenderUpdates(2),this.stage.renderFrame())},document.addEventListener("visibilitychange",this._visibilityChangeHandler)}_removeVisibilityChangeHandler(){this._visibilityChangeHandler&&document.removeEventListener("visibilitychange",this._visibilityChangeHandler)}}class zb{static load(t){return t.platform?t.platform:Ub}}let Yl=class wn{static isFunction(t){return typeof t=="function"}static isNumber(t){return typeof t=="number"}static isInteger(t){return typeof t=="number"&&t%1===0}static isBoolean(t){return t===!0||t===!1}static isString(t){return typeof t=="string"}static isObject(t){let n=typeof t;return!!t&&(n=="object"||n=="function")}static isPlainObject(t){return!!t&&typeof t=="object"}static isObjectLiteral(t){return typeof t=="object"&&t&&t.constructor===Object}static getArrayIndex(t,n){return wn.getModuloIndex(t,n.length)}static equalValues(t,n){return typeof t!=typeof n?!1:wn.isObjectLiteral(t)?wn.isObjectLiteral(n)&&wn.equalObjectLiterals(t,n):Array.isArray(t)?Array.isArray(n)&&wn.equalArrays(t,n):t===n}static equalObjectLiterals(t,n){let o=Object.keys(t),u=Object.keys(n);if(o.length!==u.length)return!1;for(let f=0,m=o.length;f<m;f++){const p=o[f],v=u[f];if(p!==v)return!1;const w=t[p],C=n[v];if(!wn.equalValues(w,C))return!1}return!0}static equalArrays(t,n){if(t.length!==n.length)return!1;for(let o=0,u=t.length;o<u;o++)if(!this.equalValues(t[o],n[o]))return!1;return!0}};class xr{constructor(t,n){this._id=t,this._gl=n,this._program=void 0,this._buffers=new Map,this._framebuffers=new Map,this._renderbuffers=new Map,this._vertexAttribs=new Array(16),this._nonDefaultFlags=new Set,this._settings=new Map,this._textures=new Array(8),this._maxTexture=0,this._activeTexture=n.TEXTURE0,this._pixelStorei=new Array(5)}_getDefaultFlag(t){return t===this._gl.DITHER}setFlag(t,n){const o=this._getDefaultFlag(t);return n===o?this._nonDefaultFlags.delete(t):this._nonDefaultFlags.has(t)?!1:(this._nonDefaultFlags.add(t),!0)}setBuffer(t,n){const o=this._buffers.get(t)!==n;return this._buffers.set(t,n),o&&t===this._gl.ARRAY_BUFFER&&(this._vertexAttribs=[]),o}setFramebuffer(t,n){const o=this._framebuffers.get(t)!==n;return this._framebuffers.set(t,n),o}setRenderbuffer(t,n){const o=this._renderbuffers.get(t)!==n;return this._renderbuffers.set(t,n),o}setProgram(t){const n=this._program!==t;return this._program=t,n}setSetting(t,n){const o=this._settings.get(t),u=!o||!Yl.equalValues(o,n);return this._settings.set(t,n),u}disableVertexAttribArray(t){const n=this._vertexAttribs[t];return n&&n[5]?(n[5]=!1,!0):!1}enableVertexAttribArray(t){const n=this._vertexAttribs[t];if(n){if(!n[0])return n[0]=!0,!0}else return this._vertexAttribs[t]=[0,0,0,0,0,!0],!0;return!1}vertexAttribPointer(t,n){let o=this._vertexAttribs[t],u=!1;return o&&(u=o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]&&o[3]===n[3]&&o[4]===n[4]),u?!1:(n[5]=o?o[5]:!1,!0)}setActiveTexture(t){const n=this._activeTexture!==t;return this._activeTexture=t,n}bindTexture(t,n){const o=xr._getTextureIndex(this._activeTexture);this._maxTexture=Math.max(this._maxTexture,o+1);const u=this._textures[o],f=xr._getTextureTargetIndex(t);return u?u[f]===n?!1:(u[f]=n,!0):n?(this._textures[o]=[],this._textures[o][f]=n,!0):!1}setPixelStorei(t,n){const o=xr._getPixelStoreiIndex(t),u=!Yl.equalValues(this._pixelStorei[o],n);return this._pixelStorei[o]=n,u}migrate(t){const n=this;this._migrateFlags(n,t),t._program!==n._program&&this._gl._useProgram(t._program),this._migrateFramebuffers(n,t),this._migrateRenderbuffers(n,t);const o=this._migrateBuffers(n,t);this._migrateAttributes(n,t,o),this._migrateFlags(n,t),this._migrateSettings(n,t),this._migratePixelStorei(n,t),this._migrateTextures(n,t)}_migratePixelStorei(t,n){for(let o=0,u=t._pixelStorei.length;o<u;o++)if(t._pixelStorei[o]!==n._pixelStorei[o]){const f=n._pixelStorei[o]!==void 0?n._pixelStorei[o]:xr._getDefaultPixelStoreiByIndex(o);this._gl._pixelStorei(xr._getPixelStoreiByIndex(o),f)}}_migrateTextures(t,n){const o=Math.max(t._maxTexture,n._maxTexture);let u=t._activeTexture;for(let f=0;f<o;f++){const m=n._textures[f],p=t._textures[f],v=xr._getTextureByIndex(f),w=Math.max(p?p.length:0,m?m.length:0);for(let C=0,L=w;C<L;C++){const E=xr._getTextureTargetByIndex(C);u!==v&&(this._gl._activeTexture(v),u=v);const R=m&&m[C]||null;this._gl._bindTexture(E,R)}}n._activeTexture!==u&&this._gl._activeTexture(n._activeTexture)}_migrateBuffers(t,n){return n._buffers.forEach((o,u)=>{t._buffers.get(u)!==o&&this._gl._bindBuffer(u,o)}),t._buffers.forEach((o,u)=>{n._buffers.get(u)===void 0&&this._gl._bindBuffer(u,null)}),n._buffers.get(this._gl.ARRAY_BUFFER)!==t._buffers.get(this._gl.ARRAY_BUFFER)}_migrateFramebuffers(t,n){n._framebuffers.forEach((o,u)=>{t._framebuffers.get(u)!==o&&this._gl._bindFramebuffer(u,o)}),t._framebuffers.forEach((o,u)=>{n._framebuffers.get(u)===void 0&&this._gl._bindFramebuffer(u,null)})}_migrateRenderbuffers(t,n){n._renderbuffers.forEach((o,u)=>{t._renderbuffers.get(u)!==o&&this._gl._bindRenderbuffer(u,o)}),t._renderbuffers.forEach((o,u)=>{n._renderbuffers.get(u)===void 0&&this._gl._bindRenderbuffer(u,null)})}_migrateAttributes(t,n,o){o?n._vertexAttribs.forEach((u,f)=>{u[0]&&this._gl._vertexAttribPointer(f,u[0],u[1],u[2],u[3],u[4]),u[5]&&this._gl._enableVertexAttribArray(f)}):(t._vertexAttribs.forEach((u,f)=>{n._vertexAttribs[f]||this._gl._disableVertexAttribArray(f)}),n._vertexAttribs.forEach((u,f)=>{this._gl._vertexAttribPointer(f,u[0],u[1],u[2],u[4]),u[5]?this._gl._enableVertexAttribArray(f):this._gl._disableVertexAttribArray(f)}))}_migrateSettings(t,n){const o=this.constructor.getDefaultSettings();t._settings.forEach((u,f)=>{const m=f.name||f.xname;if(!n._settings.has(f)){let p=o.get(m);Yl.isFunction(p)&&(p=p(this._gl)),n._settings.set(f,p),f.apply(this._gl,p)}}),n._settings.forEach((u,f)=>{const m=t._settings.get(f);(!m||!Yl.equalValues(m,u))&&f.apply(this._gl,u)})}_migrateFlags(t,n){t._nonDefaultFlags.forEach(o=>{n._nonDefaultFlags.has(o)||(this._getDefaultFlag(o)?this._gl._enable(o):this._gl._disable(o))}),n._nonDefaultFlags.forEach(o=>{t._nonDefaultFlags.has(o)||(this._getDefaultFlag(o)?this._gl._disable(o):this._gl._enable(o))})}static getDefaultSettings(){if(!this._defaultSettings){this._defaultSettings=new Map;const t=this._defaultSettings,n=WebGLRenderingContext.prototype;t.set("viewport",function(o){return[0,0,o.canvas.width,o.canvas.height]}),t.set("scissor",function(o){return[0,0,o.canvas.width,o.canvas.height]}),t.set("blendColor",[0,0,0,0]),t.set("blendEquation",[n.FUNC_ADD]),t.set("blendEquationSeparate",[n.FUNC_ADD,n.FUNC_ADD]),t.set("blendFunc",[n.ONE,n.ZERO]),t.set("blendFuncSeparate",[n.ONE,n.ZERO,n.ONE,n.ZERO]),t.set("clearColor",[0,0,0,0]),t.set("clearDepth",[1]),t.set("clearStencil",[0]),t.set("colorMask",[!0,!0,!0,!0]),t.set("cullFace",[n.BACK]),t.set("depthFunc",[n.LESS]),t.set("depthMask",[!0]),t.set("depthRange",[0,1]),t.set("frontFace",[n.CCW]),t.set("lineWidth",[1]),t.set("polygonOffset",[0,0]),t.set("sampleCoverage",[1,!1]),t.set("stencilFunc",[n.ALWAYS,0,1]),t.set("_stencilFuncSeparateFront",[n.ALWAYS,0,1]),t.set("_stencilFuncSeparateBack",[n.ALWAYS,0,1]),t.set("_stencilFuncSeparateFrontAndBack",[n.ALWAYS,0,1]),t.set("stencilMask",[1]),t.set("_stencilMaskSeparateFront",[1]),t.set("_stencilMaskSeparateBack",[1]),t.set("_stencilMaskSeparateFrontAndBack",[1]),t.set("stencilOp",[n.KEEP,n.KEEP,n.KEEP]),t.set("_stencilOpSeparateFront",[n.KEEP,n.KEEP,n.KEEP]),t.set("_stencilOpSeparateBack",[n.KEEP,n.KEEP,n.KEEP]),t.set("_stencilOpSeparateFrontAndBack",[n.KEEP,n.KEEP,n.KEEP]),t.set("vertexAttrib1f",[]),t.set("vertexAttrib1fv",[]),t.set("vertexAttrib2f",[]),t.set("vertexAttrib2fv",[]),t.set("vertexAttrib3f",[]),t.set("vertexAttrib3fv",[]),t.set("vertexAttrib4f",[]),t.set("vertexAttrib4fv",[])}return this._defaultSettings}static _getTextureTargetIndex(t){switch(t){case 3553:return 0;case 34067:return 1;default:throw new Error("Unknown texture target: "+t)}}static _getTextureTargetByIndex(t){return this._textureTargetIndices||(this._textureTargetIndices=[3553,34067]),this._textureTargetIndices[t]}static _getTextureIndex(t){return t-33984}static _getTextureByIndex(t){return t+33984}static _getPixelStoreiIndex(t){switch(t){case 3333:return 0;case 3317:return 1;case 37440:return 2;case 37441:return 3;case 37443:return 4;case 37445:return 5;default:throw new Error("Unknown pixelstorei: "+t)}}static _getPixelStoreiByIndex(t){return this._pixelStoreiIndices||(this._pixelStoreiIndices=[3333,3317,37440,37441,37443]),this._pixelStoreiIndices[t]}static _getDefaultPixelStoreiByIndex(t){return this._pixelStoreiDefaults||(this._pixelStoreiDefaults=[4,4,!1,!1,WebGLRenderingContext.prototype.BROWSER_DEFAULT_WEBGL]),this._pixelStoreiDefaults[t]}}class Bo{_initStateManager(t="default"){this._states={},this._state=this._getState(t)}_getState(t){return this._states[t]||(this._states[t]=new xr(t,this)),this._states[t]}switchState(t="default"){if(this._state._id!==t){const n=this._getState(t);this._state.migrate(n),this._state=n}}$useProgram(t){this._state.setProgram(t)&&this._useProgram(t)}$bindBuffer(t,n){this._state.setBuffer(t,n)&&this._bindBuffer(t,n)}$bindFramebuffer(t,n){this._state.setFramebuffer(t,n)&&this._bindFramebuffer(t,n)}$bindRenderbuffer(t,n){this._state.setRenderbuffer(t,n)&&this._bindRenderbuffer(t,n)}$enable(t){this._state.setFlag(t,!0)&&this._enable(t)}$disable(t){this._state.setFlag(t,!1)&&this._disable(t)}$viewport(t,n,o,u){this._state.setSetting(this._viewport,[t,n,o,u])&&this._viewport(t,n,o,u)}$scissor(t,n,o,u){this._state.setSetting(this._scissor,[t,n,o,u])&&this._scissor(t,n,o,u)}$disableVertexAttribArray(t){this._state.disableVertexAttribArray(t)&&this._disableVertexAttribArray(t)}$enableVertexAttribArray(t){this._state.enableVertexAttribArray(t)&&this._enableVertexAttribArray(t)}$vertexAttribPointer(t,n,o,u,f,m){this._state.vertexAttribPointer(t,[n,o,u,f,m])&&this._vertexAttribPointer(t,n,o,u,f,m)}$activeTexture(t){this._state.setActiveTexture(t)&&this._activeTexture(t)}$bindTexture(t,n){this._state.bindTexture(t,n)&&this._bindTexture(t,n)}$pixelStorei(t,n){this._state.setPixelStorei(t,n)&&this._pixelStorei(t,n)}$stencilFuncSeparate(t,n,o,u){let f;switch(t){case this.FRONT:f=this._stencilFuncSeparateFront;break;case this.BACK:f=this._stencilFuncSeparateBack;break;case this.FRONT_AND_BACK:f=this._stencilFuncSeparateFrontAndBack;break}this._state.setSetting(f,[n,o,u])&&f.apply(this,[n,o,u])}_stencilFuncSeparateFront(t,n,o){this._stencilFuncSeparate(this.FRONT,t,n,o)}_stencilFuncSeparateBack(t,n,o){this._stencilFuncSeparate(this.BACK,t,n,o)}_stencilFuncSeparateFrontAndBack(t,n,o){this._stencilFuncSeparate(this.FRONT_AND_BACK,t,n,o)}$stencilMaskSeparate(t,n){let o;switch(t){case this.FRONT:o=this._stencilMaskSeparateFront;break;case this.BACK:o=this._stencilMaskSeparateBack;break;case this.FRONT_AND_BACK:o=this._stencilMaskSeparateFrontAndBack;break}this._state.setSetting(o,[n])&&o.apply(this,[n])}_stencilMaskSeparateFront(t){this._stencilMaskSeparate(this.FRONT,t)}_stencilMaskSeparateBack(t){this._stencilMaskSeparate(this.BACK,t)}_stencilMaskSeparateFrontAndBack(t){this._stencilMaskSeparate(this.FRONT_AND_BACK,t)}$stencilOpSeparate(t,n,o,u){let f;switch(t){case this.FRONT:f=this._stencilOpSeparateFront;break;case this.BACK:f=this._stencilOpSeparateBack;break;case this.FRONT_AND_BACK:f=this._stencilOpSeparateFrontAndBack;break}this._state.setSetting(f,[n,o,u])&&f.apply(this,[n,o,u])}_stencilOpSeparateFront(t,n,o){this._stencilOpSeparate(this.FRONT,t,n,o)}_stencilOpSeparateBack(t,n,o){this._stencilOpSeparate(this.BACK,t,n,o)}_stencilOpSeparateFrontAndBack(t,n,o){this._stencilOpSeparate(this.FRONT_AND_BACK,t,n,o)}$blendColor(t,n,o,u){this._state.setSetting(this._blendColor,[t,n,o,u])&&this._blendColor(t,n,o,u)}$blendEquation(t){this._state.setSetting(this._blendEquation,[t])&&this._blendEquation(t)}$blendEquationSeparate(t,n){this._state.setSetting(this._blendEquationSeparate,[t,n])&&this._blendEquationSeparate(t,n)}$blendFunc(t,n){this._state.setSetting(this._blendFunc,[t,n])&&this._blendFunc(t,n)}$blendFuncSeparate(t,n,o,u){this._state.setSetting(this._blendFuncSeparate,[t,n,o,u])&&this._blendFuncSeparate(t,n,o,u)}$clearColor(t,n,o,u){this._state.setSetting(this._clearColor,[t,n,o,u])&&this._clearColor(t,n,o,u)}$clearDepth(t){this._state.setSetting(this._clearDepth,[t])&&this._clearDepth(t)}$clearStencil(t){this._state.setSetting(this._clearStencil,[t])&&this._clearStencil(t)}$colorMask(t,n,o,u){this._state.setSetting(this._colorMask,[t,n,o,u])&&this._colorMask(t,n,o,u)}$cullFace(t){this._state.setSetting(this._cullFace,[t])&&this._cullFace(t)}$depthFunc(t){this._state.setSetting(this._depthFunc,[t])&&this._depthFunc(t)}$depthMask(t){this._state.setSetting(this._depthMask,[t])&&this._depthMask(t)}$depthRange(t,n){this._state.setSetting(this._depthRange,[t,n])&&this._depthRange(t,n)}$frontFace(t){this._state.setSetting(this._frontFace,[t])&&this._frontFace(t)}$lineWidth(t){this._state.setSetting(this._lineWidth,[t])&&this._lineWidth(t)}$polygonOffset(t,n){this._state.setSetting(this._polygonOffset,[t,n])&&this._polygonOffset(t,n)}$sampleCoverage(t,n){this._state.setSetting(this._sampleCoverage,[t,n])&&this._sampleCoverage(t,n)}$stencilFunc(t,n,o){this._state.setSetting(this._stencilFunc,[t,n,o])&&this._stencilFunc(t,n,o)}$stencilMask(t){this._state.setSetting(this._stencilMask,[t])&&this._stencilMask(t)}$stencilOp(t,n,o){this._state.setSetting(this._stencilOp,[t,n,o])&&this._stencilOp(t,n,o)}$vertexAttrib1f(t,n){this._state.setSetting(this._vertexAttrib1f,[t,n])&&this._vertexAttrib1f(t,n)}$vertexAttrib1fv(t,n){this._state.setSetting(this._vertexAttrib1fv,[t,n])&&this._vertexAttrib1fv(t,n)}$vertexAttrib2f(t,n,o){this._state.setSetting(this._vertexAttrib2f,[t,n,o])&&this._vertexAttrib2f(t,n,o)}$vertexAttrib2fv(t,n){this._state.setSetting(this._vertexAttrib2fv,[t,n])&&this._vertexAttrib2fv(t,n)}$vertexAttrib3f(t,n,o,u){this._state.setSetting(this._vertexAttrib3f,[t,n,o,u])&&this._vertexAttrib3f(t,n,o,u)}$vertexAttrib3fv(t,n){this._state.setSetting(this._vertexAttrib3fv,[t,n])&&this._vertexAttrib3fv(t,n)}$vertexAttrib4f(t,n,o,u,f){this._state.setSetting(this._vertexAttrib4f,[t,n,o,u,f])&&this._vertexAttrib4f(t,n,o,u,f)}$vertexAttrib4fv(t,n){this._state.setSetting(this._vertexAttrib4fv,[t,n])&&this._vertexAttrib4fv(t,n)}static enable(t,n="default"){const o=Object.getOwnPropertyNames(Bo.prototype);return t.__proto__,o.forEach(u=>{if(u!=="constructor"){const f=Bo.prototype[u];u.charAt(0)==="$"&&(u=u.substr(1)),t[u]!==f&&(t[u]&&(t[u].name||(t[u].xname=u),t["_"+u]=t[u]),t[u]=f)}}),Bo.prototype._initStateManager.call(t,n),t}}class Bb{constructor(t){this.stage=t,this._usedMemory=0,this._uploadedTextureSources=[],this.textureSourceHashmap=new Map}get usedMemory(){return this._usedMemory}destroy(){for(let t=0,n=this._uploadedTextureSources.length;t<n;t++)this._nativeFreeTextureSource(this._uploadedTextureSources[t]);this.textureSourceHashmap.clear(),this._usedMemory=0}getReusableTextureSource(t){return this.textureSourceHashmap.get(t)}getTextureSource(t,n){let o=n?this.textureSourceHashmap.get(n):null;return o||(o=new bs(this,t),n&&(o.lookupId=n,this.textureSourceHashmap.set(n,o))),o}uploadTextureSource(t,n){if(t.isLoaded())return;this._addMemoryUsage(t.w*t.h);const o=this._nativeUploadTextureSource(t,n);t._nativeTexture=o,o.w=t.w,o.h=t.h,o.update=this.stage.frameCounter,this._uploadedTextureSources.push(t),this.addToLookupMap(t),this._updateVramUsage(t,1)}_addMemoryUsage(t){this._usedMemory+=t,this.stage.addMemoryUsage(t)}_updateVramUsage(t,n){const o=t.nativeTexture;var u;In.isWebglSupported()&&t.isLoaded()&&(!o.hasOwnProperty("bytesPerPixel")||isNaN(o.bytesPerPixel)||(u=n*(t.w*t.h*o.bytesPerPixel),this.stage.addVramUsage(u,t.hasAlpha)))}addToLookupMap(t){const n=t.lookupId;n&&(this.textureSourceHashmap.has(n)||this.textureSourceHashmap.set(n,t))}gc(){this.freeUnusedTextureSources(),this._cleanupLookupMap()}freeUnusedTextureSources(){let t=[];for(let n=0,o=this._uploadedTextureSources.length;n<o;n++){let u=this._uploadedTextureSources[n];u.allowCleanup()?this._freeManagedTextureSource(u):t.push(u)}this._uploadedTextureSources=t,this._cleanupLookupMap()}_freeManagedTextureSource(t){t.isLoaded()&&(this._nativeFreeTextureSource(t),this._addMemoryUsage(-t.w*t.h),this._updateVramUsage(t,-1)),t.loadingSince=null}_cleanupLookupMap(){this.textureSourceHashmap.forEach((t,n)=>{!(t.isLoaded()||t.isLoading())&&!t.isUsed()&&this.textureSourceHashmap.delete(n)})}freeTextureSource(t){const n=this._uploadedTextureSources.indexOf(t),o=n!==-1;t.isLoaded()&&(o&&(this._addMemoryUsage(-t.w*t.h),this._uploadedTextureSources.splice(n,1)),this._nativeFreeTextureSource(t)),t.loadingSince=null}_nativeUploadTextureSource(t,n){return this.stage.renderer.uploadTextureSource(t,n)}_nativeFreeTextureSource(t){this.stage.renderer.freeTextureSource(t),t.clearNativeTexture()}}class wu{constructor(t){this.stage=t,this.genericCancelCb=n=>{this._remove(n)},this._sources=[],this._data=[]}destroy(){this._sources=[],this._data=[]}processSome(){if(this._sources.length){const t=Date.now();do this._processItem();while(this._sources.length&&Date.now()-t<wu.MAX_UPLOAD_TIME_PER_FRAME)}}_processItem(){const t=this._sources.pop(),n=this._data.pop();t.isLoading()&&t.processLoadedSource(n)}add(t,n){this._sources.push(t),this._data.push(n)}_remove(t){const n=this._sources.indexOf(t);n>=0&&(this._sources.splice(n,1),this._data.splice(n,1))}}wu.MAX_UPLOAD_TIME_PER_FRAME=10;class jb{constructor(t){this.stage=t,this.root=null,this.updateTreeOrder=0,this.renderState=this.stage.renderer.createCoreRenderState(this),this.renderExec=this.stage.renderer.createCoreRenderExecutor(this),this.renderExec.init(),this._usedMemory=0,this._renderTexturePool=[],this._renderTextureId=1,this._zSorts=[],this.renderToTextureCount=0}get usedMemory(){return this._usedMemory}destroy(){this._renderTexturePool.forEach(t=>this._freeRenderTexture(t)),this._usedMemory=0}hasRenderUpdates(){return!!this.root._parent._hasRenderUpdates}render(){this.root._parent._hasRenderUpdates=0,this._render()}update(){this._update(),this.root._hasUpdates&&this._update(),this._performForcedZSorts()}_performForcedZSorts(){if(this._zSorts.length){for(let n=0,o=this._zSorts.length;n<o;n++)this._zSorts[n].zSort&&this._zSorts[n].sortZIndexedChildren();this._zSorts=[]}}_update(){this.updateTreeOrder=0,this.root.update()}_render(){const t=this.stage.getOption("debugFrame");this._fillRenderState(),this.stage.getOption("readPixelsBeforeDraw")&&this._readPixels(),this._performRender(),t&&console.log(`[Lightning] RTT Renders in frame: ${this.renderToTextureCount}`),this.stage.getOption("readPixelsAfterDraw")&&this.renderToTextureCount>=this.stage.getOption("readPixelsAfterDrawThreshold")&&(t&&console.log("[Lightning] readPixelsAfterDraw behavior triggered"),this._readPixels()),this.renderToTextureCount=0}_readPixels(){const t=new Uint8Array(4),n=this.stage.gl;n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,t)}_fillRenderState(){this.renderState.reset(),this.root.render(),this.renderState.finish()}_performRender(){this.renderExec.execute()}_addMemoryUsage(t){this._usedMemory+=t,this.stage.addMemoryUsage(t)}allocateRenderTexture(t,n){let o=this.stage.getRenderPrecision(),u=Math.max(1,Math.round(t*o)),f=Math.max(1,Math.round(n*o));const m=this._renderTexturePool.length;for(let v=m-1;v>=0;v--){const w=this._renderTexturePool[v];if(w.w===u&&w.h===f&&w.update!==this.stage.frameCounter)return w.f=this.stage.frameCounter,this._renderTexturePool.splice(v,1),w}const p=this._createRenderTexture(t,n,u,f);return p.precision=o,p}releaseRenderTexture(t){this._renderTexturePool.push(t)}freeUnusedRenderTextures(t=60){let n=this.stage.frameCounter-t;this._renderTexturePool=this._renderTexturePool.filter(o=>o.f<=n?(this._freeRenderTexture(o),!1):!0)}_createRenderTexture(t,n,o,u){this._addMemoryUsage(o*u);const f=this.stage.renderer.createRenderTexture(t,n,o,u);return f.id=this._renderTextureId++,f.f=this.stage.frameCounter,f.ow=t,f.oh=n,f.w=o,f.h=u,f}_freeRenderTexture(t){this.stage.renderer.freeRenderTexture(t),this._addMemoryUsage(-t.w*t.h)}copyRenderTexture(t,n,o){this.stage.renderer.copyRenderTexture(t,n,o)}forceZSort(t){this._zSorts.push(t)}}class zd{constructor(t){this.stage=t,this._timingFunction="ease",this._timingFunctionImpl=Te.getTimingFunction(this._timingFunction),this.delay=0,this.duration=.2,this.merger=null}get timingFunction(){return this._timingFunction}set timingFunction(t){this._timingFunction=t,this._timingFunctionImpl=Te.getTimingFunction(t)}get timingFunctionImpl(){return this._timingFunctionImpl}patch(t){Ot.patchObject(this,t)}}zd.prototype.isTransitionSettings=!0;class Hb{constructor(t){this.stage=t,this.stage.on("frameStart",()=>this.progress()),this.active=new Set,this.defaultTransitionSettings=new zd(this.stage)}progress(){if(this.active.size){let t=this.stage.dt,n=!1;this.active.forEach(function(o){o.progress(t),o.isRunning()||(n=!0)}),n&&(this.active=new Set([...this.active].filter(o=>o.isRunning())))}}createSettings(t){const n=new zd;return Ot.patchObject(n,t),n}addActive(t){this.active.add(t)}removeActive(t){this.active.delete(t)}}class xt{constructor(){this._clear()}_clear(){this._p=[],this._pe=[],this._idp=[],this._f=[],this._v=[],this._lv=[],this._sm=[],this._s=[],this._ve=[],this._sme=[],this._se=[],this._length=0}parse(t,n){let o,u;$.isObjectLiteral(n)||(n={0:n});let f=.5,m=[];for(let p in n)if(n.hasOwnProperty(p)){let v=n[p];$.isObjectLiteral(v)||(v={v});let w=parseFloat(p);p==="sm"?f=v.v:!isNaN(w)&&w>=0&&w<=2&&(v.p=w,v.f=$.isFunction(v.v),v.lv=v.f?v.v(0,0):v.v,m.push(v))}for(m=m.sort(function(p,v){return p.p-v.p}),u=m.length,o=0;o<u;o++){let p=o===u-1;if(!m[o].hasOwnProperty("pe"))m[o].pe=p?m[o].p<=1?1:2:m[o+1].p;else{const v=o<u-1?m[o+1].p:1;m[o].pe>v&&(m[o].pe=v)}m[o].pe===m[o].p?m[o].idp=0:m[o].idp=1/(m[o].pe-m[o].p)}for(o=0;o<u;o++)if(m[o].hasOwnProperty("sm")||(m[o].sm=f),!m[o].hasOwnProperty("s"))if(o===0||o===u-1||m[o].p===1)m[o].s=t?[0,0,0,0]:0;else{const p=m[o-1],v=m[o+1];if(p.p===v.p)m[o].s=t?[0,0,0,0]:0;else if(t){const w=xt.getRgbaComponents(v.lv),C=xt.getRgbaComponents(p.lv),L=1/(v.p-p.p);m[o].s=[L*(w[0]-C[0]),L*(w[1]-C[1]),L*(w[2]-C[2]),L*(w[3]-C[3])]}else m[o].s=(v.lv-p.lv)/(v.p-p.p)}for(o=0;o<u-1;o++)if(!m[o].f){let p=o===u-1;m[o].hasOwnProperty("ve")||(m[o].ve=p?m[o].lv:m[o+1].lv),$.isNumber(m[o].v)&&$.isNumber(m[o].lv)&&(m[o].hasOwnProperty("sme")||(m[o].sme=p?f:m[o+1].sm),m[o].hasOwnProperty("se")||(m[o].se=p?t?[0,0,0,0]:0:m[o+1].s),t?m[o].v=xt.getSplineRgbaValueFunction(m[o].v,m[o].ve,m[o].p,m[o].pe,m[o].sm,m[o].sme,m[o].s,m[o].se):m[o].v=xt.getSplineValueFunction(m[o].v,m[o].ve,m[o].p,m[o].pe,m[o].sm,m[o].sme,m[o].s,m[o].se),m[o].f=!0)}for(this.length&&this._clear(),o=0,u=m.length;o<u;o++)this._add(m[o])}_add(t){this._p.push(t.p||0),this._pe.push(t.pe||0),this._idp.push(t.idp||0),this._f.push(t.f||!1),this._v.push(t.hasOwnProperty("v")?t.v:0),this._lv.push(t.lv||0),this._sm.push(t.sm||0),this._s.push(t.s||0),this._ve.push(t.ve||0),this._sme.push(t.sme||0),this._se.push(t.se||0),this._length++}_getItem(t){const n=this._length;if(!n)return-1;if(t<this._p[0])return 0;for(let o=0;o<n;o++)if(this._p[o]<=t&&t<this._pe[o])return o;return n-1}getValue(t){const n=this._getItem(t);if(n!==-1)if(this._f[n]){const o=Math.min(1,Math.max(0,(t-this._p[n])*this._idp[n]));return this._v[n](o)}else return this._v[n]}get length(){return this._length}static getRgbaComponents(t){let n=(t/65536|0)%256,o=(t/256|0)%256,u=t%256,f=t/16777216|0;return[n,o,u,f]}static getSplineValueFunction(t,n,o,u,f,m,p,v){let w=u-o;p*=w,v*=w;let C=xt.getSplineHelpers(t,n,f,m,p,v);return C?function(L){return L===0?t:L===1?n:xt.calculateSpline(C,L)}:function(L){return L===0?t:L===1?n:n*L+t*(1-L)}}static getSplineRgbaValueFunction(t,n,o,u,f,m,p,v){let w=u-o;p[0]*=w,p[1]*=w,p[2]*=w,p[3]*=w,v[0]*=w,v[1]*=w,v[2]*=w,v[3]*=w;let C=xt.getRgbaComponents(t),L=xt.getRgbaComponents(n),E=[xt.getSplineHelpers(C[0],L[0],f,m,p[0],v[0]),xt.getSplineHelpers(C[1],L[1],f,m,p[1],v[1]),xt.getSplineHelpers(C[2],L[2],f,m,p[2],v[2]),xt.getSplineHelpers(C[3],L[3],f,m,p[3],v[3])];return E[0]?function(R){return R===0?t:R===1?n:xt.getArgbNumber([Math.min(255,xt.calculateSpline(E[0],R)),Math.min(255,xt.calculateSpline(E[1],R)),Math.min(255,xt.calculateSpline(E[2],R)),Math.min(255,xt.calculateSpline(E[3],R))])}:function(R){return R===0?t:R===1?n:xt.mergeColors(n,t,R)}}static getSplineHelpers(t,n,o,u,f,m){if(!o&&!u)return null;let p=o,v=t+f*o,w=1-u,C=n-m*u,L=3*p-3*w+1,E=-6*p+3*w,R=3*p,y=3*v-3*C+n-t,I=3*(C+t)-6*v,U=3*(v-t);return[L,E,R,y,I,U,t]}static calculateSpline(t,n){let o=t[0],u=t[1],f=t[2],m=t[3],p=t[4],v=t[5],w=t[6];if(o===-2&&m===-2&&f===0&&v===0)return n;let C=.5,L,E;for(let I=0;I<20;I++){if(L=C*(C*(C*o+u)+f),E=n-L,E>-1e-8&&E<1e-8)return C*(C*(C*m+p)+v)+w;let U=C*(C*(3*o)+2*u)+f;if(U>1e-10&&U<1e-10)break;C+=E/U}let R=0,y=1;for(let I=0;I<20;I++){if(C=.5*(R+y),L=C*(C*(C*o+u)+f),E=n-L,E>-1e-8&&E<1e-8)return C*(C*(C*m+p)+v)+w;E<0?y=C:R=C}return C}static mergeColors(t,n,o){let u=(t/65536|0)%256,f=(t/256|0)%256,m=t%256,p=t/16777216|0,v=(n/65536|0)%256,w=(n/256|0)%256,C=n%256,L=n/16777216|0,E=u*o+v*(1-o),R=f*o+w*(1-o),y=m*o+C*(1-o),I=p*o+L*(1-o);return Math.round(I)*16777216+Math.round(E)*65536+Math.round(R)*256+Math.round(y)}static getArgbNumber(t){t[0]=Math.max(0,Math.min(255,t[0])),t[1]=Math.max(0,Math.min(255,t[1])),t[2]=Math.max(0,Math.min(255,t[2])),t[3]=Math.max(0,Math.min(255,t[3]));let n=((t[3]|0)<<24)+((t[0]|0)<<16)+((t[1]|0)<<8)+(t[2]|0);return n<0&&(n=4294967295+n+1),n}}class i0{constructor(t){this.animationSettings=t,this._selector="",this._items=new xt,this._props=[],this._propSetters=[],this._resetValue=void 0,this._hasResetValue=!1,this._hasColorProperty=void 0}getResetValue(){return this._hasResetValue?this._resetValue:this._items.getValue(0)}apply(t,n,o){const u=this.getAnimatedElements(t);let f=this._items.getValue(n);if(f===void 0||!u.length)return;if(o!==1){let v=this.getResetValue();$.isNumber(f)&&$.isNumber(v)&&(this.hasColorProperty()?f=Te.mergeColors(f,v,o):f=Te.mergeNumbers(f,v,o))}const m=this._propSetters.length,p=u.length;for(let v=0;v<p;v++)for(let w=0;w<m;w++)this._propSetters[w](u[v],f)}getAnimatedElements(t){return t.select(this._selector)}reset(t){const n=this.getAnimatedElements(t);let o=this.getResetValue();if(o===void 0||!n.length)return;const u=this._propSetters.length,f=n.length;for(let m=0;m<f;m++)for(let p=0;p<u;p++)this._propSetters[p](n[m],o)}set selector(t){this._selector=t}set t(t){this.selector=t}get resetValue(){return this._resetValue}set resetValue(t){this._resetValue=t,this._hasResetValue=t!==void 0}set rv(t){this.resetValue=t}set value(t){this._items.parse(this.hasColorProperty(),t)}set v(t){this.value=t}set properties(t){Array.isArray(t)||(t=[t]),this._props=[],t.forEach(n=>{this._props.push(n),this._propSetters.push(si.getSetter(n))})}set property(t){this._hasColorProperty=void 0,this.properties=t}set p(t){this.properties=t}patch(t){Ot.patchObject(this,t)}hasColorProperty(){return this._hasColorProperty===void 0&&(this._hasColorProperty=this._props.length?si.isColorProperty(this._props[0]):!1),this._hasColorProperty}}i0.prototype.isAnimationActionSettings=!0;class $t{constructor(){this._actions=[],this.delay=0,this.duration=1,this.repeat=0,this.repeatOffset=0,this.repeatDelay=0,this.autostop=!1,this.stopMethod=$t.STOP_METHODS.FADE,this._stopTimingFunction="ease",this._stopTimingFunctionImpl=Te.getTimingFunction(this._stopTimingFunction),this.stopDuration=0,this.stopDelay=0}get actions(){return this._actions}set actions(t){this._actions=[];for(let n=0,o=t.length;n<o;n++){const u=t[n];if(u.isAnimationActionSettings)this._actions.push(u);else{const f=new i0(this);f.patch(u),this._actions.push(f)}}}apply(t,n,o=1){this._actions.forEach(function(u){u.apply(t,n,o)})}reset(t){this._actions.forEach(function(n){n.reset(t)})}get stopTimingFunction(){return this._stopTimingFunction}set stopTimingFunction(t){this._stopTimingFunction=t,this._stopTimingFunctionImpl=Te.getTimingFunction(t)}get stopTimingFunctionImpl(){return this._stopTimingFunctionImpl}patch(t){Ot.patchObject(this,t)}}$t.STOP_METHODS={FADE:"fade",REVERSE:"reverse",FORWARD:"forward",IMMEDIATE:"immediate",ONETOTWO:"onetotwo"};class Pe extends mt{constructor(t,n,o){super(),this.manager=t,this._settings=n,this._element=o,this._state=Pe.STATES.IDLE,this._p=0,this._delayLeft=0,this._repeatsLeft=0,this._stopDelayLeft=0,this._stopP=0}start(){this._element&&this._element.attached?(this._p=0,this._delayLeft=this.settings.delay,this._repeatsLeft=this.settings.repeat,this._state=Pe.STATES.PLAYING,this.emit("start"),this.checkActive()):console.warn("[Lightning] Element must be attached before starting animation")}play(){this._state===Pe.STATES.PAUSED?(this._state=Pe.STATES.PLAYING,this.checkActive(),this.emit("resume")):this._state==Pe.STATES.STOPPING&&this.settings.stopMethod==$t.STOP_METHODS.REVERSE?(this._state=Pe.STATES.PLAYING,this.emit("stopContinue")):this._state!=Pe.STATES.PLAYING&&this._state!=Pe.STATES.FINISHED&&this.start()}pause(){this._state===Pe.STATES.PLAYING&&(this._state=Pe.STATES.PAUSED,this.emit("pause"))}replay(){this._state==Pe.STATES.FINISHED?this.start():this.play()}skipDelay(){this._delayLeft=0,this._stopDelayLeft=0}finish(){this._state===Pe.STATES.PLAYING?(this._delayLeft=0,this._p=1):this._state===Pe.STATES.STOPPING&&(this._stopDelayLeft=0,this._p=0)}stop(){this._state===Pe.STATES.STOPPED||this._state===Pe.STATES.IDLE||(this._stopDelayLeft=this.settings.stopDelay||0,this.settings.stopMethod===$t.STOP_METHODS.IMMEDIATE&&!this._stopDelayLeft||this._delayLeft>0?(this._state=Pe.STATES.STOPPING,this.emit("stop")):(this.settings.stopMethod===$t.STOP_METHODS.FADE&&(this._stopP=0),this._state=Pe.STATES.STOPPING,this.emit("stop")),this.checkActive())}stopNow(){(this._state!==Pe.STATES.STOPPED||this._state!==Pe.STATES.IDLE)&&(this._state=Pe.STATES.STOPPING,this._p=0,this.emit("stop"),this.reset(),this._state=Pe.STATES.STOPPED,this.emit("stopFinish"))}isPaused(){return this._state===Pe.STATES.PAUSED}isPlaying(){return this._state===Pe.STATES.PLAYING}isStopping(){return this._state===Pe.STATES.STOPPING}isFinished(){return this._state===Pe.STATES.FINISHED}checkActive(){this.isActive()&&this.manager.addActive(this)}isActive(){return(this._state==Pe.STATES.PLAYING||this._state==Pe.STATES.STOPPING)&&this._element&&this._element.attached}progress(t){this._element&&(this._progress(t),this.apply())}_progress(t){if(this._state==Pe.STATES.STOPPING){this._stopProgress(t);return}if(this._state==Pe.STATES.PLAYING){if(this._delayLeft>0)if(this._delayLeft-=t,this._delayLeft<0)t=-this._delayLeft,this._delayLeft=0,this.emit("delayEnd");else return;this.settings.duration===0?this._p=1:this.settings.duration>0&&(this._p+=t/this.settings.duration),this._p>=1?this.settings.repeat==-1||this._repeatsLeft>0?(this._repeatsLeft>0&&this._repeatsLeft--,this._p=this.settings.repeatOffset,this.emit("progress",this._p),this.settings.repeatDelay&&(this._delayLeft=this.settings.repeatDelay),this.emit("repeat",this._repeatsLeft)):(this._p=1,this.emit("progress",this._p),this._state=Pe.STATES.FINISHED,this.emit("finish"),this.settings.autostop&&this.stop()):this.emit("progress",this._p)}}_stopProgress(t){let n=this._getStopDuration();if(this._stopDelayLeft>0)if(this._stopDelayLeft-=t,this._stopDelayLeft<0)t=-this._stopDelayLeft,this._stopDelayLeft=0,this.emit("stopDelayEnd");else return;this.settings.stopMethod==$t.STOP_METHODS.IMMEDIATE?(this._state=Pe.STATES.STOPPED,this.emit("stopFinish")):this.settings.stopMethod==$t.STOP_METHODS.REVERSE?(n===0?this._p=0:n>0&&(this._p-=t/n),this._p<=0&&(this._p=0,this._state=Pe.STATES.STOPPED,this.emit("stopFinish"))):this.settings.stopMethod==$t.STOP_METHODS.FADE?(this._progressStopTransition(t),this._stopP>=1&&(this._p=0,this._state=Pe.STATES.STOPPED,this.emit("stopFinish"))):this.settings.stopMethod==$t.STOP_METHODS.ONETOTWO?this._p<2&&(n===0?this._p=2:n>0&&(this._p<1?this._p+=t/this.settings.duration:this._p+=t/n),this._p>=2?(this._p=2,this._state=Pe.STATES.STOPPED,this.emit("stopFinish")):this.emit("progress",this._p)):this.settings.stopMethod==$t.STOP_METHODS.FORWARD&&this._p<1&&(this.settings.duration==0?this._p=1:this._p+=t/this.settings.duration,this._p>=1?this.settings.stopMethod==$t.STOP_METHODS.FORWARD?(this._p=1,this._state=Pe.STATES.STOPPED,this.emit("stopFinish")):this._repeatsLeft>0?(this._repeatsLeft--,this._p=0,this.emit("repeat",this._repeatsLeft)):(this._p=1,this._state=Pe.STATES.STOPPED,this.emit("stopFinish")):this.emit("progress",this._p))}_progressStopTransition(t){if(this._stopP<1){if(this._stopDelayLeft>0)if(this._stopDelayLeft-=t,this._stopDelayLeft<0)t=-this._stopDelayLeft,this._stopDelayLeft=0,this.emit("delayEnd");else return;const n=this._getStopDuration();n==0?this._stopP=1:this._stopP+=t/n,this._stopP>=1&&(this._stopP=1)}}_getStopDuration(){return this.settings.stopDuration||this.settings.duration}apply(){if(this._state===Pe.STATES.STOPPED)this.reset();else{let t=1;this._state===Pe.STATES.STOPPING&&this.settings.stopMethod===$t.STOP_METHODS.FADE&&(t=1-this.settings.stopTimingFunctionImpl(this._stopP)),this._settings.apply(this._element,this._p,t)}}reset(){this._settings.reset(this._element)}get state(){return this._state}get p(){return this._p}get delayLeft(){return this._delayLeft}get element(){return this._element}get frame(){return Math.round(this._p*this._settings.duration*60)}get settings(){return this._settings}}Pe.STATES={IDLE:0,PLAYING:1,STOPPING:2,STOPPED:3,FINISHED:4,PAUSED:5};class Vb{constructor(t){this.stage=t,this.stage.on("frameStart",()=>this.progress()),this.active=new Set}progress(){if(this.active.size){let t=this.stage.dt,n=!1;this.active.forEach(function(o){o.isActive()?o.progress(t):n=!0}),n&&(this.active=new Set([...this.active].filter(o=>o.isActive())))}}createAnimation(t,n){return $.isObjectLiteral(n)&&(n=this.createSettings(n)),new Pe(this,n,t)}createSettings(t){const n=new $t;return Ot.patchObject(n,t),n}addActive(t){this.active.add(t)}}class r0 extends ai{_getLookupId(){return"__whitepix"}_getSourceLoader(){return function(t){var n=new Uint8Array([255,255,255,255]);t(null,{source:n,w:1,h:1,permanent:!0})}}isAutosizeTexture(){return!1}}class In extends mt{constructor(t={}){super(),this._setOptions(t),this._usedMemory=0,this._lastGcFrame=0,this._usedVramAlpha=0,this._usedVramNonAlpha=0;const n=In.platform?In.platform:zb.load(t);this.platform=new n,this.platform.init&&this.platform.init(this),this.gl=null,this.c2d=null;const o=this.getOption("context");o?o.useProgram?this.gl=o:this.c2d=o:$.isWeb&&(!In.isWebglSupported()||this.getOption("canvas2d"))?this.c2d=this.platform.createCanvasContext(this.getOption("w"),this.getOption("h")):this.gl=this.platform.createWebGLContext(this.getOption("w"),this.getOption("h")),this.gl&&Bo.enable(this.gl,"lightning"),this._mode=this.gl?0:1,this.getCanvas()&&(this._options.w=this.getCanvas().width,this._options.h=this.getCanvas().height),this._mode===0?$.isSpark?this._renderer=new Ob(this):this._renderer=new t0(this):this._renderer=new kb(this),this.setClearColor(this.getOption("clearColor")),this.frameCounter=0,this.transitions=new Hb(this),this.animations=new Vb(this),this.textureManager=new Bb(this),this.textureThrottler=new wu(this),this.startTime=0,this.currentTime=0,this.dt=0,this.rectangleTexture=new r0(this),this.rectangleTexture.load(),this.rectangleTexture.source.permanent=!0,this.ctx=new jb(this),this._updateSourceTextures=new Set}get renderer(){return this._renderer}static isWebglSupported(){if($.isNode)return!0;try{return!!window.WebGLRenderingContext}catch(t){return!1}}get mode(){return this._mode}isWebgl(){return this.mode===0}isC2d(){return this.mode===1}getOption(t){return this._options[t]}_setOptions(t){this._options={};let n=(o,u)=>{let f=t[o];f===void 0?this._options[o]=u:this._options[o]=f};n("canvas",null),n("context",null),n("w",1920),n("h",1080),n("srcBasePath",null),n("memoryPressure",24e6),n("bufferMemory",2e6),n("textRenderIssueMargin",0),n("fontSharp",{precision:.6666666667,fontSize:24}),n("clearColor",[0,0,0,0]),n("defaultFontFace","sans-serif"),n("fixedDt",0),n("useImageWorker",!0),n("autostart",!0),n("precision",1),n("canvas2d",!1),n("platform",null),n("readPixelsBeforeDraw",!1),n("readPixelsAfterDraw",!1),n("readPixelsAfterDrawThreshold",0),n("debugFrame",!1),n("forceTxCanvasSource",!1),n("pauseRafLoopOnIdle",!1)}setApplication(t){this.application=t}init(){this.application.getOption("debug")&&this.platform._imageWorker&&console.log("[Lightning] Using image worker!"),this.application.getOption("debug")&&this.c2d&&console.log("[Lightning] Using canvas2d renderer"),this.application.setAsRoot(),this.getOption("autostart")&&this.platform.startLoop()}destroy(){this.platform.stopLoop(),this.platform.destroy(),this.ctx.destroy(),this.textureManager.destroy(),this._renderer.destroy()}stop(){this.platform.stopLoop()}resume(){this.platform.startLoop()}get root(){return this.application}getCanvas(){return this._mode?this.c2d.canvas:this.gl.canvas}getRenderPrecision(){return this._options.precision}addUpdateSourceTexture(t){this._updatingFrame?t._performUpdateSource():this._updateSourceTextures.add(t)}removeUpdateSourceTexture(t){this._updateSourceTextures&&this._updateSourceTextures.delete(t)}hasUpdateSourceTexture(t){return this._updateSourceTextures&&this._updateSourceTextures.has(t)}_performUpdateSource(){this._updateSourceTextures.size&&(this._updateSourceTextures.forEach(t=>{t._performUpdateSource()}),this._updateSourceTextures=new Set)}_calculateDt(){this.startTime=this.currentTime,this.currentTime=this.platform.getHrTime(),this._options.fixedDt?this.dt=this._options.fixedDt:this.dt=this.startTime?.001*(this.currentTime-this.startTime):.02}updateFrame(){this._calculateDt(),this.emit("frameStart"),this._performUpdateSource(),this.emit("update")}idleFrame(){this.textureThrottler.processSome(),this.emit("frameEnd"),this.frameCounter++}renderFrame(){const t=this.ctx.hasRenderUpdates();this.textureThrottler.processSome(),t&&(this._updatingFrame=!0,this.ctx.update(),this.ctx.render(),this._updatingFrame=!1),this.platform.nextFrame(t),this.emit("frameEnd"),this.frameCounter++}isUpdatingFrame(){return this._updatingFrame}drawFrame(){this.updateFrame(),this.renderFrame()}forceRenderUpdate(){this.root&&this.root.core._parent.setHasRenderUpdates(1)}setClearColor(t){this.forceRenderUpdate(),t===null?this._clearColor=null:Array.isArray(t)?this._clearColor=t:this._clearColor=Te.getRgbaComponentsNormalized(t)}getClearColor(){return this._clearColor}createElement(t){return t?this.element(t):new si(this)}createShader(t){return Qo.create(this,t)}element(t){if(t.isElement)return t;let n;return t.type?n=new t.type(this):n=new si(this),n.patch(t),n}c(t){return this.element(t)}get w(){return this._options.w}get h(){return this._options.h}get coordsWidth(){return this.w/this._options.precision}get coordsHeight(){return this.h/this._options.precision}addMemoryUsage(t){this._usedMemory+=t,this._lastGcFrame!==this.frameCounter&&this._usedMemory>this.getOption("memoryPressure")&&(this.gc(!1),this._usedMemory>this.getOption("memoryPressure")-2e6&&this.gc(!0))}get usedMemory(){return this._usedMemory}addVramUsage(t,n){n?this._usedVramAlpha+=t:this._usedVramNonAlpha+=t}get usedVramAlpha(){return this._usedVramAlpha}get usedVramNonAlpha(){return this._usedVramNonAlpha}get usedVram(){return this._usedVramAlpha+this._usedVramNonAlpha}gc(t){if(this._lastGcFrame!==this.frameCounter){this._lastGcFrame=this.frameCounter;const n=this._usedMemory;if(this.gcTextureMemory(t),this.gcRenderTextureMemory(t),this.renderer.gc(t),this.application.getOption("debug")){console.log(`[Lightning] GC${t?"[aggressive]":""}! Frame ${this._lastGcFrame} Freed ${((n-this._usedMemory)/1e6).toFixed(2)}MP from GPU memory. Remaining: ${(this._usedMemory/1e6).toFixed(2)}MP`);const o=this._usedMemory-this.textureManager.usedMemory-this.ctx.usedMemory;console.log(`[Lightning] Textures: ${(this.textureManager.usedMemory/1e6).toFixed(2)}MP, Render Textures: ${(this.ctx.usedMemory/1e6).toFixed(2)}MP, Renderer caches: ${(o/1e6).toFixed(2)}MP`)}}}gcTextureMemory(t=!1){t&&this.ctx.root.visible?(this.ctx.root.visible=!1,this.textureManager.gc(),this.ctx.root.visible=!0):this.textureManager.gc()}gcRenderTextureMemory(t=!1){t&&this.root.visible?(this.root.visible=!1,this.ctx.freeUnusedRenderTextures(0),this.root.visible=!0):this.ctx.freeUnusedRenderTextures(0)}getDrawingCanvas(){return this.platform.getDrawingCanvas()}update(){this.ctx.update()}addServiceProvider(t){$.isSpark&&this.platform.addServiceProvider(t)}getChildrenByPosition(t,n){const o=[];return this.root.core.update(),this.root.core.collectAtCoord(t,n,o),o}}let Wb=class Tn extends Ct{constructor(t={},n){Tn._temp_options=t,Tn.booting=!0;const o=new In(t.stage);super(o,n),Tn.booting=!1,this.__updateFocusCounter=0,this.__keypressTimers=new Map,this.__hoveredChild=null,this.stage.init(),this.updateFocusSettings(),this.__keymap=this.getOption("keys"),this.__keymap&&(this.stage.platform.registerKeydownHandler(u=>{this._receiveKeydown(u)}),this.stage.platform.registerKeyupHandler(u=>{this._receiveKeyup(u)})),this.getOption("enablePointer")&&(this.stage.platform.registerClickHandler(u=>{this._receiveClick(u)}),this.stage.platform.registerHoverHandler(u=>{this._receiveHover(u)}),this.stage.platform.registerScrollWheelHandler(u=>{this._recieveScrollWheel(u)}),this.cursor="default")}getOption(t){return this.__options[t]}_setOptions(t){this.__options={};let n=(o,u)=>{let f=t[o];f===void 0?this.__options[o]=u:this.__options[o]=f};n("debug",!1),n("keys",{38:"Up",40:"Down",37:"Left",39:"Right",13:"Enter",8:"Back",27:"Exit"}),n("enablePointer",!1)}__construct(){this.stage.setApplication(this),this._setOptions(Tn._temp_options),delete Tn._temp_options,super.__construct()}__init(){super.__init(),this.__updateFocus()}updateFocusPath(){this.__updateFocus()}__updateFocus(){const t=this.__updateFocusRec();!Tn.booting&&t&&this.updateFocusSettings()}__updateFocusRec(){const t=++this.__updateFocusCounter;this.__updateFocusId=t;const n=this.__getFocusPath(),o=n[n.length-1],u=this._focusPath?this._focusPath[this._focusPath.length-1]:void 0;if(u){let f=Math.min(this._focusPath.length,n.length),m;for(m=0;m<f&&this._focusPath[m]===n[m];m++);if(this._focusPath.length!==n.length||m!==n.length){this.getOption("debug")&&console.log("[Lightning] Focus changed: "+o.getLocationString());for(let p=this._focusPath.length-1;p>=m;p--)if(this._focusPath.pop()._unfocus(o,u),this.__updateFocusId!==t)return!1;for(let p=m,v=n.length;p<v;p++)if(this._focusPath.push(n[p]),this._focusPath[p]._focus(o,u),this.__updateFocusId!==t)return!1;for(let p=0;p<m;p++)this._focusPath[p]._focusChange(o,u)}}else{this._focusPath=[];for(let f=0,m=n.length;f<m;f++)if(this._focusPath.push(n[f]),this._focusPath[f]._focus(o,void 0),this.__updateFocusId!==t)return!1;return!0}return!0}updateFocusSettings(){const t=this._focusPath[this._focusPath.length-1],n={},o=Ct.prototype._setFocusSettings;for(let f=0,m=this._focusPath.length;f<m;f++)this._focusPath[f]._setFocusSettings!==o&&this._focusPath[f]._setFocusSettings(n);const u=Ct.prototype._handleFocusSettings;for(let f=0,m=this._focusPath.length;f<m;f++)this._focusPath[f]._handleFocusSettings!==u&&this._focusPath[f]._handleFocusSettings(n,this.__prevFocusSettings,t);this.__prevFocusSettings=n}_handleFocusSettings(t,n,o,u){}__getFocusPath(){const t=[this];let n=this;do{const o=n._getFocused();if(!o||o===n)break;let u=o.cparent;if(u===n)t.push(o);else{const f=[o];do u||n._throwError("Return value for _getFocused must be an attached descendant component but its '"+o.getLocationString()+"'"),f.push(u),u=u.cparent;while(u!==n);for(let m=0,p=f.length;m<p;m++)t.push(f[p-m-1])}n=o}while(!0);return t}get focusPath(){return this._focusPath}focusTopDownEvent(t,...n){const o=this.focusPath,u=o.length;for(let f=0;f<u;f++){const m=o[f]._getMostSpecificHandledMember(t);if(m!==void 0&&o[f][m](...n)!==!1)return!0}return!1}focusBottomUpEvent(t,...n){const o=this.focusPath,u=o.length;for(let f=u-1;f>=0;f--){const m=o[f]._getMostSpecificHandledMember(t);if(m!==void 0&&o[f][m](...n)!==!1)return!0}return!1}_receiveKeydown(t){const n=t,o=this.__keymap[t.keyCode],u=this.focusPath;let f;if(o&&(f=Array.isArray(o)?o:[o]),f)for(let p=0,v=f.length;p<v;p++){const w=this.__keypressTimers.has(f[p]);if(u[u.length-1].longpress&&w)return;this.stage.application.focusTopDownEvent([`_capture${f[p]}`,"_captureKey"],n)||this.stage.application.focusBottomUpEvent([`_handle${f[p]}`,"_handleKey"],n)}else this.stage.application.focusTopDownEvent(["_captureKey"],n)||this.stage.application.focusBottomUpEvent(["_handleKey"],n);this.updateFocusPath();const m=u[u.length-1];if(f&&m.longpress)for(let p=0,v=f.length;p<v;p++)this._startLongpressTimer(f[p],m)}_receiveKeyup(t){const n=t,o=this.__keymap[t.keyCode];let u;if(o&&(u=Array.isArray(o)?o:[o]),u)for(let f=0,m=u.length;f<m;f++)this.stage.application.focusTopDownEvent([`_capture${u[f]}Release`,"_captureKeyRelease"],n)||this.stage.application.focusBottomUpEvent([`_handle${u[f]}Release`,"_handleKeyRelease"],n);else this.stage.application.focusTopDownEvent(["_captureKeyRelease"],n)||this.stage.application.focusBottomUpEvent(["_handleKeyRelease"],n);if(this.updateFocusPath(),u)for(let f=0,m=u.length;f<m;f++)this.__keypressTimers.has(u[f])&&(clearTimeout(this.__keypressTimers.get(u[f])),this.__keypressTimers.delete(u[f]))}_startLongpressTimer(t,n){const o=n.longpress,u=t.toLowerCase();if(o[u]){const f=o[u];$.isNumber(f)?this.__keypressTimers.set(t,setTimeout(()=>{this.stage.application.focusTopDownEvent([`_capture${t}Long`,"_captureKey"],{})||this.stage.application.focusBottomUpEvent([`_handle${t}Long`,"_handleKey"],{}),this.__keypressTimers.delete(t)},f||500)):n._throwError("config value for longpress must be a number")}}_recieveScrollWheel(t){const n=t,{clientX:o,clientY:u}=n;o<=this.stage.w&&u<=this.stage.h&&(this.fireTopDownScrollWheelHandler("_captureScroll",n)||this.fireBottomUpScrollWheelHandler("_handleScroll",n))}fireTopDownScrollWheelHandler(t,n){let o=this.stage.application.children,u=this._findChildren([],o).reverse(),f=u.length;for(;f--;){const m=u[f];if(m&&m[t])return m._captureScroll(n),!0}return!1}fireBottomUpScrollWheelHandler(t,n){const{clientX:o,clientY:u}=n;let m=this._getTargetChild(o,u);for(;m!==null;){if(m&&m[t])return m._handleScroll(n),!0;m=m.parent}return!1}_receiveClick(t){const n=t,{clientX:o,clientY:u}=n;o<=this.stage.w&&u<=this.stage.h&&this.stage.application.fireBottomUpClickHandler(n)}fireBottomUpClickHandler(t){const{clientX:n,clientY:o}=t,u=this._getTargetChild(n,o);let f=u;for(;f!==null;){if(f&&f._handleClick){f._handleClick(u);break}f=f.parent}}_receiveHover(t){const n=t,{clientX:o,clientY:u}=n;o<=this.stage.w&&u<=this.stage.h&&this.stage.application.fireBottomUpHoverHandler(n)}fireBottomUpHoverHandler(t){const{clientX:n,clientY:o}=t,u=this._getTargetChild(n,o);if(u!==this.__hoveredChild){let f=new Set,m=new Set;if(u&&(m=new Set(u.getAncestors())),this.__hoveredChild){f=new Set(this.__hoveredChild.getAncestors());for(const w of[...f].filter(C=>!m.has(C))){const C=Ct.getComponent(w);C._handleUnhover&&C._handleUnhover(w),w.parent&&w.parent.cursor&&(this.stage.getCanvas().style.cursor=w.parent.cursor)}}this.__hoveredChild=u;const p=[...m].filter(w=>!f.has(w));for(const w of p){const C=Ct.getComponent(w);C._handleHover&&C._handleHover(w)}const v=p[0];if(v&&v.cursor&&(this.stage.getCanvas().style.cursor=v.cursor),p.length===0&&u){const w=Ct.getComponent(u);w._handleHover&&w._handleHover(u)}}}_getTargetChild(t,n){let o=this.stage.application.children,u=this._findChildren([],o),f=this._withinClickableRange(u,t,n);return f.sort((m,p)=>m.zIndex>p.zIndex?1:m.zIndex<p.zIndex?-1:m.id>p.id?1:-1),f.length?f.slice(-1)[0]:null}_findChildren(t,n){let o=n.length;for(;o--;){const u=n[o];u.__active&&u.collision&&(u.collision===!0&&t.push(u),u.hasChildren()&&this._findChildren(t,u.children))}return t}_withinClickableRange(t,n,o){let u=t.length;const f=[];for(;u--;){const m=t[u],p=this.stage.getRenderPrecision(),v=m.core._worldContext,w=v.px*p,C=v.py*p,L=m.finalW*v.ta*p,E=m.finalH*v.td*p;if(!(w>this.stage.w||C>this.stage.h)){if(m.parent.core._scissor){const R=m.parent.core._scissor.map(y=>y*p);if(!this._testCollision(n,o,...R))continue}this._testCollision(n,o,w,C,L,E)&&f.push(m)}}return f}_testCollision(t,n,o,u,f,m){return t>=o&&t<=o+f&&n>=u&&n<=u+m}destroy(){this._destroyed||(this._destroy(),this.stage.destroy(),this._destroyed=!0)}_destroy(){if(this.stage.setApplication(void 0),this._updateAttachedFlag(),this._updateEnabledFlag(),this.__keypressTimers.size){for(const t of this.__keypressTimers.values())clearTimeout(t);this.__keypressTimers.clear()}}getCanvas(){return this.stage.getCanvas()}};class n0 extends ai{constructor(t){super(t),this._factory=void 0,this._lookupId=void 0}set content({factory:t,lookupId:n=void 0}){this._factory=t,this._lookupId=n,this._changed()}_getIsValid(){return!!this._factory}_getLookupId(){return this._lookupId}_getSourceLoader(){const t=this._factory;return n=>t((o,u)=>{if(o)return n(o);n(null,this.stage.platform.getTextureOptionsForDrawingCanvas(u))},this.stage)}}class jo{static getCanvasTexture(t,n){return{type:n0,content:{factory:t,lookupId:n}}}static getRoundRect(t,n,o,u,f,m,p){Array.isArray(o)||(o=[o,o,o,o]);let v=(C,L)=>{$.isSpark?L.platform.createRoundRect(C,L,t,n,o,u,f,m,p):C(null,this.createRoundRect(L,t,n,o,u,f,m,p))},w="rect"+[t,n,u,f,m?1:0,p].concat(o).join(",");return jo.getCanvasTexture(v,w)}static createRoundRect(t,n,o,u,f,m,p,v){p===void 0&&(p=!0),f===void 0&&(f=0);let w=t.platform.getDrawingCanvas(),C=w.getContext("2d");C.imageSmoothingEnabled=!0,w.width=n+f+2,w.height=o+f+2,C.beginPath();let L=.5*f+1,E=.5*f+1;return C.moveTo(L+u[0],E),C.lineTo(L+n-u[1],E),C.arcTo(L+n,E,L+n,E+u[1],u[1]),C.lineTo(L+n,E+o-u[2]),C.arcTo(L+n,E+o,L+n-u[2],E+o,u[2]),C.lineTo(L+u[3],E+o),C.arcTo(L,E+o,L,E+o-u[3],u[3]),C.lineTo(L,E+u[0]),C.arcTo(L,E,L+u[0],E,u[0]),C.closePath(),p&&($.isNumber(v)?C.fillStyle=Te.getRgbaString(v):C.fillStyle="white",C.fill()),f&&($.isNumber(m)?C.strokeStyle=Te.getRgbaString(m):C.strokeStyle="white",C.lineWidth=f,C.stroke()),w}static getShadowRect(t,n,o=0,u=5,f=u*2){Array.isArray(o)||(o=[o,o,o,o]);let m=(v,w)=>{$.isSpark?w.platform.createShadowRect(v,w,t,n,o,u,f):v(null,this.createShadowRect(w,t,n,o,u,f))},p="shadow"+[t,n,u,f].concat(o).join(",");return jo.getCanvasTexture(m,p)}static createShadowRect(t,n,o,u,f,m){let p=t.platform.getDrawingCanvas(),v=p.getContext("2d");v.imageSmoothingEnabled=!0,p.width=n+m*2,p.height=o+m*2,v.globalAlpha=.01,v.fillRect(0,0,.01,.01),v.globalAlpha=1,v.shadowColor=Te.getRgbaString(4294967295),v.fillStyle=Te.getRgbaString(4294967295),v.shadowBlur=f,v.shadowOffsetX=n+10+m,v.shadowOffsetY=m,v.beginPath();const w=-(n+10),C=0;return v.moveTo(w+u[0],C),v.lineTo(w+n-u[1],C),v.arcTo(w+n,C,w+n,C+u[1],u[1]),v.lineTo(w+n,C+o-u[2]),v.arcTo(w+n,C+o,w+n-u[2],C+o,u[2]),v.lineTo(w+u[3],C+o),v.arcTo(w,C+o,w,C+o-u[3],u[3]),v.lineTo(w,C+u[0]),v.arcTo(w,C,w+u[0],C,u[0]),v.closePath(),v.fill(),p}static getSvgTexture(t,n,o){let u=(m,p)=>{$.isSpark?p.platform.createSvg(m,p,t,n,o):this.createSvg(m,p,t,n,o)},f="svg"+[n,o,t].join(",");return jo.getCanvasTexture(u,f)}static createSvg(t,n,o,u,f){let m=n.platform.getDrawingCanvas(),p=m.getContext("2d");p.imageSmoothingEnabled=!0;let v=new Image;v.onload=()=>{m.width=u,m.height=f,p.drawImage(v,0,0,m.width,m.height),t(null,m)},v.onError=w=>{t(w)},$.isPS4||(v.crossOrigin="Anonymous"),v.src=o}}class af{static isMf(t){return $.isFunction(t)&&t.__mf}static mf(t){return t.__mf=!0,t}static merge(t,n){const o=Object.keys(t),u=Object.keys(n);if(!u.length)return t;const f={},m={};for(let C=0,L=u.length;C<L;C++){const E=u[C];f[E]=-1,m[E]=C}for(let C=0,L=o.length;C<L;C++){const E=o[C];f[E]=C,m[E]===void 0&&(m[E]=-1)}const p=o.length,v={};for(let C=0,L=u.length;C<L;C++){const E=u[C],R=f[E];let y=R;for(;--y>=0;){const te=o[y];if(m[te]!==-1)break}for(;++y<R;){const te=o[y];v[te]=t[te]}const I=n[E],U=t[E];let Z;this.isMf(I)?Z=I(U):!$.isObjectLiteral(U)||!$.isObjectLiteral(I)?Z=I:Z=af.merge(U,I),Z!==void 0&&(v[E]=Z)}let w=p;for(;--w>=0;){const C=o[w];if(m[C]!==-1)break}for(;++w<p;){const C=o[w];v[C]=t[C]}return v}}class s0 extends Yv{constructor(t){super(),this._target=t}onAdd(t,n){this._target.addAt(t,n)}onRemove(t,n){this._target.removeAt(n)}onSync(t,n,o){this._target._setByArray(o)}onSet(t,n){this._target.setAt(t,n)}onMove(t,n,o){this._target.setAt(t,o)}createItem(t){return this._target.createItem(t)}isItem(t){return this._target.isItem(t)}}class o0 extends s0{constructor(t,n){super(t),this._wrap=n}wrap(t){let n=this._wrap(t);return t._wrapper=n,n}onAdd(t,n){t=this.wrap(t),super.onAdd(t,n)}onRemove(t,n){super.onRemove(t,n)}onSync(t,n,o){n.forEach(u=>this.wrap(u)),o=o.map(u=>u._wrapper),super.onSync(t,n,o)}onSet(t,n){t=this.wrap(t),super.onSet(t,n)}onMove(t,n,o){super.onMove(t,n,o)}}class a0 extends ai{_getLookupId(){return"__noise"}_getSourceLoader(){const t=this.stage.gl;return function(n){const o=new Uint8Array(65536);for(let f=0;f<128*128*4;f+=4){const m=Math.floor(Math.random()*256);o[f]=m,o[f+1]=m,o[f+2]=m,o[f+3]=255}const u={};t&&(u[t.TEXTURE_WRAP_S]=t.REPEAT,u[t.TEXTURE_WRAP_T]=t.REPEAT,u[t.TEXTURE_MIN_FILTER]=t.NEAREST,u[t.TEXTURE_MAG_FILTER]=t.NEAREST),n(null,{source:o,w:128,h:128,texParams:u})}}}class lf extends ai{constructor(t){super(t),this._htmlElement=void 0,this._scale=1}set htmlElement(t){this._htmlElement=t,this._changed()}get htmlElement(){return this._htmlElement}set scale(t){this._scale=t,this._changed()}get scale(){return this._scale}set html(t){if(!t)this.htmlElement=void 0;else{const n=document.createElement("div");n.innerHTML="<div>"+t+"</div>",this.htmlElement=n.firstElementChild}}get html(){return this._htmlElement.innerHTML}_getIsValid(){return this.htmlElement}_getLookupId(){return this._scale+":"+this._htmlElement.innerHTML}_getSourceLoader(){const t=this._htmlElement,n=this._scale;return function(o){if(!window.html2canvas)return o(new Error("Please include html2canvas (https://html2canvas.hertzen.com/)"));const u=lf.getPreloadArea();u.appendChild(t),html2canvas(t,{backgroundColor:null,scale:n}).then(function(f){if(u.removeChild(t),f.height===0)return o(new Error("Canvas height is 0"));o(null,{source:f,width:f.width,height:f.height})}).catch(f=>{console.error("[Lightning]",f)})}}static getPreloadArea(){return this._preloadArea||(this._preloadArea=document.createElement("div"),this._preloadArea.attachShadow&&this._preloadArea.attachShadow({mode:"closed"}),this._preloadArea.style.opacity=0,this._preloadArea.style.pointerEvents="none",this._preloadArea.style.position="fixed",this._preloadArea.style.display="block",this._preloadArea.style.top="100vh",this._preloadArea.style.overflow="hidden",document.body.appendChild(this._preloadArea)),this._preloadArea}}class Gb extends ai{constructor(t,n){super(t),this._options=n}set options(t){this._options!==t&&(this._options=t,this._changed())}get options(){return this._options}_getIsValid(){return!!this._options}_getSourceLoader(){return t=>{t(null,this._options)}}}class Xb extends Ct{constructor(t){super(t),this._wrapper=super._children.a({}),this._reloadVisibleElements=!1,this._visibleItems=new Set,this._index=0,this._started=!1,this._scrollTransitionSettings=this.stage.transitions.createSettings({}),this._itemSize=100,this._viewportScrollOffset=0,this._itemScrollOffset=0,this._roll=!1,this._rollMin=0,this._rollMax=0,this._progressAnimation=null,this._invertDirection=!1,this._horizontal=!0,this.itemList=new qb(this)}_allowChildrenAccess(){return!1}get items(){return this.itemList.get()}set items(t){this.itemList.patch(t)}start(){this._wrapper.transition(this.property,this._scrollTransitionSettings),this._scrollTransition=this._wrapper.transition(this.property),this._scrollTransition.on("progress",t=>this.update()),this.setIndex(0,!0,!0),this._started=!0,this.update()}setIndex(t,n=!1,o=!1){let u=this.length;if(!u)return;if(this.emit("unfocus",this.getElement(this.realIndex),this._index,this.realIndex),o){let p=$.getModuloIndex(t,u),v=$.getModuloIndex(this.index,u),w=p-v;w>.5*u?w-=u:w<-.5*u&&(w+=u),this._index+=w}else this._index=t;(this._roll||this.viewportSize>this._itemSize*u)&&(this._index=$.getModuloIndex(this._index,u));let f=this._horizontal^this._invertDirection?-1:1,m=f*this._index*this._itemSize;if(this._roll){let p,v,w;if(f==1)v=(u-1)*this._itemSize,w=this._viewportScrollOffset*this.viewportSize-this._itemScrollOffset*this._itemSize,v-=w,p=this.viewportSize-(this._itemSize+w),this._rollMin&&(p-=this._rollMin),this._rollMax&&(v+=this._rollMax),m=Math.max(Math.min(m,v),p);else{v=u*this._itemSize-this.viewportSize,w=this._viewportScrollOffset*this.viewportSize-this._itemScrollOffset*this._itemSize,v+=w;let C=w;this._rollMin&&(C-=this._rollMin),this._rollMax&&(v+=this._rollMax),m=Math.min(Math.max(-v,m),-C)}}this._scrollTransition.start(m),n&&this._scrollTransition.finish(),this.emit("focus",this.getElement(this.realIndex),this._index,this.realIndex)}getAxisPosition(){let t=-this._scrollTransition._targetValue,o=-(this._horizontal^this._invertDirection?-1:1)*this._index*this._itemSize;return this._viewportScrollOffset*this.viewportSize+(o-t)}update(){if(!this._started)return;let t=this.length;if(!t)return;let n=this._horizontal^this._invertDirection?-1:1,o=this._horizontal?this._wrapper.x:this._wrapper.y,u=this.viewportSize,f=this._viewportScrollOffset*u-this._itemScrollOffset*this._itemSize;o+=f;let m,p,v,w;n==-1?(m=Math.floor(-o/this._itemSize),v=1-(-o/this._itemSize-m),p=Math.floor((u-o)/this._itemSize),w=(u-o)/this._itemSize-p):(m=Math.ceil(o/this._itemSize),v=1+o/this._itemSize-m,p=Math.ceil((o-u)/this._itemSize),w=p-(o-u)/this._itemSize),(this._roll||u>this._itemSize*t)&&(p>=t&&(p=t-1,w=1),m>=t&&(m=t-1,v=1),p<=-1&&(p=0,w=1),m<=-1&&(m=0,v=1));let C=-n*m*this._itemSize,L;for(let R=m;n==-1?R<=p:R>=p;n==-1?R++:R--){let y=$.getModuloIndex(R,t),I=this.getElement(y);L=I.parent,this._visibleItems.delete(L),this._horizontal?L.x=C+f:L.y=C+f;let U=L.visible;if(L.visible=!0,(!U||this._reloadVisibleElements)&&this.emit("visible",R,y),this._progressAnimation){let Z=1;R==m?Z=v:R==p&&(Z=w),this._progressAnimation.apply(I,Z)}C+=this._itemSize}let E=this;this._visibleItems.forEach(function(R){R.visible=!1,E._visibleItems.delete(R)});for(let R=m;n==-1?R<=p:R>=p;n==-1?R++:R--){let y=$.getModuloIndex(R,t);this._visibleItems.add(this.getWrapper(y))}this._reloadVisibleElements=!1}setPrevious(){this.setIndex(this._index-1)}setNext(){this.setIndex(this._index+1)}getWrapper(t){return this._wrapper.children[t]}getElement(t){let n=this._wrapper.children[t];return n?n.children[0]:null}reload(){this._reloadVisibleElements=!0,this.update()}get element(){let t=this._wrapper.children[this.realIndex];return t?t.children[0]:null}get length(){return this._wrapper.children.length}get property(){return this._horizontal?"x":"y"}get viewportSize(){return this._horizontal?this.w:this.h}get index(){return this._index}get realIndex(){return $.getModuloIndex(this._index,this.length)}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=t,this.update()}get viewportScrollOffset(){return this._viewportScrollOffset}set viewportScrollOffset(t){this._viewportScrollOffset=t,this.update()}get itemScrollOffset(){return this._itemScrollOffset}set itemScrollOffset(t){this._itemScrollOffset=t,this.update()}get scrollTransitionSettings(){return this._scrollTransitionSettings}set scrollTransitionSettings(t){this._scrollTransitionSettings.patch(t)}set scrollTransition(t){this._scrollTransitionSettings.patch(t)}get scrollTransition(){return this._scrollTransition}get progressAnimation(){return this._progressAnimation}set progressAnimation(t){$.isObjectLiteral(t)?this._progressAnimation=this.stage.animations.createSettings(t):this._progressAnimation=t,this.update()}get roll(){return this._roll}set roll(t){this._roll=t,this.update()}get rollMin(){return this._rollMin}set rollMin(t){this._rollMin=t,this.update()}get rollMax(){return this._rollMax}set rollMax(t){this._rollMax=t,this.update()}get invertDirection(){return this._invertDirection}set invertDirection(t){this._started||(this._invertDirection=t)}get horizontal(){return this._horizontal}set horizontal(t){t!==this._horizontal&&(this._started||(this._horizontal=t))}}class qb extends o0{constructor(t){let n=o=>{let u=o.stage.createElement();return u.add(o),u.visible=!1,u};super(t._wrapper._children,n),this.list=t}onAdd(t,n){super.onAdd(t,n),this.checkStarted(n)}checkStarted(t){this.list._reloadVisibleElements=!0,this.list._started?(this.list.length===1?this.list.setIndex(0,!0,!0):this.list._index>=this.list.length&&this.list.setIndex(0),this.list.update()):this.list.start()}onRemove(t,n){super.onRemove(t,n);let o=this.list.realIndex;o===n?(o===this.list.length&&o--,o>=0&&this.list.setIndex(o)):o>n&&this.list.setIndex(o-1),this.list._reloadVisibleElements=!0}onSet(t,n){super.onSet(t,n),this.checkStarted(n)}onSync(t,n,o){super.onSync(t,n,o),this.checkStarted(0)}get _signalProxy(){return!0}}class Tu extends Je{constructor(t){super(t),this._direction=new Float32Array([1,0]),this._kernelRadius=1}get x(){return this._direction[0]}set x(t){this._direction[0]=t,this.redraw()}get y(){return this._direction[1]}set y(t){this._direction[1]=t,this.redraw()}get kernelRadius(){return this._kernelRadius}set kernelRadius(t){this._kernelRadius=t,this.redraw()}useDefault(){return this._kernelRadius===0}setupUniforms(t){super.setupUniforms(t),this._setUniform("direction",this._direction,this.gl.uniform2fv),this._setUniform("kernelRadius",this._kernelRadius,this.gl.uniform1i);const n=t.getRenderWidth(),o=t.getRenderHeight();this._setUniform("resolution",new Float32Array([n,o]),this.gl.uniform2fv)}}Tu.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    uniform vec2 resolution;
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform vec2 direction;
    uniform int kernelRadius;
    
    vec4 blur1(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
        vec4 color = vec4(0.0);
        vec2 off1 = vec2(1.3333333333333333) * direction;
        color += texture2D(image, uv) * 0.29411764705882354;
        color += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;
        color += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;
        return color; 
    }
    
    vec4 blur2(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
        vec4 color = vec4(0.0);
        vec2 off1 = vec2(1.3846153846) * direction;
        vec2 off2 = vec2(3.2307692308) * direction;
        color += texture2D(image, uv) * 0.2270270270;
        color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
        color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
        color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
        color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
        return color;
    }
    
    vec4 blur3(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
        vec4 color = vec4(0.0);
        vec2 off1 = vec2(1.411764705882353) * direction;
        vec2 off2 = vec2(3.2941176470588234) * direction;
        vec2 off3 = vec2(5.176470588235294) * direction;
        color += texture2D(image, uv) * 0.1964825501511404;
        color += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;
        color += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;
        color += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;
        color += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;
        color += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;
        color += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;
        return color;
    }    

    void main(void){
        if (kernelRadius == 1) {
            gl_FragColor = blur1(uSampler, vTextureCoord, resolution, direction) * vColor;
        } else if (kernelRadius == 2) {
            gl_FragColor = blur2(uSampler, vTextureCoord, resolution, direction) * vColor;
        } else {
            gl_FragColor = blur3(uSampler, vTextureCoord, resolution, direction) * vColor;
        }
    }
`;class Ui extends Je{setupUniforms(t){super.setupUniforms(t);const n=1/t.getTextureWidth(0),o=1/t.getTextureHeight(0);this._setUniform("stepTextureCoord",new Float32Array([n,o]),this.gl.uniform2fv)}}Ui.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    uniform vec2 stepTextureCoord;
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec4 vColor;
    varying vec2 vTextureCoordUl;
    varying vec2 vTextureCoordUr;
    varying vec2 vTextureCoordBl;
    varying vec2 vTextureCoordBr;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoordUl = aTextureCoord - stepTextureCoord;
        vTextureCoordBr = aTextureCoord + stepTextureCoord;
        vTextureCoordUr = vec2(vTextureCoordBr.x, vTextureCoordUl.y);
        vTextureCoordBl = vec2(vTextureCoordUl.x, vTextureCoordBr.y);
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;Ui.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoordUl;
    varying vec2 vTextureCoordUr;
    varying vec2 vTextureCoordBl;
    varying vec2 vTextureCoordBr;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    void main(void){
        vec4 color = 0.25 * (texture2D(uSampler, vTextureCoordUl) + texture2D(uSampler, vTextureCoordUr) + texture2D(uSampler, vTextureCoordBl) + texture2D(uSampler, vTextureCoordBr));
        gl_FragColor = color * vColor;
    }
`;class l0 extends vu{constructor(t){super(t),this._kernelRadius=1}get kernelRadius(){return this._kernelRadius}set kernelRadius(t){this._kernelRadius=t,this.redraw()}useDefault(){return this._amount===0}_beforeDrawEl({target:t}){t.ctx.filter="blur("+this._kernelRadius+"px)"}_afterDrawEl({target:t}){t.ctx.filter="none"}}class $b extends Ct{static _template(){return{}}get wrap(){return this.tag("Wrap")}set content(t){return this.wrap.content=t}get content(){return this.wrap.content}set padding(t){this.wrap._paddingX=t,this.wrap._paddingY=t,this.wrap._updateBlurSize()}set paddingX(t){this.wrap._paddingX=t,this.wrap._updateBlurSize()}set paddingY(t){this.wrap._paddingY=t,this.wrap._updateBlurSize()}set amount(t){return this.wrap.amount=t}get amount(){return this.wrap.amount}_onResize(){this.wrap.w=this.renderWidth,this.wrap.h=this.renderHeight}get _signalProxy(){return!0}_build(){this.patch({Wrap:{type:this.stage.gl?Yb:hu}})}}class hu extends Ct{static _template(){return{forceZIndexContext:!0,rtt:!0,Textwrap:{shader:{type:l0},Content:{}}}}constructor(t){super(t),this._textwrap=this.sel("Textwrap"),this._wrapper=this.sel("Textwrap>Content"),this._amount=0,this._paddingX=0,this._paddingY=0}static getSpline(){return this._multiSpline||(this._multiSpline=new xt,this._multiSpline.parse(!1,{0:0,.25:1.5,.5:5.5,.75:18,1:39})),this._multiSpline}get content(){return this.sel("Textwrap>Content")}set content(t){this.sel("Textwrap>Content").patch(t,!0)}set padding(t){this._paddingX=t,this._paddingY=t,this._updateBlurSize()}set paddingX(t){this._paddingX=t,this._updateBlurSize()}set paddingY(t){this._paddingY=t,this._updateBlurSize()}_updateBlurSize(){let t=this.renderWidth,n=this.renderHeight,o=this._paddingX,u=this._paddingY;this._wrapper.x=o,this._textwrap.x=-o,this._wrapper.y=u,this._textwrap.y=-u,this._textwrap.w=t+o*2,this._textwrap.h=n+u*2}get amount(){return this._amount}set amount(t){this._amount=t,this._textwrap.shader.kernelRadius=hu._amountToKernelRadius(t)}static _amountToKernelRadius(t){return hu.getSpline().getValue(Math.min(1,t*.25))}get _signalProxy(){return!0}}class Yb extends Ct{static _template(){const t=function(n,o){if(o._recalc&130){const u=o.w,f=o.h;let m=o;do m=m._children[0],m._element.w=u,m._element.h=f;while(m._children)}};return{Textwrap:{rtt:!0,forceZIndexContext:!0,renderOffscreen:!0,Content:{}},Layers:{L0:{rtt:!0,onUpdate:t,renderOffscreen:!0,visible:!1,Content:{shader:{type:Ui}}},L1:{rtt:!0,onUpdate:t,renderOffscreen:!0,visible:!1,Content:{shader:{type:Ui}}},L2:{rtt:!0,onUpdate:t,renderOffscreen:!0,visible:!1,Content:{shader:{type:Ui}}},L3:{rtt:!0,onUpdate:t,renderOffscreen:!0,visible:!1,Content:{shader:{type:Ui}}}},Result:{shader:{type:u0},visible:!1}}}get _signalProxy(){return!0}constructor(t){super(t),this._textwrap=this.sel("Textwrap"),this._wrapper=this.sel("Textwrap>Content"),this._layers=this.sel("Layers"),this._output=this.sel("Result"),this._amount=0,this._paddingX=0,this._paddingY=0}_buildLayers(){const n=[{x:1,y:0,kernelRadius:1},{x:0,y:1,kernelRadius:1},{x:1.5,y:0,kernelRadius:1},{x:0,y:1.5,kernelRadius:1}].map(o=>Qo.create(this.stage,Object.assign({type:Tu},o)));this._setLayerTexture(this.getLayerContents(0),this._textwrap.getTexture(),[]),this._setLayerTexture(this.getLayerContents(1),this.getLayer(0).getTexture(),[n[0],n[1]]),this._setLayerTexture(this.getLayerContents(2),this.getLayer(1).getTexture(),[n[0],n[1],n[2],n[3]]),this._setLayerTexture(this.getLayerContents(3),this.getLayer(2).getTexture(),[n[0],n[1],n[2],n[3]])}_setLayerTexture(t,n,o){if(!o.length)t.texture=n;else{const u=o.pop(),f=t.stage.c({rtt:!0,shader:u});this._setLayerTexture(f,n,o),t.childList.add(f)}return t}get content(){return this.sel("Textwrap>Content")}set content(t){this.sel("Textwrap>Content").patch(t,!0)}set padding(t){this._paddingX=t,this._paddingY=t,this._updateBlurSize()}set paddingX(t){this._paddingX=t,this._updateBlurSize()}set paddingY(t){this._paddingY=t,this._updateBlurSize()}getLayer(t){return this._layers.sel("L"+t)}getLayerContents(t){return this.getLayer(t).sel("Content")}_onResize(){this._updateBlurSize()}_updateBlurSize(){let t=this.renderWidth,n=this.renderHeight,o=this._paddingX,u=this._paddingY,f=t+o*2,m=n+u*2;this._textwrap.w=f,this._wrapper.x=o,this.getLayer(0).w=this.getLayerContents(0).w=f/2,this.getLayer(1).w=this.getLayerContents(1).w=f/4,this.getLayer(2).w=this.getLayerContents(2).w=f/8,this.getLayer(3).w=this.getLayerContents(3).w=f/16,this._output.x=-o,this._textwrap.x=-o,this._output.w=f,this._textwrap.h=m,this._wrapper.y=u,this.getLayer(0).h=this.getLayerContents(0).h=m/2,this.getLayer(1).h=this.getLayerContents(1).h=m/4,this.getLayer(2).h=this.getLayerContents(2).h=m/8,this.getLayer(3).h=this.getLayerContents(3).h=m/16,this._output.y=-u,this._textwrap.y=-u,this._output.h=m,this.w=t,this.h=n}set amount(t){this._amount=t,this._update()}get amount(){return this._amount}_update(){let t=Math.min(4,Math.max(0,this._amount));t===0?(this._textwrap.renderToTexture=!1,this._output.shader.otherTextureSource=null,this._output.visible=!1):(this._textwrap.renderToTexture=!0,this._output.visible=!0,this.getLayer(0).visible=t>0,this.getLayer(1).visible=t>1,this.getLayer(2).visible=t>2,this.getLayer(3).visible=t>3,t<=1?(this._output.texture=this._textwrap.getTexture(),this._output.shader.otherTextureSource=this.getLayer(0).getTexture(),this._output.shader.a=t):t<=2?(this._output.texture=this.getLayer(0).getTexture(),this._output.shader.otherTextureSource=this.getLayer(1).getTexture(),this._output.shader.a=t-1):t<=3?(this._output.texture=this.getLayer(1).getTexture(),this._output.shader.otherTextureSource=this.getLayer(2).getTexture(),this._output.shader.a=t-2):t<=4&&(this._output.texture=this.getLayer(2).getTexture(),this._output.shader.otherTextureSource=this.getLayer(3).getTexture(),this._output.shader.a=t-3))}set shader(t){super.shader=t,this.renderToTexture||console.warn("[Lightning] Please enable renderToTexture to use with a shader.")}_firstActive(){this._buildLayers()}}class u0 extends Je{constructor(t){super(t),this._a=0,this._otherTextureSource=null}get a(){return this._a}set a(t){this._a=t,this.redraw()}set otherTextureSource(t){this._otherTextureSource=t,this.redraw()}setupUniforms(t){super.setupUniforms(t),this._setUniform("a",this._a,this.gl.uniform1f),this._setUniform("uSampler2",1,this.gl.uniform1i)}beforeDraw(t){let n=this._otherTextureSource?this._otherTextureSource.nativeTexture:null,o=this.gl;o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,n),o.activeTexture(o.TEXTURE0)}}u0.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform sampler2D uSampler2;
    uniform float a;
    void main(void){
        if (a == 1.0) {
            gl_FragColor = texture2D(uSampler2, vTextureCoord) * vColor;
        } else {
            gl_FragColor = ((1.0 - a) * texture2D(uSampler, vTextureCoord) + (a * texture2D(uSampler2, vTextureCoord))) * vColor;
        }
    }
`;class Kb extends Ct{static _template(){const t=function(n,o){if(o._recalc&130){const u=o.w,f=o.h;let m=o;do m=m._children[0],m._element.w=u,m._element.h=f;while(m._children)}};return{Textwrap:{rtt:!0,forceZIndexContext:!0,renderOffscreen:!0,BloomBase:{shader:{type:h0},Content:{}}},Layers:{L0:{rtt:!0,onUpdate:t,scale:2,pivot:0,visible:!1,Content:{shader:{type:Ui}}},L1:{rtt:!0,onUpdate:t,scale:4,pivot:0,visible:!1,Content:{shader:{type:Ui}}},L2:{rtt:!0,onUpdate:t,scale:8,pivot:0,visible:!1,Content:{shader:{type:Ui}}},L3:{rtt:!0,onUpdate:t,scale:16,pivot:0,visible:!1,Content:{shader:{type:Ui}}}}}}get _signalProxy(){return!0}constructor(t){super(t),this._textwrap=this.sel("Textwrap"),this._wrapper=this.sel("Textwrap.Content"),this._layers=this.sel("Layers"),this._amount=0,this._paddingX=0,this._paddingY=0}_build(){const n=[{x:1,y:0,kernelRadius:3},{x:0,y:1,kernelRadius:3},{x:1.5,y:0,kernelRadius:3},{x:0,y:1.5,kernelRadius:3}].map(o=>this.stage.createShader(Object.assign({type:Tu},o)));this._setLayerTexture(this.getLayerContents(0),this._textwrap.getTexture(),[]),this._setLayerTexture(this.getLayerContents(1),this.getLayer(0).getTexture(),[n[0],n[1]]),this._setLayerTexture(this.getLayerContents(2),this.getLayer(1).getTexture(),[n[0],n[1],n[2],n[3]]),this._setLayerTexture(this.getLayerContents(3),this.getLayer(2).getTexture(),[n[0],n[1],n[2],n[3]])}_setLayerTexture(t,n,o){if(!o.length)t.texture=n;else{const u=o.pop(),f=t.stage.c({rtt:!0,shader:u});this._setLayerTexture(f,n,o),t.childList.add(f)}return t}get content(){return this.sel("Textwrap.Content")}set content(t){this.sel("Textwrap.Content").patch(t)}set padding(t){this._paddingX=t,this._paddingY=t,this._updateBlurSize()}set paddingX(t){this._paddingX=t,this._updateBlurSize()}set paddingY(t){this._paddingY=t,this._updateBlurSize()}getLayer(t){return this._layers.sel("L"+t)}getLayerContents(t){return this.getLayer(t).sel("Content")}_onResize(){this._updateBlurSize()}_updateBlurSize(){let t=this.renderWidth,n=this.renderHeight,o=this._paddingX,u=this._paddingY,f=t+o*2,m=n+u*2;this._textwrap.w=f,this._wrapper.x=o,this.getLayer(0).w=this.getLayerContents(0).w=f/2,this.getLayer(1).w=this.getLayerContents(1).w=f/4,this.getLayer(2).w=this.getLayerContents(2).w=f/8,this.getLayer(3).w=this.getLayerContents(3).w=f/16,this._textwrap.x=-o,this._textwrap.h=m,this._wrapper.y=u,this.getLayer(0).h=this.getLayerContents(0).h=m/2,this.getLayer(1).h=this.getLayerContents(1).h=m/4,this.getLayer(2).h=this.getLayerContents(2).h=m/8,this.getLayer(3).h=this.getLayerContents(3).h=m/16,this._textwrap.y=-u,this.w=t,this.h=n}set amount(t){this._amount=t,this._update()}get amount(){return this._amount}_update(){let t=Math.min(4,Math.max(0,this._amount));t>0&&(this.getLayer(0).visible=t>0,this.getLayer(1).visible=t>1,this.getLayer(2).visible=t>2,this.getLayer(3).visible=t>3)}set shader(t){super.shader=t,this.renderToTexture||console.warn("[Lightning] Please enable renderToTexture to use with a shader.")}_firstActive(){this._build()}}class h0 extends Je{}h0.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    void main(void){
        vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
        float m = max(max(color.r, color.g), color.b);
        float c = max(0.0, (m - 0.80)) * 5.0;
        color = color * c;
        gl_FragColor = color;
    }
`;class cu extends Ct{static _template(){return{ContentWrap:{renderOffscreen:!0,forceZIndexContext:!0,onAfterUpdate:cu._updateDimensions,Content:{}},Scale:{visible:!1}}}constructor(t){super(t),this._smoothScale=1,this._iterations=0}get content(){return this.tag("Content")}set content(t){this.tag("Content").patch(t,!0)}get smoothScale(){return this._smoothScale}set smoothScale(t){if(this._smoothScale!==t){let n=0;for(;t<.5&&n<12;)n++,t=t*2;this.scale=t,this._setIterations(n),this._smoothScale=t}}_setIterations(t){if(this._iterations!==t){const n=this.sel("Scale").childList,o=this.sel("ContentWrap");for(;n.length<t;){const m=n.length===0?o.getTexture():n.last.getTexture();n.a({rtt:!0,renderOffscreen:!0,texture:m})}cu._updateDimensions(this.tag("ContentWrap"),!0);const u=t>0;this.patch({ContentWrap:{renderToTexture:u},Scale:{visible:u}});for(let f=0,m=n.length;f<m;f++)n.getAt(f).patch({visible:f<t,renderOffscreen:f!==t-1});this._iterations=t}}static _updateDimensions(t,n){const o=t.children[0];let u=o.renderWidth,f=o.renderHeight;if(u!==t.w||f!==t.h||n){t.w=u,t.h=f;const m=t.parent.tag("Scale").children;for(let p=0,v=m.length;p<v;p++)u=u*.5,f=f*.5,m[p].w=u,m[p].h=f}}get _signalProxy(){return!0}}class Zb extends Ct{static _template(){return{Content:{},Borders:{Top:{rect:!0,visible:!1,mountY:1},Right:{rect:!0,visible:!1},Bottom:{rect:!0,visible:!1},Left:{rect:!0,visible:!1,mountX:1}}}}get _signalProxy(){return!0}constructor(t){super(t),this._borderTop=this.tag("Top"),this._borderRight=this.tag("Right"),this._borderBottom=this.tag("Bottom"),this._borderLeft=this.tag("Left"),this.onAfterUpdate=function(n){const o=n.childList.first;let u=n.core.w||o.renderWidth,f=n.core.h||o.renderHeight;n._borderTop.w=u,n._borderBottom.y=f,n._borderBottom.w=u,n._borderLeft.h=f+n._borderTop.h+n._borderBottom.h,n._borderLeft.y=-n._borderTop.h,n._borderRight.x=u,n._borderRight.h=f+n._borderTop.h+n._borderBottom.h,n._borderRight.y=-n._borderTop.h},this.borderWidth=1}get content(){return this.sel("Content")}set content(t){this.sel("Content").patch(t,!0)}get borderWidth(){return this.borderWidthTop}get borderWidthTop(){return this._borderTop.h}get borderWidthRight(){return this._borderRight.w}get borderWidthBottom(){return this._borderBottom.h}get borderWidthLeft(){return this._borderLeft.w}set borderWidth(t){this.borderWidthTop=t,this.borderWidthRight=t,this.borderWidthBottom=t,this.borderWidthLeft=t}set borderWidthTop(t){this._borderTop.h=t,this._borderTop.visible=t>0}set borderWidthRight(t){this._borderRight.w=t,this._borderRight.visible=t>0}set borderWidthBottom(t){this._borderBottom.h=t,this._borderBottom.visible=t>0}set borderWidthLeft(t){this._borderLeft.w=t,this._borderLeft.visible=t>0}get colorBorder(){return this.colorBorderTop}get colorBorderTop(){return this._borderTop.color}get colorBorderRight(){return this._borderRight.color}get colorBorderBottom(){return this._borderBottom.color}get colorBorderLeft(){return this._borderLeft.color}set colorBorder(t){this.colorBorderTop=t,this.colorBorderRight=t,this.colorBorderBottom=t,this.colorBorderLeft=t}set colorBorderTop(t){this._borderTop.color=t}set colorBorderRight(t){this._borderRight.color=t}set colorBorderBottom(t){this._borderBottom.color=t}set colorBorderLeft(t){this._borderLeft.color=t}get borderTop(){return this._borderTop}set borderTop(t){this.borderTop.patch(t)}get borderRight(){return this._borderRight}set borderRight(t){this.borderRight.patch(t)}get borderBottom(){return this._borderBottom}set borderBottom(t){this.borderBottom.patch(t)}get borderLeft(){return this._borderLeft}set borderLeft(t){this.borderLeft.patch(t)}set borders(t){this.borderTop=t,this.borderLeft=t,this.borderBottom=t,this.borderRight=t}}class uf extends Je{constructor(t){super(t),this._amount=1}static getC2d(){return c0}set amount(t){this._amount=t,this.redraw()}get amount(){return this._amount}useDefault(){return this._amount===0}setupUniforms(t){super.setupUniforms(t),this._setUniform("amount",this._amount,this.gl.uniform1f)}}uf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform float amount;
    void main(void){
        vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
        float grayness = 0.2 * color.r + 0.6 * color.g + 0.2 * color.b;
        gl_FragColor = vec4(amount * vec3(grayness, grayness, grayness) + (1.0 - amount) * color.rgb, color.a);
    }
`;class c0 extends vu{constructor(t){super(t),this._amount=1}static getWebGL(){return uf}set amount(t){this._amount=t,this.redraw()}get amount(){return this._amount}useDefault(){return this._amount===0}_beforeDrawEl({target:t}){t.ctx.filter="grayscale("+this._amount+")"}_afterDrawEl({target:t}){t.ctx.filter="none"}}class hf extends Je{constructor(t){super(t),this._noiseTexture=new a0(t.stage),this._graining=1/256,this._random=!1}set graining(t){this._graining=t,this.redraw()}set random(t){this._random=t,this.redraw()}setExtraAttribsInBuffer(t){this._noiseTexture.load();let n=t.extraAttribsDataByteOffset/4,o=t.quads.floats,u=t.length;for(let f=0;f<u;f++){let m=t.getElementWidth(f)/this._noiseTexture.getRenderWidth(),p=t.getElementHeight(f)/this._noiseTexture.getRenderHeight(),v=0,w=0;if(this._random){if(v=Math.random(),w=Math.random(),m+=v,p+=w,Math.random()<.5){const C=v;v=m,m=C}if(Math.random()<.5){const C=w;w=p,p=C}}o[n]=v,o[n+1]=w,o[n+2]=m,o[n+3]=w,o[n+4]=m,o[n+5]=p,o[n+6]=v,o[n+7]=p,n+=8}}beforeDraw(t){let n=this.gl;n.vertexAttribPointer(this._attrib("aNoiseTextureCoord"),2,n.FLOAT,!1,8,this.getVertexAttribPointerOffset(t));let o=this._noiseTexture.source.nativeTexture;n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,o),n.activeTexture(n.TEXTURE0)}getExtraAttribBytesPerVertex(){return 8}setupUniforms(t){super.setupUniforms(t),this._setUniform("uNoiseSampler",1,this.gl.uniform1i),this._setUniform("graining",2*this._graining,this.gl.uniform1f)}enableAttribs(){super.enableAttribs(),this.gl.enableVertexAttribArray(this._attrib("aNoiseTextureCoord"))}disableAttribs(){super.disableAttribs(),this.gl.disableVertexAttribArray(this._attrib("aNoiseTextureCoord"))}useDefault(){return this._graining===0}afterDraw(t){this._random&&this.redraw()}}hf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec2 aNoiseTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec2 vNoiseTextureCoord;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vNoiseTextureCoord = aNoiseTextureCoord;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;hf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec2 vNoiseTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform sampler2D uNoiseSampler;
    uniform float graining;
    void main(void){
        vec4 noise = texture2D(uNoiseSampler, vNoiseTextureCoord);
        vec4 color = texture2D(uSampler, vTextureCoord);
        gl_FragColor = (color * vColor) + graining * (noise.r - 0.5);
    }
`;class cf extends Je{constructor(t){super(t),this._inputValue=0,this._maxDerivative=.01,this._normalizedValue=0,this._offset=0,this._amount=.1,this._aspectRatio=1,this._offsetX=0,this._offsetY=0,this.buckets=100}get aspectRatio(){return this._aspectRatio}set aspectRatio(t){this._aspectRatio=t,this.redraw()}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this.redraw()}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this.redraw()}set amount(t){this._amount=t,this.redraw()}get amount(){return this._amount}set inputValue(t){this._inputValue=t}get inputValue(){return this._inputValue}set maxDerivative(t){this._maxDerivative=t}get maxDerivative(){return this._maxDerivative}set buckets(t){t>100&&(console.warn("[Lightning] CircularPushShader: supports max 100 buckets"),t=100),this._buckets=t,this._values=new Uint8Array(this._getValues(t)),this.redraw()}get buckets(){return this._buckets}_getValues(t){const n=[];for(let o=0;o<t;o++)n.push(this._inputValue);return n}progress(t){this._offset+=t*this._buckets;const n=Math.floor(this._offset);this._offset-=n,this._shiftBuckets(n),this.redraw()}_shiftBuckets(t){for(let n=this._buckets-1;n>=0;n--){const o=n-t;o<0?(this._normalizedValue=Math.min(this._normalizedValue+this._maxDerivative,Math.max(this._normalizedValue-this._maxDerivative,this._inputValue)),this._values[n]=255*this._normalizedValue):this._values[n]=this._values[o]}}set offset(t){this._offset=t,this.redraw()}setupUniforms(t){super.setupUniforms(t),this._setUniform("aspectRatio",this._aspectRatio,this.gl.uniform1f),this._setUniform("offsetX",this._offsetX,this.gl.uniform1f),this._setUniform("offsetY",this._offsetY,this.gl.uniform1f),this._setUniform("amount",this._amount,this.gl.uniform1f),this._setUniform("offset",this._offset,this.gl.uniform1f),this._setUniform("buckets",this._buckets,this.gl.uniform1f),this._setUniform("uValueSampler",1,this.gl.uniform1i)}useDefault(){return this._amount===0}beforeDraw(t){const n=this.gl;n.activeTexture(n.TEXTURE1),this._valuesTexture?n.bindTexture(n.TEXTURE_2D,this._valuesTexture):(this._valuesTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this._valuesTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),$.isNode&&n.pixelStorei(n.UNPACK_FLIP_BLUE_RED,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this._buckets,1,0,n.ALPHA,n.UNSIGNED_BYTE,this._values),n.activeTexture(n.TEXTURE0)}cleanup(){this._valuesTexture&&this.gl.deleteTexture(this._valuesTexture)}}cf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    uniform float offsetX;
    uniform float offsetY;
    uniform float aspectRatio;
    varying vec2 vTextureCoord;
    varying vec2 vPos;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vPos = vTextureCoord * 2.0 - 1.0;
        vPos.y = vPos.y * aspectRatio;
        vPos.y = vPos.y + offsetY;
        vPos.x = vPos.x + offsetX;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;cf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    varying vec2 vPos;
    uniform float amount;
    uniform float offset;
    uniform float values[100];
    uniform float buckets;
    uniform sampler2D uSampler;
    uniform sampler2D uValueSampler;
    void main(void){
        float l = length(vPos);
        float m = (l * buckets * 0.678 - offset) / buckets;
        float f = texture2D(uValueSampler, vec2(m, 0.0)).a * amount;
        vec2 unit = vPos / l;
        gl_FragColor = texture2D(uSampler, vTextureCoord - f * unit) * vColor;
    }
`;class d0 extends Je{constructor(t){super(t),this._amount=1}set amount(t){this._amount=t,this.redraw()}get amount(){return this._amount}useDefault(){return this._amount===0}setupUniforms(t){super.setupUniforms(t),this._setUniform("amount",this._amount,this.gl.uniform1f)}}d0.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform float amount;
    void main(void){
        vec4 color = texture2D(uSampler, vTextureCoord);
        color.rgb = color.rgb * (1.0 - amount) + amount * (1.0 * color.a - color.rgb); 
        gl_FragColor = color * vColor;
    }
`;class df extends Je{constructor(t){super(t),this._width=5,this._col=4294967295,this._color=[1,1,1,1]}set width(t){this._width=t,this.redraw()}get color(){return this._col}set color(t){if(this._col!==t){const n=Te.getRgbaComponentsNormalized(t);n[0]=n[0]*n[3],n[1]=n[1]*n[3],n[2]=n[2]*n[3],this._color=n,this.redraw(),this._col=t}}useDefault(){return this._width===0||this._col[3]===0}setupUniforms(t){super.setupUniforms(t);let n=this.gl;this._setUniform("color",new Float32Array(this._color),n.uniform4fv)}enableAttribs(){super.enableAttribs(),this.gl.enableVertexAttribArray(this._attrib("aCorner"))}disableAttribs(){super.disableAttribs(),this.gl.disableVertexAttribArray(this._attrib("aCorner"))}setExtraAttribsInBuffer(t){let n=t.extraAttribsDataByteOffset/4,o=t.quads.floats,u=t.length;for(let f=0;f<u;f++){const m=t.getElementCore(f),p=this._width/m.w,v=p/(1-2*p),w=this._width/m.h,C=w/(1-2*w);o[n]=-v,o[n+1]=-C,o[n+2]=1+v,o[n+3]=-C,o[n+4]=1+v,o[n+5]=1+C,o[n+6]=-v,o[n+7]=1+C,n+=8}}beforeDraw(t){let n=this.gl;n.vertexAttribPointer(this._attrib("aCorner"),2,n.FLOAT,!1,8,this.getVertexAttribPointerOffset(t))}getExtraAttribBytesPerVertex(){return 8}}df.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    attribute vec2 aCorner;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec2 vCorner;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vCorner = aCorner;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;df.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    varying vec2 vCorner;
    uniform vec4 color;
    uniform sampler2D uSampler;
    void main(void){
        vec2 m = min(vCorner, 1.0 - vCorner);
        float value = step(0.0, min(m.x, m.y));
        gl_FragColor = mix(color, texture2D(uSampler, vTextureCoord) * vColor, value);
    }
`;class ff extends Je{constructor(t){super(t),this._size=new Float32Array([4,4])}get x(){return this._size[0]}set x(t){this._size[0]=t,this.redraw()}get y(){return this._size[1]}set y(t){this._size[1]=t,this.redraw()}get size(){return this._size[0]}set size(t){this._size[0]=t,this._size[1]=t,this.redraw()}useDefault(){return this._size[0]===0&&this._size[1]===0}static getWebGLImpl(){return WebGLPixelateShaderImpl}setupUniforms(t){super.setupUniforms(t);let n=this.gl;this._setUniform("size",new Float32Array(this._size),n.uniform2fv)}getExtraAttribBytesPerVertex(){return 8}enableAttribs(){super.enableAttribs(),this.gl.enableVertexAttribArray(this._attrib("aTextureRes"))}disableAttribs(){super.disableAttribs(),this.gl.disableVertexAttribArray(this._attrib("aTextureRes"))}setExtraAttribsInBuffer(t){let n=t.extraAttribsDataByteOffset/4,o=t.quads.floats,u=t.length;for(let f=0;f<u;f++){let m=t.quads.getTextureWidth(t.index+f),p=t.quads.getTextureHeight(t.index+f);o[n]=m,o[n+1]=p,o[n+2]=m,o[n+3]=p,o[n+4]=m,o[n+5]=p,o[n+6]=m,o[n+7]=p,n+=8}}beforeDraw(t){let n=this.gl;n.vertexAttribPointer(this._attrib("aTextureRes"),2,n.FLOAT,!1,this.getExtraAttribBytesPerVertex(),this.getVertexAttribPointerOffset(t))}}ff.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    attribute vec2 aTextureRes;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    varying vec2 vTextureRes;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vColor = aColor;
        vTextureRes = aTextureRes;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;ff.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    varying vec2 vTextureRes;

    uniform vec2 size;
    uniform sampler2D uSampler;
    
    vec2 mapCoord( vec2 coord )
    {
        coord *= vTextureRes.xy;
        return coord;
    }
    
    vec2 unmapCoord( vec2 coord )
    {
        coord /= vTextureRes.xy;
        return coord;
    }
    
    vec2 pixelate(vec2 coord, vec2 size)
    {
        return floor( coord / size ) * size;
    }
    
    void main(void)
    {
        vec2 coord = mapCoord(vTextureCoord);
        coord = pixelate(coord, size);
        coord = unmapCoord(coord);
        gl_FragColor = texture2D(uSampler, coord) * vColor;
    }
`;class pf extends Je{constructor(t){super(t),this._radius=0,this._cutoff=1}set radius(t){this._radius=t,this.redraw()}get radius(){return this._radius}set cutoff(t){this._cutoff=t,this.redraw()}get cutoff(){return this._cutoff}useDefault(){return this._radius===0}setupUniforms(t){super.setupUniforms(t),this._setUniform("radius",2*(this._radius-.5)/t.getRenderWidth(),this.gl.uniform1f),this._setUniform("cutoff",.5*t.getRenderWidth()/this._cutoff,this.gl.uniform1f)}}pf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 pos;
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
        pos = gl_Position.xy;
    }
`;pf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec2 pos;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform float radius;
    uniform float cutoff;
    void main(void){
        vec4 color = texture2D(uSampler, vTextureCoord);
        float f = max(0.0, min(1.0, 1.0 - (length(pos) - radius) * cutoff));
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor * f;
    }
`;class gf extends Je{constructor(t){super(t),this._blend=0,this._radius=[1,1,1,1],this._stroke=0,this._fc=16777215,this._fillColor=this._getNormalizedColor(4294967295),this._strokeColor=this._getNormalizedColor(16777215)}set blend(t){this._blend=Math.min(Math.max(t,0),1)}set radius(t){Array.isArray(t)?t.length===2?this._radius=[t[0],t[1],t[0],t[1]]:t.length===3?this._radius=[t[0],t[1],t[2],this._radius[3]]:t.length===4?this._radius=t:this._radius=[t[0],t[0],t[0],t[0]]:this._radius=[t,t,t,t],this.redraw()}get radius(){return this._radius}set topLeft(t){this._radius[0]=t,this.redraw()}get topLeft(){return this._radius[0]}set topRight(t){this._radius[1]=t,this.redraw()}get topRight(){return this._radius[1]}set bottomRight(t){this._radius[2]=t,this.redraw()}get bottomRight(){return this._radius[2]}set bottomLeft(t){this._radius[3]=t,this.redraw()}get bottomLeft(){return this._radius[4]}set strokeColor(t){this._sc=t,this._strokeColor=this._getNormalizedColor(t),this.redraw()}get strokeColor(){return this._sc}set fillColor(t){this._fc=t,this._fillColor=this._getNormalizedColor(t),this.redraw()}get fillColor(){return this._fc}set stroke(t){this._stroke=t,this.redraw()}get stroke(){return this._stroke}_getNormalizedColor(t){const n=Te.getRgbaComponentsNormalized(t);return n[0]*=n[3],n[1]*=n[3],n[2]*=n[3],new Float32Array(n)}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=this.ctx.stage.getRenderPrecision(),u=this._radius.map(f=>(f+.5)*o);this._setUniform("radius",new Float32Array(u),this.gl.uniform4fv),this._setUniform("alpha",t.getElementCore(0).renderContext.alpha,this.gl.uniform1f),this._setUniform("blend",this._blend,this.gl.uniform1f),this._setUniform("strokeColor",this._strokeColor,this.gl.uniform4fv),this._setUniform("fillColor",this._fillColor,this.gl.uniform4fv),this._setUniform("stroke",this._stroke*o,this.gl.uniform1f),this._setUniform("resolution",new Float32Array([n._w*o,n._h*o]),this.gl.uniform2fv)}}gf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;

    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;

    void main(void){
        gl_Position = vec4(aVertexPosition.x * projection.x - 1.0, aVertexPosition.y * -abs(projection.y) + 1.0, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
        vColor = aColor;
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;gf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif

    #define PI 3.14159265359

    varying vec2 vTextureCoord;
    varying vec4 vColor;

    uniform sampler2D uSampler;
    uniform vec2 resolution;
    uniform vec4 radius;
    uniform float stroke;
    uniform vec4 strokeColor;
    uniform vec4 fillColor;
    uniform float alpha;
    uniform float fill;
    uniform float blend;
    
    float boxDist(vec2 p, vec2 size, float radius){
        size -= vec2(radius);
        vec2 d = abs(p) - size;
        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;
    }
    
    float fillMask(float dist){
        return clamp(-dist, 0.0, 1.0);
    }
    
    float innerBorderMask(float dist, float width){
        float alpha1 = clamp(dist + width, 0.0, 1.0);
        float alpha2 = clamp(dist, 0.0, 1.0);
        return alpha1 - alpha2;
    }

    void main() {
        vec2 halfRes = 0.5 * resolution.xy;
        float r = 0.0;
        if (vTextureCoord.x < 0.5 && vTextureCoord.y < 0.5) {
            r = radius[0];
        } else if (vTextureCoord.x >= 0.5 && vTextureCoord.y < 0.5) {
            r = radius[1];
        } else if (vTextureCoord.x >= 0.5 && vTextureCoord.y >= 0.5) {
            r = radius[2];
        } else {
            r = radius[3];
        }
        
        float b = boxDist(vTextureCoord.xy * resolution - halfRes, halfRes - 0.005, r);
        vec4 tex = texture2D(uSampler, vTextureCoord) * vColor;
        vec4 blend = mix(vec4(1.0) * alpha, tex, blend);     
        vec4 layer1 = mix(vec4(0.0), tex * fillColor, fillMask(b));
        gl_FragColor = mix(layer1, blend * strokeColor, innerBorderMask(b, stroke));
    }
`;class f0 extends Je{constructor(t){super(t),this._fade=[0,0,0,0]}set top(t){this._fade[0]=t,this.redraw()}get top(){return this._fade[0]}set right(t){this._fade[1]=t,this.redraw()}get right(){return this._fade[1]}set bottom(t){this._fade[2]=t,this.redraw()}get bottom(){return this._fade[2]}set left(t){this._fade[3]=t,this.redraw()}get left(){return this._fade[3]}set fade(t){Array.isArray(t)?t.length===2?this._fade=[t[0],t[1],t[0],t[1]]:t.length===3?this._fade=[t[0],t[1],t[2],this._fade[3]]:t.length===4?this._fade=t:this._fade=[t[0],t[0],t[0],t[0]]:this._fade=[t,t,t,t],this.redraw()}get fade(){return this._fade}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=this.ctx.stage.getRenderPrecision(),u=this._fade.map(f=>f*o);this._setUniform("fade",new Float32Array(u),this.gl.uniform4fv),this._setUniform("resolution",new Float32Array([n._w*o,n._h*o]),this.gl.uniform2fv)}}f0.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform vec2 resolution;
    uniform vec4 fade;
    
    void main() {
        vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
        vec2 halfRes = 0.5 * resolution.xy;
        vec2 point = vTextureCoord.xy * resolution.xy;
        
        vec2 pos1;
        vec2 pos2;
        vec2 d;
        float c;
        float t = 0.0;
             
        if(fade[0] > 0.0) {
            pos1 = vec2(point.x, point.y);
            pos2 = vec2(point.x, point.y + fade[0]);
            d = pos2 - pos1;
            c = dot(pos1, d) / dot(d, d);
            t = smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0));
            color = mix(vec4(0.0), color, t);
        }
        
        if(fade[1] > 0.0) {
            vec2 pos1 = vec2(point.x - resolution.x - fade[1], vTextureCoord.y);
            vec2 pos2 = vec2(point.x - resolution.x, vTextureCoord.y);
            d = pos1 - pos2;
            c = dot(pos2, d) / dot(d, d);
            t = smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0));
            color = mix(vec4(0.0), color, t);
        }
        
        if(fade[2] > 0.0) {
            vec2 pos1 = vec2(vTextureCoord.x, point.y - resolution.y - fade[2]);
            vec2 pos2 = vec2(vTextureCoord.x, point.y - resolution.y);
            d = pos1 - pos2;
            c = dot(pos2, d) / dot(d, d);
            t = smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0));
            color = mix(vec4(0.0), color, t);
        }
        
        if(fade[3] > 0.0) {
            pos1 = vec2(point.x, point.y);
            pos2 = vec2(point.x + fade[3], point.y);
            d = pos2 - pos1;
            c = dot(pos1, d) / dot(d, d);
            t = smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0));
            color = mix(vec4(0.0), color, t);
        }
        
        gl_FragColor = color;
    }
`;class mf extends Je{constructor(t){super(t),this._magnitude=1.3,this._intensity=.7,this._pivot=[.5,.5]}setupUniforms(t){super.setupUniforms(t),this._setUniform("magnitude",this._magnitude,this.gl.uniform1f),this._setUniform("intensity",this._intensity,this.gl.uniform1f),this._setUniform("pivot",new Float32Array(this._pivot),this.gl.uniform2fv),this.redraw()}set pivot(t){Array.isArray(t)?this._pivot=t:this._pivot=[t,t],this.redraw()}get pivotX(){return this._pivot[0]}set pivotX(t){this._pivot[0]=t,this.redraw()}get pivotY(){return this._pivot[1]}set pivotY(t){this._pivot[1]=t,this.redraw()}get intensity(){return this._intensity}set intensity(t){this._intensity=t,this.redraw()}get magnitude(){return this._magnitude}set magnitude(t){this._magnitude=t,this.redraw()}}mf.vertexShaderSource=Je.vertexShaderSource;mf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;

    uniform float magnitude;
    uniform float intensity;
    uniform vec2 pivot;

    void main() {
        vec2 uv = vTextureCoord.xy - pivot + vec2(0.5);
        uv.x = clamp(uv.x, 0.0, 1.0);
        uv.y = clamp(uv.y, 0.0, 1.0);
   
        uv *=  1.00 - uv.yx;
        float vig = uv.x * uv.y * 25.0 * intensity;
        vig = pow(vig, 0.45 * magnitude);
        vec4 fragColor = vec4(vig) * vColor;
        gl_FragColor = texture2D(uSampler, vTextureCoord) * fragColor;

    }
`;class _f extends Je{constructor(t){super(t),this._radius=100,this._width=50,this._period=1,this._angle=.5,this._smooth=.005,this._color=4294967295,this._backgroundColor=4278190080,this._time=Date.now()}set radius(t){this._radius=t,this.redraw()}set width(t){this._width=t,this.redraw()}set period(t){this._period=t,this.redraw()}set angle(t){this._angle=t,this.redraw()}set smooth(t){this._smooth=t,this.redraw()}set color(t){this._color=t,this.redraw()}set backgroundColor(t){this._backgroundColor=t,this.redraw()}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner;this._setUniform("iTime",Date.now()-this._time,this.gl.uniform1f);const o=this.ctx.stage.getRenderPrecision();this._setUniform("radius",this._radius*o,this.gl.uniform1f),this._setUniform("width",this._width*o,this.gl.uniform1f),this._setUniform("period",this._period,this.gl.uniform1f),this._setUniform("angle",this._angle,this.gl.uniform1f),this._setUniform("smooth",this._smooth,this.gl.uniform1f),this._setUniform("color",new Float32Array(Te.getRgbaComponentsNormalized(this._color)),this.gl.uniform4fv),this._setUniform("backgroundColor",new Float32Array(Te.getRgbaComponentsNormalized(this._backgroundColor)),this.gl.uniform4fv),this._setUniform("resolution",new Float32Array([n._w*o,n._h*o]),this.gl.uniform2fv),this.redraw()}}_f.vertexShaderSource=Je.vertexShaderSource;_f.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;

    uniform float iTime;
    uniform float radius;
    uniform float width;
    uniform float period;
    uniform float angle;
    uniform float smooth;
    uniform vec2 resolution;

    uniform vec4 color;
    uniform vec4 backgroundColor;

    float ratio = resolution.y / resolution.x;

    vec2 transpose_pos(vec2 pos) {
        if (ratio < 1.) {
            float diff = 0.5 - pos.x;
            pos.x = 0.5 - diff / ratio;
        } else {
            float diff = 0.5 - pos.y;
            pos.y = 0.5 - diff * ratio;
        }
        return pos;
    }

    float get_angle(vec2 pos) {
        pos = transpose_pos(pos);
        float a = atan(pos.y - 0.5, pos.x - 0.5);
        a = (1.0+a/3.14159)/2.0;
        
        return a;
    }

    float dist(vec2 pos1, vec2 pos2) {
        pos1 = transpose_pos(pos1);
        return distance(pos1, pos2);
    }

    void main()
    {
        vec2 fragCoord = vTextureCoord;
        vec4 fragColor = vColor;
        
        vec2 st = vTextureCoord;
        float pct = dist(st, vec2(0.5));

        float a = get_angle(st);
        float t = iTime / 1000.0 / period;

        float inner = max((radius - width) / resolution.x, (radius - width) / resolution.y);
        float outer = max(radius / resolution.x, radius / resolution.y);

        float x1 = mod(t, 1.0);
        float x2 = mod(t + angle, 1.0);

        if (x1 < x2) {
            if (a > x1 && a < x2) {
                float val = (1.0 - (x2 - a) / angle) * smoothstep(0.0, 3. * smooth, (x2 - a));
                fragColor = mix(backgroundColor, color, val);
            } else {
                fragColor = backgroundColor;
            }
        } else {
            if (a < x2) {
                float val = (1.0 - (x2 - a) / angle) * smoothstep(0.0, 3. * smooth, (x2 - a));
                fragColor = mix(backgroundColor, color, val);
            } else if (a > x1) {
                float val = (1.0 - (1.0 + x2 - a) / angle) * smoothstep(0.0, 3. * smooth, (1.0 + x2 - a));
                fragColor = mix(backgroundColor, color, val);
            } else {
                fragColor = backgroundColor;
            }
        }

        float s = smoothstep(inner, inner + smooth + 0.00001, pct) * (1.0 - smoothstep(outer, outer + smooth + 0.00001, pct));
        gl_FragColor = texture2D(uSampler, fragCoord) * vColor * (1. - s * fragColor.a) + fragColor * s;
    }
`;class yf extends Je{constructor(t){super(t),this._x=0,this._y=0,this._w=0,this._h=0,this._radius=0}get x(){return this._x}set x(t){this._x=t,this.redraw()}get y(){return this._y}set y(t){this._y=t,this.redraw()}get w(){return this._w}set w(t){this._w=t,this.redraw()}get h(){return this._h}set h(t){this._h=t,this.redraw()}get radius(){return this._radius}set radius(t){this._radius=t,this.redraw()}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=this.ctx.stage.getRenderPrecision();this._setUniform("x",this._x*o,this.gl.uniform1f),this._setUniform("y",this._y*o,this.gl.uniform1f),this._setUniform("w",this._w*o,this.gl.uniform1f),this._setUniform("h",this._h*o,this.gl.uniform1f),this._setUniform("radius",(this._radius+.5)*o,this.gl.uniform1f),this._setUniform("resolution",new Float32Array([n._w*o,n._h*o]),this.gl.uniform2fv)}useDefault(){return this._x===0&&this._y===0&&this._w===0&&this._h===0}}yf.vertexShaderSource=Je.vertexShaderSource;yf.fragmentShaderSource=`
   #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform float x;
    uniform float y;
    uniform float w;
    uniform float h;
    uniform vec2 resolution;
    uniform float radius;

    float roundBox(vec2 p, vec2 b, float r) {
        float d = length(max(abs(p)-b+r, 0.1))-r;
        return smoothstep(1.0, 0.0, d);
    }

    void main(void){
        vec4 color = texture2D(uSampler, vTextureCoord);
        vec2 pos = vTextureCoord.xy * resolution - vec2(x, y) - vec2(w, h) / 2.0;
        vec2 size = vec2(w, h) / 2.0;
        float b = roundBox(pos, size, radius);
        gl_FragColor = mix(color, vec4(0.0), b);
    }
`;class p0 extends Je{constructor(t){super(t),this._pivot=[0,0],this._ic=4294967295,this._normalizedIC=this._getNormalizedColor(this._ic),this._oc=16777215,this._normalizedOC=this._getNormalizedColor(this._oc),this._radius=0}set radiusX(t){this.radius=t}get radiusX(){return this._radius}set radiusY(t){this._radiusY=t,this.redraw()}get radiusY(){return this._radiusY}set radius(t){this._radius=t,this.redraw()}set innerColor(t){this._ic=t,this._normalizedIC=this._getNormalizedColor(t),this.redraw()}get innerColor(){return this._ic}set outerColor(t){this._oc=t,this._normalizedOC=this._getNormalizedColor(t),this.redraw()}set color(t){this.innerColor=t}get color(){return this.innerColor}get outerColor(){return this._ic}set x(t){this._x=t,this.redraw()}set y(t){this._y=t,this.redraw()}set pivot(t){Array.isArray(t)&&t.length===2?this._pivot=t:Array.isArray(t)?this._pivot=[t[0],t[1]||t[0]]:this._pivot=[t,t],this.redraw()}get pivot(){return this._pivot[0]}set pivotY(t){this._pivot[1]=t,this.redraw()}get pivotY(){return this._pivot[1]}set pivotX(t){this._pivot[0]=t,this.redraw()}get pivotX(){return this._pivot[0]}_getNormalizedColor(t){const n=Te.getRgbaComponentsNormalized(t);return n[0]*=n[3],n[1]*=n[3],n[2]*=n[3],new Float32Array(n)}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner;this._x&&(this._pivot[0]=this._x/n.w),this._y&&(this._pivot[1]=this._y/n.h),this._radius===0&&(this._radius=n.w*.5),this._setUniform("innerColor",this._normalizedIC,this.gl.uniform4fv),this._setUniform("fill",Te.getRgbaComponentsNormalized(this._oc)[3],this.gl.uniform1f),this._setUniform("outerColor",this._normalizedOC,this.gl.uniform4fv),this._setUniform("pivot",new Float32Array(this._pivot),this.gl.uniform2fv),this._setUniform("resolution",new Float32Array([n._w,n._h]),this.gl.uniform2fv),this._setUniform("alpha",t.getElementCore(0).renderContext.alpha,this.gl.uniform1f),this._setUniform("radius",this._radius,this.gl.uniform1f),this._setUniform("radiusY",this._radiusY||this._radius,this.gl.uniform1f)}}p0.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    
    #define PI 3.14159265359
    
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform vec2 resolution;
    uniform vec2 pivot;
    uniform vec4 innerColor;
    uniform vec4 outerColor;
    uniform float radius;
    uniform float radiusY;
    uniform float alpha;
    uniform float fill;
    uniform float aspectRatio;
    
    void main() {
        vec2 point = vTextureCoord.xy * resolution;
        vec2 projection = vec2(pivot.x * resolution.x, pivot.y * resolution.y);
        float d = length((point - projection) / vec2(radius * 2.0, radiusY * 2.0));
        vec4 color = mix(texture2D(uSampler, vTextureCoord) * vColor, outerColor * alpha, fill);
        gl_FragColor = mix(innerColor * alpha, color, smoothstep(0.0, 1.0, d));
    }
`;class xf extends Je{constructor(t){super(t),this._strength=.5,this._ambient=.5,this._fudge=.4,this._rx=0,this._ry=0,this._z=0,this._pivotX=NaN,this._pivotY=NaN,this._pivotZ=0,this._lightY=0,this._lightZ=0}setupUniforms(t){super.setupUniforms(t);let n=t.shaderOwner,o=n.element,u=isNaN(this._pivotX)?o.pivotX*n.w:this._pivotX,f=isNaN(this._pivotY)?o.pivotY*n.h:this._pivotY,m=n.getRenderTextureCoords(u,f),p=-Math.atan2(n._renderContext.tc,n._renderContext.ta),v=this.gl;this._setUniform("pivot",new Float32Array([m[0],m[1],this._pivotZ]),v.uniform3fv),this._setUniform("rot",new Float32Array([this._rx,this._ry,p]),v.uniform3fv),this._setUniform("z",this._z,v.uniform1f),this._setUniform("lightY",this.lightY,v.uniform1f),this._setUniform("lightZ",this.lightZ,v.uniform1f),this._setUniform("strength",this._strength,v.uniform1f),this._setUniform("ambient",this._ambient,v.uniform1f),this._setUniform("fudge",this._fudge,v.uniform1f)}set strength(t){this._strength=t,this.redraw()}get strength(){return this._strength}set ambient(t){this._ambient=t,this.redraw()}get ambient(){return this._ambient}set fudge(t){this._fudge=t,this.redraw()}get fudge(){return this._fudge}get rx(){return this._rx}set rx(t){this._rx=t,this.redraw()}get ry(){return this._ry}set ry(t){this._ry=t,this.redraw()}get z(){return this._z}set z(t){this._z=t,this.redraw()}get pivotX(){return this._pivotX}set pivotX(t){this._pivotX=t+1,this.redraw()}get pivotY(){return this._pivotY}set pivotY(t){this._pivotY=t+1,this.redraw()}get lightY(){return this._lightY}set lightY(t){this._lightY=t,this.redraw()}get pivotZ(){return this._pivotZ}set pivotZ(t){this._pivotZ=t,this.redraw()}get lightZ(){return this._lightZ}set lightZ(t){this._lightZ=t,this.redraw()}useDefault(){return this._rx===0&&this._ry===0&&this._z===0&&this._strength===0&&this._ambient===1}}xf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;

    uniform float fudge;
    uniform float strength;
    uniform float ambient;
    uniform float z;
    uniform float lightY;
    uniform float lightZ;
    uniform vec3 pivot;
    uniform vec3 rot;
    varying vec3 pos;

    void main(void) {
        pos = vec3(aVertexPosition.xy, z);
        
        pos -= pivot;
        
        // Undo XY rotation
        mat2 iRotXy = mat2( cos(rot.z), sin(rot.z), 
                           -sin(rot.z), cos(rot.z));
        pos.xy = iRotXy * pos.xy;
        
        // Perform 3d rotations
        gl_Position.x = cos(rot.x) * pos.x - sin(rot.x) * pos.z;
        gl_Position.y = pos.y;
        gl_Position.z = sin(rot.x) * pos.x + cos(rot.x) * pos.z;
        
        pos.x = gl_Position.x;
        pos.y = cos(rot.y) * gl_Position.y - sin(rot.y) * gl_Position.z;
        pos.z = sin(rot.y) * gl_Position.y + cos(rot.y) * gl_Position.z;
        
        // Redo XY rotation
        iRotXy[0][1] = -iRotXy[0][1];
        iRotXy[1][0] = -iRotXy[1][0];
        pos.xy = iRotXy * pos.xy; 

        // Undo translate to pivot position
        pos.xyz += pivot;

        pos = vec3(pos.x * projection.x - 1.0, pos.y * -abs(projection.y) + 1.0, pos.z * projection.x);
        
        // Set depth perspective
        float perspective = 1.0 + fudge * pos.z;

        pos.z += lightZ * projection.x;

        // Map coords to gl coordinate space.
        // Set z to 0 because we don't want to perform z-clipping
        gl_Position = vec4(pos.xy, 0.0, perspective);

        // Correct light source position.
        pos.y += lightY * abs(projection.y);

        vTextureCoord = aTextureCoord;
        vColor = aColor;
        
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;xf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    varying vec3 pos;
    uniform sampler2D uSampler;
    uniform float ambient;
    uniform float strength;
    void main(void){
        vec4 rgba = texture2D(uSampler, vTextureCoord);
        float d = length(pos);
        float n = 1.0 / max(0.1, d);
        rgba.rgb = rgba.rgb * (strength * n + ambient);
        gl_FragColor = rgba * vColor;
    }
`;class vf extends Je{constructor(t){super(t),this._fudge=.2,this._rx=0,this._ry=0,this._z=1}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=n.element,u=o.pivotX*n.w,f=o.pivotY*n.h,m=n.getRenderTextureCoords(u,f),p=-Math.atan2(n._renderContext.tc,n._renderContext.ta),v=this.gl;this._setUniform("pivot",new Float32Array([m[0],m[1],0]),v.uniform3fv),this._setUniform("rot",new Float32Array([this._rx,this._ry,p]),v.uniform3fv),this._setUniform("z",this._z,v.uniform1f),this._setUniform("fudge",this._fudge,v.uniform1f)}set fudge(t){this._fudge=t,this.redraw()}get fudge(){return this._fudge}get rx(){return this._rx}set rx(t){this._rx=t,this.redraw()}get ry(){return this._ry}set ry(t){this._ry=t,this.redraw()}get z(){return this._z}set z(t){this._z=t,this.redraw()}useDefault(){return this._rx===0&&this._ry===0&&this._z===0}}vf.vertexShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    attribute vec4 aColor;
    uniform vec2 projection;
    varying vec2 vTextureCoord;
    varying vec4 vColor;

    uniform float z;
    uniform vec3 pivot;
    uniform vec3 rot;
    varying vec3 pos;

    void main(void) {
        pos = vec3(aVertexPosition.xy, z);
        
        pos -= pivot;
        
        // Undo XY rotation
        mat2 iRotXy = mat2( cos(rot.z), sin(rot.z), 
                           -sin(rot.z), cos(rot.z));
        pos.xy = iRotXy * pos.xy;
        
        // Perform 3d rotations
        gl_Position.x = cos(rot.x) * pos.x - sin(rot.x) * pos.z;
        gl_Position.y = pos.y;
        gl_Position.z = sin(rot.x) * pos.x + cos(rot.x) * pos.z;
        
        pos.x = gl_Position.x;
        pos.y = cos(rot.y) * gl_Position.y - sin(rot.y) * gl_Position.z;
        pos.z = sin(rot.y) * gl_Position.y + cos(rot.y) * gl_Position.z;
        
        // Redo XY rotation
        iRotXy[0][1] = -iRotXy[0][1];
        iRotXy[1][0] = -iRotXy[1][0];
        pos.xy = iRotXy * pos.xy; 

        // Undo translate to pivot position
        pos.xyz += pivot;

        pos = vec3(pos.x * projection.x - 1.0, pos.y * -abs(projection.y) + 1.0, pos.z * projection.x);
        
        // Map coords to gl coordinate space.
        // Set z to 0 because we don't want to perform z-clipping
        gl_Position = vec4(pos.xy, 0.0, z);

        vTextureCoord = aTextureCoord;
        vColor = aColor;
        
        gl_Position.y = -sign(projection.y) * gl_Position.y;
    }
`;vf.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;

    uniform vec3 rot;
    uniform float fudge;

    void main(void) {
        vec2 coords = vTextureCoord;

        coords.xy -= vec2(0.5);
        coords.y = coords.y + (sign(rot[0]) * 0.5 - coords.x) * sin(rot[0]) * fudge * coords.y;
        coords.x = coords.x + (sign(rot[1]) * 0.5 - coords.y) * sin(rot[1]) * fudge * coords.x;
        coords.xy += vec2(0.5);

        if (coords.x < 0.0 || coords.x > 1.0 || coords.y < 0.0 || coords.y > 1.0) {
            gl_FragColor = vec4(0.0);
        } else {
            gl_FragColor = texture2D(uSampler, coords) * vColor;
        }
    }
`;class wf extends Je{constructor(t){super(t),this._x=0,this._y=0,this._w=0,this._h=0,this._radius=0,this._magnification=.6}get x(){return this._x}set x(t){this._x=t,this.redraw()}get y(){return this._y}set y(t){this._y=t,this.redraw()}get w(){return this._w}set w(t){this._w=t,this.redraw()}get h(){return this._h}set h(t){this._h=t,this.redraw()}get magnification(){return this._magnification}set magnification(t){this._magnification=t,this.redraw()}get radius(){return this._radius}set radius(t){this._radius=t,this.redraw()}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=this.ctx.stage.getRenderPrecision();this._setUniform("x",this._x*o,this.gl.uniform1f),this._setUniform("y",this._y*o,this.gl.uniform1f),this._setUniform("w",this._w*o,this.gl.uniform1f),this._setUniform("h",this._h*o,this.gl.uniform1f),this._setUniform("magnification",this._magnification,this.gl.uniform1f),this._setUniform("radius",(this._radius+.5)*o,this.gl.uniform1f),this._setUniform("resolution",new Float32Array([n._w*o,n._h*o]),this.gl.uniform2fv)}useDefault(){return this._w===0&&this._h===0}}wf.vertexShaderSource=Je.vertexShaderSource;wf.fragmentShaderSource=`
	  #ifdef GL_ES
		# ifdef GL_FRAGMENT_PRECISION_HIGH
		precision highp float;
		# else
		precision lowp float;
		# endif
	  #endif

	  varying vec2 vTextureCoord;
	  varying vec4 vColor;
	  uniform sampler2D uSampler;
	  uniform float x;
	  uniform float y;
	  uniform float w;
	  uniform float h;
	  uniform vec2 resolution;
	  uniform float radius;
	  uniform float magnification;
  
	  float roundBox(vec2 p, vec2 b, float r) {
		  float d = length(max(abs(p)-b+r, 0.1))-r;
		  return smoothstep(1.0, 0.0, d);
	  }

	  float inside(vec2 v) {
		vec2 s = step(vec2(0.0, 0.0), v) - step(vec2(1.0, 1.0), v);
		return s.x * s.y;   
      }
  
	  void main(void) {
		vec4 color = texture2D(uSampler, vTextureCoord);
		vec2 pos = vTextureCoord.xy * resolution - vec2(x, y) - vec2(w, h) / 2.0;
		vec2 size = vec2(w, h) / 2.0;
		float b = roundBox(pos, size, radius);
		vec2 pos2 = (vTextureCoord.xy * magnification * resolution + vec2(x, y) * magnification) / resolution;
		gl_FragColor = mix(color, texture2D(uSampler, pos2) * inside(pos2), b) * vColor;
	  }
  `;class Jo extends Je{constructor(t){super(t),this._period=1,this._stroke=0,this._showDot=!0,this._clockwise=!0,this._bc=4278190080,this._normalizedBC=this._getNormalizedColor(this._bc),this._c=4294967295,this._normalizedC=this._getNormalizedColor(this._c)}set radius(t){t===0&&(t=1),this._radius=t}set stroke(t){this._stroke=Math.abs(t)}get stroke(){return this._stroke}set color(t){this._c=t,this._normalizedC=this._getNormalizedColor(t)}get color(){return this._c}set backgroundColor(t){this._bc=t,this._normalizedBC=this._getNormalizedColor(t)}get backgroundColor(){return this._sc}set showDot(t){this._showDot=t}get showDot(){return this._showDot}set clockwise(t){this._clockwise=t}get clockwise(){return this._clockwise}set period(t){this._period=t}get period(){return this._period}_getNormalizedColor(t){const n=Te.getRgbaComponentsNormalized(t);return n[0]*=n[3],n[1]*=n[3],n[2]*=n[3],new Float32Array(n)}setupUniforms(t){super.setupUniforms(t);const n=t.shaderOwner,o=this._radius||n._w/2;this._stroke===0&&(this._stroke=o*.33),this._setUniform("resolution",new Float32Array([n._w,n._h]),this.gl.uniform2fv),this._setUniform("color",this._normalizedC,this.gl.uniform4fv),this._setUniform("backgroundColor",this._normalizedBC,this.gl.uniform4fv),this._setUniform("stroke",this._stroke,this.gl.uniform1f),this._setUniform("radius",o,this.gl.uniform1f),this._setUniform("direction",this._clockwise?-1:1,this.gl.uniform1f),this._setUniform("showDot",!!this._showDot,this.gl.uniform1f),this._setUniform("time",Date.now()-Jo.spinSync,this.gl.uniform1f),this._setUniform("period",this._period,this.gl.uniform1f),this._setUniform("alpha",t.getElementCore(0).renderContext.alpha,this.gl.uniform1f),(this._sc!==this._bc||this._stroke!==o*.5)&&this.redraw()}}Jo.spinSync=Date.now();Jo.fragmentShaderSource=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
    
    #define PI 3.14159265359
    
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    
    uniform sampler2D uSampler;
    uniform vec2 resolution;
    uniform vec4 color;
    uniform vec4 backgroundColor;
    uniform float direction;
    uniform float radius;
    uniform float time;
    uniform float stroke;
    uniform float showDot;
    uniform float period;
    uniform float alpha;
    
    float circleDist(vec2 p, float radius){
        return length(p) - radius;
    }
    
    float fillMask(float dist){
        return clamp(-dist, 0.0, 1.0);
    }
    
    void main() {
        vec2 halfRes = 0.5 * resolution.xy;
        vec2 center = vTextureCoord.xy * resolution - halfRes;
        
        float c = max(-circleDist(center, radius - stroke), circleDist(center, radius));
        float rot = -(time / 1000.0 / period) * 6.0 * direction;
        center *= mat2(cos(rot), sin(rot), -sin(rot), cos(rot));
        
        float a = direction * atan(center.x, center.y) * PI * 0.05 + 0.45;
        
        float strokeRad = stroke * 0.5;
        a = mix(a, max(a, fillMask(circleDist(vec2(center.x, center.y + (radius - strokeRad)), strokeRad))), showDot);
        vec4 base = mix(vec4(0.0), backgroundColor * alpha, fillMask(c));
        gl_FragColor = mix(base, color * alpha, fillMask(c) * a);
    }
`;const J={Application:Wb,Component:Ct,Base:Ot,Utils:$,StageUtils:Te,Element:si,Tools:jo,Stage:In,ElementCore:bn,ElementTexturizer:qv,Texture:ai,EventEmitter:mt,shaders:{Grayscale:uf,BoxBlur:Ui,Dithering:hf,CircularPush:cf,Inversion:d0,LinearBlur:Tu,Outline:df,Pixelate:ff,RadialFilter:pf,RoundedRectangle:gf,Spinner2:Jo,FadeOut:f0,Hole:yf,Vignette:mf,Spinner:_f,RadialGradient:p0,Light3d:xf,Perspective:vf,Magnifier:wf,WebGLShader:xu,WebGLDefaultShader:Je,C2dShader:sf,C2dDefaultShader:vu,c2d:{Grayscale:c0,Blur:l0}},textures:{RectangleTexture:r0,NoiseTexture:a0,TextTexture:An,ImageTexture:Nd,HtmlTexture:lf,StaticTexture:Gb,StaticCanvasTexture:n0,SourceTexture:$v},components:{FastBlurComponent:$b,BloomComponent:Kb,SmoothScaleComponent:cu,BorderComponent:Zb,ListComponent:Xb},tools:{ObjMerger:af,ObjectListProxy:s0,ObjectListWrapper:o0}};$.isWeb&&(window.lng=J);let Ft=class extends J.shaders.WebGLDefaultShader{set brightness(t){this._brightness=(t-50)/100,this.redraw()}set contrast(t){this._contrast=(t+50)/100,this.redraw()}set gamma(t){this._gamma=(t+50)/100,this.redraw()}setupUniforms(t){super.setupUniforms(t);const n=this.gl;this._setUniform("colorAdjust",[this._brightness||0,this._contrast||1,this._gamma||1],n.uniform3fv)}};Ft.before=`
    #ifdef GL_ES
    # ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    # else
    precision lowp float;
    # endif
    #endif
        
    varying vec2 vTextureCoord;
    varying vec4 vColor;
    uniform sampler2D uSampler;
    uniform vec3 colorAdjust;
    
    const mat3 RGBtoOpponentMat = mat3(0.2814, -0.0971, -0.0930, 0.6938, 0.1458,-0.2529, 0.0638, -0.0250, 0.4665);
    const mat3 OpponentToRGBMat = mat3(1.1677, 0.9014, 0.7214, -6.4315, 2.5970, 0.1257, -0.5044, 0.0159, 2.0517);    
`;Ft.after=`    
    vec3 brightnessContrast(vec3 value, float brightness, float contrast)
    {
        return (value - 0.5) * contrast + 0.5 + brightness;
    }   
    
    vec3 updateGamma(vec3 value, float param)
    {
        return vec3(pow(abs(value.r), param),pow(abs(value.g), param),pow(abs(value.b), param));
    } 
       
    void main(void){
        vec4 fragColor = texture2D(uSampler, vTextureCoord);        
        vec4 color = filter(fragColor) * vColor;       
        
        vec3 bc = brightnessContrast(color.rgb,colorAdjust[0],colorAdjust[1]);        
        vec3 ga = updateGamma(bc.rgb, colorAdjust[2]);  
              
        gl_FragColor = vec4(ga.rgb, color.a);          
    }    
`;class g0 extends Ft{}g0.fragmentShaderSource=`
    ${Ft.before}    
    vec4 vision(vec4 color)
    {
        vec4 r = vec4( 0.20,  0.99, -0.19, 0.0);
        vec4 g = vec4( 0.16,  0.79,  0.04, 0.0);
        vec4 b = vec4( 0.01, -0.01,  1.00, 0.0);
       
        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);	
    }
    
    vec4 filter( vec4 color )
    {   
        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);
        opponentColor.x -= opponentColor.y * 1.5; 
        vec3 rgbColor = OpponentToRGBMat * opponentColor;
        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));      
    }    
    ${Ft.after} 
`;class m0 extends Ft{}m0.fragmentShaderSource=`
    ${Ft.before}
    vec4 vision(vec4 color)
    {
        vec4 r = vec4( 0.43,  0.72, -0.15, 0.0 );
        vec4 g = vec4( 0.34,  0.57,  0.09, 0.0 );
        vec4 b = vec4(-0.02,  0.03,  1.00, 0.0 );
       
        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);	
    }
       
    vec4 filter( vec4 color )
    {   
        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);
        opponentColor.x -= opponentColor.y * 1.5; 
        vec3 rgbColor = OpponentToRGBMat * opponentColor;
        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));    
    }
    ${Ft.after}    
`;class _0 extends Ft{}_0.fragmentShaderSource=`
    ${Ft.before}    
    vec4 vision(vec4 color)
    {
        vec4 r = vec4( 0.97,  0.11, -0.08, 0.0 );
        vec4 g = vec4( 0.02,  0.82,  0.16, 0.0 );
        vec4 b = vec4(-0.06,  0.88,  0.18, 0.0 );
       
        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);	
    }   
    
    vec4 filter( vec4 color )
    {   
        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);
        opponentColor.x -= ((3.0 * opponentColor.z) - opponentColor.y) * 0.25;
        vec3 rgbColor = OpponentToRGBMat * opponentColor;
        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));
    }   
    ${Ft.after} 
`;class y0 extends Ft{}y0.fragmentShaderSource=`
    ${Ft.before}
    vec4 filter( vec4 color )
    {
        return color;
    }
    ${Ft.after}
`;class x0 extends Ft{}x0.fragmentShaderSource=`
    ${Ft.before}
    vec4 filter( vec4 color )
    {   
        float grey = dot(color.rgb, vec3(0.299, 0.587, 0.114));
        return vec4(vec3(grey, grey, grey), 1.0 ); 
    }
    ${Ft.after}
`;const Qb=c=>{const t={normal:y0,monochromacy:x0,deuteranopia:m0,tritanopia:_0,protanopia:g0};return c=typeof c=="string"&&c.toLowerCase()||null,Object.keys(t).indexOf(c)>-1?t[c]:!1},Jb={colorshift(c,t=!1,n={brightness:50,contrast:50,gamma:50}){n={brightness:50,contrast:50,gamma:50,...n};const o=t&&Qb(t);o?(ve.info("Accessibility Colorshift",t,n),c.rtt=!0,c.shader={type:o,...n}):(ve.info("Accessibility Colorshift","Disabled"),c.rtt=!1,c.shader=null)}};let ea,Sr,jr,Zl,Bd;const Po={set log(c){ea=c},set settings(c){Sr=c},set ads(c){Zl=c},set lightning(c){Bd=c},set appInstance(c){jr=c}},eI=c=>{Wo=c.sendMetric};let Wo=(c,t,n)=>{ea.info("Sending metric",c,t,n)};const tI={app:["launch","loaded","ready","close"],page:["view","leave"],user:["click","input"],media:["abort","canplay","ended","pause","play","volumechange","waiting","seeking","seeked"]},v0=(c,t,n,o,u={})=>{u={params:u,message:t,code:n,visible:o},Wo(c,"error",u)},av=(c,t,n={})=>t.reduce((o,u)=>(o[u]=(f,m={})=>{m={...n,...f?{name:f}:{},...m},Wo(c,u,m)},o),{error(o,u,f){v0(c,o,u,f)},event(o,u){Wo(c,o,u)}}),iI=c=>Object.keys(c).reduce((t,n)=>(n==="media"?t[n]=o=>av(n,c[n],{url:o}):t[n]=av(n,c[n]),t),{error:v0,event:Wo}),Tf=iI(tI),Sf=c=>c&&c.length===2?`${c.toLowerCase()}-${c.toUpperCase()}`:c,rI=c=>{if("language"in navigator){const t=Sf(navigator.language);return Promise.resolve(t)}else return Promise.resolve(c)},nI=c=>{if("language"in navigator){const t=Sf(navigator.language).slice(0,2);return Promise.resolve(t)}else return Promise.resolve(c)},sI=c=>{if("language"in navigator){const t=Sf(navigator.language).slice(3,5);return Promise.resolve(t)}else return Promise.resolve(c)},oI=()=>new Promise(c=>{Sr.get("platform","forceBrowserGeolocation")===!0&&c(!0),"permissions"in navigator&&typeof navigator.permissions.query=="function"?navigator.permissions.query({name:"geolocation"}).then(t=>{c(t.state==="granted"||t.status==="granted")}):c(!1)}),aI=c=>new Promise(t=>{oI().then(n=>{if(n===!0)if("geolocation"in navigator)navigator.geolocation.getCurrentPosition(o=>o&&o.coords&&t([o.coords.latitude,o.coords.longitude]),()=>t(c),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0});else return lv().then(o=>t(o||c));else return lv().then(o=>t(o||c))})}),lv=()=>new Promise(c=>{fetch("https://geolocation-db.com/json/").then(t=>t.json()).then(({latitude:t,longitude:n})=>c(t&&n?[t,n]:!1)).catch(()=>c(!1))}),jd={ageRating:"adult",city:"New York",zipCode:"27505",countryCode:()=>sI("US"),ip:"127.0.0.1",household:"b2244e9d4c04826ccd5a7b2c2a50e7d4",language:()=>nI("en"),latlon:()=>aI([40.7128,74.006]),locale:()=>rI("en-US"),mac:"00:00:00:00:00:00",operator:"metrological",platform:"metrological",packages:[],uid:"ee6723b8-7ab3-462c-8d93-dbf61227998e",stbType:"metrological"};let uv=c=>{const t={...jd,...Sr.get("platform","profile")};return Promise.resolve(typeof t[c]=="function"?t[c]():t[c])},hv=(c,t)=>{if(c in jd)return jd[c]=t};const lI=c=>{uv=c.getInfo?c.getInfo:uv,hv=c.setInfo?c.setInfo:hv},uI=c=>{c.billingUrl&&c.billingUrl},hI=[{number:1,name:"Metro News 1",description:"New York Cable News Channel",entitled:!0,program:{title:"The Morning Show",description:"New York's best morning show",startTime:new Date(new Date-60*5*1e3).toUTCString(),duration:60*30,ageRating:0}},{number:2,name:"MTV",description:"Music Television",entitled:!0,program:{title:"Beavis and Butthead",description:"American adult animated sitcom created by Mike Judge",startTime:new Date(new Date-60*20*1e3).toUTCString(),duration:60*45,ageRating:18}},{number:3,name:"NBC",description:"NBC TV Network",entitled:!1,program:{title:"The Tonight Show Starring Jimmy Fallon",description:"Late-night talk show hosted by Jimmy Fallon on NBC",startTime:new Date(new Date-60*10*1e3).toUTCString(),duration:60*60,ageRating:10}}],Hd=()=>Sr.get("platform","tv",hI),cv=()=>Hd()[~~(Hd.length*Math.random())];let Yi;const dv={},w0=(c,...t)=>{dv[c]&&dv[c].forEach(n=>{n.apply(null,t)})};let Kl={getChannel(){return Yi||(Yi=cv()),new Promise((c,t)=>{if(Yi){const n={...Yi};delete n.program,c(n)}else t("No channel found")})},getProgram(){return Yi||(Yi=cv()),new Promise((c,t)=>{Yi.program?c(Yi.program):t("No program found")})},setChannel(c){return new Promise((t,n)=>{if(c){const o=Hd().find(u=>u.number===c);if(o){Yi=o;const u={...Yi};delete u.program,w0("channelChange",u),t(u)}else n("Channel not found")}else n("No channel number supplied")})}};const cI=c=>{Kl={},c.getChannel&&typeof c.getChannel=="function"&&(Kl.getChannel=c.getChannel),c.getProgram&&typeof c.getProgram=="function"&&(Kl.getProgram=c.getProgram),c.setChannel&&typeof c.setChannel=="function"&&(Kl.setChannel=c.setChannel),c.emit&&typeof c.emit=="function"&&c.emit(w0)},dI=c=>{c.submit&&typeof c.submit=="function"&&c.submit,c.check&&typeof c.check=="function"&&c.check},fI=(c,t=null,n=null)=>{let o;if(c&&typeof c=="function")try{o=c.apply(n,t)}catch(u){o=u}else o=c;return o!==null&&typeof o=="object"&&o.then&&typeof o.then=="function"?o:new Promise((u,f)=>{o instanceof Error?f(o):u(o)})},fv={abort:"Abort",canplay:"CanPlay",canplaythrough:"CanPlayThrough",durationchange:"DurationChange",emptied:"Emptied",encrypted:"Encrypted",ended:"Ended",error:"Error",interruptbegin:"InterruptBegin",interruptend:"InterruptEnd",loadeddata:"LoadedData",loadedmetadata:"LoadedMetadata",loadstart:"LoadStart",pause:"Pause",play:"Play",playing:"Playing",progress:"Progress",ratechange:"Ratechange",seeked:"Seeked",seeking:"Seeking",stalled:"Stalled",timeupdate:"TimeUpdate",volumechange:"VolumeChange",waiting:"Waiting"},pI=(c,t=()=>{})=>{let n=!1;const o=()=>{n===!1&&(t(),n=!0)};return Object.keys(c).reduce((u,f)=>(typeof c[f]=="function"?u[f]=function(){return o(),c[f].apply(c,arguments)}:typeof Object.getOwnPropertyDescriptor(c,f).get=="function"?u.__defineGetter__(f,function(){return o(),Object.getOwnPropertyDescriptor(c,f).get.apply(c)}):typeof Object.getOwnPropertyDescriptor(c,f).set=="function"?u.__defineSetter__(f,function(){return o(),Object.getOwnPropertyDescriptor(c,f).set.sourceObject[f].apply(c,arguments)}):u[f]=c[f],u),{})};let pv=null;const gI=(c,t)=>{clearTimeout(pv),pv=setTimeout(()=>{c()},t)},mI=()=>class extends Bd.Component{static _template(){return{Video:{alpha:1,visible:!1,pivot:.5,texture:{type:Bd.textures.StaticTexture,options:{}}}}}set videoEl(t){this._videoEl=t}get videoEl(){return this._videoEl}get videoView(){return this.tag("Video")}get videoTexture(){return this.videoView.texture}get isVisible(){return this.videoView.alpha===1&&this.videoView.visible===!0}_init(){this._createVideoTexture()}_createVideoTexture(){const n=this.stage.gl,o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),this.videoTexture.options={source:o,w:this.videoEl.width,h:this.videoEl.height},this.videoView.w=this.videoEl.width/this.stage.getRenderPrecision(),this.videoView.h=this.videoEl.height/this.stage.getRenderPrecision()}start(){const t=this.stage;this._lastTime=0,this._updateVideoTexture||(this._updateVideoTexture=()=>{if(this.videoTexture.options.source&&this.videoEl.videoWidth&&this.active){const n=t.gl,o=new Date().getTime(),u=this.videoEl.getVideoPlaybackQuality(),f=u?u.totalVideoFrames:this.videoEl.webkitDecodedFrameCount;if(f?this._lastFrame!==f:this._lastTime<o-30){this._lastTime=o,this._lastFrame=f;try{n.bindTexture(n.TEXTURE_2D,this.videoTexture.options.source),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.videoEl),this._lastFrame=this.videoEl.webkitDecodedFrameCount,this.videoView.visible=!0,this.videoTexture.options.w=this.videoEl.width,this.videoTexture.options.h=this.videoEl.height;const p=this.videoView.w/this.videoView.h,v=this.videoEl.width/this.videoEl.height;p>v?(this.videoView.scaleX=v/p,this.videoView.scaleY=1):(this.videoView.scaleY=p/v,this.videoView.scaleX=1)}catch(p){ea.error("texImage2d video",p),this.stop()}this.videoTexture.source.forceRenderUpdate()}}}),this._updatingVideoTexture||(t.on("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!0)}stop(){const t=this.stage;if(t.removeListener("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!1,this.videoView.visible=!1,this.videoTexture.options.source){const n=t.gl;n.bindTexture(n.TEXTURE_2D,this.videoTexture.options.source),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT)}}position(t,n){this.videoView.patch({smooth:{x:n,y:t}})}size(t,n){this.videoView.patch({smooth:{w:t,h:n}})}show(){this.videoView.setSmooth("alpha",1)}hide(){this.videoView.setSmooth("alpha",0)}};let Cf=c=>c,re,Br,No,ws,Vd=1,vr=!1;const _I=c=>{c.mediaUrl&&(Cf=c.mediaUrl)};let Ql={};const vt={adsEnabled:!1,playing:!1,_playingAds:!1,get playingAds(){return this._playingAds},set playingAds(c){this._playingAds!==c&&(this._playingAds=c,Ho(c===!0?"AdStart":"AdEnd"))},skipTime:!1,playAfterSeek:null},Ad={play(){vt.playing=!0},pause(){vt.playing=!1},seeked(){vt.playAfterSeek===!0&&T0.play(),vt.playAfterSeek=null},abort(){Wd()}},Zi=c=>Math.round(Vd*c)+"px",Ho=(c,t)=>{ws&&(ws.fire("$videoPlayer"+c,t,re.currentTime),ws.fire("$videoPlayerEvent",c,t,re.currentTime))},yI=(c,t)=>{Ad[c]&&typeof Ad[c]=="function"&&Ad[c].call(null,c,t)};let Jl=null,eu=null;const xI=(c,t,n)=>Jl&&typeof Jl=="function"?Jl(c,t,n):new Promise(o=>{c=Cf(c),t.setAttribute("src",c),t.load(),o()}),vI=c=>eu&&typeof eu=="function"?eu(c):new Promise(t=>{c.removeAttribute("src"),c.load(),t()}),wI=()=>{const c=document.getElementsByTagName("video");if(c&&c.length)return c[0];{const t=document.createElement("video"),n=Sr.get("platform","width")?Sr.get("platform","width"):1920,o=Sr.get("platform","height")?Sr.get("platform","height"):1080;return t.setAttribute("id","video-player"),t.setAttribute("width",Zi(n)),t.setAttribute("height",Zi(o)),t.style.position="absolute",t.style.zIndex="1",t.style.display="none",t.style.visibility="hidden",t.style.top=Zi(0),t.style.left=Zi(0),t.style.width=Zi(n),t.style.height=Zi(o),document.body.appendChild(t),t}},TI=()=>{if(!jr.tag("VideoTexture")){const c=jr.stage.c({type:mI(),ref:"VideoTexture",zIndex:0,videoEl:re});jr.childList.addAt(c,0)}return jr.tag("VideoTexture")},SI=()=>{ea.info("VideoPlayer","Registering event listeners"),Object.keys(fv).forEach(c=>{const t=n=>{No&&No[c]&&typeof No[c]=="function"&&No[c]({currentTime:re.currentTime}),yI(c,{videoElement:re,event:n}),Ho(fv[c],{videoElement:re,event:n})};Ql[c]=t,re.addEventListener(c,t)})},Wd=()=>{ea.info("VideoPlayer","Deregistering event listeners"),Object.keys(Ql).forEach(c=>{re.removeEventListener(c,Ql[c])}),Ql={}},T0={consumer(c){ws=c},loader(c){Jl=c},unloader(c){eu=c},position(c=0,t=0){re.style.left=Zi(t),re.style.top=Zi(c),vr===!0&&Br.position(c,t)},size(c=1920,t=1080){re.style.width=Zi(c),re.style.height=Zi(t),re.width=parseFloat(re.style.width),re.height=parseFloat(re.style.height),vr===!0&&Br.size(c,t)},area(c=0,t=1920,n=1080,o=0){this.position(c,o),this.size(t-o,n-c)},open(c,t={}){if(this.canInteract)if(No=Tf.media(c),this.hide(),Wd(),this.src==c)this.clear().then(this.open(c,t));else{const n={enabled:vt.adsEnabled,duration:300};t.videoId&&(n.caid=t.videoId),Zl.get(n,ws).then(o=>{vt.playingAds=!0,o.prerolls().then(()=>{vt.playingAds=!1,xI(c,re,t).then(()=>{SI(),this.show(),this.play()}).catch(u=>{Ho("error",{videoElement:re,event:u})})})})}},reload(){if(!this.canInteract)return;const c=re.getAttribute("src");this.close(),this.open(c)},close(){Zl.cancel(),vt.playingAds&&(vt.playingAds=!1,Zl.stop(),setTimeout(()=>{this.close()})),this.canInteract&&(this.clear(),this.hide(),Wd())},clear(){if(this.canInteract)return this.pause(),vr===!0&&Br.stop(),vI(re).then(()=>{Ho("Clear",{videoElement:re})})},play(){this.canInteract&&(vr===!0&&Br.start(),fI(re.play,null,re).catch(c=>{Ho("error",{videoElement:re,event:c})}))},pause(){this.canInteract&&re.pause()},playPause(){this.canInteract&&(this.playing===!0?this.pause():this.play())},mute(c=!0){this.canInteract&&(re.muted=c)},loop(c=!0){re.loop=c},seek(c){this.canInteract&&this.src&&(vt.playAfterSeek===null&&(vt.playAfterSeek=!!vt.playing),this.pause(),re.currentTime=Math.max(0,Math.min(c,this.duration-.1)))},skip(c){this.canInteract&&this.src&&(vt.skipTime=(vt.skipTime||re.currentTime)+c,gI(()=>{this.seek(vt.skipTime),vt.skipTime=!1},300))},show(){this.canInteract&&(vr===!0?Br.show():(re.style.display="block",re.style.visibility="visible"))},hide(){this.canInteract&&(vr===!0?Br.hide():(re.style.display="none",re.style.visibility="hidden"))},enableAds(c=!0){vt.adsEnabled=c},get duration(){return re&&(isNaN(re.duration)?1/0:re.duration)},get currentTime(){return re&&re.currentTime},get muted(){return re&&re.muted},get looped(){return re&&re.loop},get src(){return re&&re.getAttribute("src")},get playing(){return vt.playing},get playingAds(){return vt.playingAds},get canInteract(){return vt.playingAds===!1},get top(){return re&&parseFloat(re.style.top)},get left(){return re&&parseFloat(re.style.left)},get bottom(){return re&&parseFloat(re.style.top-re.style.height)},get right(){return re&&parseFloat(re.style.left-re.style.width)},get width(){return re&&parseFloat(re.style.width)},get height(){return re&&parseFloat(re.style.height)},get visible(){return vr===!0?Br.isVisible:re&&re.style.display==="block"},get adsEnabled(){return vt.adsEnabled},get _videoEl(){return re},get _consumer(){return ws}},xn=pI(T0,()=>{Vd=jr&&jr.stage&&jr.stage.getRenderPrecision()||Vd,re=wI(),vr=Sr.get("platform","textureMode",!1),vr===!0&&(re.setAttribute("crossorigin","anonymous"),Br=TI())});let tu,S0=()=>Promise.resolve({prerolls:[],midrolls:[],postrolls:[]});const CI=c=>{c.getAds&&(S0=c.getAds)},Uo={active:!1},AI=(c=[])=>c.reduce((t,n)=>t.then(()=>EI(n)),Promise.resolve(null)),EI=c=>new Promise(t=>{if(Uo.active===!1)return ve.info("Ad","Skipping add due to inactive state"),t();const n=document.getElementsByTagName("video")[0];n.style.display="block",n.style.visibility="visible",n.src=Cf(c.url),n.load();let o=null,u;const f=()=>{Object.keys(m).forEach(p=>n.removeEventListener(p,m[p])),t()},m={play(){ve.info("Ad","Play ad",c.url),Ni("Play",c),En(c.callbacks,"defaultImpression")},ended(){Ni("Ended",c),En(c.callbacks,"complete"),f()},timeupdate(){!o&&n.duration&&(o={firstQuartile:n.duration/4,midPoint:n.duration/2,thirdQuartile:n.duration/4*3},ve.info("Ad","Calculated quartiles times",{timeEvents:o})),o&&o.firstQuartile&&n.currentTime>=o.firstQuartile&&(Ni("FirstQuartile",c),delete o.firstQuartile,En(c.callbacks,"firstQuartile")),o&&o.midPoint&&n.currentTime>=o.midPoint&&(Ni("MidPoint",c),delete o.midPoint,En(c.callbacks,"midPoint")),o&&o.thirdQuartile&&n.currentTime>=o.thirdQuartile&&(Ni("ThirdQuartile",c),delete o.thirdQuartile,En(c.callbacks,"thirdQuartile"))},stalled(){Ni("Stalled",c),u=setTimeout(()=>{f()},5e3)},canplay(){u&&clearTimeout(u)},error(){Ni("Error",c),f()},abort(){f()}};Object.keys(m).forEach(p=>n.addEventListener(p,m[p])),n.play()}),En=(c,t)=>{if(c&&c[t])return ve.info("Ad","Sending beacon",t,c[t]),c[t].reduce((n,o)=>n.then(()=>fetch(o).then(u=>{u.status===200?Ni("Beacon"+t+"Sent"):Ni("Beacon"+t+"Failed"+u.status),Promise.resolve(null)}).catch(()=>{Promise.resolve(null)})),Promise.resolve(null));ve.info("Ad","No callback found for "+t)},Ni=(c,t)=>{tu&&(tu.fire("$ad"+c,t),tu.fire("$adEvent",c,t))},bI={get(c,t){return c.enabled===!1?Promise.resolve({prerolls(){return Promise.resolve()}}):(tu=t,new Promise(n=>{ve.info("Ad","Starting session"),S0(c).then(o=>{ve.info("Ad","API result",o),n({prerolls(){return o.preroll?(Uo.active=!0,Ni("PrerollSlotImpression",o),En(o.preroll.callbacks,"slotImpression"),AI(o.preroll.ads).then(()=>{Ni("PrerollSlotEnd",o),En(o.preroll.callbacks,"slotEnd"),Uo.active=!1})):Promise.resolve()},midrolls(){return Promise.resolve()},postrolls(){return Promise.resolve()}})})}))},cancel(){ve.info("Ad","Cancel Ad"),Uo.active=!1},stop(){ve.info("Ad","Stop Ad"),Uo.active=!1;const c=document.getElementsByTagName("video")[0];c.pause(),c.removeAttribute("src")}};var C0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A0(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var II=function(t){return RI(t)&&!LI(t)};function RI(c){return!!c&&typeof c=="object"}function LI(c){var t=Object.prototype.toString.call(c);return t==="[object RegExp]"||t==="[object Date]"||kI(c)}var MI=typeof Symbol=="function"&&Symbol.for,PI=MI?Symbol.for("react.element"):60103;function kI(c){return c.$$typeof===PI}function OI(c){return Array.isArray(c)?[]:{}}function Go(c,t){return t.clone!==!1&&t.isMergeableObject(c)?Ss(OI(c),c,t):c}function DI(c,t,n){return c.concat(t).map(function(o){return Go(o,n)})}function FI(c,t){if(!t.customMerge)return Ss;var n=t.customMerge(c);return typeof n=="function"?n:Ss}function NI(c){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(c).filter(function(t){return Object.propertyIsEnumerable.call(c,t)}):[]}function gv(c){return Object.keys(c).concat(NI(c))}function E0(c,t){try{return t in c}catch(n){return!1}}function UI(c,t){return E0(c,t)&&!(Object.hasOwnProperty.call(c,t)&&Object.propertyIsEnumerable.call(c,t))}function zI(c,t,n){var o={};return n.isMergeableObject(c)&&gv(c).forEach(function(u){o[u]=Go(c[u],n)}),gv(t).forEach(function(u){UI(c,u)||(E0(c,u)&&n.isMergeableObject(t[u])?o[u]=FI(u,n)(c[u],t[u],n):o[u]=Go(t[u],n))}),o}function Ss(c,t,n){n=n||{},n.arrayMerge=n.arrayMerge||DI,n.isMergeableObject=n.isMergeableObject||II,n.cloneUnlessOtherwiseSpecified=Go;var o=Array.isArray(t),u=Array.isArray(c),f=o===u;return f?o?n.arrayMerge(c,t,n):zI(c,t,n):Go(t,n)}Ss.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(o,u){return Ss(o,u,n)},{})};var BI=Ss,jI=BI;const HI=A0(jI);let mv=!1;const Ed=(c=!1)=>{(c===!0||mv===!1)&&console.warn(["The 'Locale'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.","Please consider using the new 'Language'-plugin instead.","https://rdkcentral.github.io/Lightning-SDK/#/plugins/language"].join(`

`)),mv=!0};class VI{constructor(){this.__enabled=!1}async load(t){this.__enabled&&await fetch(t).then(n=>n.json()).then(n=>{this.loadFromObject(n)})}setLanguage(t){Ed(),this.__enabled=!0,this.language=t}get tr(){return Ed(!0),this.__trObj[this.language]}loadFromObject(t){Ed();const n="en";if(Object.keys(t).indexOf(this.language)===-1)if(ve.warn("No translations found for: "+this.language),Object.keys(t).indexOf(n)>-1)ve.warn("Using fallback language: "+n),this.language=n;else{const o="No translations found for fallback language: "+n;throw ve.error(o),Error(o)}this.__trObj=t;for(const o of Object.values(this.__trObj))for(const u of Object.keys(o))o[u]=new Af(o[u])}}class Af extends String{format(...t){const n=t.reduce((o,u,f)=>o.split(`{${f}}`).join(u),this);return new Af(n)}}const WI=new VI;class GI extends J.Component{static _template(){return{rect:!0,color:3137370284,h:40,w:100,x:t=>t-50,y:t=>t-50,mount:1,Text:{w:t=>t,h:t=>t,y:5,x:20,text:{fontSize:22,lineHeight:26}}}}_firstActive(){this.tag("Text").text=`APP - v${this.version}
SDK - v${this.sdkVersion}`,this.tag("Text").loadTexture(),this.w=this.tag("Text").renderWidth+40,this.h=this.tag("Text").renderHeight+5}}class XI extends J.Component{static _template(){return{rect:!0,color:4294967295,texture:J.Tools.getRoundRect(80,80,40),h:80,w:80,x:100,y:100,mount:1,Background:{x:3,y:3,texture:J.Tools.getRoundRect(72,72,36),color:4278222848},Counter:{w:t=>t,h:t=>t,y:10,text:{fontSize:32,textAlign:"center"}},Text:{w:t=>t,h:t=>t,y:48,text:{fontSize:15,textAlign:"center",text:"FPS"}}}}_setup(){this.config={log:!1,interval:500,threshold:1,...Ai.get("platform","showFps")},this.fps=0,this.lastFps=this.fps-this.config.threshold;const t=()=>{this.fps=~~(1/this.stage.dt)};this.stage.on("frameStart",t),this.stage.off("framestart",t),this.interval=setInterval(this.showFps.bind(this),this.config.interval)}_firstActive(){this.showFps()}_detach(){clearInterval(this.interval)}showFps(){if(Math.abs(this.lastFps-this.fps)<=this.config.threshold)return;this.lastFps=this.fps;let t=4278222848;this.fps<=40&&this.fps>20?t=4294944e3:this.fps<=20&&(t=4294901760),this.tag("Background").setSmooth("color",t),this.tag("Counter").text=`${this.fps}`,this.config.log&&ve.info("FPS",this.fps)}}const Ef=c=>new Promise((t,n)=>{var o=new XMLHttpRequest;o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&(o.status===0||o.status===200?t(JSON.parse(o.responseText)):n(o.statusText))},o.open("GET",c),o.send(null)});let b0,Gd;const qI=c=>{b0=Xd($I(window.location.pathname,c.path||"/")),c.proxyUrl&&(Gd=Xd(c.proxyUrl))},Xo={asset(c){return b0+c},proxyUrl(c,t={}){return Gd?Gd+"?"+_v(c,t):c},makeQueryString(){return _v(...arguments)},ensureUrlWithProtocol(){return Xd(...arguments)}},Xd=c=>/^\/[^/]/i.test(c)&&/^(?:file:)/i.test(window.location.protocol)?window.location.protocol+"//"+c:/^\/\//.test(c)?window.location.protocol+c:/^(?:https?:)/i.test(c)?c:window.location.origin+c,$I=(c="/",t)=>(t=t.charAt(t.length-1)!=="/"?t+"/":t,/^(?:https?:)?(?:\/\/)/.test(t)||t.charAt(0)==="/"?t:(c=YI(c),t=t.charAt(0)==="."?t.substr(1):t,t=t.charAt(0)!=="/"?"/"+t:t,c+t)),YI=c=>{if(c.slice(-1)==="/")return c.slice(0,-1);const t=c.split("/");return t[t.length-1].indexOf(".")>-1&&t.pop(),t.join("/")},_v=(c,t={},n="url")=>(t.operator="metrological",t[n]=c,Object.keys(t).map(o=>encodeURIComponent(o)+"="+encodeURIComponent(""+t[o])).join("&"));let yr={},vs={},Ki=null;const KI=(c,t=null)=>new Promise((n,o)=>{Ef(c).then(u=>{ZI(u),typeof t=="object"&&"then"in t&&typeof t.then=="function"?t.then(f=>yv(f).then(n).catch(o)).catch(f=>{ve.error(f),o(f)}):yv(t).then(n).catch(o)}).catch(()=>{const u="Language file "+c+" not found";ve.error(u),o(u)})}),ZI=c=>{"meta"in c&&(yr={...c.meta},delete c.meta),vs=c},yv=c=>(Ki=null,new Promise((t,n)=>{if(c in vs)Ki=c;else if("map"in yr&&c in yr.map&&yr.map[c]in vs)Ki=yr.map[c];else if("default"in yr&&yr.default in vs){const o="Translations for Language "+Ki+" not found. Using default language "+yr.default;ve.warn(o),Ki=yr.default}else{const o="Translations for Language "+Ki+" not found.";ve.error(o),n(o)}if(Ki){ve.info("Setting language to",Ki);const o=vs[Ki];if(typeof o=="object")t();else if(typeof o=="string"){const u=Xo.asset(o);Ef(u).then(f=>{vs[Ki]=f,t()}).catch(f=>{const m="Error while fetching "+u;ve.error(m,f),n(m)})}}})),Ne={eventListeners:[],timeouts:[],intervals:[],targets:[]},qo={setTimeout(c,t,...n){const o=setTimeout(()=>{Ne.timeouts=Ne.timeouts.filter(u=>u!==o),c.apply(null,n)},t,n);return ve.info("Set Timeout","ID: "+o),Ne.timeouts.push(o),o},clearTimeout(c){Ne.timeouts.indexOf(c)>-1?(Ne.timeouts=Ne.timeouts.filter(t=>t!==c),ve.info("Clear Timeout","ID: "+c),clearTimeout(c)):ve.error("Clear Timeout","ID "+c+" not found")},clearTimeouts(){Ne.timeouts.forEach(c=>{this.clearTimeout(c)})},setInterval(c,t,...n){const o=setInterval(()=>{Ne.intervals.filter(u=>u!==o),c.apply(null,n)},t,n);return ve.info("Set Interval","ID: "+o),Ne.intervals.push(o),o},clearInterval(c){Ne.intervals.indexOf(c)>-1?(Ne.intervals=Ne.intervals.filter(t=>t!==c),ve.info("Clear Interval","ID: "+c),clearInterval(c)):ve.error("Clear Interval","ID "+c+" not found")},clearIntervals(){Ne.intervals.forEach(c=>{this.clearInterval(c)})},addEventListener(c,t,n){c.addEventListener(t,n);const o=Ne.targets.indexOf(c)>-1?Ne.targets.indexOf(c):Ne.targets.push(c)-1;Ne.eventListeners[o]=Ne.eventListeners[o]||{},Ne.eventListeners[o][t]=Ne.eventListeners[o][t]||[],Ne.eventListeners[o][t].push(n),ve.info("Add eventListener","Target:",c,"Event: "+t,"Handler:",n.toString())},removeEventListener(c,t,n){const o=Ne.targets.indexOf(c);o>-1&&Ne.eventListeners[o]&&Ne.eventListeners[o][t]&&Ne.eventListeners[o][t].indexOf(n)>-1?(Ne.eventListeners[o][t]=Ne.eventListeners[o][t].filter(u=>u!==n),ve.info("Remove eventListener","Target:",c,"Event: "+t,"Handler:",n.toString()),c.removeEventListener(t,n)):ve.error("Remove eventListener","Not found","Target",c,"Event: "+t,"Handler",n.toString())},removeEventListeners(c,t){if(c&&t){const n=Ne.targets.indexOf(c);n>-1&&Ne.eventListeners[n][t].forEach(o=>{this.removeEventListener(c,t,o)})}else if(c){const n=Ne.targets.indexOf(c);n>-1&&Object.keys(Ne.eventListeners[n]).forEach(o=>{this.removeEventListeners(c,o)})}else Object.keys(Ne.eventListeners).forEach(n=>{this.removeEventListeners(Ne.targets[n])})},clear(){this.clearTimeouts(),this.clearIntervals(),this.removeEventListeners(),Ne.eventListeners=[],Ne.timeouts=[],Ne.intervals=[],Ne.targets=[]}},QI=c=>typeof c=="object"&&c!==null,I0=c=>typeof c=="string",JI=c=>({r:(c/65536|0)%256,g:(c/256|0)%256,b:c*1%256,a:c/16777216|0}),e2=(c,t,n)=>{let o=(c/65536|0)%256,u=(c/256|0)%256,f=c%256,m=c/16777216|0,p=(t/65536|0)%256,v=(t/256|0)%256,w=t%256,C=t/16777216|0,L=o*n+p*(1-n),E=u*n+v*(1-n),R=f*n+w*(1-n),y=m*n+C*(1-n);return Math.round(y)*16777216+Math.round(L)*65536+Math.round(E)*256+Math.round(R)},t2=(c,t)=>{t>1?t/=100:t<0&&(t=0);let n=(c/65536|0)%256,o=(c/256|0)%256,u=c%256;return(n<<16)+(o<<8)+u+(Math.round(t*255)|0)*16777216},i2=c=>{c[0]=Math.max(0,Math.min(255,c[0])),c[1]=Math.max(0,Math.min(255,c[1])),c[2]=Math.max(0,Math.min(255,c[2])),c[3]=Math.max(0,Math.min(255,c[3]));let t=((c[3]|0)<<24)+((c[0]|0)<<16)+((c[1]|0)<<8)+(c[2]|0);return t<0&&(t=4294967295+t+1),t},ko=c=>{const t=JI(c),n=t.r/255,o=t.g/255,u=t.b/255,f=Math.max(n,o,u),m=Math.min(n,o,u);let p=0,v=0;const w=(m+f)*.5;if(w>0){const C=f-m;if(C>0){const L=(f-n)/C,E=(f-o)/C,R=(f-u)/C;w<.5?v=f+m:v=2-f-m,n===f&&o===m?p=5+R:n===f?p=1-E:o===f&&u===m?p=1+L:o===f?p=3-R:u===f?p=3+E:p=5-L,p=p/6}}return{h:p%1,s:v,l:w,a:t.a}},Oo=c=>{let t=1,n=1,o=1,u=c.h,f=c.s,m=c.l;u<0&&(u+=1);let p=0;if(m<=.5?p=m*(1+f):p=m+f-m*f,p>0){u*=6;const v=m+m-p,w=(p-v)/p,C=Math.floor(u),L=u-C,E=p*w*L,R=v+E,y=p-E;C===0&&(t=p,n=R,o=v),C===1&&(t=y,n=p,o=v),C===2&&(t=v,n=p,o=R),C===3&&(t=v,n=y,o=p),C===4&&(t=R,n=v,o=p),C===5&&(t=p,n=v,o=y)}return i2([Math.floor(t*255),Math.floor(n*255),Math.floor(o*255),c.a])};let iu={white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",yellow:"#feff00",cyan:"#00feff",magenta:"#ff00ff"};const Rn={},xv=(c,t)=>{QI(c)?(Object.keys(c).forEach(n=>vv(n)),iu=Object.assign({},iu,c)):I0(c)&&t&&(vv(c),iu[c]=t)},vv=c=>{for(let t in Rn)t.indexOf(c)>-1&&delete Rn[t]},r2=c=>new Promise((t,n)=>{if(typeof c=="object")return xv(c),t();Ef(c).then(o=>(xv(o),t())).catch(()=>{const o="Colors file "+c+" not found";return ve.error(o),n(o)})}),n2=c=>{let t=Rn[c]||iu[c]||c;t||(t=c);const n=/^#([0-9A-F]{3}|[0-9A-F]{6})$/i;if(I0(t)&&n.test(t)){let o=n.exec(t)[1];o.length===3&&(o=o.split("").map(u=>u+u).join("")),t=`0xff${o}`*1}return Rn[c]||(Rn[c]=t),t||4294967295},Cr=c=>s2.generate(c),s2={color:null,generate:function(c=this.color){return Rn[c]?this.color=Rn[c]:this.color=n2(c),this},get(){return this.color},alpha:function(c){return this.color=t2(this.color,Math.abs(c)),this},darker(c){const t=ko(this.color);return t.l=t.l*(1-c),this.color=Oo(t),this},lighter(c){const t=ko(this.color);return t.l=t.l+(1-t.l)*c,this.color=Oo(t),this},saturation(c){const t=ko(this.color);return t.s=c,this.color=Oo(t),this},lightness(c){const t=ko(this.color);return t.l=c,this.color=Oo(t),this},hue(c){const t=ko(this.color);return t.h=c,this.color=Oo(t),this},mix(c,t){return this.color=e2(this.color,c,t),this}},o2="@lightningjs/sdk",a2="5.3.1",l2="Apache-2.0",u2="index.d.ts",h2={postinstall:"node ./scripts/postinstall.js",lint:"eslint '**/*.js'",release:"npm publish --access public",typedoc:"typedoc --tsconfig tsconfig.typedoc.json",tsd:"tsd"},c2={hooks:{"pre-commit":"lint-staged"}},d2={"@babel/polyfill":"^7.11.5","@lightningjs/core":"^2.7.0","@metrological/sdk":"^1.0.0","@michieljs/execute-as-promise":"^1.0.0",deepmerge:"^4.2.2",localcookies:"^2.0.0",shelljs:"^0.8.5","url-polyfill":"^1.1.10","whatwg-fetch":"^3.0.0"},f2={"@babel/core":"^7.11.6","@babel/plugin-transform-parameters":"^7.10.5 ","@babel/plugin-transform-spread":"^7.11.0","@babel/preset-env":"^7.11.5","babel-eslint":"^10.1.0",eslint:"^7.10.0","eslint-config-prettier":"^6.12.0","eslint-plugin-prettier":"^3.1.4",husky:"^4.3.0","lint-staged":"^10.4.0",prettier:"^1.19.1",rollup:"^1.32.1","rollup-plugin-babel":"^4.4.0",tsd:"^0.22.0",typedoc:"^0.23.9"},p2={type:"git",url:"git@github.com:rdkcentral/Lightning-SDK.git"},g2={url:"https://github.com/rdkcentral/Lightning-SDK/issues"},wv={name:o2,version:a2,license:l2,types:u2,scripts:h2,"lint-staged":{"*.js":["eslint --fix"],"src/startApp.js":["rollup -c ./rollup.config.js"]},husky:c2,dependencies:d2,devDependencies:f2,repository:p2,bugs:g2};let qd;const vn={stage:{w:1920,h:1080,precision:1,clearColor:0,canvas2d:!1},debug:!1,defaultFontFace:"RobotoRegular",keys:{8:"Back",13:"Enter",27:"Menu",37:"Left",38:"Up",39:"Right",40:"Down",174:"ChannelDown",175:"ChannelUp",178:"Stop",250:"PlayPause",191:"Search",409:"Search"}},bd=[],m2=(c,t)=>new Promise((n,o)=>{c.map(({family:u,url:f,urls:m,descriptors:p})=>()=>{const v=m?m.map(C=>"url("+C+")"):"url("+f+")",w=new FontFace(u,v,p||{});return t.push(w),ve.info("Loading font",u),document.fonts.add(w),w.load()}).reduce((u,f)=>u.then(()=>f()),Promise.resolve(null)).then(n).catch(o)});function _2(c,t,n){const{width:o,height:u}=n;return o&&u&&(vn.stage.w=o,vn.stage.h=u,vn.stage.precision=o/1920),!o&&!u&&window.innerHeight===720&&(vn.stage.w=1280,vn.stage.h=720,vn.stage.precision=1280/1920),class extends J.Application{constructor(m){const p=HI(vn,m);m.stage.canvas&&(p.stage.canvas=m.stage.canvas),super(p),this.config=p}static _template(){return{w:1920,h:1080}}colorshift(m=!1,p={}){Jb.colorshift(this,m,p)}get keymapping(){return this.stage.application.config.keys}overrideKeyMap(m,p=!1){const v=this.stage.application.config.keys;return Object.keys(m).reduce((w,C)=>(p||Object.keys(v).forEach(L=>{L!=C&&v[L]==m[C]&&delete w[L]}),w[C]=m[C],w),v),v}_setup(){Promise.all([this.loadFonts(c.config&&c.config.fonts||c.getFonts&&c.getFonts()||[]),WI.load(c.config&&c.config.locale||c.getLocale&&c.getLocale()),c.language&&this.loadLanguage(c.language()),c.colors&&this.loadColors(c.colors())]).then(()=>{Tf.app.loaded(),this.w=this.config.stage.w/this.config.stage.precision,this.h=this.config.stage.h/this.config.stage.precision,qd=this.stage.c({ref:"App",type:c,zIndex:1,forceZIndexContext:!!n.showVersion||!!n.showFps}),this.childList.a(qd),this._refocus(),ve.info("App version",this.config.version),ve.info("SDK version",wv.version),n.showVersion&&this.childList.a({ref:"VersionLabel",type:GI,version:this.config.version,sdkVersion:wv.version,zIndex:1}),n.showFps&&this.childList.a({ref:"FpsCounter",type:XI,zIndex:1}),super._setup()}).catch(console.error)}_handleBack(){this.closeApp()}_handleExit(){this.closeApp()}closeApp(){ve.info("Signaling App Close"),n.onClose&&typeof n.onClose=="function"?n.onClose(...arguments):this.close()}close(){ve.info("Closing App"),Ai.clearSubscribers(),qo.clear(),this.childList.remove(this.tag("App")),this.cleanupFonts(),this.stage.gc(),this.destroy()}loadFonts(m){return n.fontLoader&&typeof n.fontLoader=="function"?n.fontLoader(m,bd):m2(m,bd)}cleanupFonts(){"delete"in document.fonts?bd.forEach(m=>{ve.info("Removing font",m.family),document.fonts.delete(m)}):ve.info("No support for removing manually-added fonts")}loadLanguage(m){let p=Xo.asset("translations.json"),v=m;return typeof v=="object"&&(v=m.language||null,p=m.file||p),KI(p,v)}loadColors(m){let p=Xo.asset("colors.json");return m&&(typeof m=="string"||typeof m=="object")&&(p=m),r2(p)}set focus(m){this._focussed=m,this._refocus()}_getFocused(){return this._focussed||this.tag("App")}}}class mM extends J.textures.ImageTexture{constructor(t){super(t),this._scalingOptions=void 0}set options(t){this.resizeMode=this._scalingOptions=t}_getLookupId(){return`${this._src}-${this._scalingOptions.type}-${this._scalingOptions.w}-${this._scalingOptions.h}`}getNonDefaults(){const t=super.getNonDefaults();return this._src&&(t.src=this._src),t}}const Tv=["timeupdate","error","ended","loadeddata","canplay","play","playing","pause","loadstart","seeking","seeked","encrypted"];let R0=c=>c;const y2=c=>{c.mediaUrl&&(R0=c.mediaUrl)};class _M extends J.Component{_construct(){this._skipRenderToTexture=!1,this._metrics=null,this._textureMode=Ai.get("platform","textureMode")||!1,ve.info("Texture mode: "+this._textureMode),console.warn(["The 'MediaPlayer'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.","Please consider using the new 'VideoPlayer'-plugin instead.","https://rdkcentral.github.io/Lightning-SDK/#/plugins/videoplayer"].join(`

`))}static _template(){return{Video:{VideoWrap:{VideoTexture:{visible:!1,pivot:.5,texture:{type:J.textures.StaticTexture,options:{}}}}}}}set skipRenderToTexture(t){this._skipRenderToTexture=t}get textureMode(){return this._textureMode}get videoView(){return this.tag("Video")}_init(){const t=document.getElementsByTagName("video");t&&t.length>0?this.videoEl=t[0]:(this.videoEl=document.createElement("video"),this.videoEl.setAttribute("id","video-player"),this.videoEl.style.position="absolute",this.videoEl.style.zIndex="1",this.videoEl.style.display="none",this.videoEl.setAttribute("width","100%"),this.videoEl.setAttribute("height","100%"),this.videoEl.style.visibility=this.textureMode?"hidden":"visible",document.body.appendChild(this.videoEl)),this.textureMode&&!this._skipRenderToTexture&&this._createVideoTexture(),this.eventHandlers=[]}_registerListeners(){Tv.forEach(t=>{const n=o=>{this._metrics&&this._metrics[t]&&typeof this._metrics[t]=="function"&&this._metrics[t]({currentTime:this.videoEl.currentTime}),this.fire(t,{videoElement:this.videoEl,event:o})};this.eventHandlers.push(n),this.videoEl.addEventListener(t,n)})}_deregisterListeners(){ve.info("Deregistering event listeners MediaPlayer"),Tv.forEach((t,n)=>{this.videoEl.removeEventListener(t,this.eventHandlers[n])}),this.eventHandlers=[]}_attach(){this._registerListeners()}_detach(){this._deregisterListeners(),this.close()}_createVideoTexture(){const n=this.stage.gl,o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),this.videoTexture.options={source:o,w:this.videoEl.width,h:this.videoEl.height}}_startUpdatingVideoTexture(){if(this.textureMode&&!this._skipRenderToTexture){const t=this.stage;this._updateVideoTexture||(this._updateVideoTexture=()=>{if(this.videoTexture.options.source&&this.videoEl.videoWidth&&this.active){const n=t.gl,o=new Date().getTime(),u=this.videoEl.webkitDecodedFrameCount;if(u?this._lastFrame!==u:this._lastTime<o-30){this._lastTime=o,this._lastFrame=u;try{n.bindTexture(n.TEXTURE_2D,this.videoTexture.options.source),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.videoEl),this._lastFrame=this.videoEl.webkitDecodedFrameCount,this.videoTextureView.visible=!0,this.videoTexture.options.w=this.videoEl.videoWidth,this.videoTexture.options.h=this.videoEl.videoHeight;const m=this.videoTextureView.w/this.videoTextureView.h,p=this.videoEl.videoWidth/this.videoEl.videoHeight;m>p?(this.videoTextureView.scaleX=p/m,this.videoTextureView.scaleY=1):(this.videoTextureView.scaleY=m/p,this.videoTextureView.scaleX=1)}catch(m){ve.error("texImage2d video",m),this._stopUpdatingVideoTexture(),this.videoTextureView.visible=!1}this.videoTexture.source.forceRenderUpdate()}}}),this._updatingVideoTexture||(t.on("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!0)}}_stopUpdatingVideoTexture(){if(this.textureMode){const t=this.stage;if(t.removeListener("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!1,this.videoTextureView.visible=!1,this.videoTexture.options.source){const n=t.gl;n.bindTexture(n.TEXTURE_2D,this.videoTexture.options.source),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT)}}}updateSettings(t={}){this._consumer=t.consumer,this._consumer&&this._consumer.getMediaplayerSettings&&(t=Object.assign(t,this._consumer.getMediaplayerSettings())),J.Utils.equalValues(this._stream,t.stream)||(t.stream&&t.stream.keySystem?navigator.requestMediaKeySystemAccess(t.stream.keySystem.id,t.stream.keySystem.config).then(n=>n.createMediaKeys()).then(n=>this.videoEl.setMediaKeys(n)).then(()=>{t.stream&&t.stream.src&&this.open(t.stream.src)}).catch(()=>{console.error("Failed to set up MediaKeys")}):t.stream&&t.stream.src?Ai.get("app","hls")?(window.Hls||(window.Hls=class{static isSupported(){return console.warn("hls-light not included"),!1}}),window.Hls.isSupported()&&(this._hls||(this._hls=new window.Hls({liveDurationInfinity:!0})),this._hls.loadSource(t.stream.src),this._hls.attachMedia(this.videoEl),this.videoEl.style.display="block")):this.open(t.stream.src):this.close(),this._stream=t.stream),this._setHide(t.hide),this._setVideoArea(t.videoPos)}_setHide(t){this.textureMode?this.tag("Video").setSmooth("alpha",t?0:1):this.videoEl.style.visibility=t?"hidden":"visible"}open(t,n={hide:!1,videoPosition:null}){if(t=R0(t),this._metrics=Tf.media(t),ve.info("Playing stream",t),this.application.noVideo){ve.info("noVideo option set, so ignoring: "+t);return}this.videoEl.getAttribute("src")===t&&this.close(),this.videoEl.setAttribute("src",t),this.videoEl.style.visibility="hidden",this.videoEl.style.display="none",setTimeout(()=>{this.videoEl.style.display="block",this.videoEl.style.visibility="visible"}),this._setHide(n.hide),this._setVideoArea(n.videoPosition||[0,0,1920,1080])}close(){this.videoEl.pause(),this.videoEl.removeAttribute("src"),this.videoEl.load(),this._clearSrc(),this.videoEl.style.display="none"}playPause(){this.isPlaying()?this.doPause():this.doPlay()}get muted(){return this.videoEl.muted}set muted(t){this.videoEl.muted=t}get loop(){return this.videoEl.loop}set loop(t){this.videoEl.loop=t}isPlaying(){return this._getState()==="Playing"}doPlay(){this.videoEl.play()}doPause(){this.videoEl.pause()}reload(){var t=this.videoEl.getAttribute("src");this.close(),this.videoEl.src=t}getPosition(){return Promise.resolve(this.videoEl.currentTime)}setPosition(t){this.videoEl.currentTime=t}getDuration(){return Promise.resolve(this.videoEl.duration)}seek(t,n=!1){n?this.videoEl.currentTime=t:this.videoEl.currentTime+=t}get videoTextureView(){return this.tag("Video").tag("VideoTexture")}get videoTexture(){return this.videoTextureView.texture}_setVideoArea(t){if(!J.Utils.equalValues(this._videoPos,t))if(this._videoPos=t,this.textureMode)this.videoTextureView.patch({smooth:{x:t[0],y:t[1],w:t[2]-t[0],h:t[3]-t[1]}});else{const n=this.stage.getRenderPrecision();this.videoEl.style.left=Math.round(t[0]*n)+"px",this.videoEl.style.top=Math.round(t[1]*n)+"px",this.videoEl.style.width=Math.round((t[2]-t[0])*n)+"px",this.videoEl.style.height=Math.round((t[3]-t[1])*n)+"px"}}_fireConsumer(t,n){this._consumer&&this._consumer.fire(t,n)}_equalInitData(t,n){if(!t||!n||t.byteLength!=n.byteLength)return!1;const o=new Int8Array(t),u=new Int8Array(n);for(let f=0;f!=t.byteLength;f++)if(o[f]!=u[f])return!1;return!0}error(t){return this._fireConsumer("$mediaplayerError",t),this._setState(""),""}loadeddata(t){this._fireConsumer("$mediaplayerLoadedData",t)}play(t){this._fireConsumer("$mediaplayerPlay",t)}playing(t){this._fireConsumer("$mediaplayerPlaying",t),this._setState("Playing")}canplay(t){this.videoEl.play(),this._fireConsumer("$mediaplayerStart",t)}loadstart(t){this._fireConsumer("$mediaplayerLoad",t)}seeked(){this._fireConsumer("$mediaplayerSeeked",{currentTime:this.videoEl.currentTime,duration:this.videoEl.duration||1})}seeking(){this._fireConsumer("$mediaplayerSeeking",{currentTime:this.videoEl.currentTime,duration:this.videoEl.duration||1})}durationchange(t){this._fireConsumer("$mediaplayerDurationChange",t)}encrypted(t){const n=t.videoElement,o=t.event;n.mediaKeys&&!this._equalInitData(this._previousInitData,o.initData)&&(this._previousInitData=o.initData,this._fireConsumer("$mediaplayerEncrypted",t))}static _states(){return[class extends this{$enter(){this._startUpdatingVideoTexture()}$exit(){this._stopUpdatingVideoTexture()}timeupdate(){this._fireConsumer("$mediaplayerProgress",{currentTime:this.videoEl.currentTime,duration:this.videoEl.duration||1})}ended(n){this._fireConsumer("$mediaplayerEnded",n),this._setState("")}pause(n){this._fireConsumer("$mediaplayerPause",n),this._setState("Playing.Paused")}_clearSrc(){this._fireConsumer("$mediaplayerStop",{}),this._setState("")}static _states(){return[class extends this{}]}}]}}class x2{constructor(t){return t=t||{},this.forceCookies=t.forceCookies||!1,this._checkIfLocalStorageWorks()===!0&&t.forceCookies!==!0?{getItem:this._getItemLocalStorage,setItem:this._setItemLocalStorage,removeItem:this._removeItemLocalStorage,clear:this._clearLocalStorage,keys:this._getLocalStorageKeys}:{getItem:this._getItemCookie,setItem:this._setItemCookie,removeItem:this._removeItemCookie,clear:this._clearCookies,keys:this._getCookieKeys}}_checkIfLocalStorageWorks(){if(typeof localStorage>"u")return!1;try{return localStorage.setItem("feature_test","yes"),localStorage.getItem("feature_test")==="yes"&&(localStorage.removeItem("feature_test"),!0)}catch(t){return!1}}_getItemLocalStorage(t){return window.localStorage.getItem(t)}_setItemLocalStorage(t,n){return window.localStorage.setItem(t,n)}_removeItemLocalStorage(t){return window.localStorage.removeItem(t)}_clearLocalStorage(){return window.localStorage.clear()}_getLocalStorageKeys(){return Object.keys(window.localStorage)}_getItemCookie(t){var n=document.cookie.match(RegExp("(?:^|;\\s*)"+function(o){return o.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}(t)+"=([^;]*)"));return n&&n[1]===""&&(n[1]=null),n?n[1]:null}_setItemCookie(t,n){var o=new Date,u=new Date(o.getTime()+15768e7);document.cookie=`${t}=${n}; expires=${u.toUTCString()};`}_removeItemCookie(t){document.cookie=`${t}=;Max-Age=-99999999;`}_clearCookies(){document.cookie.split(";").forEach(t=>{document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=Max-Age=-99999999")})}_getCookieKeys(){return document.cookie.split(";").map(t=>t.split("=")[0])}}let $o,Sn;const v2=()=>{$o=Ai.get("platform","id"),Sn=new x2},Id=c=>$o?[$o,c].join("."):c,bf={get(c){try{return JSON.parse(Sn.getItem(Id(c)))}catch(t){return null}},set(c,t){try{return Sn.setItem(Id(c),JSON.stringify(t)),!0}catch(n){return!1}},remove(c){Sn.removeItem(Id(c))},clear(){$o?Sn.keys().forEach(c=>{c.indexOf($o+".")===0&&Sn.removeItem(c)}):Sn.clear()}},du=/\{\/(.*?)\/([igm]{0,3})\}/g,If=/^[!*$]$/,Sv=/\/:\w+?@@([0-9]+?)@@/,Cv=/^\/:/,Su=(c,t="R")=>(du.test(c)&&(c=c.replace(du,t)),c),w2=c=>{const t=new Map;return[...Object.keys(c),...Object.getOwnPropertySymbols(c)].forEach(n=>{t.set(n,c[n])}),t};class T2{constructor(t="",n,o){this._hash=t,this._storeCaller=o,this._register=new Map,this._isCreated=!1,this._isSharedInstance=!1,this._cancelled=!1,this._copiedHistoryState=null,zi(n)?this._register=w2(n):er(n)&&(this._storeCaller=n),this._register.set(It.store,this._storeCaller)}cancel(){ve.debug("[router]:",`cancelled ${this._hash}`),this._cancelled=!0}get url(){return this._hash}get register(){return this._register}get hash(){return this._hash}set hash(t){this._hash=t}get route(){return this._route}set route(t){this._route=t}get provider(){return this._provider}set provider(t){this._provider=t}get providerType(){return this._providerType}set providerType(t){this._providerType=t}set page(t){this._page=t}get page(){return this._page}set isCreated(t){this._isCreated=t}get isCreated(){return this._isCreated}get isSharedInstance(){return this._isSharedInstance}set isSharedInstance(t){this._isSharedInstance=t}get isCancelled(){return this._cancelled}set copiedHistoryState(t){this._copiedHistoryState=t}get copiedHistoryState(){return this._copiedHistoryState}}class S2{constructor(t={}){let n=["on","before","after"].reduce((o,u)=>Dt(t[u])?u:o,void 0);this._cfg=t,n&&(this._provider={type:n,request:t[n]})}get path(){return this._cfg.path}get name(){return this._cfg.name}get component(){return this._cfg.component}get options(){return this._cfg.options}get widgets(){return this._cfg.widgets}get cache(){return this._cfg.cache}get hook(){return this._cfg.hook}get beforeNavigate(){return this._cfg.beforeNavigate}get provider(){return this._provider}}const Rf=c=>Su(c).split("/").length,C2=c=>{const t=[];for(let[n]of Er.entries())Rf(n)===c&&t.push(n);return t},Cu=c=>{c=c.replace(/^#/,"");const t=/(\/?:?[^/]+)/g,n=C2(Rf(c)),o=c.match(t)||[];let u=[],f=n.filter(m=>{let p=!0;if(du.test(m)){const w=m.match(du);w&&w.length&&(m=w.reduce((C,L)=>{const E=u.length;return C=C.replace(L,`@@${E}@@`),u.push(L.substring(1,L.length-1)),C},m))}const v=m.match(t)||[];for(let w=0,C=v.length;w<C;w++){const L=v[w],E=o[w];if(Sv.test(L)){const y=Sv.exec(L)[1],I=u[y],U=/\/([^\/]+)\/([igm]{0,3})/.exec(I);if(U&&U.length){const Z=U[1],te=U[2];new RegExp(`^/${Z}$`,te).test(E)||(p=!1)}}else{if(Cv.test(L))continue;E&&L.toLowerCase()!==E.toLowerCase()&&(p=!1)}}return p});if(f.length){if(f.indexOf(c)!==-1){const m=f[f.indexOf(c)];return Er.get(m)}else if(f=f.sort(m=>Cv.test(m)?-1:1),Wr(f[0]))return Er.get(f[0])}return!1},L0=(c="",t)=>{t=Su(t,"");const n=/(\/?:?[\w%\s:.-]+)/g,o=c.match(n)||[],u=t.match(n)||[],f=/^\/:([\w-]+)\/?/;return u.reduce((m,p,v)=>{const w=f.exec(p);return w&&w.length&&m.set(w[1],decodeURIComponent(o[v].replace(/^\//,""))),m},new Map)},Au=(c,t)=>{if(c&&c.hasOwnProperty(t))return c[t]},A2=c=>{if(c.path==="$"){let t={preventStorage:!0};zi(c.options)&&(t={...c.options,...t}),c.options=t,Yo&&(c.after=Yo)}return new S2(c)},E2=(c,t,n)=>new T2(c,t,n),b2=c=>{if(!c.to&&!c.name)return!1;const t=I2(c.to||c.name),n=/\/:([\w-]+)\/?/;let o=t;return n.test(t)&&(c.params&&(o=Object.keys(c.params).reduce((f,m)=>f.replace(`:${m}`,c.params[m]),t)),c.query)?`${o}${Q2(c.query)}`:o},I2=c=>{for(let[t,n]of Er.entries())if(n.name===c)return t;return!1},R2=(c,t)=>{if(kn(c)){const u=Y2();if(u.has(c))c=u.get(c);else return!1}const n=t.register,o=c.options;return n.has("keepAlive")?n.get("keepAlive"):o&&o.keepAlive?o.keepAlive:!1},Cs=(c,t=[],n={})=>{Of(t)||(t=[t]),t.forEach(o=>{const u=`_on${X0(o)}`;Dt(c[u])&&c[u](n)})};let Ln=null;const L2=()=>{if(Pn)return Pn.get().reduce((c,t)=>{const n=t.ref.toLowerCase();return c[n]=t,c},{})},M2=(c,t)=>{const n=(c||[]).map(o=>o.toLowerCase());Pn.forEach(o=>{o.visible=n.indexOf(o.ref.toLowerCase())!==-1,o.visible&&Cs(o,["activated"],t)}),ot.state==="Widgets"&&Ln&&!Ln.visible&&ot._setState("")},P2=c=>(c=X0(c),Pn.getByRef(c)||!1),k2=c=>{const t=P2(c);t&&(O2(t),ot.state==="Widgets"?ot.reload(Ln):ot._setState("Widgets",[Ln]))},Av=()=>{Ln=null,ot._setState("")},M0=()=>Ln,O2=c=>{Ln=c},P0=(c,t)=>c.c({type:t,visible:!1,widgets:L2()});let Yt=[];const k0=c=>{const t=As();if(!t)return;const o=c.register.get(It.store),u=Cu(t),f=Au(u.options,"preventStorage");if(er(o)?o:!f){const p=t.replace(/^\//,""),v=fu(p),w=N2(Hr(),c),C=G0();if(v===-1||C.get("storeSameHash"))Yt.push({hash:p,state:w});else{const L=Yt.splice(v,1)[0];Yt.push({hash:L.hash,state:w})}}},fu=c=>{for(let t=0;t<Yt.length;t++)if(Yt[t].hash===c)return t;return-1},D2=c=>{let t=null;return Yt.length&&(c?fu(c)!==-1&&(t=Yt[fu(c)].state):t=Yt[Yt.length-1].state),t},F2=(c=null,t)=>{if(!Yt.length)return;const n=t?fu(t):Yt.length-1;n!==-1&&zi(c)&&(Yt[n].state=c)},N2=(c,t)=>{if(t.isSharedInstance){if(t.copiedHistoryState)return t.copiedHistoryState}else if(c&&Dt(c.historyState))return c.historyState();return null},O0=()=>Yt.slice(0),Eu=(c=[])=>{Of(c)&&(Yt=c)};let Ev,ot,Mn,bu,Ei,Pn,D0,Yo,$d=!0,F0=async(c,t)=>!0,N0=()=>{},Er=new Map,Ko=new Map,U0=!1,Lf=null,z0,pu,B0,j0;const U2=c=>{c.pages&&(Mn=c.pages.childList),c.widgets&&c.widgets.children&&(Pn=c.widgets.childList,Pn.forEach(t=>t.visible=!1)),c._handleBack=t=>{ru(-1),t.preventDefault()}},z2=(c,t)=>{let{appInstance:n,routes:o}=c;t&&Pf(t)&&(ot=t),ot||(ot=n||qd),Ev=ot.application,Mn=Ev.childList,bu=ot.stage,Ei=Z2(),U2(ot),Of(o)?B2(c):Dt(o)&&(console.warn("[Router]: Calling Router.route() directly is deprecated."),console.warn("Use object config: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration"))},B2=c=>{U0||j2(c),c.routes.forEach(t=>{const n=Df(t.path);if(Wr(n))console.error(`${n} already exists in routes configuration`);else{const o=A2(t);if(Er.set(n,o),o.component){let u=o.component;kf(u)&&(Ei.get("lazyCreate")||(u=P0(bu,u),Mn.a(u))),Ko.set(n,u)}}})},j2=c=>{D0=c.root,Dt(c.boot)&&(Yo=c.boot),er(c.updateHash)&&($d=c.updateHash),Dt(c.beforeEachRoute)&&(F0=c.beforeEachRoute),Dt(c.afterEachRoute)&&(N0=c.afterEachRoute),c.bootComponent&&(console.warn("[Router]: Boot Component is now available as a special router: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration?id=special-routes"),console.warn("[Router]: setting { bootComponent } property will be deprecated in a future release"),Pf(c.bootComponent)?c.routes.push({path:"$",component:c.bootComponent,after:Yo||null,options:{preventStorage:!0}}):console.error(`[Router]: ${c.bootComponent} is not a valid boot component`)),c.routes.forEach(t=>{const n=Su(t.path);if(/.*\/:.*?\?$/u.test(n)){const u=t.path.substring(0,t.path.lastIndexOf("/")),f=t.path.substring(0,t.path.lastIndexOf("?"));t.path=f;let m={...t};m.path=u,c.routes.push(m)}}),U0=!0},Mf=(c,t)=>{Ko.has(c)&&Ko.set(c,t)},H0=c=>Ko.has(c)?Ko.get(c):null,Yd=()=>{if(!Ei||!Ei.size)return!1;const c=Ei.get("updateHash");return!(er(c)&&!c||er($d)&&!$d)},H2=c=>{const t=c.hash,n=c.route,o=c.register,u=c.page;Au(n.options,"clearHistory")?Eu([]):t&&!If.test(n.path)&&k0(c),Mf(n.path,u),c.isSharedInstance||!c.isCreated?Cs(u,"changed"):c.isCreated&&Cs(u,"mounted"),Pn&&M2(n.widgets,u),Hr()&&!c.isSharedInstance&&V2(Lf,c),o.get(It.historyState)&&Dt(u.historyState)&&u.historyState(o.get(It.historyState)),W2(u),z0=c.hash,pu=n.path;for(let f of oi.values())f.isCancelled&&f.hash&&oi.delete(f.hash);N0(c),ve.info("[route]:",n.path),ve.info("[hash]:",t)},V2=(c,t)=>{const n=pu,o=t.register,u=Ei.get("lazyDestroy"),f=Ei.get("destroyOnHistoryBack"),m=o.get("keepAlive"),p=o.get(It.backtrack);let v=!1;p&&(f||u)&&(v=!0),u&&!m&&(v=!0),pu===t.route.path&&(v=!0),v?(Mf(n,c._routedType||c.constructor),Mn.remove(c),Ei.get("gcOnUnload")&&bu.gc()):c.patch({x:0,y:0,scale:1,alpha:1,visible:!1})},As=()=>z0,W2=c=>{Lf=c},Hr=()=>Lf,Kd=()=>pu,V0=()=>B0,G2=c=>{B0=c},X2=c=>{j0=c},q2=()=>j0,Wr=c=>Er.has(c),W0=()=>D0,$2=()=>Yo,G0=()=>Ei,Y2=()=>Er,Dt=c=>typeof c=="function",zi=c=>typeof c=="object"&&c!==null,er=c=>typeof c=="boolean",Pf=c=>!!(c instanceof J.Element||kf(c)),kf=c=>c.prototype&&"isComponent"in c.prototype,Of=c=>Array.isArray(c),X0=c=>`${c.charAt(0).toUpperCase()}${c.slice(1)}`,kn=c=>typeof c=="string",K2=c=>{let t;if(Dt(c))try{t=c.apply(null)}catch(n){t=n}else t=c;return zi(t)&&Dt(t.then)},Df=(c="")=>c.replace(/^#/,"").replace(/\/+$/,""),Z2=()=>{const c=Ai.get("platform","router"),t=zi(c);return["backtrack","gcOnUnload","destroyOnHistoryBack","lazyCreate","lazyDestroy","reuseInstance","autoRestoreRemote","numberNavigation","updateHash","storeSameHash"].reduce((n,o)=>(n.set(o,t?c[o]:Ai.get("platform",o)),n),new Map)},Ff=(c=As())=>{const t=xR();(c==="$"||!c)&&t&&kn(t)&&(c=t);let n="";const u=/([?&].*)/.exec(c),f={};if(document.location&&document.location.search&&(n=document.location.search),u&&u.length){let m=u[1];n?(m=m.replace(/^\?/,""),n=`${n}&${m}`):n=m}if(n){const m=new URLSearchParams(n);for(const[p,v]of m.entries())f[p]=v;return f}else return!1},Q2=c=>zi(c)?"?"+Object.keys(c).map(t=>`${t}=${c[t]}`).join("&"):"",It={route:Symbol("route"),hash:Symbol("hash"),store:Symbol("store"),fromHistory:Symbol("fromHistory"),expires:Symbol("expires"),resume:Symbol("resume"),backtrack:Symbol("backtrack"),historyState:Symbol("historyState"),queryParams:Symbol("queryParams")},J2={on:c=>(X2(ot.state||""),ot._setState("Loading"),Rd(c)),before:c=>Rd(c),after:c=>{try{Rd(c,!0)}catch(t){}return Promise.resolve()}},Rd=(c,t)=>{const n=c.route,o=n.provider,u=n.cache?n.cache*1e3:0,f=q0(c);return o.request(c.page,{...f}).then(()=>{c.page[It.expires]=Date.now()+u,t&&Cs(c.page,"dataProvided")}).catch(m=>{throw c.page[It.expires]=Date.now(),m})},q0=({page:c,route:t,hash:n,register:o=new Map})=>{const u=L0(n,t.path),f=Ff(n),m=new Map([...u,...o]),p={};for(let[v,w]of m)p[v]=w;if(f&&(p[It.queryParams]=f),o.size){const v={};for(let[w,C]of o)v[w]=C;c.persist=v}return c.params=p,Cs(c,["urlParams"],p),p},eR=c=>{if(!c[It.expires])return!1;const t=c[It.expires];return Date.now()>=t},bv=c=>Wr(c)?!!Er.get(c).provider:!1,tR=c=>{if(Wr(c.path)){const{provider:t}=Er.get(c.path);return{type:t.type,provider:t.request}}},iR=(c,t)=>new Promise(n=>{c.patch({alpha:0,visible:!0,smooth:{alpha:[1,{duration:.5,delay:.1}]}}),c.transition("alpha").on("finish",()=>{t&&(t.visible=!1),n()})}),rR=(c,t)=>new Promise(n=>{c.patch({alpha:0,visible:!0,smooth:{alpha:[1,{duration:.5,delay:.1}]}}),t&&t.patch({smooth:{alpha:[0,{duration:.5,delay:.3}]}}),c.transition("alpha").on("finish",()=>{n()})}),Iu=(c,t,n,o)=>{const u=c==="x"?1920:1080;return new Promise(f=>{n.patch({[`${c}`]:t?u*-1:u,visible:!0,smooth:{[`${c}`]:[0,{duration:.4,delay:.2}]}}),o&&o.patch({[`${c}`]:0,smooth:{[`${c}`]:[t?u:u*-1,{duration:.4,delay:.2}]}}),n.transition(c).on("finish",()=>{f()})})},nR=(c,t)=>Iu("y",0,c,t),sR=(c,t)=>Iu("y",1,c,t),oR=(c,t)=>Iu("x",0,c,t),aR=(c,t)=>Iu("x",1,c,t),Iv={fade:iR,crossFade:rR,up:nR,down:sR,left:oR,right:aR},lR=(c,t=null)=>{const n=c.pageTransition||c.easing,o=!!(c.smoothIn||c.smoothInOut||n),u=G0().get("disableTransitions");if(c.easing&&console.warn("easing() method is deprecated and will be removed. Use pageTransition()"),!o||u)return c.visible=!0,t&&(t.visible=!1),Promise.resolve();if(n){let f;try{f=n.call(c,c,t)}catch(m){f="crossFade"}if(K2(f))return f;if(kn(f)){const m=Iv[f];if(m)return m(c,t)}if(c.smoothIn){const m=(p,v,w={})=>new Promise(C=>{c.visible=!0,c.setSmooth(p,v,w),c.transition(p).on("finish",()=>{C()})});return c.smoothIn({pageIn:c,smooth:m})}}return Iv.crossFade(c,t)},Rv=async c=>{let t=!1;try{if(c=await uR(c),c&&!c.isCancelled?(ot.state==="Loading"&&(q2()==="Widgets"?ot._setState("Widgets",[M0()]):ot._setState("")),!c.isSharedInstance&&!c.isCancelled&&await lR(c.page,Hr())):t=!0,t||c.isCancelled)ve.debug("[router]:",`Rejected ${c.hash} because route to ${V0()} started`),c.isCreated&&!c.isSharedInstance&&Mn.remove(c.page);else return H2(c),c.page}catch(n){if(!n.route)console.error(n);else if(!t){const{route:o}=n;Au(o.options,"clearHistory")?Eu([]):If.test(o.path)||k0(n),n.isCreated&&!n.isSharedInstance&&Mn.remove(n.page),hR(n)}}},uR=async c=>{const t=c.route,n=c.hash,o=c.register;let u=H0(t.path),f=kf(u),m=!1;if(!f&&!o.get(It.backtrack)&&(cR(t)||(u=u.constructor,f=!0)),f)c.page=P0(bu,u),Mn.a(c.page),bv(t.path)&&(m=!0),c.isCreated=!0;else{c.page=u,bv(t.path)&&(eR(u)||u[It.hash]!==n)&&(m=!0);let p=Hr()&&Hr()[It.route];t.path===p&&(c.isSharedInstance=!0,Dt(c.page.historyState)&&(c.copiedHistoryState=c.page.historyState()))}c.page[It.hash]=n,c.page[It.route]=t.path;try{if(m){const{type:p,provider:v}=tR(t);return c.provider=v,c.providerType=p,await J2[p](c),n!==V0()?!1:(c.providerType!=="after"&&Cs(c.page,"dataProvided"),c)}else return q0(c),c}catch(p){return c.error=p,Promise.reject(c)}},hR=c=>{c&&c.error?console.error(c.error):c&&ve.error(c),c.page&&Wr("!")&&At("!",{request:c},!1)},cR=c=>{const t=Au(c.options,"reuseInstance"),n=Ei.get("reuseInstance");return er(t)?t:!(er(n)&&n===!1)};class dR extends J.Component{static _template(){return{Pages:{forceZIndexContext:!0},Loading:{rect:!0,w:1920,h:1080,color:4278190080,visible:!1,zIndex:99,Label:{mount:.5,x:960,y:540,text:{text:"Loading.."}}}}}static _states(){return[class extends this{$enter(){this.tag("Loading").visible=!0}$exit(){this.tag("Loading").visible=!1}},class extends this{$enter(n,o){this._widget=o,this._refocus()}_getFocused(){return this._widget}reload(n){this._widget=n,this._refocus()}_handleKey(){const n=Ei.get("autoRestoreRemote");(!er(n)||n===!0)&&Bt.focusPage()}}]}get pages(){return this.tag("Pages")}get widgets(){return this.tag("Widgets")}_handleBack(){}_getFocused(){return Bt.getActivePage()}}let oi=new Map,Ld="",Tr="";const fR=(c,t)=>{z2(c,t),wR(),pR()},pR=()=>{let c=(ta()||"").replace(/^#/,"");const t="$",n=Ff(c),o=$2(),u=W0(),f=c.indexOf(t)!==-1;If.test(c)&&c!==t&&(c=""),Tr=f?u:c||u;const m=()=>{!c&&u?kn(u)?At(u):Dt(u)&&u().then(p=>{zi(p)?At(p.path,p.params):At(p)}):(gu(c),mu().then(()=>{ot._refocus()}).catch(p=>{console.error(p)}))};if(Wr(t)){if(c&&!f&&!Cu(c)){At("*",{failedHash:c});return}At(t,{resume:Tr,reload:t===c},!1)}else Dt(o)?o(n).then(()=>{m()}).catch(p=>{gR(p)}):m()},gR=c=>{Wr("!")?At("!",{request:{error:c}}):console.error(c)},At=(c,t={},n)=>{if(zi(c)&&(c=b2(c),!c))return;let o=ta();!Yd()&&Ld&&(o=Ld),o.replace(/^#/,"")!==c?(gu(c,t,n),Yd()?Y0(c):(Ld=c,mu(c).then(()=>{ot._refocus()}).catch(u=>{console.error(u)}))):t.reload&&(gu(c,t,n),mu(c).then(()=>{ot._refocus()}).catch(u=>{console.error(u)}))},gu=(c,t={},n)=>{if(c=Df(c),!oi.has(c)){for(let u of oi.values())u.cancel();const o=E2(c,t,n);return oi.set(decodeURIComponent(c),o),o}return!1},mu=async c=>{const t=Df(c||ta()),n=decodeURIComponent(t);let o=oi.get(n);!o&&!oi.size&&(o=gu(t));const u=Cu(t);if(!u){Wr("*")?At("*",{failedHash:t}):console.error(`Unable to navigate to: ${t}`);return}o.hash=t,o.route=u;let f=await F0(As(),o);if(f&&u.beforeNavigate&&(f=await u.beforeNavigate(As(),o)),er(f)){if(f)return mR(o)}else if(o.cancel(),oi.delete(n),kn(f))At(f);else if(zi(f)){let m=!0;er(f.store)&&(m=f.store),At(f.path,f.params,m)}},mR=c=>{const t=c.hash,n=c.route,o=decodeURIComponent(t);if(G2(t),n.path){const u=H0(n.path);if(Dt(n.hook)){const f=L0(t,n.path),m={};for(const p of f.keys())m[p]=f.get(p);n.hook(ot,{...m})}if(u){const f=Hr();if(f){const m=R2(Kd(),c);f&&n.path===Kd()&&!m&&f._setState("")}Pf(u)?Rv(c).then(()=>{ot._refocus(),oi.delete(o)}):u().then(m=>m.default).then(m=>(Mf(n.path,m),Rv(c))).then(()=>{ot._refocus(),oi.delete(o)})}else oi.delete(o)}},ru=(c=0)=>{if(!c||isNaN(c))return!1;const t=O0();if(c=Math.abs(c),c>t.length)return Dt(ot._handleAppClose)?ot._handleAppClose():ot.application.closeApp();if(t.length){const n=t.splice(t.length-c,c)[0];return Eu(t),At(n.hash,{[It.backtrack]:!0,[It.historyState]:n.state},!1)}else if(Ei.get("backtrack")){const n=/(\/:?[\w%\s-]+)$/;let o=Su(ta()),u=Rf(o);if(u>1){for(;u--;)if(o=o.replace(n,""),Cu(o))return At(o,{[It.backtrack]:!0},!1)}}return!1},_R=()=>{kn(Tr)?(At(Tr,!1),Tr=""):Dt(Tr)?Tr().then(c=>{Tr="",zi(c)?At(c.path,c.params):At(c)}):console.warn("[Router]: resume() called but no hash found")},yR=()=>{if(!$0()){const c=As();At(c,{reload:!0},!1)}},$0=()=>{if(oi.size){let c=!1;for(let t of oi.values())t.isCancelled||(c=!0);return c}return!1},xR=()=>Tr;let ta=()=>document.location.hash,Y0=c=>{document.location.hash=c};const vR=c=>{c.getHash&&(ta=c.getHash),c.setHash&&(Y0=c.setHash)},wR=()=>{qo.addEventListener(window,"hashchange",async()=>{if(Yd())try{await mu()}catch(c){console.error(c)}})},TR=()=>{const c=W0();kn(c)?At(c):Dt(c)&&c().then(t=>{zi(t)?At(t.path,t.params):At(t)})},Bt={startRouter:fR,navigate:At,resume:_R,step:ru,go:ru,back:ru.bind(null,-1),activePage:Hr,getActivePage(){return Hr()},getActiveRoute:Kd,getActiveHash:As,focusWidget:k2,getActiveWidget:M0,restoreFocus:Av,isNavigating:$0,getHistory:O0,setHistory:Eu,getHistoryState:D2,replaceHistoryState:F2,getQueryStringParams:Ff,reload:yR,symbols:It,App:dR,focusPage:Av,root:TR,setupRoutes(){console.warn("Router: setupRoutes is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},on(){console.warn("Router.on() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},before(){console.warn("Router.before() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},after(){console.warn("Router.after() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")}};let Md;const SR=(c,t,n,o)=>{db(t,n),qI(n),v2(),n.plugins&&(n.plugins.profile&&lI(n.plugins.profile),n.plugins.metrics&&eI(n.plugins.metrics),n.plugins.mediaPlayer&&y2(n.plugins.mediaPlayer),n.plugins.mediaPlayer&&_I(n.plugins.mediaPlayer),n.plugins.ads&&CI(n.plugins.ads),n.plugins.router&&vR(n.plugins.router),n.plugins.tv&&cI(n.plugins.tv),n.plugins.purchase&&uI(n.plugins.purchase),n.plugins.pin&&dI(n.plugins.pin));const u=_2(c,o,n);return Po.log=ve,Po.settings=Ai,Po.ads=bI,Po.lightning=J,Md=new u(t),Po.appInstance=Md,Md};class SM extends J.Component{static _template(){return{visible:!1,rect:!0,color:2415919104,shader:{type:J.shaders.RoundedRectangle,radius:5},Text:{y:5,x:20,text:{textColor:4294967295,fontSize:38,lineHeight:38*1.4,textAlign:"center",wordWrap:!0,maxLines:3,shadow:!0,shadowColor:4281545523}}}}_init(){this._textTextureDefaults=new J.textures.TextTexture(this.stage).cloneArgs(),this.tag("Text").on("txLoaded",({_source:t})=>{this.w=t.w+this.tag("Text").x*2,this.h=t.h,this.position()})}get textFormat(){const t=this.tag("Text").text;return{fontFace:t.fontFace||"sans-serif",fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:t.textAlign,wordWrap:!0,maxLines:t.maxLines}}show(){this.visible=!0}hide(){this.visible=!1}position(){this.x=this._calculateX(this.xPos),this.y=this._calculateY(this.yPos)}set viewportW(t){this._viewportW=t,this.x=this._calculateX(this.xPos)}get viewportW(){return this._viewportW||this.application.finalW}set viewportH(t){this._viewportH=t,this.y=this._calculateY(this.yPos)}get viewportH(){return this._viewportH||this.application.finalH}_calculateX(t){return t==="center"?t=(this.viewportW-this.finalW)/2:t==="left"?t=60:t==="right"&&(t=this.viewportW-this.finalW-60),t}set xPos(t){this._x=t,this.x=this._calculateX(t)}get xPos(){return this._x||"center"}_calculateY(t){return t==="center"?(this.viewportH-this.finalH)/2:t==="top"?60:t==="bottom"?this.viewportH-this.finalH-60:t}set yPos(t){this._y=t,this.y=this._calculateY(t)}get yPos(){return this._y||"bottom"}set fontFamily(t){this.tag("Text").text.fontFace=t}set fontSize(t){this.tag("Text").text.fontSize=t,this.tag("Text").text.lineHeight=t*1.3}set fontColor(t){this.tag("Text").color=t}set backgroundColor(t){this.color=t}_defineBreakpoint(t,n){if(n>=this.maxWidth)return this.maxWidth;const o=J.textures.TextTexture.renderer(this.stage,this.stage.platform.getDrawingCanvas(),{...this._textTextureDefaults,...this.textFormat,wordWrapWidth:n,text:t})._calculateRenderInfo();return o.width<=n&&o.lines.length<=2?n:this._defineBreakpoint(t,n*1.25)}set text(t){if(this.alpha=0,t&&t.length){const n=this._defineBreakpoint(t,640);this.tag("Text").text.wordWrapWidth=n,this.tag("Text").text=t,this.alpha=1}}set textAlign(t){this._textAlign=t,this.tag("Text").text.textAlign=t}set maxWidth(t){this._maxWidth=t}get maxWidth(){return(this._maxWidth||1200)-this.tag("Text").x*2}set maxLines(t){this.tag("Text").text.maxLines=t}}const ee={colors:{background:4279639853,primary:4279509822,primaryLight:4280169822,secondary:4283596540,tertiary:4284586236,accent:4291485694,error:4281685370,warning:4281685370,info:4281685370,white:4294046193,yellow:4294105945,accentGrey:{light:4288784562,dark:4282732896},dark:4278584867,black:4278190080,orange:4294724610}},_u=["/filters/dgnlsl30-movies-action?page=1&language=en&size=50","/filters/dgnlsl30-movies-comedy?page=1&language=en&size=50","/filters/marvel-movies?page=1&language=en&size=50","/filters/gNAaDQJl13GS?page=1&language=en&size=100","/filters/dgnlsl30-movies-action?page=1&language=en&size=50","/filters/dgnlsl30-movies-comedy?page=1&language=en&size=50","/filters/marvel-movies?page=1&language=en&size=50","/filters/gNAaDQJl13GS?page=1&language=en&size=100","/filters/dgnlsl30-movies-action?page=1&language=en&size=50","/filters/dgnlsl30-movies-comedy?page=1&language=en&size=50","/filters/marvel-movies?page=1&language=en&size=50","/filters/gNAaDQJl13GS?page=1&language=en&size=100","/filters/dgnlsl30-movies-action?page=1&language=en&size=50","/filters/dgnlsl30-movies-comedy?page=1&language=en&size=50","/filters/marvel-movies?page=1&language=en&size=50","/filters/gNAaDQJl13GS?page=1&language=en&size=100"],Lv=["Action Movies","Only on Enlight","Marvel Movies","Drama Movies","Romantic Comdey Movies","Trending Now","Comdey Movies","Thriller Movies","Action Movies","Only on Enlight","Marvel Movies","Drama Movies","Romantic Comdey Movies","Trending Now","Comdey Movies","Thriller Movies","Long Rail"],Zd={regular:{w:216,h:324,margin:30,minimumCardsInViewport:7},wide:{w:324,h:216,margin:30,minimumCardsInViewport:5}};class Mv extends J.Component{constructor(){super(...arguments),this.data={},this.index=0,this.totalElements=0,this.cardSize=Zd.regular,this.focused=!1,this.railIndex=0}static _template(){return{rect:!0,color:ee.colors.primary,shader:{type:J.shaders.RoundedRectangle,radius:20},Image:{w:t=>t,h:t=>t,shader:{type:J.shaders.RoundedRectangle,radius:20}},Label:{x:10,w:t=>t,color:ee.colors.accentGrey.light,text:{fontSize:22.5,fontFace:"Saira Regular",fontStyle:"400"}}}}set item(t){const{label:n,src:o,data:u,index:f,totalElements:m,cardSize:p,railIndex:v}=t;this.data=u,this.index=f,this.totalElements=m,this.cardSize=p,this.railIndex=v,this.patch({Image:{src:o},w:this.cardSize.w,h:this.cardSize.h,Label:{text:n==null?void 0:n.toString(),y:this.cardSize.h+4}})}_handleEnter(){Bt.navigate(`content/railItem/${this.data.uid}`,{from:"Home",data:this.data})}_focus(){this.focused=!0;const t={cardWidth:this.w,cardHeight:this.h,cardIndex:this.index,railTotalElements:this.totalElements,cardSize:this.cardSize,railIndex:this.railIndex};this.fireAncestors("$changeItemOnFocus",this.data,t),this.patch({Label:{smooth:{color:ee.colors.white}}})}_unfocus(){this.focused=!1,this.patch({smooth:{color:ee.colors.primary,scale:1},Label:{smooth:{color:ee.colors.accentGrey.light}},Rectangle:void 0})}}function K0(c,t){return function(){return c.apply(t,arguments)}}const{toString:Z0}=Object.prototype,{getPrototypeOf:Nf}=Object,Uf=(c=>t=>{const n=Z0.call(t);return c[n]||(c[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),br=c=>(c=c.toLowerCase(),t=>Uf(t)===c),Ru=c=>t=>typeof t===c,{isArray:Is}=Array,Zo=Ru("undefined");function CR(c){return c!==null&&!Zo(c)&&c.constructor!==null&&!Zo(c.constructor)&&Vr(c.constructor.isBuffer)&&c.constructor.isBuffer(c)}const Q0=br("ArrayBuffer");function AR(c){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(c):t=c&&c.buffer&&Q0(c.buffer),t}const ER=Ru("string"),Vr=Ru("function"),J0=Ru("number"),zf=c=>c!==null&&typeof c=="object",bR=c=>c===!0||c===!1,nu=c=>{if(Uf(c)!=="object")return!1;const t=Nf(c);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in c)&&!(Symbol.iterator in c)},IR=br("Date"),RR=br("File"),LR=br("Blob"),MR=br("FileList"),PR=c=>zf(c)&&Vr(c.pipe),kR=c=>{const t="[object FormData]";return c&&(typeof FormData=="function"&&c instanceof FormData||Z0.call(c)===t||Vr(c.toString)&&c.toString()===t)},OR=br("URLSearchParams"),DR=c=>c.trim?c.trim():c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ia(c,t,{allOwnKeys:n=!1}={}){if(c===null||typeof c>"u")return;let o,u;if(typeof c!="object"&&(c=[c]),Is(c))for(o=0,u=c.length;o<u;o++)t.call(null,c[o],o,c);else{const f=n?Object.getOwnPropertyNames(c):Object.keys(c),m=f.length;let p;for(o=0;o<m;o++)p=f[o],t.call(null,c[p],p,c)}}function ew(c,t){t=t.toLowerCase();const n=Object.keys(c);let o=n.length,u;for(;o-- >0;)if(u=n[o],t===u.toLowerCase())return u;return null}const tw=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),iw=c=>!Zo(c)&&c!==tw;function Qd(){const{caseless:c}=iw(this)&&this||{},t={},n=(o,u)=>{const f=c&&ew(t,u)||u;nu(t[f])&&nu(o)?t[f]=Qd(t[f],o):nu(o)?t[f]=Qd({},o):Is(o)?t[f]=o.slice():t[f]=o};for(let o=0,u=arguments.length;o<u;o++)arguments[o]&&ia(arguments[o],n);return t}const FR=(c,t,n,{allOwnKeys:o}={})=>(ia(t,(u,f)=>{n&&Vr(u)?c[f]=K0(u,n):c[f]=u},{allOwnKeys:o}),c),NR=c=>(c.charCodeAt(0)===65279&&(c=c.slice(1)),c),UR=(c,t,n,o)=>{c.prototype=Object.create(t.prototype,o),c.prototype.constructor=c,Object.defineProperty(c,"super",{value:t.prototype}),n&&Object.assign(c.prototype,n)},zR=(c,t,n,o)=>{let u,f,m;const p={};if(t=t||{},c==null)return t;do{for(u=Object.getOwnPropertyNames(c),f=u.length;f-- >0;)m=u[f],(!o||o(m,c,t))&&!p[m]&&(t[m]=c[m],p[m]=!0);c=n!==!1&&Nf(c)}while(c&&(!n||n(c,t))&&c!==Object.prototype);return t},BR=(c,t,n)=>{c=String(c),(n===void 0||n>c.length)&&(n=c.length),n-=t.length;const o=c.indexOf(t,n);return o!==-1&&o===n},jR=c=>{if(!c)return null;if(Is(c))return c;let t=c.length;if(!J0(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=c[t];return n},HR=(c=>t=>c&&t instanceof c)(typeof Uint8Array<"u"&&Nf(Uint8Array)),VR=(c,t)=>{const o=(c&&c[Symbol.iterator]).call(c);let u;for(;(u=o.next())&&!u.done;){const f=u.value;t.call(c,f[0],f[1])}},WR=(c,t)=>{let n;const o=[];for(;(n=c.exec(t))!==null;)o.push(n);return o},GR=br("HTMLFormElement"),XR=c=>c.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,o,u){return o.toUpperCase()+u}),Pv=(({hasOwnProperty:c})=>(t,n)=>c.call(t,n))(Object.prototype),qR=br("RegExp"),rw=(c,t)=>{const n=Object.getOwnPropertyDescriptors(c),o={};ia(n,(u,f)=>{t(u,f,c)!==!1&&(o[f]=u)}),Object.defineProperties(c,o)},$R=c=>{rw(c,(t,n)=>{if(Vr(c)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=c[n];if(Vr(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},YR=(c,t)=>{const n={},o=u=>{u.forEach(f=>{n[f]=!0})};return Is(c)?o(c):o(String(c).split(t)),n},KR=()=>{},ZR=(c,t)=>(c=+c,Number.isFinite(c)?c:t),Pd="abcdefghijklmnopqrstuvwxyz",kv="0123456789",nw={DIGIT:kv,ALPHA:Pd,ALPHA_DIGIT:Pd+Pd.toUpperCase()+kv},QR=(c=16,t=nw.ALPHA_DIGIT)=>{let n="";const{length:o}=t;for(;c--;)n+=t[Math.random()*o|0];return n};function JR(c){return!!(c&&Vr(c.append)&&c[Symbol.toStringTag]==="FormData"&&c[Symbol.iterator])}const eL=c=>{const t=new Array(10),n=(o,u)=>{if(zf(o)){if(t.indexOf(o)>=0)return;if(!("toJSON"in o)){t[u]=o;const f=Is(o)?[]:{};return ia(o,(m,p)=>{const v=n(m,u+1);!Zo(v)&&(f[p]=v)}),t[u]=void 0,f}}return o};return n(c,0)},X={isArray:Is,isArrayBuffer:Q0,isBuffer:CR,isFormData:kR,isArrayBufferView:AR,isString:ER,isNumber:J0,isBoolean:bR,isObject:zf,isPlainObject:nu,isUndefined:Zo,isDate:IR,isFile:RR,isBlob:LR,isRegExp:qR,isFunction:Vr,isStream:PR,isURLSearchParams:OR,isTypedArray:HR,isFileList:MR,forEach:ia,merge:Qd,extend:FR,trim:DR,stripBOM:NR,inherits:UR,toFlatObject:zR,kindOf:Uf,kindOfTest:br,endsWith:BR,toArray:jR,forEachEntry:VR,matchAll:WR,isHTMLForm:GR,hasOwnProperty:Pv,hasOwnProp:Pv,reduceDescriptors:rw,freezeMethods:$R,toObjectSet:YR,toCamelCase:XR,noop:KR,toFiniteNumber:ZR,findKey:ew,global:tw,isContextDefined:iw,ALPHABET:nw,generateString:QR,isSpecCompliantForm:JR,toJSONObject:eL};function He(c,t,n,o,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=c,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),u&&(this.response=u)}X.inherits(He,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:X.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const sw=He.prototype,ow={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(c=>{ow[c]={value:c}});Object.defineProperties(He,ow);Object.defineProperty(sw,"isAxiosError",{value:!0});He.from=(c,t,n,o,u,f)=>{const m=Object.create(sw);return X.toFlatObject(c,m,function(v){return v!==Error.prototype},p=>p!=="isAxiosError"),He.call(m,c.message,t,n,o,u),m.cause=c,m.name=c.name,f&&Object.assign(m,f),m};const tL=null;function Jd(c){return X.isPlainObject(c)||X.isArray(c)}function aw(c){return X.endsWith(c,"[]")?c.slice(0,-2):c}function Ov(c,t,n){return c?c.concat(t).map(function(u,f){return u=aw(u),!n&&f?"["+u+"]":u}).join(n?".":""):t}function iL(c){return X.isArray(c)&&!c.some(Jd)}const rL=X.toFlatObject(X,{},null,function(t){return/^is[A-Z]/.test(t)});function Lu(c,t,n){if(!X.isObject(c))throw new TypeError("target must be an object");t=t||new FormData,n=X.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,U){return!X.isUndefined(U[I])});const o=n.metaTokens,u=n.visitor||C,f=n.dots,m=n.indexes,v=(n.Blob||typeof Blob<"u"&&Blob)&&X.isSpecCompliantForm(t);if(!X.isFunction(u))throw new TypeError("visitor must be a function");function w(y){if(y===null)return"";if(X.isDate(y))return y.toISOString();if(!v&&X.isBlob(y))throw new He("Blob is not supported. Use a Buffer instead.");return X.isArrayBuffer(y)||X.isTypedArray(y)?v&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function C(y,I,U){let Z=y;if(y&&!U&&typeof y=="object"){if(X.endsWith(I,"{}"))I=o?I:I.slice(0,-2),y=JSON.stringify(y);else if(X.isArray(y)&&iL(y)||(X.isFileList(y)||X.endsWith(I,"[]"))&&(Z=X.toArray(y)))return I=aw(I),Z.forEach(function(q,H){!(X.isUndefined(q)||q===null)&&t.append(m===!0?Ov([I],H,f):m===null?I:I+"[]",w(q))}),!1}return Jd(y)?!0:(t.append(Ov(U,I,f),w(y)),!1)}const L=[],E=Object.assign(rL,{defaultVisitor:C,convertValue:w,isVisitable:Jd});function R(y,I){if(!X.isUndefined(y)){if(L.indexOf(y)!==-1)throw Error("Circular reference detected in "+I.join("."));L.push(y),X.forEach(y,function(Z,te){(!(X.isUndefined(Z)||Z===null)&&u.call(t,Z,X.isString(te)?te.trim():te,I,E))===!0&&R(Z,I?I.concat(te):[te])}),L.pop()}}if(!X.isObject(c))throw new TypeError("data must be an object");return R(c),t}function Dv(c){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(c).replace(/[!'()~]|%20|%00/g,function(o){return t[o]})}function Bf(c,t){this._pairs=[],c&&Lu(c,this,t)}const lw=Bf.prototype;lw.append=function(t,n){this._pairs.push([t,n])};lw.toString=function(t){const n=t?function(o){return t.call(this,o,Dv)}:Dv;return this._pairs.map(function(u){return n(u[0])+"="+n(u[1])},"").join("&")};function nL(c){return encodeURIComponent(c).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function uw(c,t,n){if(!t)return c;const o=n&&n.encode||nL,u=n&&n.serialize;let f;if(u?f=u(t,n):f=X.isURLSearchParams(t)?t.toString():new Bf(t,n).toString(o),f){const m=c.indexOf("#");m!==-1&&(c=c.slice(0,m)),c+=(c.indexOf("?")===-1?"?":"&")+f}return c}class sL{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){X.forEach(this.handlers,function(o){o!==null&&t(o)})}}const Fv=sL,hw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},oL=typeof URLSearchParams<"u"?URLSearchParams:Bf,aL=typeof FormData<"u"?FormData:null,lL=typeof Blob<"u"?Blob:null,uL=(()=>{let c;return typeof navigator<"u"&&((c=navigator.product)==="ReactNative"||c==="NativeScript"||c==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),hL=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Qi={isBrowser:!0,classes:{URLSearchParams:oL,FormData:aL,Blob:lL},isStandardBrowserEnv:uL,isStandardBrowserWebWorkerEnv:hL,protocols:["http","https","file","blob","url","data"]};function cL(c,t){return Lu(c,new Qi.classes.URLSearchParams,Object.assign({visitor:function(n,o,u,f){return Qi.isNode&&X.isBuffer(n)?(this.append(o,n.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},t))}function dL(c){return X.matchAll(/\w+|\[(\w*)]/g,c).map(t=>t[0]==="[]"?"":t[1]||t[0])}function fL(c){const t={},n=Object.keys(c);let o;const u=n.length;let f;for(o=0;o<u;o++)f=n[o],t[f]=c[f];return t}function cw(c){function t(n,o,u,f){let m=n[f++];const p=Number.isFinite(+m),v=f>=n.length;return m=!m&&X.isArray(u)?u.length:m,v?(X.hasOwnProp(u,m)?u[m]=[u[m],o]:u[m]=o,!p):((!u[m]||!X.isObject(u[m]))&&(u[m]=[]),t(n,o,u[m],f)&&X.isArray(u[m])&&(u[m]=fL(u[m])),!p)}if(X.isFormData(c)&&X.isFunction(c.entries)){const n={};return X.forEachEntry(c,(o,u)=>{t(dL(o),u,n,0)}),n}return null}const pL={"Content-Type":void 0};function gL(c,t,n){if(X.isString(c))try{return(t||JSON.parse)(c),X.trim(c)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(c)}const Mu={transitional:hw,adapter:["xhr","http"],transformRequest:[function(t,n){const o=n.getContentType()||"",u=o.indexOf("application/json")>-1,f=X.isObject(t);if(f&&X.isHTMLForm(t)&&(t=new FormData(t)),X.isFormData(t))return u&&u?JSON.stringify(cw(t)):t;if(X.isArrayBuffer(t)||X.isBuffer(t)||X.isStream(t)||X.isFile(t)||X.isBlob(t))return t;if(X.isArrayBufferView(t))return t.buffer;if(X.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let p;if(f){if(o.indexOf("application/x-www-form-urlencoded")>-1)return cL(t,this.formSerializer).toString();if((p=X.isFileList(t))||o.indexOf("multipart/form-data")>-1){const v=this.env&&this.env.FormData;return Lu(p?{"files[]":t}:t,v&&new v,this.formSerializer)}}return f||u?(n.setContentType("application/json",!1),gL(t)):t}],transformResponse:[function(t){const n=this.transitional||Mu.transitional,o=n&&n.forcedJSONParsing,u=this.responseType==="json";if(t&&X.isString(t)&&(o&&!this.responseType||u)){const m=!(n&&n.silentJSONParsing)&&u;try{return JSON.parse(t)}catch(p){if(m)throw p.name==="SyntaxError"?He.from(p,He.ERR_BAD_RESPONSE,this,null,this.response):p}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qi.classes.FormData,Blob:Qi.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};X.forEach(["delete","get","head"],function(t){Mu.headers[t]={}});X.forEach(["post","put","patch"],function(t){Mu.headers[t]=X.merge(pL)});const jf=Mu,mL=X.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),_L=c=>{const t={};let n,o,u;return c&&c.split(`
`).forEach(function(m){u=m.indexOf(":"),n=m.substring(0,u).trim().toLowerCase(),o=m.substring(u+1).trim(),!(!n||t[n]&&mL[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},Nv=Symbol("internals");function Do(c){return c&&String(c).trim().toLowerCase()}function su(c){return c===!1||c==null?c:X.isArray(c)?c.map(su):String(c)}function yL(c){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(c);)t[o[1]]=o[2];return t}function xL(c){return/^[-_a-zA-Z]+$/.test(c.trim())}function kd(c,t,n,o,u){if(X.isFunction(o))return o.call(this,t,n);if(u&&(t=n),!!X.isString(t)){if(X.isString(o))return t.indexOf(o)!==-1;if(X.isRegExp(o))return o.test(t)}}function vL(c){return c.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function wL(c,t){const n=X.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(c,o+n,{value:function(u,f,m){return this[o].call(this,t,u,f,m)},configurable:!0})})}class Pu{constructor(t){t&&this.set(t)}set(t,n,o){const u=this;function f(p,v,w){const C=Do(v);if(!C)throw new Error("header name must be a non-empty string");const L=X.findKey(u,C);(!L||u[L]===void 0||w===!0||w===void 0&&u[L]!==!1)&&(u[L||v]=su(p))}const m=(p,v)=>X.forEach(p,(w,C)=>f(w,C,v));return X.isPlainObject(t)||t instanceof this.constructor?m(t,n):X.isString(t)&&(t=t.trim())&&!xL(t)?m(_L(t),n):t!=null&&f(n,t,o),this}get(t,n){if(t=Do(t),t){const o=X.findKey(this,t);if(o){const u=this[o];if(!n)return u;if(n===!0)return yL(u);if(X.isFunction(n))return n.call(this,u,o);if(X.isRegExp(n))return n.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Do(t),t){const o=X.findKey(this,t);return!!(o&&this[o]!==void 0&&(!n||kd(this,this[o],o,n)))}return!1}delete(t,n){const o=this;let u=!1;function f(m){if(m=Do(m),m){const p=X.findKey(o,m);p&&(!n||kd(o,o[p],p,n))&&(delete o[p],u=!0)}}return X.isArray(t)?t.forEach(f):f(t),u}clear(t){const n=Object.keys(this);let o=n.length,u=!1;for(;o--;){const f=n[o];(!t||kd(this,this[f],f,t,!0))&&(delete this[f],u=!0)}return u}normalize(t){const n=this,o={};return X.forEach(this,(u,f)=>{const m=X.findKey(o,f);if(m){n[m]=su(u),delete n[f];return}const p=t?vL(f):String(f).trim();p!==f&&delete n[f],n[p]=su(u),o[p]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return X.forEach(this,(o,u)=>{o!=null&&o!==!1&&(n[u]=t&&X.isArray(o)?o.join(", "):o)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const o=new this(t);return n.forEach(u=>o.set(u)),o}static accessor(t){const o=(this[Nv]=this[Nv]={accessors:{}}).accessors,u=this.prototype;function f(m){const p=Do(m);o[p]||(wL(u,m),o[p]=!0)}return X.isArray(t)?t.forEach(f):f(t),this}}Pu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);X.freezeMethods(Pu.prototype);X.freezeMethods(Pu);const Ar=Pu;function Od(c,t){const n=this||jf,o=t||n,u=Ar.from(o.headers);let f=o.data;return X.forEach(c,function(p){f=p.call(n,f,u.normalize(),t?t.status:void 0)}),u.normalize(),f}function dw(c){return!!(c&&c.__CANCEL__)}function ra(c,t,n){He.call(this,c==null?"canceled":c,He.ERR_CANCELED,t,n),this.name="CanceledError"}X.inherits(ra,He,{__CANCEL__:!0});function TL(c,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?c(n):t(new He("Request failed with status code "+n.status,[He.ERR_BAD_REQUEST,He.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const SL=Qi.isStandardBrowserEnv?function(){return{write:function(n,o,u,f,m,p){const v=[];v.push(n+"="+encodeURIComponent(o)),X.isNumber(u)&&v.push("expires="+new Date(u).toGMTString()),X.isString(f)&&v.push("path="+f),X.isString(m)&&v.push("domain="+m),p===!0&&v.push("secure"),document.cookie=v.join("; ")},read:function(n){const o=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function CL(c){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(c)}function AL(c,t){return t?c.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):c}function fw(c,t){return c&&!CL(t)?AL(c,t):t}const EL=Qi.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let o;function u(f){let m=f;return t&&(n.setAttribute("href",m),m=n.href),n.setAttribute("href",m),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return o=u(window.location.href),function(m){const p=X.isString(m)?u(m):m;return p.protocol===o.protocol&&p.host===o.host}}():function(){return function(){return!0}}();function bL(c){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(c);return t&&t[1]||""}function IL(c,t){c=c||10;const n=new Array(c),o=new Array(c);let u=0,f=0,m;return t=t!==void 0?t:1e3,function(v){const w=Date.now(),C=o[f];m||(m=w),n[u]=v,o[u]=w;let L=f,E=0;for(;L!==u;)E+=n[L++],L=L%c;if(u=(u+1)%c,u===f&&(f=(f+1)%c),w-m<t)return;const R=C&&w-C;return R?Math.round(E*1e3/R):void 0}}function Uv(c,t){let n=0;const o=IL(50,250);return u=>{const f=u.loaded,m=u.lengthComputable?u.total:void 0,p=f-n,v=o(p),w=f<=m;n=f;const C={loaded:f,total:m,progress:m?f/m:void 0,bytes:p,rate:v||void 0,estimated:v&&m&&w?(m-f)/v:void 0,event:u};C[t?"download":"upload"]=!0,c(C)}}const RL=typeof XMLHttpRequest<"u",LL=RL&&function(c){return new Promise(function(n,o){let u=c.data;const f=Ar.from(c.headers).normalize(),m=c.responseType;let p;function v(){c.cancelToken&&c.cancelToken.unsubscribe(p),c.signal&&c.signal.removeEventListener("abort",p)}X.isFormData(u)&&(Qi.isStandardBrowserEnv||Qi.isStandardBrowserWebWorkerEnv)&&f.setContentType(!1);let w=new XMLHttpRequest;if(c.auth){const R=c.auth.username||"",y=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";f.set("Authorization","Basic "+btoa(R+":"+y))}const C=fw(c.baseURL,c.url);w.open(c.method.toUpperCase(),uw(C,c.params,c.paramsSerializer),!0),w.timeout=c.timeout;function L(){if(!w)return;const R=Ar.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),I={data:!m||m==="text"||m==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:R,config:c,request:w};TL(function(Z){n(Z),v()},function(Z){o(Z),v()},I),w=null}if("onloadend"in w?w.onloadend=L:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(L)},w.onabort=function(){w&&(o(new He("Request aborted",He.ECONNABORTED,c,w)),w=null)},w.onerror=function(){o(new He("Network Error",He.ERR_NETWORK,c,w)),w=null},w.ontimeout=function(){let y=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const I=c.transitional||hw;c.timeoutErrorMessage&&(y=c.timeoutErrorMessage),o(new He(y,I.clarifyTimeoutError?He.ETIMEDOUT:He.ECONNABORTED,c,w)),w=null},Qi.isStandardBrowserEnv){const R=(c.withCredentials||EL(C))&&c.xsrfCookieName&&SL.read(c.xsrfCookieName);R&&f.set(c.xsrfHeaderName,R)}u===void 0&&f.setContentType(null),"setRequestHeader"in w&&X.forEach(f.toJSON(),function(y,I){w.setRequestHeader(I,y)}),X.isUndefined(c.withCredentials)||(w.withCredentials=!!c.withCredentials),m&&m!=="json"&&(w.responseType=c.responseType),typeof c.onDownloadProgress=="function"&&w.addEventListener("progress",Uv(c.onDownloadProgress,!0)),typeof c.onUploadProgress=="function"&&w.upload&&w.upload.addEventListener("progress",Uv(c.onUploadProgress)),(c.cancelToken||c.signal)&&(p=R=>{w&&(o(!R||R.type?new ra(null,c,w):R),w.abort(),w=null)},c.cancelToken&&c.cancelToken.subscribe(p),c.signal&&(c.signal.aborted?p():c.signal.addEventListener("abort",p)));const E=bL(C);if(E&&Qi.protocols.indexOf(E)===-1){o(new He("Unsupported protocol "+E+":",He.ERR_BAD_REQUEST,c));return}w.send(u||null)})},ou={http:tL,xhr:LL};X.forEach(ou,(c,t)=>{if(c){try{Object.defineProperty(c,"name",{value:t})}catch(n){}Object.defineProperty(c,"adapterName",{value:t})}});const ML={getAdapter:c=>{c=X.isArray(c)?c:[c];const{length:t}=c;let n,o;for(let u=0;u<t&&(n=c[u],!(o=X.isString(n)?ou[n.toLowerCase()]:n));u++);if(!o)throw o===!1?new He(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(X.hasOwnProp(ou,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`);if(!X.isFunction(o))throw new TypeError("adapter is not a function");return o},adapters:ou};function Dd(c){if(c.cancelToken&&c.cancelToken.throwIfRequested(),c.signal&&c.signal.aborted)throw new ra(null,c)}function zv(c){return Dd(c),c.headers=Ar.from(c.headers),c.data=Od.call(c,c.transformRequest),["post","put","patch"].indexOf(c.method)!==-1&&c.headers.setContentType("application/x-www-form-urlencoded",!1),ML.getAdapter(c.adapter||jf.adapter)(c).then(function(o){return Dd(c),o.data=Od.call(c,c.transformResponse,o),o.headers=Ar.from(o.headers),o},function(o){return dw(o)||(Dd(c),o&&o.response&&(o.response.data=Od.call(c,c.transformResponse,o.response),o.response.headers=Ar.from(o.response.headers))),Promise.reject(o)})}const Bv=c=>c instanceof Ar?c.toJSON():c;function Es(c,t){t=t||{};const n={};function o(w,C,L){return X.isPlainObject(w)&&X.isPlainObject(C)?X.merge.call({caseless:L},w,C):X.isPlainObject(C)?X.merge({},C):X.isArray(C)?C.slice():C}function u(w,C,L){if(X.isUndefined(C)){if(!X.isUndefined(w))return o(void 0,w,L)}else return o(w,C,L)}function f(w,C){if(!X.isUndefined(C))return o(void 0,C)}function m(w,C){if(X.isUndefined(C)){if(!X.isUndefined(w))return o(void 0,w)}else return o(void 0,C)}function p(w,C,L){if(L in t)return o(w,C);if(L in c)return o(void 0,w)}const v={url:f,method:f,data:f,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:p,headers:(w,C)=>u(Bv(w),Bv(C),!0)};return X.forEach(Object.keys(c).concat(Object.keys(t)),function(C){const L=v[C]||u,E=L(c[C],t[C],C);X.isUndefined(E)&&L!==p||(n[C]=E)}),n}const pw="1.3.4",Hf={};["object","boolean","number","function","string","symbol"].forEach((c,t)=>{Hf[c]=function(o){return typeof o===c||"a"+(t<1?"n ":" ")+c}});const jv={};Hf.transitional=function(t,n,o){function u(f,m){return"[Axios v"+pw+"] Transitional option '"+f+"'"+m+(o?". "+o:"")}return(f,m,p)=>{if(t===!1)throw new He(u(m," has been removed"+(n?" in "+n:"")),He.ERR_DEPRECATED);return n&&!jv[m]&&(jv[m]=!0,console.warn(u(m," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(f,m,p):!0}};function PL(c,t,n){if(typeof c!="object")throw new He("options must be an object",He.ERR_BAD_OPTION_VALUE);const o=Object.keys(c);let u=o.length;for(;u-- >0;){const f=o[u],m=t[f];if(m){const p=c[f],v=p===void 0||m(p,f,c);if(v!==!0)throw new He("option "+f+" must be "+v,He.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new He("Unknown option "+f,He.ERR_BAD_OPTION)}}const ef={assertOptions:PL,validators:Hf},zr=ef.validators;class yu{constructor(t){this.defaults=t,this.interceptors={request:new Fv,response:new Fv}}request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Es(this.defaults,n);const{transitional:o,paramsSerializer:u,headers:f}=n;o!==void 0&&ef.assertOptions(o,{silentJSONParsing:zr.transitional(zr.boolean),forcedJSONParsing:zr.transitional(zr.boolean),clarifyTimeoutError:zr.transitional(zr.boolean)},!1),u!==void 0&&ef.assertOptions(u,{encode:zr.function,serialize:zr.function},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let m;m=f&&X.merge(f.common,f[n.method]),m&&X.forEach(["delete","get","head","post","put","patch","common"],y=>{delete f[y]}),n.headers=Ar.concat(m,f);const p=[];let v=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(n)===!1||(v=v&&I.synchronous,p.unshift(I.fulfilled,I.rejected))});const w=[];this.interceptors.response.forEach(function(I){w.push(I.fulfilled,I.rejected)});let C,L=0,E;if(!v){const y=[zv.bind(this),void 0];for(y.unshift.apply(y,p),y.push.apply(y,w),E=y.length,C=Promise.resolve(n);L<E;)C=C.then(y[L++],y[L++]);return C}E=p.length;let R=n;for(L=0;L<E;){const y=p[L++],I=p[L++];try{R=y(R)}catch(U){I.call(this,U);break}}try{C=zv.call(this,R)}catch(y){return Promise.reject(y)}for(L=0,E=w.length;L<E;)C=C.then(w[L++],w[L++]);return C}getUri(t){t=Es(this.defaults,t);const n=fw(t.baseURL,t.url);return uw(n,t.params,t.paramsSerializer)}}X.forEach(["delete","get","head","options"],function(t){yu.prototype[t]=function(n,o){return this.request(Es(o||{},{method:t,url:n,data:(o||{}).data}))}});X.forEach(["post","put","patch"],function(t){function n(o){return function(f,m,p){return this.request(Es(p||{},{method:t,headers:o?{"Content-Type":"multipart/form-data"}:{},url:f,data:m}))}}yu.prototype[t]=n(),yu.prototype[t+"Form"]=n(!0)});const au=yu;class Vf{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(f){n=f});const o=this;this.promise.then(u=>{if(!o._listeners)return;let f=o._listeners.length;for(;f-- >0;)o._listeners[f](u);o._listeners=null}),this.promise.then=u=>{let f;const m=new Promise(p=>{o.subscribe(p),f=p}).then(u);return m.cancel=function(){o.unsubscribe(f)},m},t(function(f,m,p){o.reason||(o.reason=new ra(f,m,p),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Vf(function(u){t=u}),cancel:t}}}const kL=Vf;function OL(c){return function(n){return c.apply(null,n)}}function DL(c){return X.isObject(c)&&c.isAxiosError===!0}const tf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(tf).forEach(([c,t])=>{tf[t]=c});const FL=tf;function gw(c){const t=new au(c),n=K0(au.prototype.request,t);return X.extend(n,au.prototype,t,{allOwnKeys:!0}),X.extend(n,t,null,{allOwnKeys:!0}),n.create=function(u){return gw(Es(c,u))},n}const Rt=gw(jf);Rt.Axios=au;Rt.CanceledError=ra;Rt.CancelToken=kL;Rt.isCancel=dw;Rt.VERSION=pw;Rt.toFormData=Lu;Rt.AxiosError=He;Rt.Cancel=Rt.CanceledError;Rt.all=function(t){return Promise.all(t)};Rt.spread=OL;Rt.isAxiosError=DL;Rt.mergeConfig=Es;Rt.AxiosHeaders=Ar;Rt.formToJSON=c=>cw(X.isHTMLForm(c)?new FormData(c):c);Rt.HttpStatusCode=FL;Rt.default=Rt;const NL=Rt;class mw{constructor(){this.AxiosAPI=NL.create({baseURL:"https://api-entertainment.enlight.diagnal.com/v1b3/content"})}async fetch(t){try{return[await this.AxiosAPI.get(t),void 0]}catch(n){return[void 0,n]}}}class _w extends J.Component{constructor(){super(...arguments),this.index=-1,this.dataLength=0,this.railIndex=0,this.axiosRequester=new mw,this.responseData={},this.data=[],this.Wrapper=this.tag("Slider.Wrapper")}static _template(){return{Header:{x:50,y:20,color:ee.colors.white,text:{text:"",fontSize:35,fontFace:"Saira Regular",fontStyle:"600"}},Slider:{w:1920,h:400,y:105,mount:0,rect:!0,clipping:!0,color:Cr("transparent").get(),Wrapper:{x:80}}}}_init(){const t=[];this.railIndex<_u.length?this.axiosRequester.fetch(_u[this.railIndex]).then(n=>{var o,u,f,m,p,v;if(n){this.responseData=(o=n[0])==null?void 0:o.data,this.dataLength=this.responseData.totalElements||0,this.data=this.responseData.content||[];for(let w=0;w<this.dataLength;w++){let C=Zd.regular,L=(f=(u=this.data[w])==null?void 0:u.images.find(y=>y.width===288))==null?void 0:f.url;(this.dataLength===10||this.dataLength===31)&&(C=Zd.wide,L=(p=(m=this.data[w])==null?void 0:m.images.find(y=>y.width===526))==null?void 0:p.url);let E=(v=this.data[w])==null?void 0:v.title,R=C.w+C.margin;t.push({type:Mv,x:w*R,item:{label:E,src:L||"https://pmd205470tn-a.akamaihd.net/D2C_-_Content/191/249/oyPcsfGWL5Se6RGW1JCVgpHlASH_288x432_13635141800.jpg",data:this.data[w],index:w,totalElements:this.dataLength,cardSize:C,railIndex:this.railIndex}})}}this.patch({Header:{text:Lv[this.railIndex]}}),this.tag("Wrapper").children=t,this.index=0,this._setState("RowItem")}):this.setLongRail()}async setLongRail(){var n,o,u;console.log("je"),this.data=await bf.get("longData"),this.dataLength=this.data.length,console.log(this.data.length);const t=[];for(let f=0;f<this.dataLength;f++){let m=(n=this.data[f])==null?void 0:n.title,p=(u=(o=this.data[f])==null?void 0:o.images.find(v=>v.width===288))==null?void 0:u.url;t.push({type:Mv,x:f*(216+30),item:{label:m,src:p||"https://pmd205470tn-a.akamaihd.net/D2C_-_Content/191/249/oyPcsfGWL5Se6RGW1JCVgpHlASH_288x432_13635141800.jpg",data:this.data[f]}})}this.patch({Header:{text:Lv[this.railIndex]}}),this.tag("Wrapper").children=t,this.index=0}repositionWrapper(){const t=this.tag("Wrapper"),o=t.children[this.index].cardSize;this.index<this.dataLength-(o.minimumCardsInViewport-1)&&t.setSmooth("x",-(o.w+o.margin)*this.index+80,{duration:.1})}_handleLeft(){this.index>0&&(this.index-=1,this.repositionWrapper())}_handleRight(){this.index<this.dataLength-1&&(this.index+=1,this.repositionWrapper())}_getFocused(){return this.tag("Slider.Wrapper").children[this.index]}}class Fd extends J.Component{static _template(){return{NavText:{w:120,color:ee.colors.accentGrey.light,text:{fontSize:35}}}}set navtext(t){this.patch({NavText:{text:t==null?void 0:t.toString()}})}_focus(){this.patch({smooth:{scale:1.1},NavText:{smooth:{color:ee.colors.white}},Rectangle:{color:ee.colors.yellow,x:2,y:t=>t+50,w:100,h:5,rect:!0}})}_unfocus(){this.patch({smooth:{color:ee.colors.primary,scale:1},NavText:{smooth:{color:ee.colors.accentGrey.light}},Rectangle:void 0})}}class UL extends J.Component{static _template(){return{w:50,h:50,src:"https://pmd205470tn-a.akamaihd.net/D2C_-_Content/808/289/5qtySjfuJfOLvVrVXuwNo2BIVPH.jpg",shader:{type:J.shaders.RoundedRectangle,radius:10,stroke:5,strokeColor:ee.colors.white}}}set navtext(t){this.patch({NavText:{text:t==null?void 0:t.toString()}})}_focus(){this.patch({smooth:{scale:1.1},shader:{strokeColor:ee.colors.yellow}})}_unfocus(){this.patch({smooth:{scale:1},shader:{strokeColor:ee.colors.white}})}}class CM extends J.Component{constructor(){super(...arguments),this.index=0}static _template(){return{Navbar:{w:1920,h:1080,rect:!0,zIndex:1,shader:{x:100,y:-100,pivot:.5,type:J.shaders.RadialGradient,outerColor:ee.colors.primaryLight,innerColor:ee.colors.dark,radius:800},NavItems:{x:10,y:10,NavMenu:{shader:null}}}}}_init(){var n;const t={Home:{type:Fd,x:20,y:12,navtext:"Home"},Search:{type:Fd,x:140,y:12,navtext:"Search"},Gridlayout:{type:Fd,x:280,y:12,navtext:"Grids"},Profile:{x:1840,y:15,type:UL}};this.tag("Navbar.NavItems.NavMenu").children=t,(n=this.tag("Navbar"))==null||n.animation({duration:8,repeat:-1,delay:2,actions:[{p:"shader.radius",v:{0:{v:800},.5:{v:400},1:{v:800}}}]}).start()}_handleLeft(){this.index>0&&(this.index-=1)}_handleRight(){this.index<3&&(this.index+=1)}_handleEnter(){this.index===0?Bt.navigate("home"):this.index===1?Bt.navigate("search"):this.index===2?Bt.navigate("grid"):Bt.navigate("settings")}_getFocused(){return this.tag("Navbar.NavItems.NavMenu").children[this.index]}_focus(){}_unfocus(){this.index=0}}class ku extends J.Component{static _template(){return{Back:{w:80,color:ee.colors.accentGrey.light,text:{text:"Back",fontSize:35}}}}_focus(){this.patch({smooth:{scale:1.1},Back:{smooth:{color:ee.colors.white}},Rectangle:{color:ee.colors.yellow,x:2,y:t=>t+50,w:80,h:5,rect:!0}})}_unfocus(){this.patch({smooth:{color:ee.colors.primary,scale:1},Back:{smooth:{color:ee.colors.accentGrey.light}},Rectangle:void 0})}}class Ts extends J.Component{static _template(){return{VideoSpec:{w:120,h:80,shader:{type:J.shaders.RoundedRectangle,radius:20,stroke:8,strokeColor:ee.colors.accentGrey.light},color:ee.colors.accentGrey.light,Spec:{mount:.5,color:ee.colors.accentGrey.light,text:{fontSize:22,fontFace:"Saira Regular",fontStyle:"400"}}}}}set specData(t){this.patch({VideoSpec:{Spec:{text:t}}})}}class zL extends J.Component{constructor(){super(...arguments),this._isPlaying=!1}static _template(){return{mount:.5,x:1920/2,y:1080/2,rect:!0,w:150,h:150,color:0,Background:{rect:!0,w:150,h:150,color:4289440683,shader:{type:J.shaders.RoundedRectangle,radius:75}},Text:{mount:.5,x:75,y:75,text:{textColor:4294967295,text:"Pause"}}}}_setup(){this._isPlaying=!0}set isPlaying(t){this._isPlaying=t,this.tag("Text").patch({text:{text:t?"Pause":"Play"}})}get isPlaying(){return this._isPlaying}}class Hv extends J.Component{static _template(){return{Button:{w:500,h:100,color:0,rect:!0,shader:{type:J.shaders.RadialGradient,innerColor:ee.colors.accentGrey.dark},Label:{shader:null,h:t=>t,text:{fontSize:35,textColor:ee.colors.white,textAlign:"left",textIndent:20,textBaseline:"hanging"}}}}}set label(t){this.patch({Button:{Label:{text:t}}})}_focus(){this.patch({smooth:{scale:1.1},Button:{shader:{innerColor:2868042585},Label:{text:{textColor:ee.colors.white}}}})}_unfocus(){this.patch({smooth:{scale:1},Button:{shader:{innerColor:ee.colors.accentGrey.dark}}})}}class Vv extends J.Component{constructor(){super(...arguments),this.firstActive=!0,this.Thumbnail=this.tag("ContentView.Thumbnail"),this.ContentDetails=this.tag("ContentView.ContentDetails")}static _template(){return{ContentView:{Thumbnail:{alpha:0,x:1e3,y:110,scale:1.5,shader:{type:J.shaders.FadeOut,innerColor:ee.colors.black,left:200,bottom:200}},ContentDetails:{ContentData:{shader:null,zIndex:2,Title:{x:40,y:165,shader:null,text:{fontSize:80,fontFace:"Saira Regular",fontStyle:"600"},color:ee.colors.white},Description:{x:40,y:270,w:900,shader:null,text:{wordWrap:!0,maxLines:3,maxLinesSuffix:"...",fontSize:30,fontFace:"Saira Regular",fontStyle:"400"},color:ee.colors.accentGrey.light},Genre:{x:40,y:380,w:900,shader:null,text:{fontSize:24,fontFace:"Saira Regular",fontStyle:"400"},color:ee.colors.accentGrey.light},Info:{visible:!1,Director:{x:40,y:440,w:100,shader:null,text:{text:"Director : ",fontSize:24,fontFace:"Saira Regular",fontStyle:"600"},color:ee.colors.accentGrey.light},Starring:{x:40,y:470,w:100,shader:null,text:{text:"Staring  : ",fontSize:24,fontFace:"Saira Regular",fontStyle:"600"},color:ee.colors.accentGrey.light},DirectorList:{x:150,y:440,w:800,shader:null,text:{fontSize:24},color:ee.colors.accentGrey.light},StarringList:{x:150,y:470,w:800,shader:null,text:{fontSize:24,wordWrap:!0,maxLines:1,maxLinesSuffix:"..."},color:ee.colors.accentGrey.light}},VideoSpec:{visible:!1,VideoSpec1:{x:70,y:140,shader:null,type:Ts,specData:"  16+  "},VideoSpec2:{x:135,y:140,shader:null,type:Ts,specData:"  4k  "},VideoSpec3:{x:193,y:140,shader:null,type:Ts,specData:"  cc  "}}}}}}}set data(t){console.log(t);const{imgSrc:n,title:o,description:u,genre:f,directorsList:m,actorsList:p}=t;this.tag("ContentView.Thumbnail").patch({smooth:{src:n}}),this.tag("ContentView.Thumbnail").transition("src").on("finish",()=>{this.tag("ContentView.Thumbnail").setSmooth("alpha",1,{duration:.5})});const v=this.tag("ContentView.ContentDetails").animation({duration:.5,delay:0,actions:[{p:"alpha",v:{0:0,.8:0,1:1}},{p:"x",v:{0:10,.6:-100,.65:10}},{p:"y",v:{0:0,.6:0,.65:-30,1:0}}]});if(this.patch({ContentView:{shader:{type:J.shaders.RadialGradient,x:300,y:300,innerColor:4278190080,radius:1500},ContentDetails:{x:10,ContentData:{Title:{text:{text:o}},Description:{text:{text:u}},Genre:{text:{text:f}},Info:{visible:!0,DirectorList:{text:{text:m}},StarringList:{text:{text:p}}},VideoSpec:{visible:!0}}}}}),this.firstActive){this.firstActive=!1,this.tag("ContentView.ContentDetails").animation({duration:1,delay:0,repeat:0,actions:[{p:"alpha",v:{0:0,1:1}},{p:"y",v:{0:-30,1:0}}]}).start();return}v.start()}animate(){this.tag("ContentView.ContentDetails").animation({duration:2,delay:0,actions:[{p:"alpha",v:{0:1,.5:0}},{p:"y",v:{0:0,.5:-30,1:0}}]}).start()}_init(){this.tag("ContentView.Thumbnail").on("txError",()=>{console.error("texture failed to load: "+this.tag("ContentView.Thumbnail").src)})}}class Wf extends J.shaders.RoundedRectangle{constructor(t){super(t),this._shadowCoords=[0,0,0,0],this._shadowColorRaw=16777215,this._shadowColor=this._getNormalizedColor(16777215),this._innerStrokeColorRaw=16777215,this._innerStrokeColor=this._getNormalizedColor(16777215),this._innerStroke=0}set shadowColor(t){this._shadowColorRaw=t,this._shadowColor=this._getNormalizedColor(t),this.redraw()}get shadowColor(){return this._shadowColorRaw}set shadowCoords(t){Array.isArray(t)?t.length===2?this._shadowCoords=[t[0],t[1],t[0],t[1]]:t.length===3?this._shadowCoords=[t[0],t[1],t[2],this._shadowCoords[3]]:t.length===4?this._shadowCoords=t:this._shadowCoords=[t[0],t[0],t[0],t[0]]:this._shadowCoords=[t,t,t,t],this.redraw()}get shadowCoords(){return this._shadowCoords}set innerStrokeColor(t){this._innerStrokeColorRaw=t,this._innerStrokeColor=this._getNormalizedColor(t),this.redraw()}get innerStrokeColor(){return this._innerStrokeColorRaw}set innerStroke(t){this._innerStroke=t,this.redraw()}get innerStroke(){return this._innerStroke}setupUniforms(t){super.setupUniforms(t);const n=this.ctx.stage.getRenderPrecision();this._setUniform("shadowCoords",new Float32Array(this._shadowCoords.map(o=>o*n)),this.gl.uniform4fv),this._setUniform("shadowColor",this._shadowColor,this.gl.uniform4fv),this._setUniform("innerStroke",this._innerStroke*n,this.gl.uniform1f),this._setUniform("innerStrokeColor",this._innerStrokeColor,this.gl.uniform4fv),this._setUniform("renderPrecision",this.ctx.stage.getRenderPrecision(),this.gl.uniform1f)}}Wf.vertexShaderSource=`
#ifdef GL_ES
# ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
# else
precision lowp float;
# endif
#endif
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

uniform vec2 projection;
uniform vec2 resolution;
uniform vec4 shadowCoords;
uniform float renderPrecision;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void) {
    vec2 outerEdge = clamp(aTextureCoord * 2.0 - vec2(1.0), -1.0, 1.0);

    vec2 shadowPosition = shadowCoords.xy;
    float shadowBlur = shadowCoords.z;
    float shadowSpread = shadowCoords.w;

    vec2 shadowPositionActual = outerEdge * max(vec2(0.0), shadowPosition + shadowSpread + shadowBlur);

    vec2 vertexPosition = aVertexPosition + outerEdge + shadowPositionActual;
    gl_Position = vec4(
      vertexPosition.x * projection.x - 1.0,
      -sign(projection.y) * (vertexPosition.y * -abs(projection.y) + 1.0),
      0.0,
      1.0
    );

    vTextureCoord = aTextureCoord + ((vertexPosition - aVertexPosition) / resolution * renderPrecision);
    vColor = aColor;
}
`;Wf.fragmentShaderSource=`
#ifdef GL_ES
# ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
# else
precision lowp float;
# endif
#endif

#define PI 3.14159265359

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;
uniform vec2 resolution;
uniform vec4 radius;
uniform float stroke;
uniform vec4 strokeColor;
uniform float innerStroke;
uniform vec4 innerStrokeColor;
uniform vec4 fillColor;
uniform vec4 shadowColor;
uniform vec4 shadowCoords;
uniform float alpha;
uniform float fill;
uniform float blend;

float boxDist(vec2 p, vec2 size, float radius) {
    size -= vec2(radius);
    vec2 d = abs(p) - size;
    return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - max(radius, 0.0);
}

float fillMask(float dist) {
    return clamp(-dist, 0.0, 1.0);
}

float innerBorderMask(float dist, float width, float offset) {
    float alpha1 = clamp(dist + width + step(width, 1.0) * 0.5 + offset, 0.0, 1.0);
    float alpha2 = clamp(dist + offset, 0.0, 1.0);
    return alpha1 - alpha2;
}

float shadowMask(float dist, float shadowBlur, float innerDist) {
    return (1. - clamp(-innerDist, 0.0, 1.0)) * smoothstep(1.0, 1.0 + shadowBlur, max(1.0 - shadowBlur, -dist));
}

void main() {
    vec2 halfRes = 0.5 * resolution.xy;

    vec2 outerEdge = clamp(vTextureCoord * 2.0 - vec2(1.0), -1.0, 1.0);

    float shadowBlur = shadowCoords.z;
    float shadowSpread = shadowCoords.w;
    vec2 shadowPosition = shadowCoords.xy;

    vec2 shadowPositionActual = vTextureCoord - (shadowPosition + (shadowSpread + shadowBlur) * outerEdge) / resolution;

    float r = radius[0] * step(vTextureCoord.x, 0.5) * step(vTextureCoord.y, 0.5);
    r = r + radius[1] * step(0.5001, vTextureCoord.x) * step(vTextureCoord.y, 0.5);
    r = r + radius[2] * step(0.5001, vTextureCoord.x) * step(0.5001, vTextureCoord.y);
    r = r + radius[3] * step(vTextureCoord.x, 0.5) * step(0.5001, vTextureCoord.y);

    float rectDist = boxDist(vTextureCoord * resolution - halfRes, halfRes - 0.005, r);
    float shadowDist = boxDist(shadowPositionActual * resolution - halfRes, halfRes - 0.005, r + shadowBlur);

    vec4 tex = texture2D(uSampler, vTextureCoord) * vColor;
    vec4 blend = mix(vec4(1.0) * alpha, tex, blend);

    vec4 rectBackground = mix(vec4(0.0), tex * fillColor, fillMask(rectDist));
    vec4 shadowBackground = mix(vec4(0.0), shadowColor, shadowMask(shadowDist, shadowBlur, rectDist));
    vec4 merged = mix(shadowBackground, rectBackground, smoothstep(0.0, 0.1, rectBackground.a));
    vec4 innerStroked = mix(merged, innerStrokeColor, innerBorderMask(rectDist, innerStroke, stroke));
    vec4 outerStroked = mix(innerStroked, strokeColor, innerBorderMask(rectDist, stroke, 0.0));

    gl_FragColor = blend * outerStroked;
}

`;class yw{constructor(t,n,o,u,f){this.offsetX=t,this.offsetY=n,this.radius=o,this.spread=u,this.color=f}getShadowCoords(){return[this.offsetX,this.offsetY,this.radius,this.spread]}}class BL extends J.Component{constructor(t,n){super(t),this.rect=!0,this._color=4294967295,Object.assign(this,n)}get src(){return super.src}set src(t){super.src=t,t||(this.rect=!0)}get radius(){return this._radius}set radius(t){this._radius=t,this.updateShader()}get shadow(){return this._shadow}set shadow(t){this._shadow=t,this.updateShader()}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){this._strokeWidth=t,this.updateShader()}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t,this.updateShader()}get innerStrokeWidth(){return this._innerStrokeWidth}set innerStrokeWidth(t){this._innerStrokeWidth=t,this.updateShader()}get innerStrokeColor(){return this._innerStrokeColor}set innerStrokeColor(t){this._innerStrokeColor=t,this.updateShader()}themeChanged(){this.colorName&&this._onColorNameChanged(),this.updateShader()}_init(){this._onResize=this.updateShader}_firstActive(){this.updateShader()}getShadowCoords(){if(!this.shadowName)return[0,0,0,0];const t=theme().shadow[this.shadowName];return[t.offsetX,t.offsetY,t.radius,t.spread]}getNormalizedRadius(){let t;if(Array.isArray(this.radius)||(t=[this.radius,this.radius,this.radius,this.radius]),this.w>0&&this.h>0){const n=Math.min(this.w,this.h)/2;for(let o=0;o<4;o++)t[o]=Math.min(t[o],n)}return t}updateShader(){var n;if(!this.__initialized)return;const t={type:Wf,radius:this.getNormalizedRadius()};this.shadow&&this.shadow instanceof yw&&(t.shadowCoords=this.shadow.getShadowCoords(),t.shadowColor=this.shadow.color),this.strokeWidth&&(t.stroke=this.strokeWidth,this.strokeColor&&(t.strokeColor=this.strokeColor)),this.innerStrokeWidth&&this.innerStrokeColor&&(t.innerStroke=this.innerStrokeWidth||0,t.innerStrokeColor=(n=this.innerStrokeColor)!=null?n:void 0),this.shader=t}}class jL extends J.Component{constructor(){super(...arguments),this.Box=this.tag("Box"),this.Rect=this.tag("Rect")}static _template(){return{Box:{zIndex:5,rect:!0,shader:{type:J.shaders.RoundedRectangle,radius:20,stroke:5,strokeColor:ee.colors.orange},color:Cr("transparent").get()},Rect:{type:BL,color:Cr("transparent").get(),radius:20,alpha:.4,shadow:new yw(0,0,30,5,ee.colors.orange)}}}set props(t){console.log("obj",t);const{w:n,h:o}=t;this.Box.patch({w:n,h:o}),this.Rect.patch({w:n-20,h:o-20,x:10,y:10})}}class Wv extends J.Component{constructor(){super(...arguments),this.index=0,this.rowLength=_u.length,this.hideNav=!1,this.eventData={},this.Wrapper=this.tag("Background.Slider.Wrapper")}static _template(){return{Background:{w:1920,h:1080,color:ee.colors.black,rect:!0,Version:{x:50,y:25,w:100,h:100,alpha:.3,text:{text:"V: 0.0.1",fontSize:20}},Box:{x:80,y:665,type:jL},ContentDetails:{type:Vv},Slider:{zIndex:2,clipping:!0,color:Cr("transparent").get(),w:1920,h:540,x:1920,y:0,mount:1,rect:!0,Wrapper:{}}}}}$changeItemOnFocus(t,n){var te,q;let o=(te=t.images.find(H=>H.width===828))==null?void 0:te.url,u=t.title,f=t.description,m=t.genre.join(" . "),p=t.director.map(H=>H.personName).join(", "),v=t.actor.map(H=>H.personName).join(", ");const{railTotalElements:w,cardIndex:C,cardSize:L,railIndex:E}=n,{minimumCardsInViewport:R,w:y,h:I,margin:U}=L;this.tag("Background.ContentDetails").Thumbnail.setSmooth("alpha",0,{duration:.5}),this.tag("Background.ContentDetails").ContentDetails.setSmooth("alpha",0,{duration:.5}),qo.setTimeout(()=>{if(E===this.index&&this.Wrapper.children[this.index].Wrapper.children[n.cardIndex].focused){const H={type:Vv,data:{imgSrc:o,title:u,description:f,genre:m,directorsList:p,actorsList:v}};this.tag("Background.ContentDetails").patch(H)}},500),(q=this.tag("Box"))==null||q.patch({props:{w:y,h:I}});const Z=this.tag("Box");C>=w-(R-1)?Z.setSmooth("x",(y+U)*(R-(w-C))+80,{duration:.1}):Z.setSmooth("x",80,{duration:.1})}_init(){this.backgroundFetchAndSave();const t=[];for(let n=0;n<this.rowLength;n++)t.push({type:_w,x:0,y:n*(500+50),railIndex:n});this.tag("Background.Slider.Wrapper").children=t}async backgroundFetchAndSave(){let t=new mw,n=[];for(let o of _u)await t.fetch(o).then(u=>{var f;if(u){let p=((f=u[0])==null?void 0:f.data).content||[];n=[...n,...p]}});await bf.set("longData",n)}repositionWrapper(){this.tag("Background.Slider.Wrapper").setSmooth("y",(-540-10)*this.index,{duration:.1})}_active(){const t=this.tag("Background.Slider").animation({duration:1,delay:0,actions:[{p:"alpha",v:{0:0,1:1}},{p:"y",v:{0:1400,1:1100}}]}),n=this.tag("Background.Box").animation({duration:1,delay:0,actions:[{p:"alpha",v:{0:0,1:1}},{p:"y",v:{0:965,1:665}}]});t.start(),n.start()}_handleUp(){this.index>0&&(this.index-=1,this.index>=0&&this.repositionWrapper())}_handleDown(){this.index<this.rowLength-1&&(this.index+=1,this.repositionWrapper())}_getFocused(){return this.index<=0?this.patch({Navbar:{visible:!0}}):this.patch({Navbar:{visible:!1}}),this.index>=0?this.tag("Background.Slider.Wrapper").children[this.index]:this.tag("Navbar")}pageTransitionOut(t){return new Promise((n,o)=>{this.tag("Background.Slider").patch({smooth:{y:[1300,{duration:1,delay:0,timingFunction:"ease"}],alpha:0}}),this.tag("Background.Box").patch({smooth:{y:[865,{duration:1,delay:0,timingFunction:"ease"}],alpha:0}}),this.tag("Background.ContentDetails").animate(),this.tag("Background.Slider").transition("y").on("finish",()=>{n()})})}}class Ji extends J.Component{static _template(){return{Wrapper:{}}}_construct(){this._direction=Ji.DIRECTION.row,this._scrollTransitionSettings=this.stage.transitions.createSettings({}),this._spacing=0,this._autoResize=!1,this._requestingItems=!1,this._requestThreshold=1,this._requestsEnabled=!1,this._gcThreshold=5,this._gcIncrement=0,this._forceLoad=!1,this.clear()}_setup(){this._updateScrollTransition()}_updateScrollTransition(){const t=this._direction===1?"y":"x";this.wrapper.transition(t,this._scrollTransitionSettings),this._scrollTransition=this.wrapper.transition(t)}_indexChanged(t){let{previousIndex:n,index:o,dataLength:u,mainIndex:f,previousMainIndex:m,lines:p}=t;!isNaN(m)&&!isNaN(f)&&!isNaN(p)&&(n=m,o=f,u=p),this._requestsEnabled&&!this._requestingItems&&o+this._requestThreshold>=u&&this.requestItems(!1,t),this._refocus(),this.scrollCollectionWrapper(t),t.previousIndex!==t.index&&this.signal("onIndexChanged",t)}requestItems(t=!1,n=void 0){n===void 0&&(n={previous:0,index:0,max:0}),this._requestingItems=!0,this.signal("onRequestItems",n).then(o=>{o===!1&&(this.enableRequests=!1),this._requestingItems=!1,t&&this.clear();const u=typeof o;(Array.isArray(o)||u==="object"||u==="string"||u==="number")&&this.add(o)})}setIndex(t){const n=vw(t,0,this._items.length-1),o=this._index;return this._index=n,this._indexChanged({previousIndex:o,index:n,dataLength:this._items.length}),o!==n}clear(){if(this._uids=[],this._items=[],this._index=0,this._scrollTransition&&this._scrollTransition.reset(0,1),this.wrapper){const t=this.wrapper.children>0;this.wrapper.patch({x:0,y:0,children:[]}),t&&this._collectGarbage(!0)}}add(t){this.addAt(t)}addAt(t,n=this._items.length){if(n>=0&&n<=this._items.length){Array.isArray(t)||(t=[t]);const o=this._normalizeDataItems(t);this._items.splice(n,0,...o),this.plotItems(),this.setIndex(this._index)}else throw new Error("addAt: The index "+n+" is out of bounds "+this._items.length)}remove(t){if(this.hasItems&&t.assignedID){const n=this.itemWrappers;for(let o=0;o<this._items.length;o++){let u=this._items[o];if(n[o]&&n[o].component.isAlive&&(u=n[o].component),t.assignedID===u.assignedID)return this.removeAt(o)}}else throw new Error("remove: item not found")}removeAt(t,n=1){if(t<0&&t>=this._items.length)throw new Error("removeAt: The index "+t+" is out of bounds "+this._items.length);const o=this._items[t];return this._items.splice(t,n),this.plotItems(),o}reload(t){this.clear(),this.add(t)}plotItems(t,n){}reposition(t=70){this._repositionDebounce&&clearTimeout(this._repositionDebounce),this._repositionDebounce=setTimeout(()=>{this.repositionItems()},t)}repositionItems(){this.signal("onItemsRepositioned")}up(){return this._attemptNavigation(-1,1)}down(){return this._attemptNavigation(1,1)}left(){return this._attemptNavigation(-1,0)}right(){return this._attemptNavigation(1,0)}first(){return this.setIndex(0)}last(){return this.setIndex(this._items.length-1)}next(){return this.setIndex(this._index+1)}previous(){return this.setIndex(this._index-1)}_attemptNavigation(t,n){return this.hasItems?this.navigate(t,n):!1}navigate(t,n=this._direction){return n!==this._direction?!1:this.setIndex(this._index+t)}scrollCollectionWrapper(t){let{previousIndex:n,index:o,dataLength:u,mainIndex:f,previousMainIndex:m,lines:p}=t;!isNaN(m)&&!isNaN(f)&&!isNaN(p)&&(n=m,o=f,u=p);const{directionIsRow:v,main:w,mainDim:C,mainMarginFrom:L,mainMarginTo:E}=this._getPlotProperties(this._direction),R=this.currentItemWrapper;let y=this[C];y===0&&(y=v?1920:1080);const I=Math.min(this.wrapper[w],this._scrollTransition&&this._scrollTransition.targetValue||0),U=this._getItemSizes(R),Z=U[L]||U.margin||0,te=U[E]||U.margin||0;let q=this._scroll;if(!isNaN(q))q>=0&&q<=1?q=y*q-(R[w]+R[C]*q):q=q-R[w];else if(typeof q=="function")q=q.apply(this,[R,t]);else if(typeof q=="object"){const{jump:H=!1,after:se=!1,backward:he=0,forward:je=1}=q;if(H){let ge=o%H;if(ge===0&&(q=Z-R[w]),ge===H-1){const ue=Z+R[C]+te;q=ge*ue+Z-R[w]}}else if(se){if(q=0,o>=se-1){const ge=Z+R[C]+te;q=(se-1)*ge+Z-R[w]}}else{const ge=y*this._normalizePixelToPercentage(he,y),ue=y*this._normalizePixelToPercentage(je,y);o<u-1&&n<o&&I+R[w]+R[C]>ue?q=ue-(R[w]+R[C]):o>0&&o<n&&I+R[w]<ge?q=ge-R[w]:o===u-1?q=y-(R[w]+R[C]):o===0&&(q=Z-R[w])}}else isNaN(q)&&(n<o&&I+R[w]+R[C]>y?q=y-(R[w]+R[C]):o<n&&I+R[w]<0&&(q=Z-R[w]));this.active&&!isNaN(q)&&this._scrollTransition?this._scrollTransition.isRunning()?this._scrollTransition.reset(q,.05):this._scrollTransition.start(q):isNaN(q)||(this.wrapper[w]=q)}$childInactive({child:t}){if(typeof t=="object"){const n=t.componentIndex;for(let o in this._items[n])t.component[o]!==void 0&&(this._items[n][o]=t.component[o])}this._collectGarbage()}$getChildComponent({index:t}){return this._items[t]}_resizeWrapper(t){let n=t;if(!isNaN(t)){const{main:o,mainDim:u,crossDim:f}=this._getPlotProperties(this._direction),m=this.wrapper.childList.last;n={[u]:m[o]+m[u],[f]:t}}this.wrapper.patch(n),this._autoResize&&this.patch(n)}_generateUniqueID(){let t="";for(;this._uids[t]||t==="";)t=Math.random().toString(36).substr(2,9);return this._uids[t]=!0,t}_getPlotProperties(t){const n=t===0;return{directionIsRow:!!n,mainDirection:n?"rows":"columns",main:n?"x":"y",mainDim:n?"w":"h",mainMarginTo:n?"marginRight":"marginBottom",mainMarginFrom:n?"marginLeft":"marginTop",crossDirection:n?"rows":"columns",cross:n?"y":"x",crossDim:n?"h":"w",crossMarginTo:n?"marginBottom":"marginRight",crossMarginFrom:n?"marginTop":"marginLeft"}}_getItemSizes(t){const n=t.type;return t.component&&t.component.__attached&&(t=t.component),{w:t.w||n&&n.width,h:t.h||n&&n.height,margin:t.margin||n&&n.margin||0,marginLeft:t.marginLeft||n&&n.marginLeft,marginRight:t.marginRight||n&&n.marginRight,marginTop:t.marginTop||n&&n.marginTop,marginBottom:t.marginBottom||n&&n.marginBottom}}_collectGarbage(t){this._gcIncrement++,(t||this.active&&this._gcThreshold!==0&&this._gcIncrement>=this._gcThreshold)&&(this._gcIncrement=0,this.stage.gc())}_normalizeDataItems(t){return t.map((n,o)=>this._normalizeDataItem(n)||o).filter(n=>isNaN(n)?!0:(console.warn(`Item at index: ${n}, is not a valid item. Removing it from dataset`),!1))}_normalizeDataItem(t,n){return(typeof t=="string"||typeof t=="number")&&(t={label:t.toString()}),typeof t=="object"?{assignedID:this._generateUniqueID(),type:this.itemType,collectionWrapper:this,isAlive:!1,...t}:n}_normalizePixelToPercentage(t,n){return t&&t>1?t/n:t||0}_getFocused(){return this.hasItems?this.currentItemWrapper:this}_handleRight(){return this.right()}_handleLeft(){return this.left()}_handleUp(){return this.up()}_handleDown(){return this.down()}_inactive(){this._repositionDebounce&&clearTimeout(this._repositionDebounce),this._collectGarbage(!0)}static get itemType(){}set forceLoad(t){this._forceLoad=t}get forceLoad(){return this._forceLoad}get requestingItems(){return this._requestingItems}set requestThreshold(t){this._requestThreshold=t}get requestThreshold(){return this._requestThreshold}set enableRequests(t){this._requestsEnabled=t}get enableRequests(){return this._requestsEnabled}set gcThreshold(t){this._gcThreshold=t}get gcThreshold(){return this._gcThreshold}get wrapper(){return this.tag("Wrapper")}get hasItems(){return this.wrapper&&this.wrapper.children&&this.wrapper.children.length>0}get currentItemWrapper(){return this.wrapper.children[this._index]}get currentItem(){return this.currentItemWrapper&&this.currentItemWrapper.component||void 0}set direction(t){this._direction=Ji.DIRECTION[t]||Ji.DIRECTION.row}get direction(){return Object.keys(Ji.DIRECTION)[this._direction]}set items(t){this.clear(),this.add(t)}get items(){const t=this.itemWrappers;return this._items.map((n,o)=>t[o]&&t[o].component.isAlive?t[o].component:n)}get length(){return this._items.length}set index(t){this.setIndex(t)}get itemWrappers(){return this.wrapper.children}get index(){return this._index}set scrollTransition(t){this._scrollTransitionSettings.patch(t),this.active&&this._updateScrollTransition()}get scrollTransition(){return this._scrollTransition}set scroll(t){this._scroll=t}get scroll(){return this._scroll}set autoResize(t){this._autoResize=t}get autoResize(){return this._autoResize}set spacing(t){this._spacing=t}get spacing(){return this._spacing}}Ji.DIRECTION={row:0,column:1};class HL extends J.Component{static _template(){return{alpha:0}}_construct(){this._blink=!0}_init(){this._blinkAnimation=this.animation({duration:1,repeat:-1,actions:[{p:"alpha",v:{0:0,.5:1,1:0}}]})}show(){this._blink?this._blinkAnimation.start():this.alpha=1}hide(){this._blink?this._blinkAnimation.stop():this.alpha=0}set blink(t){this._blink=t,this.active&&(t?this.show():this.hide())}get blink(){return this._blink}}class xw extends J.Component{static _template(){return{clipbox:!0}}create(){if(this.children.length>0)return;const t=this.fireAncestors("$getChildComponent",{index:this.componentIndex});t.isAlive=!0;const{w:n,h:o,margin:u,marginTop:f,marginBottom:m,marginRight:p,marginLeft:v}=this;this.children=[{...t,w:n,h:o,margin:u,marginTop:f,marginRight:p,marginLeft:v,marginBottom:m}],this.hasFocus()&&this._refocus()}get component(){return this.children[0]||this.fireAncestors("$getChildComponent",{index:this.componentIndex})}_setup(){this.forceLoad&&this.create()}_active(){this.create()}_inactive(){this.forceLoad||(this.children[0].isAlive=!1,this.fireAncestors("$childInactive",{child:this}),this.childList.clear())}_getFocused(){return this.children&&this.children[0]||this}}class VL extends J.Component{static _template(){return{clipbox:!0}}_update(){let t=this.children&&this.children[0];t&&t.action===this._key.data.action?t.patch({...this._key}):this.children=[{type:this._key.keyType,...this._key}],this.hasFocus()&&this._refocus()}set key(t){this._key=t,this.active&&this._update()}get key(){return this._key}_active(){this._update()}_inactive(){this.childList.clear()}_getFocused(){return this.children&&this.children[0]||this}}const vw=(c,t,n)=>Math.min(Math.max(c,t),n),Ou=(c,t)=>{t.forEach(n=>{Object.defineProperty(c,n,{set:function(o){c[`_${n}`]=o},get:function(){return c[`_${n}`]}})})},Gv=(c,t,n)=>{for(let o=0;o<c.length;o++)if(c[o][n]===t)return o;return-1};class WL extends Ji{_construct(){this._crossSpacing=5,this._mainSpacing=5,this._rows=0,this._columns=0,super._construct()}clear(){super.clear(),this._mainIndex=0,this._crossIndex=0,this._previous=void 0}setIndex(t){const n=vw(t,0,this._items.length-1),o=this._index,{mainIndex:u,crossIndex:f}=this._findLocationOfIndex(this._index),{mainIndex:m,crossIndex:p}=this._findLocationOfIndex(n);this._mainIndex=m,this._crossIndex=p,this._previous={mainIndex:m,crossIndex:p,realIndex:o},this._index=n,this._indexChanged({previousIndex:o,index:n,mainIndex:m,previousMainIndex:u,crossIndex:p,previousCrossIndex:f,lines:this._lines.length,dataLength:this._items.length})}_findLocationOfIndex(t){for(let n=0;n<this._lines.length;n++)if(this._lines[n].includes(t))return{mainIndex:n,crossIndex:this._lines[n].indexOf(t)};return{mainIndex:-1,crossIndex:-1}}plotItems(){const t=this._items,n=this.wrapper,{directionIsRow:o,mainDirection:u,main:f,mainDim:m,mainMarginTo:p,mainMarginFrom:v,cross:w,crossDim:C,crossMarginTo:L,crossMarginFrom:E}=this._getPlotProperties(this._direction),R=this[C];let y=0,I=0,U=0;const Z=[],te=o?1920:1080,q=o?1080:1920,H=this.core.renderContext;this._lines=[[]];let se=[];const he=t.map((ge,ue)=>{const b=this._getItemSizes(ge),Q=b[E]||b.margin||0;if(ue===0&&(y+=b[v]||b.margin||0),se.length>0&&(this[u]>0&&this[u]===se.length||this[u]===0&&I+Q+b[C]>R)){const pt=this._getBiggestInLine(se);y=pt[f]+pt[m]+(pt[p]||pt.margin||this._mainSpacing),I=Q,this._lines.push([]),se=[],U++}else I+=Q;const fe=`IW-${ge.assignedID}`;let et=y,we=I;const oe=n.tag(fe);oe&&(oe.active&&(I!==oe[w]||y!==oe[f])||!oe.active&&(H[`p${f}`]+n[f]+y<=te||H[`p${w}`]+n[w]+I<=q))&&(et=oe[f],we=oe[w],Z.push(ue));const Et={ref:fe,type:xw,componentIndex:ue,forceLoad:this._forceLoad,...b,[`assigned${f.toUpperCase()}`]:y,[`assigned${w.toUpperCase()}`]:I,[f]:et,[w]:we};return I+=b[C]+(b[L]||b.margin||this._crossSpacing),this._lines[U].push(ue),se.push(Et),Et});n.children=he,Z.forEach(ge=>{const ue=n.children[ge];ue.patch({smooth:{x:ue.assignedX,y:ue.assignedY}})});const je=this._getBiggestInLine(se);this._resizeWrapper({[m]:je[f]+je[m],[C]:R})}repositionItems(){const t=this.wrapper;if(!t&&t.children.length)return!0;const{main:n,mainDim:o,mainMarginTo:u,mainMarginFrom:f,cross:m,crossDim:p,crossMarginTo:v,crossMarginFrom:w}=this._getPlotProperties(this._direction),C=this[p];let L=0,E=0,R=0,y=[];this.lines=[[]],t.children.forEach((U,Z)=>{const te=this._getItemSizes(U),q=te[w]||te.margin||0;if(Z===0&&(L+=te[f]||te.margin||0),y.length>0&&(this[mainDirection]>0&&this[mainDirection]===y.length||this[mainDirection]===0&&E+q+te[p]>C)){const H=this._getBiggestInLine(y);L=H[n]+H[o]+(H[u]||H.margin||this._mainSpacing),E=q,this._lines.push([]),y=[],R++}else E+=q;U.patch({[`assigned${n.toUpperCase()}`]:L,[`assigned${m.toUpperCase()}`]:E,[n]:L,[m]:E}),E+=te[p]+(te[v]||te.margin||this._crossSpacing),this._lines[R].push(Z),y.push(newItem)});const I=this._getBiggestInLine(y);this._resizeWrapper({[o]:I[n]+I[o],[p]:C}),super.repositionItems()}_getBiggestInLine(t){const{mainDim:n}=this._getPlotProperties(this._direction);return t.reduce((o,u)=>u[n]>o[n]?u:o)}navigate(t,n){const{directionIsRow:o,cross:u,crossDim:f}=this._getPlotProperties(this._direction),m=o&&n===Ji.DIRECTION.column||!o&&n===Ji.DIRECTION.row;let p=this._mainIndex+!m*t,v=this._crossIndex+!!m*t,w=this._index;if(m&&v>-1&&v<=this._lines[p].length)this._lines[p][v]!==void 0&&(w=this._lines[p][v],this._previous=void 0);else if(!m&&p<this._lines.length&&p>-1){const C=this._lines[p];if(this._previous&&this._previous.mainIndex===p)w=this._previous.realIndex,v=this._previous.crossIndex;else if(C){const L=this.currentItemWrapper,E=C.map(I=>{const U=this.wrapper.children[I];return U[u]<=L[u]&&L[u]<=U[u]+U[f]?U[u]+U[f]-L[u]:U[u]>=L[u]&&U[u]<=L[u]+L[f]?L[u]+L[f]-U[u]:-1});let R=-1,y=-1;for(let I=0;I<E.length&&!(E[I]===-1&&R>-1);I++)E[I]>R&&(R=E[I],y=I);y>-1&&(v=y,w=C[y])}this._previous={mainIndex:this._mainIndex,crossIndex:this._crossIndex,realIndex:this._index}}return this._index!==w?(this.setIndex(w),!0):!1}set rows(t){this._rows=t,this.direction="row"}get rows(){return this._rows}set columns(t){this._columns=t,this.direction="column"}get columns(){return this._columns}set crossSpacing(t){this._crossSpacing=t}get crossSpacing(){return this._crossSpacing}set mainSpacing(t){this._mainSpacing=t}get mainSpacing(){return this._mainSpacing}set spacing(t){this._spacing=t,this._mainSpacing=t,this._crossSpacing=t}}class GL extends J.Component{static _template(){return{PreLabel:{renderOffscreen:!0},PostLabel:{renderOffscreen:!0},Cursor:{type:HL,rect:!0,w:4,h:54,x:0,y:0}}}_construct(){this._input="",this._previousInput="",this._description="",this._cursorX=0,this._cursorIndex=0,this._passwordMask="*",this._passwordMode=!1,this._autoHideCursor=!0,this._labelPositionStatic=!0,this._maxLabelWidth=0}_init(){this.tag("PreLabel").on("txLoaded",()=>{this._labelTxLoaded()}),this.tag("PostLabel").on("txLoaded",()=>{this._labelTxLoaded})}onInputChanged({input:t=""}){let n=Math.max(t.length-this._input.length+this._cursorIndex,0);this._input=t,this._update(n)}toggleCursor(t=!this._cursorVisible){this._cursorVisible=t,this.cursor[t?"show":"hide"]()}_labelTxLoaded(){const t=this.tag("PreLabel"),n=this.tag("Cursor"),o=this.tag("PostLabel");this.h=t.renderHeight||o.renderHeight,n.x=t.renderWidth+this._cursorX,o.x=n.x+n.w*(1-n.mountX),this.setSmooth("x",this._labelOffset),this.autoHideCursor||this.toggleCursor(!0)}_update(t=0){const n=this._input.length>0;let o=this._description+"",u="";n?(o=this._input.substring(0,t),u=this._input.substring(t,this._input.length),this._passwordMode&&(o=this._passwordMask.repeat(o.length),u=this._passwordMask.repeat(u.length)),this.toggleCursor(!0)):this._autoHideCursor&&this.toggleCursor(!1),this.patch({PreLabel:{text:{text:o}},PostLabel:{text:{text:u}}}),this.h===0&&(this.tag("PreLabel").loadTexture(),this.h=this.tag("PreLabel").renderHeight),this._cursorIndex=t}_handleRight(){this._update(Math.min(this._input.length,this._cursorIndex+1))}_handleLeft(){this._update(Math.max(0,this._cursorIndex-1))}_firstActive(){this._labelTxLoaded(),this._update()}get input(){return this._input}get hasInput(){return this._input.length>0}get cursorIndex(){return this._cursorIndex}set inputText(t){this._inputText=t,this.tag("PreLabel").patch({text:t}),this.tag("PostLabel").patch({text:t})}get inputText(){return this._inputText}set description(t){this._description=t}get description(){return this._description}set cursor(t){t.x&&(this._cursorX=t.x,delete t.x),this.tag("Cursor").patch(t)}get cursor(){return this.tag("Cursor")}get cursorVisible(){return this._cursorVisible}set autoHideCursor(t){this._autoHideCursor=t}get autoHideCursor(){return this._autoHideCursor}set passwordMode(t){this._passwordMode=t}get passwordMode(){return this._passwordMode}set passwordMask(t){this._passwordMask=t}get passwordmask(){return this._passwordMask}set maxLabelWidth(t){this._maxLabelWidth=t}get maxLabelWidth(){return this._maxLabelWidth}set labelPositionStatic(t){this._labelPositionStatic=t}get labelPositionStatic(){return this._labelPositionStatic}get _labelOffset(){if(this._labelPositionStatic)return 0;let t=this.maxLabelWidth-this.tag("Cursor").x;return t<0?t:0}}let Gf=class extends J.Component{static _template(){return{Background:{w:t=>t,h:t=>t,rect:!0},Label:{mount:.5,x:t=>t/2,y:t=>t/2}}}_construct(){this._backgroundColors={},this._labelColors={}}set data(t){this._data=t,this._update()}get data(){return this._data}set labelText(t){this._labelText=t,this.tag("Label").patch({text:t})}get labelText(){return this._labelText}set label(t){this.tag("Label").patch(t)}get label(){return this.tag("Label")}set labelColors(t){this._labelColors=t,this._update()}get labelColors(){return this._labelColors}set backgroundColors(t){this._backgroundColors=t,this._update()}get backgroundColors(){return this._backgroundColors}set background(t){this.tag("Background").patch(t)}get background(){return this.tag("Background")}_update(){if(!this.active)return;const{label:t=""}=this._data,n=this.hasFocus();let{focused:o,unfocused:u=4278190080}=this._backgroundColors,{focused:f,unfocused:m=4294967295}=this._labelColors;this.patch({Background:{color:n&&o?o:u},Label:{text:{text:t},color:n&&f?f:m}})}_firstActive(){this._update()}_focus(){let{focused:t,unfocused:n=4278190080}=this._backgroundColors,{focused:o,unfocused:u=4294967295}=this._labelColors;this.patch({Background:{smooth:{color:t||n}},Label:{smooth:{color:o||u}}})}_unfocus(){let{unfocused:t=4278190080}=this._backgroundColors,{unfocused:n=4294967295}=this._labelColors;this.patch({Background:{smooth:{color:t}},Label:{smooth:{color:n}}})}static get width(){return 80}static get height(){return 80}};class XL extends J.Component{static _template(){return{Keys:{w:t=>t}}}_construct(){this._input="",this._inputField=void 0,this._maxCharacters=56,this.navigationWrapAround=!1,this.resetFocus()}resetFocus(){this._columnIndex=0,this._rowIndex=0,this._previousKey=null}_setup(){this._keys=this.tag("Keys"),this._update()}_update(){const{layouts:t,buttonTypes:n={},styling:o={}}=this._config;(!this._layout||this._layout&&t[this._layout]===void 0)&&(console.error(`Configured layout "${this._layout}" does not exist. Picking first available: "${Object.keys(t)[0]}"`),this._layout=Object.keys(t)[0]);const{horizontalSpacing:u=0,verticalSpacing:f=0,align:m="left"}=o;let p=0;const v=/^[A-Z][A-Za-z0-9]{1}/,w=/\:/;n.default===void 0&&(n.default=Gf),this._keys.children=t[this._layout].map((C,L)=>{const{x:E=0,margin:R=0,marginRight:y,marginLeft:I,marginTop:U,marginBottom:Z,spacing:te=u||0,align:q=m}=o[`Row${L+1}`]||{};let H=0,se=0;const he=C.map((b,Q)=>{const fe=b;let et=n.default,we="Input",oe=b;v.test(b)&&(w.test(b)&&(b=b.split(":"),oe=b[1].toString(),b=b[0]),n[b]&&(et=n[b],we=b.action||b));const Et=et.margin||et.type.margin,{w:pt=et.type.width||0,h:tr=et.type.height||0,marginLeft:Ir=et.type.marginLeft||Et||0,marginRight:ir=et.type.marginRight||Et||te}=et;se=tr>se?tr:se;const Bi=H+Ir;return H+=Ir+pt+ir,{ref:`Key-{${Q+1}}`,type:VL,keyboard:this,x:Bi,w:pt,h:tr,key:{data:{origin:fe,key:b,label:oe,action:we},w:pt,h:tr,...et}}});let je=E+(I||R),ge=0;this.w&&q==="center"&&(je=this.w/2,ge=.5),this.w&&q==="right"&&(je=this.w-(y||R),ge=1);const ue=p+(U||R);return p=ue+se+(Z||R||f),{ref:`Row-${L+1}`,x:je,mountX:ge,w:H,y:ue,children:he}}),this._refocus()}_getFocused(){return this.currentKeyWrapper||this}_handleRight(){return this.navigate("row",1)}_handleLeft(){return this.navigate("row",-1)}_handleUp(){return this.navigate("column",-1)}_handleDown(){return this.navigate("column",1)}_handleKey({key:t,code:n="CustomKey"}){if(n==="Backspace"&&this._input.length===0)return!1;t===" "&&(t="Space");const o=this._findKey(t);return o&&this._handleEnter(),o}_findKey(t){const n=this._config.layouts[this._layout];let o=0,u=0;for(;o<n.length;o++)for(u=0;u<n[o].length;u++){let f=n[o][u];if(t.length>1&&f.indexOf(t)>-1||f.toUpperCase()===t.toUpperCase())return this._rowIndex=o,this._columnIndex=u,!0}return!1}_handleEnter(){const{origin:t,action:n}=this.currentKey.data,o={index:this._input.length,key:t};if(this._inputField&&this._inputField.cursorIndex&&(o.index=this._inputField.cursorIndex),n!=="Input"){const u=o.key.split(":"),f=`on${u[0]}`,m=this[f];o.key=u[1],m&&m.apply&&m.call&&m.call(this,o),this.signal(f,{input:this._input,keyboard:this,...o})}else this.addAt(o.key,o.index)}_changeInput(t){if(t.length>this._maxCharacters)return;const n={previousInput:this._input,input:this._input=t};this._inputField&&this._inputField.onInputChanged&&this._inputField.onInputChanged(n),this.signal("onInputChanged",n)}focus(t){this._findKey(t)}add(t){this._changeInput(this._input+t)}addAt(t,n){n>this._input.length-1?this.add(t):n>-1&&this._changeInput(this._input.substring(0,n)+t+this._input.substring(n,this._input.length))}remove(){this._changeInput(this._input.substring(0,this._input.length-1))}removeAt(t){t>this._input.length-1?this.remove():t>-1&&this._changeInput(this._input.substring(0,t-1)+this._input.substring(t,this._input.length))}clear(){this._changeInput("")}layout(t){t!==this._layout&&(this._layout=t,this.attached&&(this.resetFocus(),this._update()))}inputField(t){t&&t.isComponent?(this._rowIndex=0,this._columnIndex=0,this._input=t.input!==void 0?t.input:"",this._inputField=t):(this._rowIndex=0,this._columnIndex=0,this._input="",this._inputField=void 0)}navigate(t,n){const o=(t==="row"?this._columnIndex:this._rowIndex)+n,u=this.rows[this._rowIndex];if(t==="row"&&o>-1&&o<u.children.length)return this._previous=null,this._columnIndex=o;if(t==="row"&&this.navigationWrapAround){this._previous=null;let f=u.children.length;return this._columnIndex=(o%f+f)%f}if(t==="column"&&o>-1&&o<this.rows.length){const f=this._rowIndex,m=this._columnIndex;if(this._previous&&this._previous.row===o){const p=this._previous.column;this._previous.column=this._columnIndex,this._columnIndex=p,this._rowIndex=this._previous.row}else{const p=this.rows[o],v=this.currentKeyWrapper,w=this.rows[this._rowIndex],C=w.x-w.w*w.mountX+v.x,L=p.children.map(y=>{const I=p.x-p.w*p.mountX+y.x;return I<=C&&C<I+y.w?I+y.w-C:I>=C&&I<=C+v.w?C+v.w-I:-1});let E=-1,R=-1;for(let y=0;y<L.length&&!(L[y]===-1&&E>-1);y++)L[y]>E&&(E=L[y],R=y);if(R>-1)this._rowIndex=o,this._columnIndex=R;else if(this.navigationWrapAround)return this._columnIndex=Math.min(this.rows[0].children.length-1,this._columnIndex),this._rowIndex=0}if(this._rowIndex!==f)return this._previous={column:m,row:f},this._rowIndex=o}else if(t==="column"&&this.navigationWrapAround){this._previous={column:this._columnIndex,row:this._rowIndex};let f=this.rows.length;this._rowIndex=(o%f+f)%f,this._columnIndex=Math.min(this.rows[this._rowIndex].children.length-1,this._columnIndex)}return!1}onSpace({index:t}){this.addAt(" ",t)}onBackspace({index:t}){this.removeAt(t)}onClear(){this.clear()}onLayout({key:t}){this.layout(t)}set config(t){this._config=t,this.active&&this._update()}get config(){return this._config}set currentInputField(t){this.inputField(t)}get currentInputField(){return this._inputField}set currentLayout(t){this.layout(t)}get currentLayout(){return this._layout}set maxCharacters(t){this._maxCharacters=t}get maxCharacters(){return this._maxCharacters}get rows(){return this._keys&&this._keys.children}get currentKeyWrapper(){return this.rows&&this.rows[this._rowIndex].children[this._columnIndex]}get currentKey(){return this.currentKeyWrapper&&this.currentKeyWrapper.key}}class qL extends Ji{plotItems(){const t=this._items,n=this.wrapper,{directionIsRow:o,main:u,mainDim:f,mainMarginTo:m,mainMarginFrom:p,cross:v,crossDim:w}=this._getPlotProperties(this._direction);let C=0,L=0,E=0;const R=[],y=o?1920:1080,I=o?1080:1920,U=this.core.renderContext,Z=t.map((te,q)=>{const H=this._getItemSizes(te);E+=H[p]||H.margin||0,L<H[w]&&(L=H[w]);const se=`IW-${te.assignedID}`;let he=E;C=te[v]||C;let je=he,ge=C;const ue=n.tag(se);return ue&&(ue.active&&(C!==ue[v]||he!==ue[u])||!ue.active&&(U[`p${u}`]+n[u]+he<=y||U[`p${v}`]+n[v]+C<=I))&&(je=ue[u],ge=ue[v],R.push(q)),E+=H[f]+(H[m]||H.margin||this._spacing),{ref:se,type:xw,componentIndex:q,forceLoad:this._forceLoad,...H,[`assigned${u.toUpperCase()}`]:he,[`assigned${v.toUpperCase()}`]:C,[u]:je,[v]:ge}});n.children=Z,R.forEach(te=>{const q=n.children[te];q.patch({smooth:{x:q.assignedX,y:q.assignedY}})}),this._resizeWrapper(L)}repositionItems(){const t=this.wrapper;if(!t&&t.children.length)return!0;const{main:n,mainDim:o,mainMarginTo:u,mainMarginFrom:f,cross:m,crossDim:p}=this._getPlotProperties(this._direction);let v=0,w=0,C=0;t.children.forEach(L=>{const E=this._getItemSizes(L);C+=E[f]||E.margin||0,v=L[m]||v,w<E[p]&&(w=E[p]);const R=C;C+=E[o]+(E[u]||E.margin||this.spacing),L.patch({[`assigned${n.toUpperCase()}`]:R,[`assigned${m.toUpperCase()}`]:0,[n]:R,[m]:v,...E})}),this._resizeWrapper(w),super.repositionItems()}}class Xf extends J.Component{static _template(){return{LabelClipper:{w:t=>t,rtt:!0,shader:{type:J.shaders.FadeOut},LabelWrapper:{Label:{renderOffscreen:!0},LabelCopy:{renderOffscreen:!0}}}}}_construct(){this._autoStart=!0,this._scrollAnimation=!1,this._fade=30,this._spacing=30,this._label={},this._align="left",this._animationSettings={delay:.7,repeat:-1,stopMethod:"immediate"}}_init(){const t=this.tag("Label");t.on("txLoaded",()=>{this._update(t),this._updateAnimation(t),this._autoStart&&this.start()})}_update(t=this.tag("Label")){const n=t.renderWidth,o=n<=this.renderWidth;let u=0;o&&this._align!=="left"&&(u=(this.renderWidth-n)*Xf.ALIGN[this._align]),this.tag("LabelClipper").patch({h:t.renderHeight,shader:{right:o?0:this._fade},LabelWrapper:{x:0,Label:{x:u},LabelCopy:{x:n+this._spacing}}})}_updateAnimation(t=this.tag("Label")){this._scrollAnimation&&this._scrollAnimation.stopNow(),t.renderWidth>this.renderWidth&&(this._animationSettings.duration||(this._animationSettings.duration=t.renderWidth/50),this._scrollAnimation=this.animation({...this._animationSettings,actions:[{t:"LabelWrapper",p:"x",v:{sm:0,0:0,1:-(t.renderWidth+this._spacing)}},{t:"LabelClipper",p:"shader.left",v:{0:0,.2:this._fade,.8:this._fade,1:0}}]}))}start(){this._scrollAnimation&&(this._scrollAnimation.stopNow(),this.tag("LabelCopy").patch({text:this._label}),this._scrollAnimation.start())}stop(){this._scrollAnimation&&(this._scrollAnimation.stopNow(),this.tag("LabelCopy").text="")}set label(t){typeof t=="string"&&(t={text:t}),this._label={...this._label,...t},this.tag("Label").patch({text:t})}get label(){return this.tag("Label")}set align(t){this._align=t}get align(){return this._align}set autoStart(t){this._autoStart=t}get autoStart(){return this._autoStart}set repeat(t){this.animationSettings={repeat:t}}get repeat(){return this._animationSettings.repeat}set delay(t){this.animationSettings={delay:t}}get delay(){return this._animationSettings.delay}set duration(t){this.animationSettings={duration:t}}get duration(){return this._animationSettings.duration}set animationSettings(t){this._animationSettings={...this._animationSettings,...t},this._scrollAnimation&&this._updateAnimation()}get animationSettings(){return this._animationSettings}}Xf.ALIGN={left:0,center:.5,right:1};const $L=(c,t,n,o)=>{let u=t+c;return u<n&&(u=o),u>o&&(u=n),u};class YL extends J.Component{static _template(){return{h:80,w:574,Focus:{alpha:0,w:t=>t,h:t=>t,rect:!0},Label:{x:30,y:t=>t*.5,mountY:.5,text:{text:"",fontSize:22}},ValueWrapper:{x:t=>t-30,w:200,h:t=>t,mountX:1,Value:{x:t=>t*.5,y:t=>t*.5,mountX:.5,mountY:.5,text:{text:"",fontSize:22}}}}}_construct(){this._focusColor=4278227525,this._labelColor=4288519581,this._labelColorFocused=4294967295,this._padding=30,this._max=100,this._min=0,this._value=50,this._options=void 0,this._label="label",this._focusAnimation=null,Ou(this,["focusColor","labelColor","labelColorFocused","padding","max","min","focusAnimation"])}_update(){this.patch({Focus:{color:this._focusColor},Label:{x:this._padding,color:this._labelColor,text:{text:this._label}},ValueWrapper:{x:t=>t-this._padding,Value:{color:this._labelColor,text:{text:this.optionValue||this.value}}}}),this.hasFocus()&&this._focus()}_createFocusAnimation(){this._focusAnimation=this.animation({duration:.2,stopMethod:"reverse",actions:[{t:"Focus",p:"alpha",v:{0:0,1:1}},{t:"Label",p:"color",v:{0:this._labelColor,1:this._labelColorFocused}},{t:"ValueWrapper.Value",p:"color",v:{0:this._labelColor,1:this._labelColorFocused}}]})}_firstActive(){this._focusAnimation||this._createFocusAnimation(),this._update()}_navigate(t){this.value=$L(t,this._value,this._min,this._max);const n={value:this._value};this._options&&(n.options=this._options),this.fireAncestors("$onValueChanged",n),this.signal("onValueChanged",n)}_handleLeft(){this._navigate(-1)}_handleRight(){this._navigate(1)}_focus(){this._focusAnimation&&this._focusAnimation.start()}_unfocus(){this._focusAnimation&&this._focusAnimation.stop()}set label(t){this._label=t,this.active&&(this.tag("Label").text.text=t)}get label(){return this._label}set value(t){this._value=t,this.active&&(this.tag("Value").text.text=this.optionValue||this._value)}get value(){return this._value}get optionValue(){return this._options&&this._options[this._value]&&this._options[this._value].label||void 0}set options(t){const n=t.map(o=>typeof o=="string"?{label:o}:o);this._value=0,this._options=n,this._max=n.length-1,this._update()}get options(){return this._options}}class KL extends YL{static _template(){return{...super._template(),ValueWrapper:{x:t=>t-30,w:200,h:t=>t,mountX:1,ArrowLeft:{y:t=>t*.5,mountY:.5},Value:{x:t=>t*.5,y:t=>t*.5,mountX:.5,mountY:.5,text:{text:"",fontSize:22}},ArrowRight:{y:t=>t*.5,x:t=>t,mountY:.5,mountX:1}}}}_update(){this.patch({Focus:{color:this._focusColor},Label:{x:this._padding,color:this._labelColor,text:{text:this._label}},ValueWrapper:{x:t=>t-this._padding,ArrowLeft:{color:this._labelColor},Value:{color:this._labelColor,text:{text:this.optionValue||this.value}},ArrowRight:{color:this._labelColor}}}),this.hasFocus()&&this._focus()}_createFocusAnimation(){this._focusAnimation=this.animation({duration:.2,stopMethod:"reverse",actions:[{t:"Focus",p:"alpha",v:{0:0,1:1}},{t:"ValueWrapper.ArrowLeft",p:"color",v:{0:this._labelColor,1:this._labelColorFocused}},{t:"ValueWrapper.Value",p:"color",v:{0:this._labelColor,1:this._labelColorFocused}},{t:"ValueWrapper.ArrowRight",p:"color",v:{0:this._labelColor,1:this._labelColorFocused}}]})}_firstActive(){this._focusAnimation||this._createFocusAnimation();const t=this.tag("ArrowLeft"),n=this.tag("ArrowRight");t.src!==void 0&&t.text!==null||(t.text={text:"",fontSize:18}),n.src!==void 0&&n.text!==null||(n.text={text:"",fontSize:18}),this._update()}}class EM extends J.Component{static _template(){return{w:574,h:240,List:{type:qL,w:t=>t,h:t=>t,forceLoad:!0,spacing:0,direction:"column"}}}_construct(){this._autoColorShift=!0,this._focusColor=4278227525,this._labelColor=4288519581,this._labelColorFocused=4294967295,this._options=[{type:"neutral",label:"normal"},{type:"protanopia",label:"Protanopia"},{type:"deuteranopia",label:"Deuteranopia"},{type:"tritanopia",label:"Tritanopia"},{type:"monochromacy",label:"Achromatopsia"}],Ou(this,["focusColor","labelColor","labelColorFocused","options","autoColorShift"])}_getFocused(){return this.tag("List")}_shiftColors(){this._autoColorShift&&this.application&&this.application.colorshift&&this.application.colorshift(this._settings.correction,this._settings)}$onValueChanged(){const t=this.tag("List").items,n=t[0];this._settings={correction:n.options[n.value].type,brightness:t[1].value,contrast:t[2].value,gamma:t[3].value},this._currentCorrection&&this._settings.correction!==this._currentCorrection&&t.slice(1).forEach(u=>{u.value=50}),this._currentCorrection=this._settings.correction,this._shiftColors(),this.signal("onColorShift",this._settings)}_update(){const t=this.tag("List"),n=["Brightness","Contrast","Gamma"],o=this._options,u=this._settings,f={focusColor:this._focusColor,labelColor:this._labelColor,labelColorFocused:this._labelColorFocused};this._shiftColors();const m=n.map(p=>{const v=p.toLocaleLowerCase();return{type:this[`${v}Component`],label:p,value:u[v],w:this.finalW,h:80,...f}});m.unshift({type:this.correctionComponent,options:o,value:Gv(o,u.correction,"type"),label:"Color adjustment",w:this.finalW,h:80,...f}),t.clear(),t.add(m)}_firstActive(){this._settings||(this._settings={correction:"neutral",brightness:50,contrast:50,gamma:50}),this._update()}set settings(t){if(this._settings=t,this.active){const n=this.tag("List").items;n[0]=Gv(this._options,t.correction,"type"),n[1]=t.brightness||50,n[2]=t.contrast||50,n[3]=t.gamma||50}}get settings(){return this._settings}get correctionTag(){return this.tag("List").items[0]}get brightnessTag(){return this.tag("List").items[1]}get contrastTag(){return this.tag("List").items[2]}get gammaTag(){return this.tag("List").items[3]}get adjustmentTags(){return this.tag("List").items}set stepperComponent(t){this._stepperComponent=t}get stepperComponent(){return this._stepperComponent||KL}set correctionComponent(t){this._correctionComponent=t}get correctionComponent(){return this._correctionComponent||this.stepperComponent}set brightnessComponent(t){this._brightnessComponent=t}get brightnessComponent(){return this._brightnessComponent||this.stepperComponent}set contrastComponent(t){this._contrastComponent=t}get contrastComponent(){return this._contrastComponent||this.stepperComponent}set gammaComponent(t){this._gammaComponent=t}get gammaComponent(){return this._gammaComponent||this.stepperComponent}}class bM extends J.Component{static _template(){return{Focus:{alpha:0,x:t=>t*.5,y:t=>t*.5,mount:.5,w:120,h:50,rect:!0,shader:{type:J.shaders.RoundedRectangle,radius:25}},Label:{x:t=>t*.5,y:t=>t*.5,mount:.5,renderOffscreen:!0,text:{text:"",fontSize:22}}}}_construct(){this._focusColor=4278227525,this._labelColor=4288519581,this._labelColorFocused=4294967295,this._padding=40,Ou(this,["focusColor","labelColor","labelColorFocused","padding"])}set label(t){this.tag("Label").text.text=t,this._label=t}get label(){return this._label}_init(){const t=this.tag("Label");t.on("txLoaded",()=>{this.patch({w:t.renderWidth,Focus:{w:t.renderWidth+this._padding*2}}),this.collectionWrapper&&this.collectionWrapper.reposition()})}_focus(){this.patch({Focus:{smooth:{alpha:1}},Label:{smooth:{color:this._labelColorFocused}}})}_unfocus(t){t.isCarouselItem===!0&&this.patch({Focus:{smooth:{alpha:0}},Label:{smooth:{color:this._labelColor}}})}_firstActive(){this.patch({Focus:{color:this._focusColor},Label:{color:this._labelColor}}),this.cparent.componentIndex===this.collectionWrapper.currentItemWrapper.componentIndex&&this._focus()}get isCarouselItem(){return!0}static get width(){return 120}static get height(){return 50}}class IM extends J.Component{static _template(){return{w:300,h:10,Background:{w:t=>t,h:t=>t,rect:!0,rtt:!0,shader:{type:J.shaders.RoundedRectangle,radius:5},Progress:{h:t=>t,w:10,rect:!0,shader:{type:J.shaders.RoundedRectangle,radius:0}}}}}_construct(){this._progressColor=4278227525,this._progressColorFocused=void 0,this._backgroundColor=4288519581,this._backgroundColorFocused=void 0,this._backgroundRadius=5,this._progressRadius=0,this.value=.5,Ou(this,["progressColor","backgroundColor","progressColorFocused","backgroundColorFocused"])}progress(t){t>1&&(t=t/100),this._value=t,this.tag("Progress").w=this.w*t}_createFocusAnimation(){this._focusAnimation=this.animation({duration:.2,stopMethod:"reverse",actions:[{t:"Background",p:"color",v:{0:this._backgroundColor,1:this._backgroundColorFocused||this._backgroundColor}},{t:"Background.Progress",p:"color",v:{0:this._progressColor,1:this._progressColorFocused||this._progressColor}}]})}_firstActive(){this._focusAnimation||this._createFocusAnimation(),this.patch({Background:{color:this._backgroundColor,shader:{radius:this._backgroundRadius},Progress:{color:this._progressColor,shader:{radius:this._progressRadius}}}}),this.progress(this._value),this.hasFocus()&&this._focus()}_focus(){this._focusAnimation&&this._focusAnimation.start()}_unfocus(){this._focusAnimation&&this._focusAnimation.stop()}set value(t){this._value=t,this.active&&this.progress(t)}get value(){return this._value}set backgroundRadius(t){this._backgroundRadius=t,this.active&&(this.tag("Background").shader.radius=t)}get progressRadius(){return this._progressRadius}set progressRadius(t){this._progressRadius=t,this.active&&(this.tag("Progress").shader.radius=t)}get progressRadius(){return this._progressRadius}get backgroundTag(){return this.tag("Background")}get progressTag(){return this.tag("Progress")}}class ZL extends J.Component{constructor(){super(...arguments),this.index=2,this.intervalSub=0}static _template(){return{w:1920,h:1080,color:ee.colors.primaryLight,rect:!0,shader:{x:100,y:-100,pivot:.5,type:J.shaders.RadialGradient,outerColor:ee.colors.primaryLight,innerColor:ee.colors.dark,radius:800},SearchComponent:{x:40,y:40,shader:null,SearchBox:{x:0,y:60,w:950,h:60,rect:!0,color:ee.colors.accentGrey.light,shader:{type:J.shaders.RoundedRectangle,radius:30},InputWrapper:{x:20,color:ee.colors.dark,InputField:{y:20,type:GL}}},BackButton:{type:ku},Keyboard:{x:0,y:140,type:XL,config:JL,currentLayout:"abc",maxCharacters:24,signals:{onSearch:!0}}}}}_setup(){const t=this.tag("SearchComponent.SearchBox.InputWrapper.InputField");this.tag("Keyboard").inputField(t)}onSearch(t){console.log("search",t.input)}_active(){super._active(),this.tag("SearchComponent.SearchBox.InputWrapper.InputField").color=ee.colors.accentGrey.dark;const t={type:_w,x:-30,y:380,railIndex:16};this.tag("SearchComponent").patch({LongRail:t})}_getFocused(){return this.tag("Keyboard")}_handleUp(){this.index>1&&(this.index-=1)}_handleDown(){this.index<3&&(this.index+=1)}_handleEnter(){this.index===1&&Bt.navigate("home")}_getFocused(){return this.tag("SearchComponent").children[this.index]}}class QL extends Gf{_firstActive(){this.label={mountY:.45},this.labelColors={unfocused:Cr("white").get(),focused:ee.colors.dark},this.backgroundColors={unfocused:Cr("white").alpha(0).get(),focused:ee.colors.white},this.hasFocus()&&this._focus()}static get width(){return 90}static get height(){return 40}}class Fo extends Gf{_active(){this.label={mountY:.45},this.labelColors={unfocused:Cr("black").get(),focused:Cr("white").get()},this.backgroundColors={unfocused:Cr("white").get(),focused:ee.colors.accentGrey.light},this.hasFocus()&&this._focus()}static get height(){return 60}static get width(){return 160}}const JL={layouts:{abc:[["a","b","c","d","e","f","g","h","i","j"],["k","l","m","n","o","p","q","r","s","t"],["u","v","w","x","y","z","_","-","@","."],["Layout:ABC","Layout:123","Space","Search","Del"]],ABC:[["A","B","C","D","E","F","G","H","I","J"],["K","L","M","N","O","P","Q","R","S","T"],["U","V","W","X","Y","Z","_","-","@","."],["Layout:abc","Layout:123","Space","Search","Del"]],123:[["1","2","3","4","5","6","7","8","9","0"],["Layout:abc","Space","Clear","Del"]]},styling:{align:"center",horizontalSpacing:5,verticalSpacing:20},buttonTypes:{default:{type:QL},Del:{type:Fo,icon:"del"},Layout:{type:Fo},Space:{type:Fo,w:280,label:"space"},Clear:{type:Fo,label:"clear"},Search:{type:Fo,label:"search"}}};var rf={exports:{}};(function(c,t){(function(n,o){var u="1.0.35",f="",m="?",p="function",v="undefined",w="object",C="string",L="major",E="model",R="name",y="type",I="vendor",U="version",Z="architecture",te="console",q="mobile",H="tablet",se="smarttv",he="wearable",je="embedded",ge=350,ue="Amazon",b="Apple",Q="ASUS",fe="BlackBerry",et="Browser",we="Chrome",oe="Edge",Et="Firefox",pt="Google",tr="Huawei",Ir="LG",ir="Microsoft",Bi="Motorola",On="Opera",Rs="Samsung",B="Sharp",Vt="Sony",jt="Xiaomi",Dn="Zebra",Fn="Facebook",Nn="Chromium OS",na="Mac OS",Du=function(be,We){var ce={};for(var $e in be)We[$e]&&We[$e].length%2===0?ce[$e]=We[$e].concat(be[$e]):ce[$e]=be[$e];return ce},ie=function(be){for(var We={},ce=0;ce<be.length;ce++)We[be[ce].toUpperCase()]=be[ce];return We},Gr=function(be,We){return typeof be===C?rr(We).indexOf(rr(be))!==-1:!1},rr=function(be){return be.toLowerCase()},Xr=function(be){return typeof be===C?be.replace(/[^\d\.]/g,f).split(".")[0]:o},Ls=function(be,We){if(typeof be===C)return be=be.replace(/^\s\s*/,f),typeof We===v?be:be.substring(0,ge)},Kt=function(be,We){for(var ce=0,$e,bi,gt,Ue,_e,Le;ce<We.length&&!_e;){var Un=We[ce],Ms=We[ce+1];for($e=bi=0;$e<Un.length&&!_e&&Un[$e];)if(_e=Un[$e++].exec(be),_e)for(gt=0;gt<Ms.length;gt++)Le=_e[++bi],Ue=Ms[gt],typeof Ue===w&&Ue.length>0?Ue.length===2?typeof Ue[1]==p?this[Ue[0]]=Ue[1].call(this,Le):this[Ue[0]]=Ue[1]:Ue.length===3?typeof Ue[1]===p&&!(Ue[1].exec&&Ue[1].test)?this[Ue[0]]=Le?Ue[1].call(this,Le,Ue[2]):o:this[Ue[0]]=Le?Le.replace(Ue[1],Ue[2]):o:Ue.length===4&&(this[Ue[0]]=Le?Ue[3].call(this,Le.replace(Ue[1],Ue[2])):o):this[Ue]=Le||o;ce+=2}},Ve=function(be,We){for(var ce in We)if(typeof We[ce]===w&&We[ce].length>0){for(var $e=0;$e<We[ce].length;$e++)if(Gr(We[ce][$e],be))return ce===m?o:ce}else if(Gr(We[ce],be))return ce===m?o:ce;return be},nr={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},sa={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Fu={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[U,[R,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[U,[R,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[R,U],[/opios[\/ ]+([\w\.]+)/i],[U,[R,On+" Mini"]],[/\bopr\/([\w\.]+)/i],[U,[R,On]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[R,U],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[U,[R,"UC"+et]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[U,[R,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[U,[R,"WeChat"]],[/konqueror\/([\w\.]+)/i],[U,[R,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[U,[R,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[U,[R,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[R,/(.+)/,"$1 Secure "+et],U],[/\bfocus\/([\w\.]+)/i],[U,[R,Et+" Focus"]],[/\bopt\/([\w\.]+)/i],[U,[R,On+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[U,[R,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[U,[R,"Dolphin"]],[/coast\/([\w\.]+)/i],[U,[R,On+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[U,[R,"MIUI "+et]],[/fxios\/([-\w\.]+)/i],[U,[R,Et]],[/\bqihu|(qi?ho?o?|360)browser/i],[[R,"360 "+et]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[R,/(.+)/,"$1 "+et],U],[/(comodo_dragon)\/([\w\.]+)/i],[[R,/_/g," "],U],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[R,U],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[R],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[R,Fn],U],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[R,U],[/\bgsa\/([\w\.]+) .*safari\//i],[U,[R,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[U,[R,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[U,[R,we+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[R,we+" WebView"],U],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[U,[R,"Android "+et]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[R,U],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[U,[R,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[U,R],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[R,[U,Ve,nr]],[/(webkit|khtml)\/([\w\.]+)/i],[R,U],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[R,"Netscape"],U],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[U,[R,Et+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[R,U],[/(cobalt)\/([\w\.]+)/i],[R,[U,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[Z,"amd64"]],[/(ia32(?=;))/i],[[Z,rr]],[/((?:i[346]|x)86)[;\)]/i],[[Z,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[Z,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[Z,"armhf"]],[/windows (ce|mobile); ppc;/i],[[Z,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[Z,/ower/,f,rr]],[/(sun4\w)[;\)]/i],[[Z,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[Z,rr]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[E,[I,Rs],[y,H]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[E,[I,Rs],[y,q]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[E,[I,b],[y,q]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[E,[I,b],[y,H]],[/(macintosh);/i],[E,[I,b]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[E,[I,B],[y,q]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[E,[I,tr],[y,H]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[E,[I,tr],[y,q]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[E,/_/g," "],[I,jt],[y,q]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[E,/_/g," "],[I,jt],[y,H]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[E,[I,"OPPO"],[y,q]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[E,[I,"Vivo"],[y,q]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[E,[I,"Realme"],[y,q]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[E,[I,Bi],[y,q]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[E,[I,Bi],[y,H]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[E,[I,Ir],[y,H]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[E,[I,Ir],[y,q]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[E,[I,"Lenovo"],[y,H]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[E,/_/g," "],[I,"Nokia"],[y,q]],[/(pixel c)\b/i],[E,[I,pt],[y,H]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[E,[I,pt],[y,q]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[E,[I,Vt],[y,q]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[E,"Xperia Tablet"],[I,Vt],[y,H]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[E,[I,"OnePlus"],[y,q]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[E,[I,ue],[y,H]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[E,/(.+)/g,"Fire Phone $1"],[I,ue],[y,q]],[/(playbook);[-\w\),; ]+(rim)/i],[E,I,[y,H]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[E,[I,fe],[y,q]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[E,[I,Q],[y,H]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[E,[I,Q],[y,q]],[/(nexus 9)/i],[E,[I,"HTC"],[y,H]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[I,[E,/_/g," "],[y,q]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[E,[I,"Acer"],[y,H]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[E,[I,"Meizu"],[y,q]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[I,E,[y,q]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[I,E,[y,H]],[/(surface duo)/i],[E,[I,ir],[y,H]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[E,[I,"Fairphone"],[y,q]],[/(u304aa)/i],[E,[I,"AT&T"],[y,q]],[/\bsie-(\w*)/i],[E,[I,"Siemens"],[y,q]],[/\b(rct\w+) b/i],[E,[I,"RCA"],[y,H]],[/\b(venue[\d ]{2,7}) b/i],[E,[I,"Dell"],[y,H]],[/\b(q(?:mv|ta)\w+) b/i],[E,[I,"Verizon"],[y,H]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[E,[I,"Barnes & Noble"],[y,H]],[/\b(tm\d{3}\w+) b/i],[E,[I,"NuVision"],[y,H]],[/\b(k88) b/i],[E,[I,"ZTE"],[y,H]],[/\b(nx\d{3}j) b/i],[E,[I,"ZTE"],[y,q]],[/\b(gen\d{3}) b.+49h/i],[E,[I,"Swiss"],[y,q]],[/\b(zur\d{3}) b/i],[E,[I,"Swiss"],[y,H]],[/\b((zeki)?tb.*\b) b/i],[E,[I,"Zeki"],[y,H]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[I,"Dragon Touch"],E,[y,H]],[/\b(ns-?\w{0,9}) b/i],[E,[I,"Insignia"],[y,H]],[/\b((nxa|next)-?\w{0,9}) b/i],[E,[I,"NextBook"],[y,H]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[I,"Voice"],E,[y,q]],[/\b(lvtel\-)?(v1[12]) b/i],[[I,"LvTel"],E,[y,q]],[/\b(ph-1) /i],[E,[I,"Essential"],[y,q]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[E,[I,"Envizen"],[y,H]],[/\b(trio[-\w\. ]+) b/i],[E,[I,"MachSpeed"],[y,H]],[/\btu_(1491) b/i],[E,[I,"Rotor"],[y,H]],[/(shield[\w ]+) b/i],[E,[I,"Nvidia"],[y,H]],[/(sprint) (\w+)/i],[I,E,[y,q]],[/(kin\.[onetw]{3})/i],[[E,/\./g," "],[I,ir],[y,q]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[E,[I,Dn],[y,H]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[E,[I,Dn],[y,q]],[/smart-tv.+(samsung)/i],[I,[y,se]],[/hbbtv.+maple;(\d+)/i],[[E,/^/,"SmartTV"],[I,Rs],[y,se]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[I,Ir],[y,se]],[/(apple) ?tv/i],[I,[E,b+" TV"],[y,se]],[/crkey/i],[[E,we+"cast"],[I,pt],[y,se]],[/droid.+aft(\w)( bui|\))/i],[E,[I,ue],[y,se]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[E,[I,B],[y,se]],[/(bravia[\w ]+)( bui|\))/i],[E,[I,Vt],[y,se]],[/(mitv-\w{5}) bui/i],[E,[I,jt],[y,se]],[/Hbbtv.*(technisat) (.*);/i],[I,E,[y,se]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[I,Ls],[E,Ls],[y,se]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[y,se]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[I,E,[y,te]],[/droid.+; (shield) bui/i],[E,[I,"Nvidia"],[y,te]],[/(playstation [345portablevi]+)/i],[E,[I,Vt],[y,te]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[E,[I,ir],[y,te]],[/((pebble))app/i],[I,E,[y,he]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[E,[I,b],[y,he]],[/droid.+; (glass) \d/i],[E,[I,pt],[y,he]],[/droid.+; (wt63?0{2,3})\)/i],[E,[I,Dn],[y,he]],[/(quest( 2| pro)?)/i],[E,[I,Fn],[y,he]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[I,[y,je]],[/(aeobc)\b/i],[E,[I,ue],[y,je]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[E,[y,q]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[E,[y,H]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[y,H]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[y,q]],[/(android[-\w\. ]{0,9});.+buil/i],[E,[I,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[U,[R,oe+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[U,[R,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[R,U],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[U,R]],os:[[/microsoft (windows) (vista|xp)/i],[R,U],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[R,[U,Ve,sa]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[R,"Windows"],[U,Ve,sa]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[U,/_/g,"."],[R,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[R,na],[U,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[U,R],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[R,U],[/\(bb(10);/i],[U,[R,fe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[U,[R,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[U,[R,Et+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[U,[R,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[U,[R,"watchOS"]],[/crkey\/([\d\.]+)/i],[U,[R,we+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[R,Nn],U],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[R,U],[/(sunos) ?([\w\.\d]*)/i],[[R,"Solaris"],U],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[R,U]]},li=function(be,We){if(typeof be===w&&(We=be,be=o),!(this instanceof li))return new li(be,We).getResult();var ce=typeof n!==v&&n.navigator?n.navigator:o,$e=be||(ce&&ce.userAgent?ce.userAgent:f),bi=ce&&ce.userAgentData?ce.userAgentData:o,gt=We?Du(Fu,We):Fu,Ue=ce&&ce.userAgent==$e;return this.getBrowser=function(){var _e={};return _e[R]=o,_e[U]=o,Kt.call(_e,$e,gt.browser),_e[L]=Xr(_e[U]),Ue&&ce&&ce.brave&&typeof ce.brave.isBrave==p&&(_e[R]="Brave"),_e},this.getCPU=function(){var _e={};return _e[Z]=o,Kt.call(_e,$e,gt.cpu),_e},this.getDevice=function(){var _e={};return _e[I]=o,_e[E]=o,_e[y]=o,Kt.call(_e,$e,gt.device),Ue&&!_e[y]&&bi&&bi.mobile&&(_e[y]=q),Ue&&_e[E]=="Macintosh"&&ce&&typeof ce.standalone!==v&&ce.maxTouchPoints&&ce.maxTouchPoints>2&&(_e[E]="iPad",_e[y]=H),_e},this.getEngine=function(){var _e={};return _e[R]=o,_e[U]=o,Kt.call(_e,$e,gt.engine),_e},this.getOS=function(){var _e={};return _e[R]=o,_e[U]=o,Kt.call(_e,$e,gt.os),Ue&&!_e[R]&&bi&&bi.platform!="Unknown"&&(_e[R]=bi.platform.replace(/chrome os/i,Nn).replace(/macos/i,na)),_e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return $e},this.setUA=function(_e){return $e=typeof _e===C&&_e.length>ge?Ls(_e,ge):_e,this},this.setUA($e),this};li.VERSION=u,li.BROWSER=ie([R,U,L]),li.CPU=ie([Z]),li.DEVICE=ie([E,I,y,te,q,se,H,he,je]),li.ENGINE=li.OS=ie([R,U]),c.exports&&(t=c.exports=li),t.UAParser=li;var qr=typeof n!==v&&(n.jQuery||n.Zepto);if(qr&&!qr.ua){var $r=new li;qr.ua=$r.getResult(),qr.ua.get=function(){return $r.getUA()},qr.ua.set=function(be){$r.setUA(be);var We=$r.getResult();for(var ce in We)qr.ua[ce]=We[ce]}}})(typeof window=="object"?window:C0)})(rf,rf.exports);var eM=rf.exports;class tM extends J.Component{constructor(){super(...arguments),this.contentId="",this.index=1,this.from=""}static _template(){return{ContentView:{w:1920,h:1080,color:ee.colors.black,rect:!0,shader:{x:100,y:-100,pivot:.5,type:J.shaders.RadialGradient,outerColor:ee.colors.primaryLight,innerColor:ee.colors.dark,radius:800},Thumbnail:{x:1e3,y:110,scale:1.5,shader:{type:J.shaders.FadeOut,innerColor:ee.colors.black,left:200,bottom:200}},ContentData:{shader:null,zIndex:2,Title:{x:40,y:165,shader:null,text:{fontSize:80},color:ee.colors.white},Description:{x:40,y:270,w:900,shader:null,text:{wordWrap:!0,maxLines:3,maxLinesSuffix:"...",fontSize:30},color:ee.colors.accentGrey.light},Genre:{x:40,y:380,w:900,shader:null,text:{fontSize:24},color:ee.colors.accentGrey.light},Info:{visible:!1,Director:{x:40,y:440,w:100,shader:null,text:{text:"Director : ",fontSize:24},color:ee.colors.accentGrey.light},Starring:{x:40,y:470,w:100,shader:null,text:{text:"Staring  : ",fontSize:24},color:ee.colors.accentGrey.light},DirectorList:{x:150,y:440,w:800,shader:null,text:{fontSize:24},color:ee.colors.accentGrey.light},StarringList:{x:150,y:470,w:800,shader:null,text:{fontSize:24,wordWrap:!0,maxLines:1,maxLinesSuffix:"..."},color:ee.colors.accentGrey.light}},VideoSpec:{visible:!1,VideoSpec1:{x:70,y:140,shader:null,type:Ts,specData:"  16+  "},VideoSpec2:{x:135,y:140,shader:null,type:Ts,specData:"  4k  "},VideoSpec3:{x:193,y:140,shader:null,type:Ts,specData:"  cc  "}}},ContentActions:{shader:null,BackButton:{x:40,y:40,type:ku},PlayButton:{x:40,y:570,type:Hv,label:"Play Video"},PlayTrailer:{x:40,y:700,type:Hv,label:"Play Trailer"}}}}}_inactive(){console.log("Inactive"),this.index=1}set params(t){var m;const{id:n,from:o,data:u}=t;this.from=o;let f=(m=u.images.find(p=>p.width===828))==null?void 0:m.url;this.contentId=n,this.patch({ContentView:{shader:{type:J.shaders.RadialGradient,x:300,y:300,innerColor:4278190080,radius:1500},Thumbnail:{src:f},ContentData:{x:10,Title:{text:{text:u.title}},Description:{text:{text:u.description}},Genre:{text:{text:u.genre.join(" . ")}},Info:{visible:!0,DirectorList:{text:{text:u.director.map(p=>p.personName).join(", ")}},StarringList:{text:{text:u.actor.map(p=>p.personName).join(", ")}}},VideoSpec:{visible:!0}}}}),this._refocus()}_init(){}animateElements(){const t=this.tag("ContentView.ContentData").animation({duration:1,delay:0,actions:[{p:"alpha",v:{0:0,1:1}},{p:"y",v:{0:-60,1:0}}]});this.tag("ContentView.ContentActions").animation({duration:1,delay:0,actions:[{p:"alpha",v:{0:0,1:1}},{p:"x",v:{0:-100,1:10}}]}).start(),t.start()}_handleUp(){this.index>0&&(this.index-=1)}_handleDown(){this.index<2&&(this.index+=1)}_handleEnter(){this.index===0?this.from=="gridItem"||this.from=="Grid"?Bt.navigate("grid"):Bt.navigate("home"):new eM.UAParser().getResult().os.name==="Android"?window.LngAndroid.openActivity("https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"):Bt.navigate(`player/${this.contentId}`)}_getFocused(){return this.tag("ContentView.ContentActions").children[this.index]}pageTransition(t,n){return n?new Promise((o,u)=>{n.pageTransitionOut(n).then(()=>{t.visible=!0,t.animateElements(),o()})}):Promise.resolve()}}var ww={};/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/(function(c){(function(){var t=typeof window<"u"?window:C0,n={};(function(u,f,m){/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/var p;function v(e){var i=0;return function(){return i<e.length?{done:!1,value:e[i++]}:{done:!0}}}var w=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,i,r){return e==Array.prototype||e==Object.prototype||(e[i]=r.value),e};function C(e){e=[typeof globalThis=="object"&&globalThis,e,typeof u=="object"&&u,typeof self=="object"&&self,typeof f=="object"&&f];for(var i=0;i<e.length;++i){var r=e[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}var L=C(this);function E(e,i){if(i)e:{var r=L;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in r))break e;r=r[a]}e=e[e.length-1],s=r[e],i=i(s),i!=s&&i!=null&&w(r,e,{configurable:!0,writable:!0,value:i})}}E("Symbol",function(e){function i(l){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return new r(s+(l||"")+"_"+a++,l)}function r(l,h){this.g=l,w(this,"description",{configurable:!0,writable:!0,value:h})}if(e)return e;r.prototype.toString=function(){return this.g};var s="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return i}),E("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var i="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<i.length;r++){var s=L[i[r]];typeof s=="function"&&typeof s.prototype[e]!="function"&&w(s.prototype,e,{configurable:!0,writable:!0,value:function(){return R(v(this))}})}return e});function R(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function y(e){var i=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return i?i.call(e):{next:v(e)}}function I(e){if(!(e instanceof Array)){e=y(e);for(var i,r=[];!(i=e.next()).done;)r.push(i.value);e=r}return e}var U=typeof Object.create=="function"?Object.create:function(e){function i(){}return i.prototype=e,new i},Z;if(typeof Object.setPrototypeOf=="function")Z=Object.setPrototypeOf;else{var te;e:{var q={a:!0},H={};try{H.__proto__=q,te=H.a;break e}catch(e){}te=!1}Z=te?function(e,i){if(e.__proto__=i,e.__proto__!==i)throw new TypeError(e+" is not extensible");return e}:null}var se=Z;function he(e,i){if(e.prototype=U(i.prototype),e.prototype.constructor=e,se)se(e,i);else for(var r in i)if(r!="prototype")if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(e,r,s)}else e[r]=i[r];e.xh=i.prototype}function je(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.u=this.i=null}function ge(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}je.prototype.s=function(e){this.h=e};function ue(e,i){e.i={Ee:i,Le:!0},e.g=e.m||e.j}je.prototype.return=function(e){this.i={return:e},this.g=this.j};function b(e,i,r){return e.g=r,{value:i}}je.prototype.A=function(e){this.g=e};function Q(e){e.g=0}function fe(e,i,r){e.m=i,r!=null&&(e.j=r)}function et(e){e.m=0,e.j=2}function we(e,i){e.g=i,e.m=0}function oe(e){e.m=0;var i=e.i.Ee;return e.i=null,i}function Et(e){e.u=[e.i],e.m=0,e.j=0}function pt(e,i){var r=e.u.splice(0)[0];(r=e.i=e.i||r)?r.Le?e.g=e.m||e.j:r.A!=null&&e.j<r.A?(e.g=r.A,e.i=null):e.g=e.j:e.g=i}function tr(e){this.g=new je,this.h=e}function Ir(e,i){ge(e.g);var r=e.g.l;return r?ir(e,"return"in r?r.return:function(s){return{value:s,done:!0}},i,e.g.return):(e.g.return(i),Bi(e))}function ir(e,i,r,s){try{var a=i.call(e.g.l,r);if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");if(!a.done)return e.g.o=!1,a;var l=a.value}catch(h){return e.g.l=null,ue(e.g,h),Bi(e)}return e.g.l=null,s.call(e.g,l),Bi(e)}function Bi(e){for(;e.g.g;)try{var i=e.h(e.g);if(i)return e.g.o=!1,{value:i.value,done:!1}}catch(r){e.g.h=void 0,ue(e.g,r)}if(e.g.o=!1,e.g.i){if(i=e.g.i,e.g.i=null,i.Le)throw i.Ee;return{value:i.return,done:!0}}return{value:void 0,done:!0}}function On(e){this.next=function(i){return ge(e.g),e.g.l?i=ir(e,e.g.l.next,i,e.g.s):(e.g.s(i),i=Bi(e)),i},this.throw=function(i){return ge(e.g),e.g.l?i=ir(e,e.g.l.throw,i,e.g.s):(ue(e.g,i),i=Bi(e)),i},this.return=function(i){return Ir(e,i)},this[Symbol.iterator]=function(){return this}}function Rs(e){function i(s){return e.next(s)}function r(s){return e.throw(s)}return new Promise(function(s,a){function l(h){h.done?s(h.value):Promise.resolve(h.value).then(i,r).then(l,a)}l(e.next())})}function B(e){return Rs(new On(new tr(e)))}function Vt(){for(var e=Number(this),i=[],r=e;r<arguments.length;r++)i[r-e]=arguments[r];return i}E("Promise",function(e){function i(h){this.h=0,this.i=void 0,this.g=[],this.o=!1;var d=this.j();try{h(d.resolve,d.reject)}catch(g){d.reject(g)}}function r(){this.g=null}function s(h){return h instanceof i?h:new i(function(d){d(h)})}if(e)return e;r.prototype.h=function(h){if(this.g==null){this.g=[];var d=this;this.i(function(){d.l()})}this.g.push(h)};var a=L.setTimeout;r.prototype.i=function(h){a(h,0)},r.prototype.l=function(){for(;this.g&&this.g.length;){var h=this.g;this.g=[];for(var d=0;d<h.length;++d){var g=h[d];h[d]=null;try{g()}catch(_){this.j(_)}}}this.g=null},r.prototype.j=function(h){this.i(function(){throw h})},i.prototype.j=function(){function h(_){return function(x){g||(g=!0,_.call(d,x))}}var d=this,g=!1;return{resolve:h(this.F),reject:h(this.l)}},i.prototype.F=function(h){if(h===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof i)this.H(h);else{e:switch(typeof h){case"object":var d=h!=null;break e;case"function":d=!0;break e;default:d=!1}d?this.D(h):this.m(h)}},i.prototype.D=function(h){var d=void 0;try{d=h.then}catch(g){this.l(g);return}typeof d=="function"?this.J(d,h):this.m(h)},i.prototype.l=function(h){this.s(2,h)},i.prototype.m=function(h){this.s(1,h)},i.prototype.s=function(h,d){if(this.h!=0)throw Error("Cannot settle("+h+", "+d+"): Promise already settled in state"+this.h);this.h=h,this.i=d,this.h===2&&this.G(),this.u()},i.prototype.G=function(){var h=this;a(function(){if(h.B()){var d=L.console;typeof d<"u"&&d.error(h.i)}},1)},i.prototype.B=function(){if(this.o)return!1;var h=L.CustomEvent,d=L.Event,g=L.dispatchEvent;return typeof g>"u"?!0:(typeof h=="function"?h=new h("unhandledrejection",{cancelable:!0}):typeof d=="function"?h=new d("unhandledrejection",{cancelable:!0}):(h=L.document.createEvent("CustomEvent"),h.initCustomEvent("unhandledrejection",!1,!0,h)),h.promise=this,h.reason=this.i,g(h))},i.prototype.u=function(){if(this.g!=null){for(var h=0;h<this.g.length;++h)l.h(this.g[h]);this.g=null}};var l=new r;return i.prototype.H=function(h){var d=this.j();h.Lc(d.resolve,d.reject)},i.prototype.J=function(h,d){var g=this.j();try{h.call(d,g.resolve,g.reject)}catch(_){g.reject(_)}},i.prototype.then=function(h,d){function g(S,A){return typeof S=="function"?function(M){try{_(S(M))}catch(O){x(O)}}:A}var _,x,T=new i(function(S,A){_=S,x=A});return this.Lc(g(h,_),g(d,x)),T},i.prototype.catch=function(h){return this.then(void 0,h)},i.prototype.Lc=function(h,d){function g(){switch(_.h){case 1:h(_.i);break;case 2:d(_.i);break;default:throw Error("Unexpected state: "+_.h)}}var _=this;this.g==null?l.h(g):this.g.push(g),this.o=!0},i.resolve=s,i.reject=function(h){return new i(function(d,g){g(h)})},i.race=function(h){return new i(function(d,g){for(var _=y(h),x=_.next();!x.done;x=_.next())s(x.value).Lc(d,g)})},i.all=function(h){var d=y(h),g=d.next();return g.done?s([]):new i(function(_,x){function T(M){return function(O){S[M]=O,A--,A==0&&_(S)}}var S=[],A=0;do S.push(void 0),A++,s(g.value).Lc(T(S.length-1),x),g=d.next();while(!g.done)})},i});function jt(e,i){return Object.prototype.hasOwnProperty.call(e,i)}E("WeakMap",function(e){function i(g){if(this.g=(d+=Math.random()+1).toString(),g){g=y(g);for(var _;!(_=g.next()).done;)_=_.value,this.set(_[0],_[1])}}function r(){}function s(g){var _=typeof g;return _==="object"&&g!==null||_==="function"}function a(g){if(!jt(g,h)){var _=new r;w(g,h,{value:_})}}function l(g){var _=Object[g];_&&(Object[g]=function(x){return x instanceof r?x:(Object.isExtensible(x)&&a(x),_(x))})}if(function(){if(!e||!Object.seal)return!1;try{var g=Object.seal({}),_=Object.seal({}),x=new e([[g,2],[_,3]]);return x.get(g)!=2||x.get(_)!=3?!1:(x.delete(g),x.set(_,4),!x.has(g)&&x.get(_)==4)}catch(T){return!1}}())return e;var h="$jscomp_hidden_"+Math.random();l("freeze"),l("preventExtensions"),l("seal");var d=0;return i.prototype.set=function(g,_){if(!s(g))throw Error("Invalid WeakMap key");if(a(g),!jt(g,h))throw Error("WeakMap key fail: "+g);return g[h][this.g]=_,this},i.prototype.get=function(g){return s(g)&&jt(g,h)?g[h][this.g]:void 0},i.prototype.has=function(g){return s(g)&&jt(g,h)&&jt(g[h],this.g)},i.prototype.delete=function(g){return s(g)&&jt(g,h)&&jt(g[h],this.g)?delete g[h][this.g]:!1},i}),E("Map",function(e){function i(){var d={};return d.Qa=d.next=d.head=d}function r(d,g){var _=d.g;return R(function(){if(_){for(;_.head!=d.g;)_=_.Qa;for(;_.next!=_.head;)return _=_.next,{done:!1,value:g(_)};_=null}return{done:!0,value:void 0}})}function s(d,g){var _=g&&typeof g;_=="object"||_=="function"?l.has(g)?_=l.get(g):(_=""+ ++h,l.set(g,_)):_="p_"+g;var x=d.h[_];if(x&&jt(d.h,_))for(d=0;d<x.length;d++){var T=x[d];if(g!==g&&T.key!==T.key||g===T.key)return{id:_,list:x,index:d,ga:T}}return{id:_,list:x,index:-1,ga:void 0}}function a(d){if(this.h={},this.g=i(),this.size=0,d){d=y(d);for(var g;!(g=d.next()).done;)g=g.value,this.set(g[0],g[1])}}if(function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var d=Object.seal({x:4}),g=new e(y([[d,"s"]]));if(g.get(d)!="s"||g.size!=1||g.get({x:4})||g.set({x:4},"t")!=g||g.size!=2)return!1;var _=g.entries(),x=_.next();return x.done||x.value[0]!=d||x.value[1]!="s"?!1:(x=_.next(),!(x.done||x.value[0].x!=4||x.value[1]!="t"||!_.next().done))}catch(T){return!1}}())return e;var l=new WeakMap;a.prototype.set=function(d,g){d=d===0?0:d;var _=s(this,d);return _.list||(_.list=this.h[_.id]=[]),_.ga?_.ga.value=g:(_.ga={next:this.g,Qa:this.g.Qa,head:this.g,key:d,value:g},_.list.push(_.ga),this.g.Qa.next=_.ga,this.g.Qa=_.ga,this.size++),this},a.prototype.delete=function(d){return d=s(this,d),d.ga&&d.list?(d.list.splice(d.index,1),d.list.length||delete this.h[d.id],d.ga.Qa.next=d.ga.next,d.ga.next.Qa=d.ga.Qa,d.ga.head=null,this.size--,!0):!1},a.prototype.clear=function(){this.h={},this.g=this.g.Qa=i(),this.size=0},a.prototype.has=function(d){return!!s(this,d).ga},a.prototype.get=function(d){return(d=s(this,d).ga)&&d.value},a.prototype.entries=function(){return r(this,function(d){return[d.key,d.value]})},a.prototype.keys=function(){return r(this,function(d){return d.key})},a.prototype.values=function(){return r(this,function(d){return d.value})},a.prototype.forEach=function(d,g){for(var _=this.entries(),x;!(x=_.next()).done;)x=x.value,d.call(g,x[1],x[0],this)},a.prototype[Symbol.iterator]=a.prototype.entries;var h=0;return a}),E("Set",function(e){function i(r){if(this.g=new Map,r){r=y(r);for(var s;!(s=r.next()).done;)this.add(s.value)}this.size=this.g.size}return function(){if(!e||typeof e!="function"||!e.prototype.entries||typeof Object.seal!="function")return!1;try{var r=Object.seal({x:4}),s=new e(y([r]));if(!s.has(r)||s.size!=1||s.add(r)!=s||s.size!=1||s.add({x:4})!=s||s.size!=2)return!1;var a=s.entries(),l=a.next();return l.done||l.value[0]!=r||l.value[1]!=r?!1:(l=a.next(),l.done||l.value[0]==r||l.value[0].x!=4||l.value[1]!=l.value[0]?!1:a.next().done)}catch(h){return!1}}()?e:(i.prototype.add=function(r){return r=r===0?0:r,this.g.set(r,r),this.size=this.g.size,this},i.prototype.delete=function(r){return r=this.g.delete(r),this.size=this.g.size,r},i.prototype.clear=function(){this.g.clear(),this.size=0},i.prototype.has=function(r){return this.g.has(r)},i.prototype.entries=function(){return this.g.entries()},i.prototype.values=function(){return this.g.values()},i.prototype.keys=i.prototype.values,i.prototype[Symbol.iterator]=i.prototype.values,i.prototype.forEach=function(r,s){var a=this;this.g.forEach(function(l){return r.call(s,l,l,a)})},i)});function Dn(e,i,r){e instanceof String&&(e=String(e));for(var s=e.length,a=0;a<s;a++){var l=e[a];if(i.call(r,l,a,e))return{Je:a,v:l}}return{Je:-1,v:void 0}}E("Array.prototype.findIndex",function(e){return e||function(i,r){return Dn(this,i,r).Je}}),E("Object.is",function(e){return e||function(i,r){return i===r?i!==0||1/i===1/r:i!==i&&r!==r}}),E("Array.prototype.includes",function(e){return e||function(i,r){var s=this;s instanceof String&&(s=String(s));var a=s.length;for(r=r||0,0>r&&(r=Math.max(r+a,0));r<a;r++){var l=s[r];if(l===i||Object.is(l,i))return!0}return!1}});function Fn(e,i,r){if(e==null)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(i instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""}E("String.prototype.includes",function(e){return e||function(i,r){return Fn(this,i,"includes").indexOf(i,r||0)!==-1}}),E("Array.prototype.find",function(e){return e||function(i,r){return Dn(this,i,r).v}}),E("String.prototype.startsWith",function(e){return e||function(i,r){var s=Fn(this,i,"startsWith"),a=s.length,l=i.length;r=Math.max(0,Math.min(r|0,s.length));for(var h=0;h<l&&r<a;)if(s[r++]!=i[h++])return!1;return h>=l}});function Nn(e,i){e instanceof String&&(e+="");var r=0,s=!1,a={next:function(){if(!s&&r<e.length){var l=r++;return{value:i(l,e[l]),done:!1}}return s=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}E("Array.prototype.keys",function(e){return e||function(){return Nn(this,function(i){return i})}});var na=typeof Object.assign=="function"?Object.assign:function(e,i){for(var r=1;r<arguments.length;r++){var s=arguments[r];if(s)for(var a in s)jt(s,a)&&(e[a]=s[a])}return e};E("Object.assign",function(e){return e||na}),E("Array.from",function(e){return e||function(i,r,s){r=r!=null?r:function(d){return d};var a=[],l=typeof Symbol<"u"&&Symbol.iterator&&i[Symbol.iterator];if(typeof l=="function"){i=l.call(i);for(var h=0;!(l=i.next()).done;)a.push(r.call(s,l.value,h++))}else for(l=i.length,h=0;h<l;h++)a.push(r.call(s,i[h],h));return a}}),E("Array.prototype.values",function(e){return e||function(){return Nn(this,function(i,r){return r})}}),E("Promise.prototype.finally",function(e){return e||function(i){return this.then(function(r){return Promise.resolve(i()).then(function(){return r})},function(r){return Promise.resolve(i()).then(function(){throw r})})}}),E("Array.prototype.entries",function(e){return e||function(){return Nn(this,function(i,r){return[i,r]})}}),E("String.prototype.repeat",function(e){return e||function(i){var r=Fn(this,null,"repeat");if(0>i||1342177279<i)throw new RangeError("Invalid count value");i|=0;for(var s="";i;)i&1&&(s+=r),(i>>>=1)&&(r+=r);return s}}),E("Number.isNaN",function(e){return e||function(i){return typeof i=="number"&&isNaN(i)}}),E("Object.values",function(e){return e||function(i){var r=[],s;for(s in i)jt(i,s)&&r.push(i[s]);return r}}),E("Math.log2",function(e){return e||function(i){return Math.log(i)/Math.LN2}}),E("Math.trunc",function(e){return e||function(i){if(i=Number(i),isNaN(i)||i===1/0||i===-1/0||i===0)return i;var r=Math.floor(Math.abs(i));return 0>i?-r:r}}),E("Object.entries",function(e){return e||function(i){var r=[],s;for(s in i)jt(i,s)&&r.push([s,i[s]]);return r}});var Du=this||self;function ie(e,i){e=e.split(".");var r=Du;e[0]in r||typeof r.execScript>"u"||r.execScript("var "+e[0]);for(var s;e.length&&(s=e.shift());)e.length||i===void 0?r[s]&&r[s]!==Object.prototype[s]?r=r[s]:r=r[s]={}:r[s]=i}function Gr(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}Gr.prototype.sample=function(e,i){var r=Math.pow(this.g,e);i=i*(1-r)+r*this.h,isNaN(i)||(this.h=i,this.i+=e)};function rr(e){return e.h/(1-Math.pow(e.g,e.i))}function Xr(){this.h=new Gr(2),this.j=new Gr(5),this.g=0,this.i=128e3,this.l=16e3}Xr.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},Xr.prototype.sample=function(e,i){if(!(i<this.l)){var r=8e3*i/e;e/=1e3,this.g+=i,this.h.sample(e,r),this.j.sample(e,r)}},Xr.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(rr(this.h),rr(this.j))};function Ls(){}function Kt(){}function Ve(){}function nr(e){var i=Vt.apply(1,arguments);$r.has(e)||($r.add(e),Ve.apply(Ls,I(i)))}function sa(){}function Fu(){}function li(){}function qr(){}var $r=new Set;if(u.console&&u.console.log.bind){var be={},We=(be[1]=console.error.bind(console),be[2]=console.warn.bind(console),be[3]=console.info.bind(console),be[4]=console.log.bind(console),be[5]=console.debug.bind(console),be[6]=console.debug.bind(console),be);Ve=We[2],Kt=We[1]}function ce(e){if($e.has(e))return $e.get(e);var i=MediaSource.isTypeSupported(e);return $e.set(e,i),i}var $e=new Map;function bi(e,i){return typeof e=="number"&&typeof i=="number"&&isNaN(e)&&isNaN(i)?!0:e===i}function gt(e,i){i=e.indexOf(i),-1<i&&e.splice(i,1)}function Ue(e,i,r){if(r||(r=bi),e.length!=i.length)return!1;i=i.slice();var s={};e=y(e);for(var a=e.next();!a.done;s={md:s.md},a=e.next()){if(s.md=a.value,a=i.findIndex(function(l){return function(h){return r(l.md,h)}}(s)),a==-1)return!1;i[a]=i[i.length-1],i.pop()}return i.length==0}function _e(e,i,r){if(r||(r=bi),e.length!=i.length)return!1;for(var s=0;s<e.length;s++)if(!r(e[s],i[s]))return!1;return!0}function Le(e,i,r){this.startTime=e,this.direction=Uu,this.endTime=i,this.payload=r,this.region=new zn,this.position=null,this.positionAlign=Ms,this.size=0,this.textAlign=sr,this.writingMode=ks,this.lineInterpretation=zu,this.line=null,this.lineHeight="",this.lineAlign=Yr,this.displayAlign=Ps,this.fontSize=this.textStrokeWidth=this.textStrokeColor=this.textShadow=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=Kf,this.fontStyle=ju,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.cellResolution={columns:32,rows:15}}Le.prototype.clone=function(){var e=new Le(0,0,""),i;for(i in this)e[i]=this[i],e[i]&&e[i].constructor==Array&&(e[i]=e[i].slice());return e};function Un(e,i){if(e.startTime!=i.startTime||e.endTime!=i.endTime||e.payload!=i.payload)return!1;for(var r in e)if(r!="startTime"&&r!="endTime"&&r!="payload"){if(r=="nestedCues"){if(!_e(e.nestedCues,i.nestedCues,Un))return!1}else if(r=="region"||r=="cellResolution"){for(var s in e[r])if(e[r][s]!=i[r][s])return!1}else if(Array.isArray(e[r])){if(!_e(e[r],i[r]))return!1}else if(e[r]!=i[r])return!1}return!0}ie("shaka.text.Cue",Le);var Ms="auto";Le.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Ms};var sr="center",Nu={LEFT:"left",RIGHT:"right",CENTER:sr,START:"start",END:"end"};Le.textAlign=Nu;var Ps="after",qf={BEFORE:"before",CENTER:"center",AFTER:Ps};Le.displayAlign=qf;var Uu="ltr";Le.direction={HORIZONTAL_LEFT_TO_RIGHT:Uu,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var ks="horizontal-tb";Le.writingMode={HORIZONTAL_TOP_TO_BOTTOM:ks,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var zu=0;Le.lineInterpretation={LINE_NUMBER:zu,PERCENTAGE:1};var Yr="start",Bu={CENTER:"center",START:Yr,END:"end"};Le.lineAlign=Bu;var $f={white:"#FFF",lime:"#0F0",cyan:"#0FF",red:"#F00",yellow:"#FF0",magenta:"#F0F",blue:"#00F",black:"#000"};Le.defaultTextColor=$f;var Yf={bg_white:"#FFF",bg_lime:"#0F0",bg_cyan:"#0FF",bg_red:"#F00",bg_yellow:"#FF0",bg_magenta:"#F0F",bg_blue:"#00F",bg_black:"#000"};Le.defaultTextBackgroundColor=Yf;var Kf=400;Le.fontWeight={NORMAL:Kf,BOLD:700};var ju="normal",Zf={NORMAL:ju,ITALIC:"italic",OBLIQUE:"oblique"};Le.fontStyle=Zf,Le.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};function zn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=ji,this.scroll=Qf}ie("shaka.text.CueRegion",zn);var ji=1;zn.units={PX:0,PERCENTAGE:ji,LINES:2};var Qf="";zn.scrollMode={NONE:Qf,UP:"up"};function Os(){}function Kr(e,i){if(!e&&!i)return!0;if(!e||!i||e.byteLength!=i.byteLength)return!1;if(Hu(e)==Hu(i)&&(e.byteOffset||0)==(i.byteOffset||0))return!0;var r=Ie(e);i=Ie(i);for(var s=0;s<e.byteLength;s++)if(r[s]!=i[s])return!1;return!0}function Hu(e){return e instanceof ArrayBuffer?e:e.buffer}function ui(e){return e instanceof ArrayBuffer?e:e.byteOffset==0&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function Ie(e,i,r){return r=r===void 0?1/0:r,Jf(e,i===void 0?0:i,r,Uint8Array)}function Wt(e,i,r){return r=r===void 0?1/0:r,Jf(e,i===void 0?0:i,r,DataView)}function Jf(e,i,r,s){var a=(e.byteOffset||0)+e.byteLength;return i=Math.max(0,Math.min((e.byteOffset||0)+i,a)),new s(Hu(e),i,Math.min(i+Math.max(r,0),a)-i)}ie("shaka.util.BufferUtils",Os),Os.toDataView=Wt,Os.toUint8=Ie,Os.toArrayBuffer=ui,Os.equal=Kr;function F(e,i,r){var s=Vt.apply(3,arguments);this.severity=e,this.category=i,this.code=r,this.data=s,this.handled=!1}F.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},ie("shaka.util.Error",F),F.Severity={RECOVERABLE:1,CRITICAL:2},F.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},F.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_SRC_EQUALS:2016,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,HLS_AES_128_INVALID_IV_LENGTH:4043,HLS_AES_128_INVALID_KEY_LENGTH:4044,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004};/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/var Tw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/function Zt(e){var i;e instanceof Zt?(oa(this,e.Ea),this.pb=e.pb,this.Ha=e.Ha,Vu(this,e.Kb),this.qa=e.qa,aa(this,e.g.clone()),this.fb=e.fb):e&&(i=String(e).match(Tw))?(oa(this,i[1]||"",!0),this.pb=Ds(i[2]||""),this.Ha=Ds(i[3]||"",!0),Vu(this,i[4]),this.qa=Ds(i[5]||"",!0),aa(this,i[6]||"",!0),this.fb=Ds(i[7]||"")):this.g=new Bn(null)}p=Zt.prototype,p.Ea="",p.pb="",p.Ha="",p.Kb=null,p.qa="",p.fb="",p.toString=function(){var e=[],i=this.Ea;if(i&&e.push(Fs(i,ep,!0),":"),i=this.Ha){e.push("//");var r=this.pb;r&&e.push(Fs(r,ep,!0),"@"),e.push(encodeURIComponent(i).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i=this.Kb,i!=null&&e.push(":",String(i))}return(i=this.qa)&&(this.Ha&&i.charAt(0)!="/"&&e.push("/"),e.push(Fs(i,i.charAt(0)=="/"?Aw:Cw,!0))),(i=this.g.toString())&&e.push("?",i),(i=this.fb)&&e.push("#",Fs(i,bw)),e.join("")},p.resolve=function(e){var i=this.clone();i.Ea==="data"&&(i=new Zt);var r=!!e.Ea;r?oa(i,e.Ea):r=!!e.pb,r?i.pb=e.pb:r=!!e.Ha,r?i.Ha=e.Ha:r=e.Kb!=null;var s=e.qa;if(r)Vu(i,e.Kb);else if(r=!!e.qa){if(s.charAt(0)!="/")if(this.Ha&&!this.qa)s="/"+s;else{var a=i.qa.lastIndexOf("/");a!=-1&&(s=i.qa.substr(0,a+1)+s)}if(s==".."||s==".")s="";else if(s.indexOf("./")!=-1||s.indexOf("/.")!=-1){a=s.lastIndexOf("/",0)==0,s=s.split("/");for(var l=[],h=0;h<s.length;){var d=s[h++];d=="."?a&&h==s.length&&l.push(""):d==".."?((1<l.length||l.length==1&&l[0]!="")&&l.pop(),a&&h==s.length&&l.push("")):(l.push(d),a=!0)}s=l.join("/")}}return r?i.qa=s:r=e.g.toString()!=="",r?aa(i,e.g.clone()):r=!!e.fb,r&&(i.fb=e.fb),i},p.clone=function(){return new Zt(this)};function oa(e,i,r){e.Ea=r?Ds(i,!0):i,e.Ea&&(e.Ea=e.Ea.replace(/:$/,""))}function Vu(e,i){if(i){if(i=Number(i),isNaN(i)||0>i)throw Error("Bad port number "+i);e.Kb=i}else e.Kb=null}function aa(e,i,r){i instanceof Bn?e.g=i:(r||(i=Fs(i,Ew)),e.g=new Bn(i))}function Ds(e,i){return e?i?decodeURI(e):decodeURIComponent(e):""}function Fs(e,i,r){return e!=null?(e=encodeURI(e).replace(i,Sw),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Sw(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var ep=/[#\/\?@]/g,Cw=/[#\?:]/g,Aw=/[#\?]/g,Ew=/[#\?@]/g,bw=/#/g;function Bn(e){this.g=e||null}function tp(e){if(!e.la&&(e.la={},e.Oc=0,e.g))for(var i=e.g.split("&"),r=0;r<i.length;r++){var s=i[r].indexOf("="),a=null;if(0<=s){var l=i[r].substring(0,s);a=i[r].substring(s+1)}else l=i[r];l=decodeURIComponent(l.replace(/\+/g," ")),a=a||"",e.add(l,decodeURIComponent(a.replace(/\+/g," ")))}}p=Bn.prototype,p.la=null,p.Oc=null,p.add=function(e,i){tp(this),this.g=null;var r=this.la.hasOwnProperty(e)?this.la[e]:null;return r||(this.la[e]=r=[]),r.push(i),this.Oc++,this},p.set=function(e,i){return tp(this),this.g=null,this.la.hasOwnProperty(e)?this.la[e]=[i]:this.add(e,i),this},p.toString=function(){if(this.g)return this.g;if(!this.la)return"";var e=[],i;for(i in this.la)for(var r=encodeURIComponent(i),s=this.la[i],a=0;a<s.length;a++){var l=r;s[a]!==""&&(l+="="+encodeURIComponent(s[a])),e.push(l)}return this.g=e.join("&")},p.clone=function(){var e=new Bn;if(e.g=this.g,this.la){var i={},r;for(r in this.la)i[r]=this.la[r].concat();e.la=i,e.Oc=this.Oc}return e};function Wu(e,i){return e.concat(i)}function Iw(){}function Rr(e){return e!=null}function Gt(e,i){if(i.length==0)return e;var r=i.map(function(s){return new Zt(s)});return e.map(function(s){return new Zt(s)}).map(function(s){return r.map(function(a){return s.resolve(a)})}).reduce(Wu,[]).map(function(s){return s.toString()})}function Zr(e,i){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:i||[],keyIds:new Set}}function Ns(e,i){if(i.length==1)return i[0];if(e=jn(e,i),e!=null)return e;throw new F(2,4,4025,i)}function jn(e,i){for(var r=y(Rw[e]),s=r.next();!s.done;s=r.next()){s=s.value;for(var a=y(i),l=a.next();!l.done;l=a.next())if(l=l.value,s.test(l.trim()))return l.trim()}return e==ze?"":null}var ze="text",Mt={va:"video",Hc:"audio",X:ze,Wb:"image",Gg:"application"},Rw={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cx]$/,/^[du]dts$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av01/,/^dvhe/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Ke(){var e,i,r=new Promise(function(s,a){e=s,i=a});return r.resolve=e,r.reject=i,r}Ke.prototype.resolve=function(){},Ke.prototype.reject=function(){};function Hn(e){this.h=e,this.g=void 0}Hn.prototype.value=function(){return this.g==null&&(this.g=this.h()),this.g};function Us(e){this.h=e,this.g=null}Us.prototype.N=function(e){var i=this;this.stop();var r=!0,s=null;return this.g=function(){u.clearTimeout(s),r=!1},s=u.setTimeout(function(){r&&i.h()},1e3*e),this},Us.prototype.stop=function(){this.g&&(this.g(),this.g=null)};function Ee(e){this.h=e,this.g=null}Ee.prototype.Mb=function(){return this.stop(),this.h(),this},Ee.prototype.N=function(e){var i=this;return this.stop(),this.g=new Us(function(){i.h()}).N(e),this},Ee.prototype.Ca=function(e){var i=this;return this.stop(),this.g=new Us(function(){i.g.N(e),i.h()}).N(e),this},Ee.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},ie("shaka.util.Timer",Ee),Ee.prototype.stop=Ee.prototype.stop,Ee.prototype.tickEvery=Ee.prototype.Ca,Ee.prototype.tickAfter=Ee.prototype.N,Ee.prototype.tickNow=Ee.prototype.Mb;function Ii(){return!!(u.MediaSource&&MediaSource.isTypeSupported)}function Vn(e){return rp().canPlayType(e)!=""}function Gu(){return!!navigator.userAgent.match(/Edge?\//)}function zs(){return tt("Xbox One")}function Wn(){return tt("Tizen")}function ip(){return tt("Web0S")&&tt("Chrome/38.0.2125.122 Safari/537.36")}function la(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Wn()&&!tt("PC=EOS")&&!tt("VirginMedia")&&!Bs()&&!tt("AFT")}function Bs(){return tt("PlayStation 4")}function Xu(){if(!la())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function tt(e){return(navigator.userAgent||"").includes(e)}function rp(){return Gn||(qu||(qu=new Ee(function(){Gn=null})),(Gn=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Gn=document.createElement("video")),qu.N(1),Gn)}var qu=null,Gn=null;function Qr(){}function at(e){if(!e)return"";if(e=Ie(e),e[0]==239&&e[1]==187&&e[2]==191&&(e=e.subarray(3)),u.TextDecoder&&!Bs())return e=new TextDecoder().decode(e),e.includes("")&&Kt('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var i="",r=0;r<e.length;++r){var s=65533;if(e[r]&128?e.length>=r+2&&(e[r]&224)==192&&(e[r+1]&192)==128?(s=(e[r]&31)<<6|e[r+1]&63,r+=1):e.length>=r+3&&(e[r]&240)==224&&(e[r+1]&192)==128&&(e[r+2]&192)==128?(s=(e[r]&15)<<12|(e[r+1]&63)<<6|e[r+2]&63,r+=2):e.length>=r+4&&(e[r]&241)==240&&(e[r+1]&192)==128&&(e[r+2]&192)==128&&(e[r+3]&192)==128&&(s=(e[r]&7)<<18|(e[r+1]&63)<<12|(e[r+2]&63)<<6|e[r+3]&63,r+=3):s=e[r],65535>=s)i+=String.fromCharCode(s);else{s-=65536;var a=s&1023;i+=String.fromCharCode(55296+(s>>10)),i+=String.fromCharCode(56320+a)}}return i}function Lr(e,i,r){if(!e)return"";if(!r&&e.byteLength%2!=0)throw new F(2,2,2004);r=Math.floor(e.byteLength/2);var s=new Uint16Array(r);e=Wt(e);for(var a=0;a<r;a++)s[a]=e.getUint16(2*a,i);return Yu.value()(s)}function Jr(e){function i(s){return r.byteLength<=s||32<=r[s]&&126>=r[s]}if(!e)return"";var r=Ie(e);if(r[0]==239&&r[1]==187&&r[2]==191)return at(r);if(r[0]==254&&r[1]==255)return Lr(r.subarray(2),!1);if(r[0]==255&&r[1]==254)return Lr(r.subarray(2),!0);if(r[0]==0&&r[2]==0)return Lr(e,!1);if(r[1]==0&&r[3]==0)return Lr(e,!0);if(i(0)&&i(1)&&i(2)&&i(3))return at(e);throw new F(2,2,2003)}function Mr(e){if(u.TextEncoder&&!Bs()){var i=new TextEncoder;return ui(i.encode(e))}e=encodeURIComponent(e),e=unescape(e),i=new Uint8Array(e.length);for(var r=0;r<e.length;r++)i[r]=e[r].charCodeAt(0);return ui(i)}function $u(e,i){for(var r=new ArrayBuffer(2*e.length),s=new DataView(r),a=0;a<e.length;++a)s.setUint16(2*a,e.charCodeAt(a),i);return r}ie("shaka.util.StringUtils",Qr),Qr.resetFromCharCode=function(){Yu.g=void 0},Qr.toUTF16=$u,Qr.toUTF8=Mr,Qr.fromBytesAutoDetect=Jr,Qr.fromUTF16=Lr,Qr.fromUTF8=at;var Yu=new Hn(function(){function e(r){try{var s=new Uint8Array(r);return 0<String.fromCharCode.apply(null,s).length}catch(a){return!1}}for(var i={Ua:65536};0<i.Ua;i={Ua:i.Ua},i.Ua/=2)if(e(i.Ua))return function(r){return function(s){for(var a="",l=0;l<s.length;l+=r.Ua)a+=String.fromCharCode.apply(null,s.subarray(l,l+r.Ua));return a}}(i);return null});function Pr(){}function np(e){return e=Ie(e),e=Yu.value()(e),btoa(e)}function en(e,i){return i=i==null?!0:i,e=np(e).replace(/\+/g,"-").replace(/\//g,"_"),i?e:e.replace(/[=]*$/,"")}function or(e){e=u.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var i=new Uint8Array(e.length),r=0;r<e.length;++r)i[r]=e.charCodeAt(r);return i}function js(e){for(var i=e.length/2,r=new Uint8Array(i),s=0;s<i;s++)r[s]=u.parseInt(e.substr(2*s,2),16);return r}function Hs(e){var i=Ie(e);e="",i=y(i);for(var r=i.next();!r.done;r=i.next())r=r.value,r=r.toString(16),r.length==1&&(r="0"+r),e+=r;return e}function Vs(){for(var e=Vt.apply(0,arguments),i=0,r=y(e),s=r.next();!s.done;s=r.next())i+=s.value.byteLength;for(i=new Uint8Array(i),r=0,e=y(e),s=e.next();!s.done;s=e.next())s=s.value,i.set(Ie(s),r),r+=s.byteLength;return i}ie("shaka.util.Uint8ArrayUtils",Pr),Pr.concat=Vs,Pr.toHex=Hs,Pr.fromHex=js,Pr.fromBase64=or,Pr.toBase64=en,Pr.toStandardBase64=np;function ua(){}ie("shaka.dependencies",ua),ua.has=function(e){return ha.has(e)},ua.add=function(e,i){if(!sp[e])throw Error(e+" is not supported");ha.set(e,function(){return i})};var sp={muxjs:"muxjs"};ua.Allowed=sp;var ha=new Map([["muxjs",function(){return u.muxjs}]]);function op(e){var i=this;this.o=e,this.m=ha.get("muxjs")(),this.h=this.g=null,this.l=[],this.i=[],this.j=!1,this.m&&(this.g=new this.m.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.g.on("data",function(r){i.i=r.captions,i.l.push(Vs(r.initSegment,r.data))}),this.g.on("done",function(){var r={data:Vs.apply(Pr,I(i.l)),captions:i.i};i.h.resolve(r),i.j=!1}))}op.prototype.destroy=function(){return this.g&&this.g.dispose(),this.g=null,Promise.resolve()};function Ku(e,i){var r=ap(e),s=e.toLowerCase().split(";")[0]=="audio/aac";return!ha.get("muxjs")()||!r&&!s?!1:s?ce('audio/mp4; codecs="mp4a.40.2"'):i?ce(ca(i,e)):(i=ca("audio",e),e=ca("video",e),ce(i)||ce(e))}function ap(e){return e.toLowerCase().split(";")[0].split("/")[1]=="mp2t"}function lp(e,i){return i.toLowerCase().split(";")[0]=="audio/aac"?'audio/mp4; codecs="mp4a.40.2"':ap(i)?ca(e,i):i}function ca(e,i){if(i=i.replace(/mp2t/i,"mp4"),e=="audio"&&(i=i.replace("video","audio")),e=/avc1\.(66|77|100)\.(\d+)/.exec(i)){var r="avc1.",s=e[1],a=Number(e[2]);r=(s=="66"?r+"4200":s=="77"?r+"4d00":r+"6400")+(a>>4).toString(16),r+=(a&15).toString(16),i=i.replace(e[0],r)}return i}function Lw(e,i){return e.j=!0,e.h=new Ke,e.l=[],e.i=[],i=Ie(i),e.g.push(i),e.g.flush(),e.j&&e.h.reject(new F(2,3,3018)),e.h}function up(){}function Hi(e,i){return i&&(e+='; codecs="'+i+'"'),e}function Xn(e,i,r){return i=Hi(e,i),Ku(i,r)?lp(r,i):e!="video/mp2t"&&r=="audio"?i.replace("video","audio"):i}function kr(e){var i=Ws(e);switch(e=i[0],i=i[1].toLowerCase(),!0){case(e==="mp4a"&&i==="69"):case(e==="mp4a"&&i==="6b"):return"mp3";case(e==="mp4a"&&i==="66"):case(e==="mp4a"&&i==="67"):case(e==="mp4a"&&i==="68"):case(e==="mp4a"&&i==="40.2"):case(e==="mp4a"&&i==="40.02"):case(e==="mp4a"&&i==="40.5"):case(e==="mp4a"&&i==="40.05"):case(e==="mp4a"&&i==="40.29"):case(e==="mp4a"&&i==="40.42"):return"aac";case(e==="mp4a"&&i==="a5"):return"ac-3";case(e==="mp4a"&&i==="a6"):return"ec-3";case(e==="mp4a"&&i==="b2"):return"dtsx";case(e==="mp4a"&&i==="a9"):return"dtsc";case e==="avc1":case e==="avc3":return"avc";case e==="hvc1":case e==="hev1":return"hevc";case e==="dvh1":case e==="dvhe":return"dovi"}return e}function hp(e){return e=e.split(/ *; */),e.shift(),(e=e.find(function(i){return i.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function Ws(e){e=e.split(".");var i=e[0];return e.shift(),[i,e.join(".")]}ie("shaka.util.MimeUtils",up),up.getFullType=Hi,new Map().set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function ar(e){this.j=null,this.i=e,this.u=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.B="",this.o=new Map}function da(e){return!!(wt[e]||e=="application/cea-608"||e=="application/cea-708")}ar.prototype.destroy=function(){return this.i=this.j=null,this.o.clear(),Promise.resolve()};function Mw(e,i,r,s){var a,l,h,d;return B(function(g){if(g.g==1)return b(g,Promise.resolve(),2);if(!e.j||!e.i)return g.return();if(r==null||s==null)return e.j.parseInit(Ie(i)),g.return();a=e.u?r:e.s,l={periodStart:e.s,segmentStart:r,segmentEnd:s,vttOffset:a},h=e.j.parseMedia(Ie(i),l),d=h.filter(function(_){return _.startTime>=e.l&&_.startTime<e.m}),e.i.append(d),e.g==null&&(e.g=Math.max(r,e.l)),e.h=Math.min(s,e.m),Q(g)})}ar.prototype.remove=function(e,i){var r=this;return B(function(s){if(s.g==1)return b(s,Promise.resolve(),2);!r.i||!r.i.remove(e,i)||r.g==null||i<=r.g||e>=r.h||(e<=r.g&&i>=r.h?r.g=r.h=null:e<=r.g&&i<r.h?r.g=i:e>r.g&&i>=r.h&&(r.h=e)),Q(s)})};function Pw(e,i,r){e.l=i,e.m=r}function cp(e,i,r){if(e.B=i,i=e.o.get(i))for(var s=y(i.keys()),a=s.next();!a.done;a=s.next())(a=i.get(a.value).filter(function(l){return l.endTime<=r}))&&e.i.append(a)}function kw(e){var i=[];e=y(e);for(var r=e.next();!r.done;r=e.next())r=r.value,i.push({stream:r.stream,cue:new Le(r.startTime,r.endTime,r.text)});return i}function dp(e,i,r){i.startTime+=r,i.endTime+=r,i=y(i.nestedCues);for(var s=i.next();!s.done;s=i.next())dp(e,s.value,r)}function fp(e,i,r,s,a){var l=r+" "+s,h=new Map;i=y(i);for(var d=i.next();!d.done;d=i.next()){var g=d.value;d=g.stream,g=g.cue,h.has(d)||h.set(d,new Map),h.get(d).has(l)||h.get(d).set(l,[]),dp(e,g,a),g.startTime>=e.l&&g.startTime<e.m&&(h.get(d).get(l).push(g),d==e.B&&e.i.append([g]))}for(a=y(h.keys()),l=a.next();!l.done;l=a.next())for(l=l.value,e.o.has(l)||e.o.set(l,new Map),i=y(h.get(l).keys()),d=i.next();!d.done;d=i.next())d=d.value,g=h.get(l).get(d),e.o.get(l).set(d,g);e.g=e.g==null?Math.max(r,e.l):Math.min(e.g,Math.max(r,e.l)),e.h=Math.max(e.h,Math.min(s,e.m))}ie("shaka.text.TextEngine",ar),ar.prototype.destroy=ar.prototype.destroy,ar.findParser=function(e){return wt[e]},ar.unregisterParser=function(e){delete wt[e]},ar.registerParser=function(e,i){wt[e]=i};var wt={};function hi(){}function fa(e,i){return e=De(e),i=De(i),e.split("-")[0]==i.split("-")[0]}function Gs(e,i){return e=De(e),i=De(i),e=e.split("-"),i=i.split("-"),e[0]==i[0]&&e.length==1&&i.length==2}function Zu(e,i){return e=De(e),i=De(i),e=e.split("-"),i=i.split("-"),e.length==2&&i.length==2&&e[0]==i[0]}function De(e){var i=e.split("-");return e=i[0]||"",i=i[1]||"",e=e.toLowerCase(),e=pp.get(e)||e,(i=i.toUpperCase())?e+"-"+i:e}function tn(e,i){return e=De(e),i=De(i),i==e?4:Gs(i,e)?3:Zu(i,e)?2:Gs(e,i)?1:0}function Qu(e){var i=e.indexOf("-");return e=0<=i?e.substring(0,i):e,e=e.toLowerCase(),e=pp.get(e)||e}function Ju(e){return e.language?De(e.language):e.audio&&e.audio.language?De(e.audio.language):e.video&&e.video.language?De(e.video.language):"und"}function pa(e,i){e=De(e);var r=new Set,s=y(i);for(i=s.next();!i.done;i=s.next())r.add(De(i.value));for(s=y(r),i=s.next();!i.done;i=s.next())if(i=i.value,i==e)return i;for(s=y(r),i=s.next();!i.done;i=s.next())if(i=i.value,Gs(i,e))return i;for(s=y(r),i=s.next();!i.done;i=s.next())if(i=i.value,Zu(i,e))return i;for(r=y(r),i=r.next();!i.done;i=r.next())if(i=i.value,Gs(e,i))return i;return null}ie("shaka.util.LanguageUtils",hi),hi.findClosestLocale=pa,hi.getLocaleForVariant=Ju,hi.getLocaleForText=function(e){return De(e.language||"und")},hi.getBase=Qu,hi.relatedness=tn,hi.areSiblings=function(e,i){var r=Qu(e),s=Qu(i);return e!=r&&i!=s&&r==s},hi.normalize=De,hi.isSiblingOf=Zu,hi.isParentOf=Gs,hi.areLanguageCompatible=fa,hi.areLocaleCompatible=function(e,i){return e=De(e),i=De(i),e==i};var pp=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function qn(){this.g={}}p=qn.prototype,p.push=function(e,i){this.g.hasOwnProperty(e)?this.g[e].push(i):this.g[e]=[i]},p.get=function(e){return(e=this.g[e])?e.slice():null},p.remove=function(e,i){e in this.g&&(this.g[e]=this.g[e].filter(function(r){return r!=i}),this.g[e].length==0&&delete this.g[e])},p.forEach=function(e){for(var i in this.g)e(i,this.g[i])},p.size=function(){return Object.keys(this.g).length},p.keys=function(){return Object.keys(this.g)};function gp(e,i,r,s,a){var l=e.variants;(i.length||r.length)&&(l=Fw(l,i,r)),l=Sp(l,s),i=Ow(l),i=Dw(i);var h=Nw(i,a);e.variants=e.variants.filter(function(d){return mp(d)==h})}function Ow(e){var i=new qn;e=y(e);for(var r=e.next();!r.done;r=e.next()){r=r.value;var s=mp(r);i.push(s,r)}return i}function Dw(e){var i=0,r=new Map,s=e.size();return e.forEach(function(a,l){l=y(l);for(var h=l.next();!h.done;h=l.next()){h=h.value;var d=h.video;if(d&&d.width&&d.height){d=d.width*d.height*(d.frameRate||1),r.has(d)||r.set(d,new qn);var g=r.get(d);g.push(a,h),g.size()===s&&(i=Math.max(i,d))}}}),i?r.get(i):e}function Fw(e,i,r){var s={};i=y(i);for(var a=i.next();!a.done;s={xd:s.xd},a=i.next())if(s.xd=a.value,a=e.filter(function(l){return function(h){return h.video&&h.video.codecs.startsWith(l.xd)}}(s)),a.length){e=a;break}for(s={},r=y(r),i=r.next();!i.done;s={jd:s.jd},i=r.next())if(s.jd=i.value,i=e.filter(function(l){return function(h){return h.audio&&h.audio.codecs.startsWith(l.jd)}}(s)),i.length){e=i;break}return e}function Nw(e,i){i=y(i);for(var r=i.next();!r.done;r=i.next())if(r=r.value,r==$w||r==Yw){if(e=Uw(e,r),e.size()==1)return e.keys()[0]}else if(r==Kw)break;return zw(e)}function Uw(e,i){var r=0,s=new qn;return e.forEach(function(a,l){for(var h=0,d=0,g=y(l),_=g.next();!_.done;_=g.next())_=_.value,_.decodingInfos.length&&(h+=_.decodingInfos[0][i]?1:0,d++);h/=d,h>r?(s.g={},s.push(a,l),r=h):h==r&&s.push(a,l)}),s}function zw(e){var i="",r=1/0;return e.forEach(function(s,a){var l=0,h=0;a=y(a);for(var d=a.next();!d.done;d=a.next())l+=d.value.bandwidth||0,++h;l/=h,l<r&&(i=s,r=l)}),i}function mp(e){var i="";e.video&&(i=kr(e.video.codecs));var r="";return e.audio&&(r=kr(e.audio.codecs)),i+"-"+r}function Bw(e,i,r){e.variants=e.variants.filter(function(s){return eh(s,i,r)})}function eh(e,i,r){function s(l,h,d){return l>=h&&l<=d}var a=e.video;if(e.disabledUntilTime!=0){if(e.disabledUntilTime>Date.now()/1e3)return!1;e.disabledUntilTime=0}return!(a&&a.width&&a.height&&(!s(a.width,i.minWidth,Math.min(i.maxWidth,r.width))||!s(a.height,i.minHeight,Math.min(i.maxHeight,r.height))||!s(a.width*a.height,i.minPixels,i.maxPixels))||e&&e.video&&e.video.frameRate&&!s(e.video.frameRate,i.minFrameRate,i.maxFrameRate)||!s(e.bandwidth,i.minBandwidth,i.maxBandwidth))}function th(e,i,r){var s=!1;e=y(e);for(var a=e.next();!a.done;a=e.next()){a=a.value;var l=a.allowedByApplication;a.allowedByApplication=eh(a,i,r),l!=a.allowedByApplication&&(s=!0)}return s}function jw(e,i){return B(function(r){return r.g==1?b(r,_p(i,0<i.offlineSessionIds.length),2):(xp(e,i),Vw(i),b(r,Ww(i),0))})}function _p(e,i){return B(function(r){if(r.g==1)return b(r,yp(e.variants,i,!1),2);e.variants=e.variants.filter(function(s){var a=s.video;if(a){var l=ga(a.codecs);if(a.codecs.includes(",")){var h=a.codecs.split(",");l=Ns("video",h),l=ga(l),h=Ns("audio",h),h=ih(h);var d=Xn(a.mimeType,h,"audio");if(!ce(d))return!1;l=[l,h].join()}if(h=Xn(a.mimeType,l,"video"),!ce(h))return!1;a.codecs=l}if(l=s.audio){if(h=ih(l.codecs),d=Xn(l.mimeType,h,"audio"),!ce(d))return!1;l.codecs=h}return zs()&&a&&(a.width&&1920<a.width||a.height&&1080<a.height)&&(a.codecs.includes("avc1.")||a.codecs.includes("avc3."))?(Ap(s),!1):((a=s.decodingInfos.some(function(g){return g.supported}))||(Ap(s),void 0),a)}),Q(r)})}function yp(e,i,r){var s,a,l,h,d,g,_,x,T,S;return B(function(A){if(e.some(function(M){return M.decodingInfos.length}))return A.return();for(s=navigator.mediaCapabilities,a=[],l=function(M,O){var P;return B(function(k){if(k.g==1)return fe(k,2),b(k,s.decodingInfo(O),4);if(k.g!=2)return P=k.h,M.decodingInfos.push(P),we(k,0);oe(k),JSON.stringify(O),Q(k)})},h=y(e),d=h.next();!d.done;d=h.next())for(g=d.value,_=Hw(g,i,r),x=y(_),T=x.next();!T.done;T=x.next())S=T.value,a.push(l(g,S));return b(A,Promise.all(a),0)})}function Hw(e,i,r){var s=e.audio,a=e.video;if(r={type:r?"file":"media-source"},a){var l=a.codecs;if(a.codecs.includes(",")){var h=a.codecs.split(",");l=Ns("video",h),l=ga(l),h=Ns("audio",h),h=Xn(a.mimeType,h,"audio"),r.audio={contentType:h,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}if(l=ga(l),l=Xn(a.mimeType,l,"video"),r.video={contentType:l,width:a.width||64,height:a.height||64,bitrate:a.bandwidth||e.bandwidth||1,framerate:a.frameRate||1},a.hdr)switch(a.hdr){case"SDR":r.video.transferFunction="srgb";break;case"PQ":r.video.transferFunction="pq";break;case"HLG":r.video.transferFunction="hlg"}}if(s&&(l=ih(s.codecs),l=Xn(s.mimeType,l,"audio"),r.audio={contentType:l,channels:s.channelsCount||2,bitrate:s.bandwidth||e.bandwidth||1,samplerate:s.audioSamplingRate||1,spatialRendering:s.spatialAudio}),h=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]),!h.length)return[r];e=[],l=new Map,h=y(h);for(var d=h.next();!d.done;d=h.next()){var g=d.value;l.get(g.keySystem)||l.set(g.keySystem,[]),l.get(g.keySystem).push(g)}h=i?"required":"optional",i=i?["persistent-license"]:["temporary"],g=y(l.keys());for(var _=g.next();!_.done;_=g.next()){var x=_.value;_=Object.assign({},r);var T=l.get(x);for(x={keySystem:x,initDataType:"cenc",persistentState:h,distinctiveIdentifier:"optional",sessionTypes:i},T=y(T),d=T.next();!d.done;d=T.next()){if(d=d.value,d.initData&&d.initData.length){for(var S=new Set,A=y(d.initData),M=A.next();!M.done;M=A.next())S.add(M.value.initDataType);x.initDataType=d.initData[0].initDataType}d.distinctiveIdentifierRequired&&(x.distinctiveIdentifier="required"),d.persistentStateRequired&&(x.persistentState="required"),d.sessionType&&(x.sessionTypes=[d.sessionType]),s&&(d.audioRobustness!=""?x.audio?x.audio.robustness=x.audio.robustness||d.audioRobustness:x.audio={robustness:d.audioRobustness}:x.audio||(x.audio={})),a&&(d.videoRobustness!=""?x.video?x.video.robustness=x.video.robustness||d.videoRobustness:x.video={robustness:d.videoRobustness}:x.video||(x.video={}))}_.keySystemConfiguration=x,e.push(_)}return e}function ih(e){return Wn()&&e.toLowerCase()=="ac-3"?"ec-3":e}function ga(e){if(e.includes("avc1")){var i=e.split(".");if(i.length==3)return e=i.shift()+".",e+=parseInt(i.shift(),10).toString(16),e+=("000"+parseInt(i.shift(),10).toString(16)).slice(-4)}else if(e=="vp9")return"vp09.00.41.08";return e}function xp(e,i){i.variants=i.variants.filter(function(r){var s=r.audio;return r=r.video,!(s&&e&&e.audio&&!vp(s,e.audio)||r&&e&&e.video&&!vp(r,e.video))})}function Vw(e){e.textStreams=e.textStreams.filter(function(i){return da(Hi(i.mimeType,i.codecs))})}function Ww(e){var i,r,s,a,l,h,d;return B(function(g){switch(g.g){case 1:i=[],r=y(e.imageStreams),s=r.next();case 2:if(s.done){g.A(4);break}if(a=s.value,l=a.mimeType,ya.has(l)){g.A(5);break}if(h=Zw.get(l),!h){ya.set(l,!1),g.A(5);break}return b(g,Gw(h),7);case 7:d=g.h,ya.set(l,d);case 5:ya.get(l)&&i.push(a),s=r.next(),g.A(2);break;case 4:e.imageStreams=i,Q(g)}})}function Gw(e){return new Promise(function(i){var r=new Image;r.src=e,"decode"in r?r.decode().then(function(){i(!0)}).catch(function(){i(!1)}):r.onload=r.onerror=function(){i(r.height===2)}})}function vp(e,i){return!(e.mimeType!=i.mimeType||e.codecs.split(".")[0]!=i.codecs.split(".")[0])}function rn(e){var i=e.audio,r=e.video,s=i?i.mimeType:null,a=r?r.mimeType:null,l=i?i.codecs:null,h=r?r.codecs:null,d=[];h&&d.push(h),l&&d.push(l);var g=[];r&&g.push(r.mimeType),i&&g.push(i.mimeType),g=g[0]||null;var _=[];i&&_.push(i.kind),r&&_.push(r.kind),_=_[0]||null;var x=new Set;if(i)for(var T=y(i.roles),S=T.next();!S.done;S=T.next())x.add(S.value);if(r)for(T=y(r.roles),S=T.next();!S.done;S=T.next())x.add(S.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:_,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:g,audioMimeType:s,videoMimeType:a,codecs:d.join(", "),audioCodec:l,videoCodec:h,primary:e.primary,roles:Array.from(x),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null},r&&(e.videoId=r.id,e.originalVideoId=r.originalId,e.width=r.width||null,e.height=r.height||null,e.frameRate=r.frameRate||null,e.pixelAspectRatio=r.pixelAspectRatio||null,e.videoBandwidth=r.bandwidth||null),i&&(e.audioId=i.id,e.originalAudioId=i.originalId,e.channelsCount=i.channelsCount,e.audioSamplingRate=i.audioSamplingRate,e.audioBandwidth=i.bandwidth||null,e.spatialAudio=i.spatialAudio,e.label=i.label,e.audioRoles=i.roles),e}function ma(e){return{id:e.id,active:!1,type:ze,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null}}function rh(e){var i=e.width||null,r=e.height||null,s=null;e.segmentIndex&&(s=e.segmentIndex.get(0));var a=e.tilesLayout;return s&&(a=s.tilesLayout||a),a&&i!=null&&(i/=Number(a.split("x")[0])),a&&r!=null&&(r/=Number(a.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:i,height:r,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:a||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId}}function nh(e){return e.__shaka_id||(e.__shaka_id=qw++),e.__shaka_id}function wp(e){var i=Tp(e);return i.active=e.mode!="disabled",i.type="text",i.originalTextId=e.id,e.kind=="captions"&&(i.mimeType="application/cea-608"),e.kind&&(i.roles=[e.kind]),e.kind=="forced"&&(i.forced=!0),i}function _a(e){var i=Tp(e);return i.active=e.enabled,i.type="variant",i.originalAudioId=e.id,e.kind=="main"&&(i.primary=!0),e.kind&&(i.roles=[e.kind],i.audioRoles=[e.kind],i.label=e.label),i}function Tp(e){return{id:nh(e),active:!1,type:"",bandwidth:0,language:De(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null}}function Xs(e){return e.allowedByApplication&&e.allowedByKeySystem}function Xw(e){return e.filter(function(i){return Xs(i)})}function Sp(e,i){var r=e.filter(function(h){return h.audio&&h.audio.channelsCount}),s=new Map;r=y(r);for(var a=r.next();!a.done;a=r.next()){a=a.value;var l=a.audio.channelsCount;s.has(l)||s.set(l,[]),s.get(l).push(a)}return r=Array.from(s.keys()),r.length==0?e:(e=r.filter(function(h){return h<=i}),e.length?s.get(Math.max.apply(Math,I(e))):s.get(Math.min.apply(Math,I(r))))}function sh(e,i,r,s){var a=e,l=e.filter(function(g){return g.primary});l.length&&(a=l);var h=a.length?a[0].language:"";if(a=a.filter(function(g){return g.language==h}),i){var d=pa(De(i),e.map(function(g){return g.language}));d&&(a=e.filter(function(g){return De(g.language)==d}))}if(a=a.filter(function(g){return g.forced==s}),r){if(e=Cp(a,r),e.length)return e}else if(e=a.filter(function(g){return g.roles.length==0}),e.length)return e;return e=a.map(function(g){return g.roles}).reduce(Wu,[]),e.length?Cp(a,e[0]):a}function Cp(e,i){return e.filter(function(r){return r.roles.includes(i)})}function Ap(e){var i=[];return e.audio&&i.push(Ep(e.audio)),e.video&&i.push(Ep(e.video)),i.join(", ")}function Ep(e){return e.type=="audio"?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:e.type=="video"?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}var qw=0,$w="smooth",Yw="powerEfficient",Kw="bandwidth",ya=new Map().set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),Zw=new Map().set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function lt(){var e=this;this.l=null,this.o=!1,this.i=new Xr,navigator.connection&&navigator.connection.addEventListener("change",function(){if(e.g.useNetworkInformation&&e.o){e.i=new Xr,e.g&&e.i.configure(e.g.advanced);var i=e.chooseVariant();i&&e.l(i)}}),this.m=[],this.u=1,this.B=!1,this.h=this.j=this.g=this.s=null,this.D=new Ee(function(){if(e.g.restrictToElementSize){var i=e.chooseVariant();i&&e.l(i)}})}p=lt.prototype,p.stop=function(){this.l=null,this.o=!1,this.m=[],this.u=1,this.j=this.s=null,this.h&&(this.h.disconnect(),this.h=null),this.D.stop()},p.init=function(e){this.l=e},p.chooseVariant=function(){var e=1/0,i=1/0;this.g.restrictToScreenSize&&(i=this.g.ignoreDevicePixelRatio?1:u.devicePixelRatio,e=u.screen.height*i,i*=u.screen.width),this.h&&this.g.restrictToElementSize&&(i=this.g.ignoreDevicePixelRatio?1:u.devicePixelRatio,e=this.j.clientWidth*i,i*=this.j.clientHeight),e=bp(this.g.restrictions,this.m,e,i),i=this.i.getBandwidthEstimate(oh(this)),this.m.length&&!e.length&&(e=bp(null,this.m,1/0,1/0),e=[e[0]]);for(var r=e[0]||null,s=0;s<e.length;s++){for(var a=e[s],l=isNaN(this.u)?1:Math.abs(this.u),h=l*a.bandwidth/this.g.bandwidthDowngradeTarget,d={bandwidth:1/0},g=s+1;g<e.length;g++)if(a.bandwidth!=e[g].bandwidth){d=e[g];break}l=l*d.bandwidth/this.g.bandwidthUpgradeTarget,i>=h&&i<=l&&r.bandwidth!=a.bandwidth&&(r=a)}return this.s=Date.now(),r},p.enable=function(){this.o=!0},p.disable=function(){this.o=!1},p.segmentDownloaded=function(e,i){if(this.i.sample(e,i),this.s!=null&&this.o)e:{if(this.B){if(Date.now()-this.s<1e3*this.g.switchInterval)break e}else{if(e=this.i,!(e.g>=e.i))break e;this.B=!0}e=this.chooseVariant(),this.i.getBandwidthEstimate(oh(this)),e&&this.l(e)}},p.getBandwidthEstimate=function(){return this.i.getBandwidthEstimate(oh(this))},p.setVariants=function(e){this.m=e},p.playbackRateChanged=function(e){this.u=e},p.setMediaElement=function(e){var i=this;this.j=e,this.h&&(this.h.disconnect(),this.h=null),this.j&&"ResizeObserver"in u&&(this.h=new ResizeObserver(function(){i.D.N(Qw)}),this.h.observe(this.j))},p.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)};function oh(e){var i=e.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&e.g.useNetworkInformation&&(i=1e6*navigator.connection.downlink),i}function bp(e,i,r,s){return e&&(i=i.filter(function(a){return eh(a,e,{width:s,height:r})})),i.sort(function(a,l){return a.bandwidth-l.bandwidth})}ie("shaka.abr.SimpleAbrManager",lt),lt.prototype.configure=lt.prototype.configure,lt.prototype.setMediaElement=lt.prototype.setMediaElement,lt.prototype.playbackRateChanged=lt.prototype.playbackRateChanged,lt.prototype.setVariants=lt.prototype.setVariants,lt.prototype.getBandwidthEstimate=lt.prototype.getBandwidthEstimate,lt.prototype.segmentDownloaded=lt.prototype.segmentDownloaded,lt.prototype.disable=lt.prototype.disable,lt.prototype.enable=lt.prototype.enable,lt.prototype.chooseVariant=lt.prototype.chooseVariant,lt.prototype.init=lt.prototype.init,lt.prototype.stop=lt.prototype.stop;var Qw=1;function ah(e,i){this.g=e,this.h=i}ah.prototype.toString=function(){return"v"+this.g+"."+this.h};function Ip(e,i){var r=new ah(5,0),s=Rp,a=s.g,l=r.h-a.h;(0<(r.g-a.g||l)?s.i:s.h)(s.g,r,e,i)}function Jw(e,i,r,s){Ve([r,"has been deprecated and will be removed in",i,". We are currently at version",e,". Additional information:",s].join(" "))}function eT(e,i,r,s){Kt([r,"has been deprecated and has been removed in",i,". We are now at version",e,". Additional information:",s].join(""))}var Rp=null;ie("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3});function xa(e,i){for(this.h=e,this.g=new Set([e]),i=i||[],e=y(i),i=e.next();!i.done;i=e.next())this.add(i.value)}xa.prototype.add=function(e){return lh(this.h,e)?(this.g.add(e),!0):!1};function lh(e,i){var r;if(!(r=!!e.audio!=!!i.audio||!!e.video!=!!i.video||e.language!=i.language)&&(r=e.audio&&i.audio)){r=e.audio;var s=i.audio;r=!((!(!r.channelsCount||!s.channelsCount||2<r.channelsCount||2<s.channelsCount)||r.channelsCount==s.channelsCount)&&Lp(r,s)&&Mp(r.roles,s.roles))}return!r&&(r=e.video&&i.video)&&(e=e.video,i=i.video,r=!(Lp(e,i)&&Mp(e.roles,i.roles))),!r}xa.prototype.values=function(){return this.g.values()};function Lp(e,i){if(e.mimeType!=i.mimeType||(e=e.codecs.split(",").map(function(s){return Ws(s)[0]}),i=i.codecs.split(",").map(function(s){return Ws(s)[0]}),e.length!=i.length))return!1;e.sort(),i.sort();for(var r=0;r<e.length;r++)if(e[r]!=i[r])return!1;return!0}function Mp(e,i){if(e=new Set(e),i=new Set(i),e.delete("main"),i.delete("main"),e.size!=i.size)return!1;e=y(e);for(var r=e.next();!r.done;r=e.next())if(!i.has(r.value))return!1;return!0}function Pp(e){this.g=e,this.h=new $n(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}Pp.prototype.create=function(e){var i=this,r=e.filter(function(s){return lh(i.g,s)});return r.length?new xa(r[0],r):this.h.create(e)};function $n(e,i,r,s){this.i=e,this.j=i,this.g=r,this.h=s===void 0?"":s}$n.prototype.create=function(e){var i=[];i=tT(e,this.i);var r=e.filter(function(s){return s.primary});for(i=i.length?i:r.length?r:e,e=iT(i,this.j),e.length&&(i=e),this.g&&(e=Sp(i,this.g),e.length&&(i=e)),this.h&&(e=rT(i,this.h),e.length&&(i=e)),e=new xa(i[0]),i=y(i),r=i.next();!r.done;r=i.next())r=r.value,lh(e.h,r)&&e.add(r);return e};function tT(e,i){i=De(i);var r=pa(i,e.map(function(s){return Ju(s)}));return r?e.filter(function(s){return r==Ju(s)}):[]}function iT(e,i){return e.filter(function(r){return r.audio?i?r.audio.roles.includes(i):r.audio.roles.length==0:!1})}function rT(e,i){return e.filter(function(r){return r.audio?r.audio.label.toLowerCase()==i.toLowerCase():!1})}function nT(){this.g=va,this.h=new Map().set(va,2).set(Yn,1)}function kp(e,i,r){e.h.set(va,r).set(Yn,i)}var Yn=0,va=1;function Op(e,i){var r=Kn();this.l=e.maxAttempts==null?r.maxAttempts:e.maxAttempts,this.j=e.baseDelay==null?r.baseDelay:e.baseDelay,this.o=e.fuzzFactor==null?r.fuzzFactor:e.fuzzFactor,this.m=e.backoffFactor==null?r.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=i===void 0?!1:i)&&(this.g=1)}function Dp(e){var i,r;return B(function(s){if(s.g==1){if(e.g>=e.l)if(e.i)e.g=1,e.h=e.j;else throw new F(2,7,1010);return i=e.g,e.g++,i==0?s.return():(r=e.h*(1+(2*Math.random()-1)*e.o),b(s,new Promise(function(a){new Ee(a).N(r/1e3)}),2))}e.h*=e.m,Q(s)})}function Kn(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}}function it(e,i){this.promise=e,this.i=i,this.g=!1}function nn(e){return new it(Promise.reject(e),function(){return Promise.resolve()})}function uh(){var e=Promise.reject(new F(2,7,7001));return e.catch(function(){}),new it(e,function(){return Promise.resolve()})}function Zn(e){return new it(Promise.resolve(e),function(){return Promise.resolve()})}function Vi(e){return new it(e,function(){return e.catch(function(){})})}it.prototype.abort=function(){return this.g=!0,this.i()};function Fp(e){return new it(Promise.all(e.map(function(i){return i.promise})),function(){return Promise.all(e.map(function(i){return i.abort()}))})}it.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},it.prototype.Y=function(e,i){function r(d){return function(g){if(a.g&&d)l.reject(h);else{var _=d?e:i;_?s=sT(_,g,l):(d?l.resolve:l.reject)(g)}}}function s(){return l.reject(h),a.abort()}var a=this,l=new Ke,h=new F(2,7,7001);return this.promise.then(r(!0),r(!1)),new it(l,function(){return s()})};function sT(e,i,r){try{var s=e(i);return s&&s.promise&&s.abort?(r.resolve(s.promise),function(){return s.abort()}):(r.resolve(s),function(){return Promise.resolve(s).then(function(){},function(){})})}catch(a){return r.reject(a),function(){return Promise.resolve()}}}ie("shaka.util.AbortableOperation",it),it.prototype.chain=it.prototype.Y,it.prototype.finally=it.prototype.finally,it.all=Fp,it.prototype.abort=it.prototype.abort,it.notAbortable=Vi,it.completed=Zn,it.aborted=uh,it.failed=nn;function ye(e,i){if(i)if(i instanceof Map)for(var r=y(i.keys()),s=r.next();!s.done;s=r.next())s=s.value,Object.defineProperty(this,s,{value:i.get(s),writable:!0,enumerable:!0});else for(r in i)Object.defineProperty(this,r,{value:i[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=u.performance&&u.performance.now?u.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Np(e){var i=new ye(e.type),r;for(r in e)Object.defineProperty(i,r,{value:e[r],writable:!0,enumerable:!0});return i}ye.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},ye.prototype.stopImmediatePropagation=function(){this.g=!0},ye.prototype.stopPropagation=function(){},ie("shaka.util.FakeEvent",ye);var wa={Ig:"abrstatuschanged",Jg:"adaptation",Kg:"buffering",Lg:"downloadfailed",Mg:"downloadheadersreceived",Ng:"drmsessionupdate",Pg:"emsg",ah:"prft",Error:"error",Qg:"expirationupdated",Rg:"gapjumped",Tg:"loaded",Ug:"loading",Wg:"manifestparsed",Xg:"mediaqualitychanged",Metadata:"metadata",Zg:"onstatechange",$g:"onstateidle",bh:"ratechange",eh:"segmentappended",fh:"sessiondata",gh:"stalldetected",hh:"streaming",ih:"textchanged",jh:"texttrackvisibility",kh:"timelineregionadded",lh:"timelineregionenter",mh:"timelineregionexit",nh:"trackschanged",ph:"unloading",qh:"variantchanged"};function Oe(){this.da=new qn,this.Wc=this}Oe.prototype.addEventListener=function(e,i){this.da&&this.da.push(e,i)},Oe.prototype.removeEventListener=function(e,i){this.da&&this.da.remove(e,i)},Oe.prototype.dispatchEvent=function(e){if(!this.da)return!0;var i=this.da.get(e.type)||[],r=this.da.get("All");for(r&&(i=i.concat(r)),i=y(i),r=i.next();!r.done;r=i.next()){r=r.value,e.target=this.Wc,e.currentTarget=this.Wc;try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(s){}if(e.g)break}return e.defaultPrevented},Oe.prototype.release=function(){this.da=null};function Qn(e){function i(s){switch(typeof s){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return s;default:if(!s||s.buffer&&s.buffer.constructor==ArrayBuffer)return s;if(r.has(s))return null;var a=s.constructor==Array;if(s.constructor!=Object&&!a)return null;r.add(s);var l=a?[]:{},h;for(h in s)l[h]=i(s[h]);return a&&(l.length=s.length),l}}var r=new Set;return i(e)}function Up(e){var i={},r;for(r in e)i[r]=e[r];return i}function Ta(){this.g=[]}function Jn(e,i){e.g.push(i.finally(function(){gt(e.g,i)}))}Ta.prototype.destroy=function(){for(var e=[],i=y(this.g),r=i.next();!r.done;r=i.next())r=r.value,r.promise.catch(function(){}),e.push(r.abort());return this.g=[],Promise.all(e)};function Ge(e,i,r){Oe.call(this),this.i=!1,this.m=new Ta,this.g=new Set,this.h=new Set,this.l=e||null,this.j=i||null,this.s=r||null,this.o=!1}he(Ge,Oe),p=Ge.prototype,p.je=function(e){this.o=e};function lr(e,i,r,s){r=r||jp;var a=Ca[e];(!a||r>=a.priority)&&(Ca[e]={priority:r,jg:i,kg:s===void 0?!1:s})}p.lg=function(e){this.g.add(e)},p.Bg=function(e){this.g.delete(e)},p.rf=function(){this.g.clear()},p.mg=function(e){this.h.add(e)},p.Cg=function(e){this.h.delete(e)},p.tf=function(){this.h.clear()};function ci(e,i,r){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:i,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:r===void 0?null:r}}p.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),Oe.prototype.release.call(this),this.m.destroy()},p.request=function(e,i){var r=this,s=new Bp;if(this.i){var a=Promise.reject(new F(2,7,7001));return a.catch(function(){}),new Sa(a,function(){return Promise.resolve()},s)}i.method=i.method||"GET",i.headers=i.headers||{},i.retryParameters=i.retryParameters?Qn(i.retryParameters):Kn(),i.uris=Qn(i.uris),a=oT(this,e,i);var l=a.Y(function(){return zp(r,e,i,new Op(i.retryParameters,!1),0,null,s)}),h=l.Y(function(T){return aT(r,e,T)}),d=Date.now(),g=0;a.promise.then(function(){g=Date.now()-d},function(){});var _=0;l.promise.then(function(){_=Date.now()},function(){});var x=h.Y(function(T){var S=Date.now()-_,A=T.response;return A.timeMs+=g,A.timeMs+=S,T.Yf||!r.l||A.fromCache||e!=Or||r.l(A.timeMs,A.data.byteLength),A},function(T){throw T&&(T.severity=2),T});return a=new Sa(x.promise,function(){return x.abort()},s),Jn(this.m,a),a};function oT(e,i,r){var s=Zn(void 0),a={};e=y(e.g);for(var l=e.next();!l.done;a={sd:a.sd},l=e.next())a.sd=l.value,s=s.Y(function(h){return function(){return r.body&&(r.body=ui(r.body)),h.sd(i,r)}}(a));return s.Y(void 0,function(h){throw h instanceof F&&h.code==7001?h:new F(2,1,1006,h)})}function zp(e,i,r,s,a,l,h){e.o&&(r.uris[a]=r.uris[a].replace("http://","https://"));var d=new Zt(r.uris[a]),g=d.Ea,_=!1;g||(g=location.protocol,g=g.slice(0,-1),oa(d,g),r.uris[a]=d.toString()),g=g.toLowerCase();var x=(g=Ca[g])?g.jg:null;if(!x)return nn(new F(2,1,1e3,d));var T=g.kg,S=null,A=null,M=!1,O=!1,P;return Vi(Dp(s)).Y(function(){if(e.i)return uh();P=Date.now();var k=x(r.uris[a],r,i,function(N,j,V){S&&S.stop(),A&&A.N(D/1e3),e.l&&i==Or&&(e.l(N,j),_=!0,h.g=V)},function(N){e.j&&e.j(N,r,i),O=!0});if(!T)return k;var z=r.retryParameters.connectionTimeout;z&&(S=new Ee(function(){M=!0,k.abort()}),S.N(z/1e3));var D=r.retryParameters.stallTimeout;return D&&(A=new Ee(function(){M=!0,k.abort()})),k}).Y(function(k){S&&S.stop(),A&&A.stop(),k.timeMs==null&&(k.timeMs=Date.now()-P);var z={response:k,Yf:_};return!O&&e.j&&e.j(k.headers,r,i),z},function(k){if(S&&S.stop(),A&&A.stop(),e.s){var z=null,D=0;k instanceof F&&(z=k,k.code==1001&&(D=k.data[1])),e.s(r,z,D,M)}if(e.i)return uh();if(M&&(k=new F(1,1,1003,r.uris[a],i)),k instanceof F){if(k.code==7001)throw k;if(k.code==1010)throw l;if(k.severity==1)return z=new Map().set("error",k),z=new ye("retry",z),e.dispatchEvent(z),a=(a+1)%r.uris.length,zp(e,i,r,s,a,k,h)}throw k})}function aT(e,i,r){var s=Zn(void 0),a={};e=y(e.h);for(var l=e.next();!l.done;a={td:a.td},l=e.next())a.td=l.value,s=s.Y(function(h){return function(){var d=r.response;return d.data&&(d.data=ui(d.data)),h.td(i,d)}}(a));return s.Y(function(){return r},function(h){var d=2;if(h instanceof F){if(h.code==7001)throw h;d=h.severity}throw new F(d,1,1007,h)})}ie("shaka.net.NetworkingEngine",Ge),Ge.prototype.request=Ge.prototype.request,Ge.prototype.destroy=Ge.prototype.destroy,Ge.makeRequest=ci,Ge.defaultRetryParameters=function(){return Kn()},Ge.prototype.clearAllResponseFilters=Ge.prototype.tf,Ge.prototype.unregisterResponseFilter=Ge.prototype.Cg,Ge.prototype.registerResponseFilter=Ge.prototype.mg,Ge.prototype.clearAllRequestFilters=Ge.prototype.rf,Ge.prototype.unregisterRequestFilter=Ge.prototype.Bg,Ge.prototype.registerRequestFilter=Ge.prototype.lg,Ge.unregisterScheme=function(e){delete Ca[e]},Ge.registerScheme=lr,Ge.prototype.setForceHTTPS=Ge.prototype.je;function Bp(){this.g=0}Ge.NumBytesRemainingClass=Bp;function Sa(e,i,r){it.call(this,e,i),this.h=r}he(Sa,it),Ge.PendingRequest=Sa;var Or=1;Ge.RequestType={MANIFEST:0,SEGMENT:Or,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6};var jp=3;Ge.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:jp};var Ca={};function sn(e){this.g=!1,this.h=new Ke,this.i=e}sn.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))};function Xe(e,i){if(e.g)throw i instanceof F&&i.code==7003?i:new F(2,7,7003,i)}function Ye(){this.g=new qn}p=Ye.prototype,p.release=function(){this.nb(),this.g=null},p.C=function(e,i,r,s){this.g&&(e=new Hp(e,i,r,s),this.g.push(i,e))},p.ma=function(e,i,r,s){function a(h){l.zc(e,i,a),r(h)}var l=this;this.C(e,i,a,s)},p.zc=function(e,i,r){if(this.g){var s=this.g.get(i)||[];s=y(s);for(var a=s.next();!a.done;a=s.next())a=a.value,a.target!=e||r!=a.listener&&r||(a.zc(),this.g.remove(i,a))}},p.nb=function(){if(this.g){var e=this.g,i=[],r;for(r in e.g)i.push.apply(i,I(e.g[r]));for(e=y(i),i=e.next();!i.done;i=e.next())i.value.zc();this.g.g={}}},ie("shaka.util.EventManager",Ye),Ye.prototype.removeAll=Ye.prototype.nb,Ye.prototype.unlisten=Ye.prototype.zc,Ye.prototype.listenOnce=Ye.prototype.ma,Ye.prototype.listen=Ye.prototype.C,Ye.prototype.release=Ye.prototype.release;function Hp(e,i,r,s){this.target=e,this.type=i,this.listener=r,this.g=lT(e,s),this.target.addEventListener(i,r,this.g)}Hp.prototype.zc=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};function lT(e,i){if(i==null)return!1;if(typeof i=="boolean")return i;var r=new Set(["passive","capture"]);return Object.keys(i).filter(function(s){return!r.has(s)}),uT(e)?i:i.capture||!1}function uT(e){var i=Vp;if(i==null){i=!1;try{var r={},s={get:function(){return i=!0,!1}};Object.defineProperty(r,"passive",s),Object.defineProperty(r,"capture",s),s=function(){},e.addEventListener("test",s,r),e.removeEventListener("test",s,r)}catch(a){i=!1}Vp=i}return i||!1}var Vp=void 0;function Wp(e,i){var r=[];e=y(e);for(var s=e.next();!s.done;s=e.next())r.push(i(s.value));return r}function hT(e,i){e=y(e);for(var r=e.next();!r.done;r=e.next())if(!i(r.value))return!1;return!0}function qs(e){for(var i=new Map,r=y(Object.keys(e)),s=r.next();!s.done;s=r.next())s=s.value,i.set(s,e[s]);return i}function hh(e){var i={};return e.forEach(function(r,s){i[s]=r}),i}function cT(e,i){if(e||i){if(e&&!i||i&&!e)return!1}else return!0;if(e.size!=i.size)return!1;e=y(e);for(var r=e.next();!r.done;r=e.next()){var s=y(r.value);if(r=s.next().value,s=s.next().value,!i.has(r)||(r=i.get(r),r!=s||r==null))return!1}return!0}function Be(e,i){this.S=Wt(e),this.h=i==Gp,this.g=0}p=Be.prototype,p.ha=function(){return this.g<this.S.byteLength},p.Z=function(){return this.g},p.Gf=function(){return this.S.byteLength},p.Ra=function(){try{var e=this.S.getUint8(this.g);return this.g+=1,e}catch(i){throw ur()}},p.$d=function(){try{var e=this.S.getUint16(this.g,this.h);return this.g+=2,e}catch(i){throw ur()}},p.K=function(){try{var e=this.S.getUint32(this.g,this.h);return this.g+=4,e}catch(i){throw ur()}},p.Pe=function(){try{var e=this.S.getInt32(this.g,this.h);return this.g+=4,e}catch(i){throw ur()}},p.$a=function(){try{if(this.h)var e=this.S.getUint32(this.g,!0),i=this.S.getUint32(this.g+4,!0);else i=this.S.getUint32(this.g,!1),e=this.S.getUint32(this.g+4,!1)}catch(r){throw ur()}if(2097151<i)throw new F(2,3,3001);return this.g+=8,i*Math.pow(2,32)+e},p.Za=function(e){if(this.g+e>this.S.byteLength)throw ur();var i=Ie(this.S,this.g,e);return this.g+=e,i},p.skip=function(e){if(this.g+e>this.S.byteLength)throw ur();this.g+=e},p.sg=function(e){if(this.g<e)throw ur();this.g-=e},p.seek=function(e){if(0>e||e>this.S.byteLength)throw ur();this.g=e},p.sc=function(){for(var e=this.g;this.ha()&&this.S.getUint8(this.g)!=0;)this.g+=1;return e=Ie(this.S,e,this.g-e),this.g+=1,at(e)};function ur(){return new F(2,3,3e3)}ie("shaka.util.DataViewReader",Be),Be.prototype.readTerminatedString=Be.prototype.sc,Be.prototype.seek=Be.prototype.seek,Be.prototype.rewind=Be.prototype.sg,Be.prototype.skip=Be.prototype.skip,Be.prototype.readBytes=Be.prototype.Za,Be.prototype.readUint64=Be.prototype.$a,Be.prototype.readInt32=Be.prototype.Pe,Be.prototype.readUint32=Be.prototype.K,Be.prototype.readUint16=Be.prototype.$d,Be.prototype.readUint8=Be.prototype.Ra,Be.prototype.getLength=Be.prototype.Gf,Be.prototype.getPosition=Be.prototype.Z,Be.prototype.hasMoreData=Be.prototype.ha;var Gp=1;Be.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:Gp};function qe(){this.i=[],this.h=[],this.g=!1}p=qe.prototype,p.box=function(e,i){return e=qp(e),this.i[e]=dT,this.h[e]=i,this},p.P=function(e,i){return e=qp(e),this.i[e]=$p,this.h[e]=i,this},p.stop=function(){this.g=!0},p.parse=function(e,i,r){for(e=new Be(e,0),this.g=!1;e.ha()&&!this.g;)this.qc(0,e,i,r)},p.qc=function(e,i,r,s){var a=i.Z();if(s&&a+8>i.S.byteLength)this.g=!0;else{var l=i.K(),h=i.K(),d=Aa(h),g=!1;switch(l){case 0:l=i.S.byteLength-a;break;case 1:if(s&&i.Z()+8>i.S.byteLength){this.g=!0;return}l=i.$a(),g=!0}var _=this.h[h];if(_){var x=null,T=null;if(this.i[h]==$p){if(s&&i.Z()+4>i.S.byteLength){this.g=!0;return}T=i.K(),x=T>>>24,T&=16777215}h=a+l,r&&h>i.S.byteLength&&(h=i.S.byteLength),s&&h>i.S.byteLength?this.g=!0:(s=h-i.Z(),i=0<s?i.Za(s):new Uint8Array(0),i=new Be(i,0),_({name:d,parser:this,partialOkay:r||!1,version:x,flags:T,reader:i,size:l,start:a+e,has64BitSize:g}))}else i.skip(Math.min(a+l-i.Z(),i.S.byteLength-i.Z()))}};function rt(e){for(var i=Ys(e);e.reader.ha()&&!e.parser.g;)e.parser.qc(e.start+i,e.reader,e.partialOkay)}function $s(e){for(var i=Ys(e),r=e.reader.K(),s=0;s<r&&(e.parser.qc(e.start+i,e.reader,e.partialOkay),!e.parser.g);s++);}function Xp(e){var i=Ys(e);for(e.reader.skip(78);e.reader.ha()&&!e.parser.g;)e.parser.qc(e.start+i,e.reader,e.partialOkay)}function es(e){return function(i){e(i.reader.Za(i.reader.S.byteLength-i.reader.Z()))}}function qp(e){var i=0;e=y(e);for(var r=e.next();!r.done;r=e.next())i=i<<8|r.value.charCodeAt(0);return i}function Aa(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function Ys(e){return 8+(e.has64BitSize?8:0)+(e.flags!=null?4:0)}ie("shaka.util.Mp4Parser",qe),qe.headerSize=Ys,qe.typeToString=Aa,qe.allData=es,qe.visualSampleEntry=Xp,qe.sampleDescription=$s,qe.children=rt,qe.prototype.parseNext=qe.prototype.qc,qe.prototype.parse=qe.prototype.parse,qe.prototype.stop=qe.prototype.stop,qe.prototype.fullBox=qe.prototype.P,qe.prototype.box=qe.prototype.box;var dT=0,$p=1;function Yp(e){var i=this;this.g=[],this.h=[],this.data=[],new qe().box("moov",rt).box("moof",rt).P("pssh",function(r){if(!(1<r.version)){var s=Ie(r.reader.S,-12,r.size);if(i.data.push(s),i.g.push(Hs(r.reader.Za(16))),0<r.version){s=r.reader.K();for(var a=0;a<s;a++){var l=Hs(r.reader.Za(16));i.h.push(l)}}}}).parse(e)}function ch(e,i,r,s){var a=e.length,l=i.length+16+a;0<s&&(l+=4+16*r.size);var h=new Uint8Array(l),d=Wt(h),g=0;if(d.setUint32(g,l),g+=4,d.setUint32(g,1886614376),g+=4,1>s?d.setUint32(g,0):d.setUint32(g,16777216),g+=4,h.set(i,g),g+=i.length,0<s)for(d.setUint32(g,r.size),g+=4,i=y(r),r=i.next();!r.done;r=i.next())r=js(r.value),h.set(r,g),g+=r.length;return d.setUint32(g,a),h.set(e,g+4),h}function Ea(e,i){return e=st(e,i),e.length!=1?null:e[0]}function ba(e,i,r){return e=Kp(e,i,r),e.length!=1?null:e[0]}function st(e,i){var r=[];e=y(e.childNodes);for(var s=e.next();!s.done;s=e.next())s=s.value,s instanceof Element&&s.tagName==i&&r.push(s);return r}function fT(e){return Array.from(e.childNodes).filter(function(i){return i instanceof Element})}function Kp(e,i,r){var s=[];e=y(e.childNodes);for(var a=e.next();!a.done;a=e.next())a=a.value,a instanceof Element&&a.localName==r&&a.namespaceURI==i&&s.push(a);return s}function on(e,i,r){return e.hasAttributeNS(i,r)?e.getAttributeNS(i,r):null}function hr(e,i,r){i=y(i);for(var s=i.next();!s.done;s=i.next())if(s=s.value,e.hasAttributeNS(s,r))return e.getAttributeNS(s,r);return null}function Ia(e){return Array.from(e.childNodes).every(Zp)?e.textContent.trim():null}function Zp(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}function Ze(e,i,r,s){s=s===void 0?null:s;var a=null;return e=e.getAttribute(i),e!=null&&(a=r(e)),a==null?s:a}function Qp(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function cr(e){return!e||(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e),!e)?null:(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null)}function Ra(e){var i=/([0-9]+)-([0-9]+)/.exec(e);return!i||(e=Number(i[1]),!isFinite(e))?null:(i=Number(i[2]),isFinite(i)?{start:e,end:i}:null)}function pT(e){return e=Number(e),e%1===0?e:null}function La(e){return e=Number(e),e%1===0&&0<e?e:null}function Wi(e){return e=Number(e),e%1===0&&0<=e?e:null}function Ks(e){return e=Number(e),isNaN(e)?null:e}function gT(e){var i,r=(i=e.match(/^(\d+)\/(\d+)$/))?Number(i[1])/Number(i[2]):Number(e);return isNaN(r)?null:r}function Zs(e,i){var r=new DOMParser,s=mT.value()(e);e=null;try{e=r.parseFromString(s,"text/xml")}catch(a){return null}if(r=e.documentElement,!r||r.getElementsByTagName("parsererror").length||r.tagName!=i)return null;for(i=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=i.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return r}function Jp(e,i){try{var r=at(e);return Zs(r,i)}catch(s){return null}}var mT=new Hn(function(){if(typeof trustedTypes<"u"){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(i){return i}});return function(i){return e.createHTML(i)}}return function(i){return i}});function Ma(e,i){var r=this;i=i===void 0?1:i,this.D=e,this.G=new Set,this.l=this.u=null,this.da=this.W=!1,this.H=0,this.g=null,this.s=new Ye,this.i=new Map,this.B=[],this.o=new Ke,this.h=null,this.m=function(s){r.o.reject(s),e.onError(s)},this.ea=new Map,this.ba=new Map,this.O=new Ee(function(){return bT(r)}),this.L=!1,this.J=[],this.M=!1,this.ca=new Ee(function(){LT(r)}).Ca(i),this.o.catch(function(){}),this.j=new sn(function(){return _T(r)}),this.V=!1,this.F=null}p=Ma.prototype,p.destroy=function(){return this.j.destroy()};function _T(e){return B(function(i){switch(i.g){case 1:return e.s.release(),e.s=null,e.o.reject(),e.ca.stop(),e.ca=null,e.O.stop(),e.O=null,b(i,ug(e),2);case 2:if(!e.l){i.A(3);break}return fe(i,4),b(i,e.l.setMediaKeys(null),6);case 6:we(i,5);break;case 4:oe(i);case 5:e.l=null;case 3:e.g=null,e.G.clear(),e.u=null,e.B=[],e.h=null,e.m=function(){},e.D=null,e.V=!1,e.F=null,Q(i)}})}p.configure=function(e){this.h=e};function yT(e,i,r){return e.da=!0,e.B=[],e.L=r,tg(e,i)}function eg(e,i,r){return e.B=r,e.L=0<r.length,tg(e,i)}function xT(e,i,r,s,a,l){var h=new Map;return a={audioCapabilities:a,videoCapabilities:l,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:i},a.drmInfos=[{keySystem:i,licenseServerUri:r,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:s,serverCertificateUri:"",initData:null,keyIds:null}],h.set(i,a),og(e,h,[])}function tg(e,i){var r,s,a,l,h,d,g,_,x,T,S,A,M,O;return B(function(P){if(P.g==1){if(r=CT(e))for(s=y(i),a=s.next();!a.done;a=s.next())l=a.value,l.video&&(l.video.drmInfos=[r]),l.audio&&(l.audio.drmInfos=[r]);for(h=i.some(function(k){return!!(k.video&&k.video.drmInfos.length||k.audio&&k.audio.drmInfos.length)}),h||(d=qs(e.h.servers),MT(i,d)),g=y(i),a=g.next();!a.done;a=g.next())for(_=a.value,x=hg(_),T=y(x),S=T.next();!S.done;S=T.next())A=S.value,PT(A,qs(e.h.servers),qs(e.h.advanced||{}),e.h.keySystemsMapping);return b(P,yp(i,e.L,e.V),2)}return M=h||Object.keys(e.h.servers).length,M?(O=og(e,void 0,i),P.return(h?O:O.catch(function(){}))):(e.W=!0,P.return(Promise.resolve()))})}function ig(e){var i;return B(function(r){switch(r.g){case 1:if(e.l.mediaKeys)return r.return();if(!e.F){r.A(2);break}return b(r,e.F,3);case 3:return Xe(e.j),r.return();case 2:return fe(r,4),e.F=e.l.setMediaKeys(e.u),b(r,e.F,6);case 6:we(r,5);break;case 4:i=oe(r),e.m(new F(2,6,6003,i.message));case 5:Xe(e.j),Q(r)}})}function vT(e,i){return B(function(r){if(r.g==1)return b(r,ig(e),2);Qs(e,i.initDataType,Ie(i.initData)),Q(r)})}p.Yb=function(e){var i=this,r;return B(function(s){if(s.g==1)return i.u?(i.l=e,i.s.ma(i.l,"play",function(){for(var a=y(i.J),l=a.next();!l.done;l=a.next())fh(i,l.value);i.M=!0,i.J=[]}),"webkitCurrentPlaybackTargetIsWireless"in i.l&&i.s.C(i.l,"webkitcurrentplaybacktargetiswirelesschanged",function(){return ug(i)}),(r=i.g?i.g.initData.find(function(a){return 0<a.initData.length}):null)||i.g.keySystem!=="com.apple.fps"||i.B.length?b(s,ig(i),2):s.A(2)):(i.s.ma(e,"encrypted",function(){i.m(new F(2,6,6010))}),s.return());rg(i),r||i.B.length||i.h.parseInbandPsshEnabled||i.s.C(i.l,"encrypted",function(a){return vT(i,a)}),Q(s)})};function dh(e){var i,r,s,a,l;return B(function(h){switch(h.g){case 1:if(!e.u||!e.g)return h.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){h.A(2);break}return i=ci([e.g.serverCertificateUri],e.h.retryParameters),fe(h,3),r=e.D.kb.request(5,i),b(h,r.promise,5);case 5:s=h.h,e.g.serverCertificate=Ie(s.data),we(h,4);break;case 3:throw a=oe(h),new F(2,6,6017,a);case 4:if(e.j.g)return h.return();case 2:return!e.g.serverCertificate||!e.g.serverCertificate.length?h.return():(fe(h,6),b(h,e.u.setServerCertificate(e.g.serverCertificate),8));case 8:we(h,0);break;case 6:throw l=oe(h),new F(2,6,6004,l.message)}})}function wT(e,i){var r,s,a;return B(function(l){if(l.g==1)return b(l,ag(e,i),2);if(l.g!=3)return r=l.h,r?(s=[],(a=e.i.get(r))&&(a.Ja=new Ke,s.push(a.Ja)),s.push(r.remove()),b(l,Promise.all(s),3)):l.return();e.i.delete(r),Q(l)})}function rg(e){for(var i=(e.g?e.g.initData:[])||[],r=y(i),s=r.next();!s.done;s=r.next())s=s.value,Qs(e,s.initDataType,s.initData);for(r=y(e.B),s=r.next();!s.done;s=r.next())ag(e,s.value);return i.length||e.B.length||e.o.resolve(),e.o}function Qs(e,i,r){if(r.length){var s=e.i.values();s=y(s);for(var a=s.next();!a.done;a=s.next())if(Kr(r,a.value.initData)&&!tt("Tizen 2"))return;0<e.i.size&&ka(e)&&(e.o.resolve(),e.o=new Ke,e.o.catch(function(){})),AT(e,i,r,e.g.sessionType)}}function ng(e){return e?!!e.match(/^com\.(microsoft|chromecast)\.playready/):!1}function sg(e){return e=e.i.keys(),e=Wp(e,function(i){return i.sessionId}),Array.from(e)}p.ic=function(){var e=1/0,i=this.i.keys();i=y(i);for(var r=i.next();!r.done;r=i.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},p.Qc=function(){return hh(this.ba)};function og(e,i,r){var s,a,l,h,d,g,_,x,T,S,A,M,O;return B(function(P){switch(P.g){case 1:if(s=new Map,r.length){a=TT(e,r,s),P.A(2);break}return b(P,ST(e,i),3);case 3:a=P.h;case 2:if(l=a,!l)throw new F(2,6,6001);for(Xe(e.j),fe(P,4),e.G.clear(),h=l.getConfiguration(),d=h.audioCapabilities||[],g=h.videoCapabilities||[],_=y(d),x=_.next();!x.done;x=_.next())T=x.value,e.G.add(T.contentType.toLowerCase());for(S=y(g),x=S.next();!x.done;x=S.next())A=x.value,e.G.add(A.contentType.toLowerCase());if(r.length){var k=l.keySystem,z=s.get(l.keySystem),D=[],N=[],j=[],V=[],G=new Set;cg(z,D,j,N,V,G);var Y=e.L?"persistent-license":"temporary";for(k={keySystem:k,licenseServerUri:D[0],distinctiveIdentifierRequired:z[0].distinctiveIdentifierRequired,persistentStateRequired:z[0].persistentStateRequired,sessionType:z[0].sessionType||Y,audioRobustness:z[0].audioRobustness||"",videoRobustness:z[0].videoRobustness||"",serverCertificate:j[0],serverCertificateUri:N[0],initData:V,keyIds:G},z=y(z),D=z.next();!D.done;D=z.next())D=D.value,D.distinctiveIdentifierRequired&&(k.distinctiveIdentifierRequired=D.distinctiveIdentifierRequired),D.persistentStateRequired&&(k.persistentStateRequired=D.persistentStateRequired);z=k}else z=l.keySystem,k=i.get(l.keySystem),D=[],N=[],j=[],V=[],G=new Set,cg(k.drmInfos,D,j,N,V,G),z={keySystem:z,licenseServerUri:D[0],distinctiveIdentifierRequired:k.distinctiveIdentifier=="required",persistentStateRequired:k.persistentState=="required",sessionType:k.sessionTypes[0]||"temporary",audioRobustness:(k.audioCapabilities?k.audioCapabilities[0].robustness:"")||"",videoRobustness:(k.videoCapabilities?k.videoCapabilities[0].robustness:"")||"",serverCertificate:j[0],serverCertificateUri:N[0],initData:V,keyIds:G};if(e.g=z,!e.g.licenseServerUri)throw new F(2,6,6012,e.g.keySystem);return b(P,l.createMediaKeys(),6);case 6:return M=P.h,Xe(e.j),e.u=M,e.W=!0,b(P,dh(e),7);case 7:Xe(e.j),we(P,0);break;case 4:throw O=oe(P),Xe(e.j,O),e.g=null,e.G.clear(),O instanceof F?O:new F(2,6,6002,O.message)}})}function TT(e,i,r){for(var s=y(i),a=s.next();!a.done;a=s.next()){var l=y(hg(a.value));for(a=l.next();!a.done;a=l.next())a=a.value,r.has(a.keySystem)||r.set(a.keySystem,[]),r.get(a.keySystem).push(a)}if(r.size==1&&r.has(""))throw new F(2,6,6e3);for(s={},e=y(e.h.preferredKeySystems),a=e.next();!a.done;s={qd:s.qd},a=e.next())for(s.qd=a.value,l=y(i),a=l.next();!a.done;a=l.next())if(a=a.value.decodingInfos.find(function(_){return function(x){return x.supported&&x.keySystemAccess!=null&&x.keySystemAccess.keySystem==_.qd}}(s)))return a.keySystemAccess;for(e=y([!0,!1]),a=e.next();!a.done;a=e.next())for(s=a.value,l=y(i),a=l.next();!a.done;a=l.next()){var h=y(a.value.decodingInfos);for(a=h.next();!a.done;a=h.next()){var d=a.value;if(d.supported&&d.keySystemAccess){a=r.get(d.keySystemAccess.keySystem);var g=y(a);for(a=g.next();!a.done;a=g.next())if(!!a.value.licenseServerUri==s)return d.keySystemAccess}}}return null}function ST(e,i){var r,s,a,l,h,d,g,_,x,T,S,A,M,O,P;return B(function(k){switch(k.g){case 1:if(i.size==1&&i.has(""))throw new F(2,6,6e3);for(s=y(i.values()),a=s.next();!a.done;a=s.next())l=a.value,l.audioCapabilities.length==0&&delete l.audioCapabilities,l.videoCapabilities.length==0&&delete l.videoCapabilities;h=y(e.h.preferredKeySystems),d=h.next();case 2:if(d.done){k.A(4);break}if(g=d.value,!i.has(g)){k.A(3);break}return _=i.get(g),fe(k,6),b(k,navigator.requestMediaKeySystemAccess(g,[_]),8);case 8:return r=k.h,k.return(r);case 6:oe(k);case 7:Xe(e.j);case 3:d=h.next(),k.A(2);break;case 4:x=y([!0,!1]),T=x.next();case 9:if(T.done){k.A(11);break}S=T.value,A=y(i.keys()),d=A.next();case 12:if(d.done){T=x.next(),k.A(9);break}if(M=d.value,O=i.get(M),P=O.drmInfos.some(function(z){return!!z.licenseServerUri}),P!=S){k.A(13);break}return fe(k,15),b(k,navigator.requestMediaKeySystemAccess(M,[O]),17);case 17:return r=k.h,k.return(r);case 15:oe(k);case 16:Xe(e.j);case 13:d=A.next(),k.A(12);break;case 11:return k.return(r)}})}function CT(e){if(e=qs(e.h.clearKeys),e.size==0)return null;var i=[],r=[];e.forEach(function(a,l){var h=l;h.length!=22&&(h=en(js(l),!1)),l=a,l.length!=22&&(l=en(js(a),!1)),a={kty:"oct",kid:h,k:l},i.push(a),r.push(a.kid)}),e=JSON.stringify({keys:i});var s=JSON.stringify({kids:r});return s=[{initData:Ie(Mr(s)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+u.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:s,keyIds:new Set(r)}}function ag(e,i){var r,s,a,l,h;return B(function(d){switch(d.g){case 1:try{r=e.u.createSession("persistent-license")}catch(g){return s=new F(2,6,6005,g.message),e.m(s),d.return(Promise.reject(s))}return e.s.C(r,"message",function(g){e.l&&e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.M?e.J.push(g):fh(e,g)}),e.s.C(r,"keystatuseschange",function(g){return lg(e,g)}),a={initData:null,initDataType:null,loaded:!1,Vd:1/0,Ja:null,type:"persistent-license"},e.i.set(r,a),fe(d,2),b(d,r.load(i),4);case 4:return l=d.h,Xe(e.j),l?(a.loaded=!0,ka(e)&&e.o.resolve(),d.return(r)):(e.i.delete(r),e.m(new F(2,6,6013)),d.return(Promise.resolve()));case 2:h=oe(d),Xe(e.j,h),e.i.delete(r),e.m(new F(2,6,6005,h.message));case 3:return d.return(Promise.resolve())}})}function AT(e,i,r,s){try{var a=e.u.createSession(s)}catch(l){e.m(new F(2,6,6005,l.message));return}e.s.C(a,"message",function(l){e.l&&e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.M?e.J.push(l):fh(e,l)}),e.s.C(a,"keystatuseschange",function(l){return lg(e,l)}),e.i.set(a,{initData:r,initDataType:i,loaded:!1,Vd:1/0,Ja:null,type:s});try{r=e.h.initDataTransform(r,i,e.g)}catch(l){i=l,l instanceof F||(i=new F(2,6,6016,l)),e.m(i);return}e.h.logLicenseExchange&&en(r),a.generateRequest(i,r).catch(function(l){if(!e.j.g){e.i.delete(a);var h=l.errorCode;if(h&&h.systemCode){var d=h.systemCode;0>d&&(d+=Math.pow(2,32)),d="0x"+d.toString(16)}e.m(new F(2,6,6006,l.message,l,d))}})}function fh(e,i){var r,s,a,l,h,d,g,_,x,T,S,A,M,O;B(function(P){switch(P.g){case 1:return r=i.target,e.h.logLicenseExchange&&en(i.message),s=e.i.get(r),a=e.g.licenseServerUri,l=e.h.advanced[e.g.keySystem],i.messageType=="individualization-request"&&l&&l.individualizationServer&&(a=l.individualizationServer),h=ci([a],e.h.retryParameters),h.body=i.message,h.method="POST",h.licenseRequestType=i.messageType,h.sessionId=r.sessionId,h.drmInfo=e.g,s&&(h.initData=s.initData,h.initDataType=s.initDataType),ng(e.g.keySystem)&&ET(h),d=Date.now(),fe(P,2),_=e.D.kb.request(2,h),b(P,_.promise,4);case 4:g=P.h,we(P,3);break;case 2:return x=oe(P),T=new F(2,6,6007,x),e.m(T),s&&s.Ja&&s.Ja.reject(T),P.return();case 3:return e.j.g?P.return():(e.H+=(Date.now()-d)/1e3,e.h.logLicenseExchange&&en(g.data),fe(P,5),b(P,r.update(g.data),7));case 7:we(P,6);break;case 5:return S=oe(P),A=new F(2,6,6008,S.message),e.m(A),s&&s.Ja&&s.Ja.reject(A),P.return();case 6:if(e.j.g)return P.return();M=new ye("drmsessionupdate"),e.D.onEvent(M),s&&(s.Ja&&s.Ja.resolve(),O=new Ee(function(){s.loaded=!0,ka(e)&&e.o.resolve()}),O.N(OT)),Q(P)}})}function ET(e){var i=Lr(e.body,!0,!0);if(i.includes("PlayReadyKeyMessage")){i=Zs(i,"PlayReadyKeyMessage");for(var r=y(i.getElementsByTagName("HttpHeader")),s=r.next();!s.done;s=r.next())s=s.value,e.headers[s.getElementsByTagName("name")[0].textContent]=s.getElementsByTagName("value")[0].textContent;e.body=or(i.getElementsByTagName("Challenge")[0].textContent)}else e.headers["Content-Type"]="text/xml; charset=utf-8"}function lg(e,i){i=i.target;var r=e.i.get(i),s=!1;i.keyStatuses.forEach(function(l,h){if(typeof h=="string"){var d=h;h=l,l=d}if(ng(e.g.keySystem)&&h.byteLength==16&&(Gu()||Bs())){d=Wt(h);var g=d.getUint32(0,!0),_=d.getUint16(4,!0),x=d.getUint16(6,!0);d.setUint32(0,g,!1),d.setUint16(4,_,!1),d.setUint16(6,x,!1)}l!="status-pending"&&(r.loaded=!0),l=="expired"&&(s=!0),h=Hs(h).slice(0,32),e.ea.set(h,l)});var a=i.expiration-Date.now();(0>a||s&&1e3>a)&&r&&!r.Ja&&(e.i.delete(i),i.close().catch(function(){})),ka(e)&&(e.o.resolve(),e.O.N(DT))}function bT(e){var i=e.ea,r=e.ba;r.clear(),i.forEach(function(s,a){return r.set(a,s)}),i=Array.from(r.values()),i.length&&i.every(function(s){return s=="expired"})&&e.m(new F(2,6,6014)),e.D.cd(hh(r))}function IT(){var e,i,r,s,a,l,h,d;return B(function(g){return g.g==1?(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),i=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],r={initDataTypes:["cenc"],videoCapabilities:i},s={videoCapabilities:i,persistentState:"required",sessionTypes:["persistent-license"]},a=[s,r],l=new Map,h=function(_){var x,T,S;return B(function(A){switch(A.g){case 1:if(fe(A,2),_==="org.w3.clearkey"&&Xu())throw Error("Unsupported keySystem");return b(A,navigator.requestMediaKeySystemAccess(_,a),4);case 4:return x=A.h,S=(T=x.getConfiguration().sessionTypes)?T.includes("persistent-license"):!1,tt("Tizen 3")&&(S=!1),l.set(_,{persistentState:S}),b(A,x.createMediaKeys(),5);case 5:we(A,0);break;case 2:oe(A),l.set(_,null),Q(A)}})},d=e.map(function(_){return h(_)}),b(g,Promise.all(d),2)):g.return(hh(l))})}function RT(e){var i;return B(function(r){if(r.g==1)return i=new Promise(function(s,a){new Ee(a).N(kT)}),fe(r,2),b(r,Promise.race([Promise.all([e.close(),e.closed]),i]),4);if(r.g!=2)return we(r,0);oe(r),Q(r)})}function ug(e){var i;return B(function(r){return i=Array.from(e.i.entries()),e.i.clear(),b(r,Promise.all(i.map(function(s){s=y(s);var a=s.next().value,l=s.next().value;return B(function(h){if(h.g==1)return fe(h,2),e.da||e.B.includes(a.sessionId)||l.type!=="persistent-license"?b(h,RT(a),5):b(h,a.remove(),5);if(h.g!=2)return we(h,0);oe(h),Q(h)})})),0)})}function Pa(e,i){if(!e.length)return i;if(!i.length)return e;var r=[];e=y(e);for(var s=e.next();!s.done;s=e.next()){s=s.value;for(var a={},l=y(i),h=l.next();!h.done;a={Da:a.Da},h=l.next())if(h=h.value,s.keySystem==h.keySystem){a.Da=[],a.Da=a.Da.concat(s.initData||[]),a.Da=a.Da.concat(h.initData||[]),a.Da=a.Da.filter(function(d){return function(g,_){return g.keyId===void 0||_===d.Da.findIndex(function(x){return x.keyId===g.keyId})}}(a)),l=s.keyIds&&h.keyIds?new Set([].concat(I(s.keyIds),I(h.keyIds))):s.keyIds||h.keyIds,r.push({keySystem:s.keySystem,licenseServerUri:s.licenseServerUri||h.licenseServerUri,distinctiveIdentifierRequired:s.distinctiveIdentifierRequired||h.distinctiveIdentifierRequired,persistentStateRequired:s.persistentStateRequired||h.persistentStateRequired,videoRobustness:s.videoRobustness||h.videoRobustness,audioRobustness:s.audioRobustness||h.audioRobustness,serverCertificate:s.serverCertificate||h.serverCertificate,serverCertificateUri:s.serverCertificateUri||h.serverCertificateUri,initData:a.Da,keyIds:l});break}}return r}function hg(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function LT(e){e.i.forEach(function(i,r){var s=i.Vd,a=r.expiration;isNaN(a)&&(a=1/0),a!=s&&(e.D.onExpirationUpdated(r.sessionId,a),i.Vd=a)})}function ka(e){return e=e.i.values(),hT(e,function(i){return i.loaded})}function MT(e,i){var r=[];for(i.forEach(function(s,a){r.push({keySystem:a,licenseServerUri:s,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),e=y(e),i=e.next();!i.done;i=e.next())i=i.value,i.video&&(i.video.drmInfos=r),i.audio&&(i.audio.drmInfos=r)}function cg(e,i,r,s,a,l){var h={};e=y(e);for(var d=e.next();!d.done;h={oa:h.oa},d=e.next()){if(h.oa=d.value,i.includes(h.oa.licenseServerUri)||i.push(h.oa.licenseServerUri),s.includes(h.oa.serverCertificateUri)||s.push(h.oa.serverCertificateUri),h.oa.serverCertificate&&(r.some(function(x){return function(T){return Kr(T,x.oa.serverCertificate)}}(h))||r.push(h.oa.serverCertificate)),h.oa.initData){d={};for(var g=y(h.oa.initData),_=g.next();!_.done;d={Dc:d.Dc},_=g.next())d.Dc=_.value,a.some(function(x){return function(T){var S=x.Dc;return T.keyId&&T.keyId==S.keyId?!0:T.initDataType==S.initDataType&&Kr(T.initData,S.initData)}}(d))||a.push(d.Dc)}if(h.oa.keyIds)for(d=y(h.oa.keyIds),g=d.next();!g.done;g=d.next())l.add(g.value)}}function PT(e,i,r,s){var a=e.keySystem;a&&(a!="org.w3.clearkey"||!e.licenseServerUri)&&(i.size&&(i=i.get(a)||"",e.licenseServerUri=i),e.keyIds||(e.keyIds=new Set),(r=r.get(a))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=r.persistentStateRequired),e.videoRobustness||(e.videoRobustness=r.videoRobustness),e.audioRobustness||(e.audioRobustness=r.audioRobustness),e.serverCertificate||(e.serverCertificate=r.serverCertificate),r.sessionType&&(e.sessionType=r.sessionType),e.serverCertificateUri||(e.serverCertificateUri=r.serverCertificateUri)),s[a]&&(e.keySystem=s[a]),u.cast&&u.cast.__platform__&&a=="com.microsoft.playready"&&(e.keySystem="com.chromecast.playready"))}var kT=1,OT=5,DT=.5,Oa=new Hn(function(){return ui(new Uint8Array([0]))});function Da(){}function dg(e,i,r,s){var a,l,h,d;return B(function(g){if(g.g==1)return s&&(a=di[s.toLowerCase()])?g.return(a):(l=ts(e))&&(h=an[l])?g.return(h):s?g.A(2):b(g,fg(e,i,r),3);if(g.g!=2&&(s=g.h)&&(d=di[s]))return g.return(d);throw new F(2,4,4e3,e)})}function fg(e,i,r){var s,a,l;return B(function(h){return h.g==1?(s=ci([e],r),s.method="HEAD",b(h,i.request(0,s).promise,2)):(a=h.h,l=a.headers["content-type"],h.return(l?l.toLowerCase().split(";").shift():""))})}function ts(e){return e=new Zt(e).qa.split("/").pop().split("."),e.length==1?"":e.pop().toLowerCase()}ie("shaka.media.ManifestParser",Da),Da.unregisterParserByMime=function(e){delete di[e]},Da.registerParserByMime=function(e,i){di[e]=i},Da.registerParserByExtension=function(e,i){an[e]=i};var di={},an={};function FT(e){function i(){s=!0}function r(_){l.push(_),rt(_)}e=Ie(e);var s=!1,a,l=[],h=[];if(new qe().box("moov",r).box("trak",r).box("mdia",r).box("minf",r).box("stbl",r).P("stsd",function(_){a=_,l.push(_),$s(_)}).P("encv",i).P("enca",i).P("hev1",function(_){h.push({box:_,lb:1701733238})}).P("hvc1",function(_){h.push({box:_,lb:1701733238})}).P("avc1",function(_){h.push({box:_,lb:1701733238})}).P("avc3",function(_){h.push({box:_,lb:1701733238})}).P("ac-3",function(_){h.push({box:_,lb:1701733217})}).P("ec-3",function(_){h.push({box:_,lb:1701733217})}).P("mp4a",function(_){h.push({box:_,lb:1701733217})}).parse(e),s)return e;if(h.length==0||!a)throw Hs(e),new F(2,3,3019);h.reverse();for(var d=y(h),g=d.next();!g.done;g=d.next())g=g.value,e=NT(e,a,g.box,l,g.lb);return e}function NT(e,i,r,s,a){var l=UT.value(),h=e.subarray(r.start,r.start+r.size),d=Wt(h),g=new Uint8Array(r.size+l.byteLength);for(g.set(h,0),h=Wt(g),h.setUint32(4,a),g.set(l,r.size),a=d.getUint32(4),h.setUint32(r.size+16,a),pg(g,0,g.byteLength),a=new Uint8Array(e.byteLength+g.byteLength),r=zs()?r.start:r.start+r.size,l=e.subarray(r),a.set(e.subarray(0,r)),a.set(g,r),a.set(l,r+g.byteLength),e=y(s),s=e.next();!s.done;s=e.next())s=s.value,pg(a,s.start,s.size+g.byteLength);return g=Wt(a,i.start),i=Ys(i),e=g.getUint32(i),g.setUint32(i,e+1),a}function pg(e,i,r){e=Wt(e,i),i=e.getUint32(0),i!=0&&(i==1?(e.setUint32(8,r>>32),e.setUint32(12,r&4294967295)):e.setUint32(0,r))}var UT=new Hn(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function gg(e,i,r,s,a){if(s>=a)return null;for(var l=-1,h=-1,d=0;d<r.length;d++)if(r[d].some(function(N){return N!=null&&N.g.trim()!=""})){l=d;break}for(d=r.length-1;0<=d;d--)if(r[d].some(function(N){return N!=null&&N.g.trim()!=""})){h=d;break}if(l===-1||h===-1)return null;for(var g=d=!1,_="white",x="black",T=ph(s,a,d,g,_,x);l<=h;l++){for(var S=r[l],A=-1,M=-1,O=0;O<S.length;O++)if(S[O]!=null&&S[O].g.trim()!==""){A=O;break}for(O=S.length-1;0<=O;O--)if(S[O]!=null&&S[O].g.trim()!==""){M=O;break}if(A===-1||M===-1)S=mg(s,a),e.nestedCues.push(S);else{for(;A<=M;A++)if(O=S[A]){var P=O.l,k=O.i,z=O.j,D=O.h;(P!=d||k!=g||z!=_||D!=x)&&(T.payload&&e.nestedCues.push(T),T=ph(s,a,P,k,z,D),d=P,g=k,_=z,x=D),T.payload+=O.g}else T.payload+=" ";T.payload&&e.nestedCues.push(T),l!==h&&(T=mg(s,a),e.nestedCues.push(T)),T=ph(s,a,d,g,_,x)}}return e.nestedCues.length?{cue:e,stream:i}:null}function ph(e,i,r,s,a,l){return e=new Le(e,i,""),r&&e.textDecoration.push("underline"),s&&(e.fontStyle="italic"),e.color=a,e.backgroundColor=l,e}function mg(e,i){return e=new Le(e,i,""),e.lineBreak=!0,e}function _g(e,i,r,s,a){this.g=e,this.l=i,this.i=r,this.h=s,this.j=a}function gh(e,i){this.i=[],this.g=1,this.h=0,this.u=e,this.s=i,this.j=this.m=!1,this.l="white",this.o="black",Js(this)}function Fa(e,i,r){return gg(new Le(i,r,""),"CC"+(e.u<<1|e.s+1),e.i,i,r)}function Js(e){dr(e,0,15),e.g=1}function is(e,i,r){if(!(32>r||127<r)){var s="";switch(i){case eo:s=Tg.has(r)?Tg.get(r):String.fromCharCode(r);break;case xg:s=zT.get(r);break;case vg:e.i[e.g].pop(),s=BT.get(r);break;case wg:e.i[e.g].pop(),s=jT.get(r)}s&&e.i[e.g].push(new _g(s,e.m,e.j,e.o,e.l))}}function yg(e,i,r,s){if(!(0>r||0>i))if(i>=r)for(--s;0<=s;s--)e.i[i+s]=e.i[r+s].map(function(l){return l});else for(var a=0;a<s;a++)e.i[i+a]=e.i[r+a].map(function(l){return l})}function dr(e,i,r){for(var s=0;s<=r;s++)e.i[i+s]=[]}var eo=0,xg=1,vg=2,wg=3,Tg=new Map([[39,""],[42,""],[92,""],[92,""],[94,""],[95,""],[96,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),zT=new Map([[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),BT=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,"*"],[41,"'"],[42,""],[43,""],[44,""],[45,""],[46,""],[47,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]),jT=new Map([[32,""],[33,""],[34,""],[35,""],[36,""],[37,""],[38,""],[39,""],[40,""],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[54,""],[55,""],[56,""],[57,""],[58,""],[59,""],[60,""],[61,""],[62,""],[63,""]]);function Na(e,i){this.h=HT,this.o=new gh(e,i),this.i=new gh(e,i),this.l=new gh(e,i),this.g=this.i,this.j=0,this.m=null}function mh(e,i,r){e.g=e.i;var s=e.g,a=null;return e.h!==Ua&&e.h!==to&&(a=Fa(s,e.j,r),r=e.i,r.g=0<r.h?r.h:0,dr(r,0,15),r=e.l,r.g=0<r.h?r.h:0,dr(r,0,15),s.g=15),e.h=Ua,s.h=i,a}function Sg(e){e.h=VT,e.g=e.l,e.g.h=0}function Cg(e){nr("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=to}var HT=0,VT=1,Ua=3,to=4,WT="black green blue cyan red yellow magenta black".split(" "),Ag="white green blue cyan red yellow magenta white_italics".split(" ");function Eg(){this.l=!1,this.B=this.F=0,this.D=qT,this.i=[],this.g=this.h=this.j=0,this.u=this.o=!1,this.s="white",this.m="black",_h(this)}function _h(e){e.i=[];for(var i=0;16>i;i++)e.i.push(yh())}function yh(){for(var e=[],i=0;42>i;i++)e.push(null);return e}function ln(e,i){bg(e)&&(e.i[e.h][e.g]=new _g(i,e.u,e.o,e.m,e.s),e.g++)}function bg(e){var i=e.g<e.B&&0<=e.g;return e.h<e.F&&0<=e.h&&i}Eg.prototype.isVisible=function(){return this.l};function un(e,i,r){var s=new Le(e.j,i,"");return s.textAlign=e.D===GT?"left":e.D===XT?"right":sr,(r=gg(s,"svc"+r,e.i,e.j,i))&&(e.j=i),r}var GT=0,XT=1,qT=2;function $T(){this.i=[],this.h=null,this.g=0}function YT(e,i){i.type===3?(e.g=2*(i.value&63)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(i),e.g--),e.g===0&&(e.i.push(new za(e.h)),e.h=null,e.g=0))}function za(e){this.g=0,this.h=e}za.prototype.ha=function(){return this.g<this.h.length},za.prototype.Z=function(){return this.g};function _t(e){if(!e.ha())throw new F(2,2,3e3);return e.h[e.g++]}za.prototype.skip=function(e){if(this.g+e>this.h.length)throw new F(2,2,3e3);this.g+=e};function KT(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function ZT(e,i,r,s){if(128<=r&&135>=r)s=r&7,e.h[s]&&(e.g=e.h[s]);else{if(r===136){r=_t(i).value,i=null,r=y(io(e,r));for(var a=r.next();!a.done;a=r.next())a=e.h[a.value],a.isVisible()&&(i=un(a,s,e.i)),_h(a);return i}if(r===137)for(i=_t(i).value,i=y(io(e,i)),r=i.next();!r.done;r=i.next())r=e.h[r.value],r.isVisible()||(r.j=s),r.l=!0;else{if(r===138){for(r=_t(i).value,i=null,r=y(io(e,r)),a=r.next();!a.done;a=r.next())a=e.h[a.value],a.isVisible()&&(i=un(a,s,e.i)),a.l=!1;return i}if(r===139){for(r=_t(i).value,i=null,r=y(io(e,r)),a=r.next();!a.done;a=r.next())a=e.h[a.value],a.isVisible()?i=un(a,s,e.i):a.j=s,a.l=!a.l;return i}if(r===140)return i=_t(i).value,Ig(e,i,s);if(r===143)return s=Ig(e,255,s),Rg(e),s;if(r===144)i.skip(1),s=_t(i).value,e.g&&(e.g.o=0<(s&128),e.g.u=0<(s&64));else if(r===145)s=_t(i).value,r=_t(i).value,i.skip(1),e.g&&(i=Lg((r&48)>>4,(r&12)>>2,r&3),e.g.s=Lg((s&48)>>4,(s&12)>>2,s&3),e.g.m=i);else if(r===146)s=_t(i).value,i=_t(i).value,e.g&&(e=e.g,e.h=s&15,e.g=i&63);else if(r===151)i.skip(1),i.skip(1),s=_t(i).value,i.skip(1),e.g&&(e.g.D=s&3);else if(152<=r&&159>=r){if(r=(r&15)-8,a=e.h[r]!==null,!a){var l=new Eg;l.j=s,e.h[r]=l}s=_t(i).value,_t(i),_t(i),l=_t(i).value;var h=_t(i).value;i=_t(i).value,a&&!(i&7)||(i=e.h[r],i.h=0,i.g=0,i.u=!1,i.o=!1,i.s="white",i.m="black"),i=e.h[r],i.l=0<(s&32),i.F=(l&15)+1,i.B=(h&63)+1,e.g=e.h[r]}}}return null}function io(e,i){for(var r=[],s=0;8>s;s++)(i&1)===1&&e.h[s]&&r.push(s),i>>=1;return r}function Ig(e,i,r){var s=null;i=y(io(e,i));for(var a=i.next();!a.done;a=i.next()){a=a.value;var l=e.h[a];l.isVisible()&&(s=un(l,r,e.i)),e.h[a]=null}return s}function Rg(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Lg(e,i,r){var s={0:0,1:0,2:1,3:1};return e=s[e],i=s[i],r=s[r],QT[e<<2|i<<1|r]}var Mg=new Map([[32," "],[33,""],[37,""],[42,""],[44,""],[48,""],[49,""],[50,""],[51,""],[52,""],[53,""],[57,""],[58,""],[60,""],[61,""],[63,""],[118,""],[119,""],[120,""],[121,""],[122,""],[123,""],[124,""],[125,""],[126,""],[127,""]]),QT="black blue green cyan red magenta yellow white".split(" ");function JT(){this.h=[],this.g=[],this.i=new $T,this.l=0,this.s=new Map([["CC1",new Na(0,0)],["CC2",new Na(0,1)],["CC3",new Na(1,0)],["CC4",new Na(1,1)]]),this.o=this.m=0,this.j=new Map,xh(this)}function xh(e){e.m=0,e.o=0,e=y(e.s.values());for(var i=e.next();!i.done;i=e.next())i=i.value,i.h=2,i.g=i.i,i.m=null,Js(i.i),Js(i.l),Js(i.o)}function eS(e){function i(l,h){return l.pts-h.pts||l.order-h.order}var r=[];e.h.sort(i),e.g.sort(i);for(var s=y(e.h),a=s.next();!a.done;a=s.next())(a=tS(e,a.value))&&r.push(a);for(s=y(e.g),a=s.next();!a.done;a=s.next())YT(e.i,a.value);for(s=y(e.i.i),a=s.next();!a.done;a=s.next())a=iS(e,a.value),r.push.apply(r,I(a));return e.i.i=[],e.h=[],e.g=[],r}function tS(e,i){var r=i.type;if((i.xa&112)===16){var s=i.xa>>3&1;r===0?e.m=s:e.o=s}if(r=e.s.get("CC"+(r<<1|(r?e.o:e.m)+1)),i.xa===255&&i.La===255||!i.xa&&!i.La||!Pg(i.xa)||!Pg(i.La))return 45<=++e.l&&xh(e),null;if(e.l=0,i.xa&=127,i.La&=127,!i.xa&&!i.La)return null;if(e=null,(i.xa&112)===16)e:{if(s=i.xa,e=i.La,r.m===(s<<8|e))r.m=null;else if(r.m=s<<8|e,(s&240)===16&&(e&192)===64){i=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(s&7)<<1|e>>5&1];var a=(e&30)>>1;s="white";var l=!1;if(7>a?s=Ag[a]:a===7&&(l=!0),e=(e&1)===1,r.h!==to){if(a=r.g,r.h===Ua&&i!==a.g){var h=1+i-a.h;yg(a,h,1+a.g-a.h,a.h),dr(a,0,h-1),dr(a,i+1,15-i)}a.g=i,r.g.m=e,r.g.j=l,r.g.l=s,r.g.o="black"}}else if((s&247)===17&&(e&240)===32)r.g.m=!1,r.g.j=!1,r.g.l="white",is(r.g,eo,32),s=!1,i=Ag[(e&14)>>1],i==="white_italics"&&(i="white",s=!0),r.g.m=(e&1)===1,r.g.j=s,r.g.l=i;else if((s&247)===16&&(e&240)===32||(s&247)===23&&(e&255)===45)i="black",!(s&7)&&(i=WT[(e&14)>>1]),r.g.o=i;else if((s&247)===17&&(e&240)===48)is(r.g,xg,e);else if((s&246)===18&&(e&224)===32)is(r.g,s&1?wg:vg,e);else if((s&246)===20&&(e&240)===32){switch(e=i.pts,s=null,i.La){case 32:Sg(r);break;case 33:r=r.g,r.i[r.g].pop();break;case 37:s=mh(r,2,e);break;case 38:s=mh(r,3,e);break;case 39:s=mh(r,4,e);break;case 40:is(r.g,eo,32);break;case 41:r.h=2,r.g=r.i,r.g.h=0,r.j=e;break;case 42:Js(r.o),Cg(r);break;case 43:Cg(r);break;case 44:i=r.i,s=null,r.h!==to&&(s=Fa(i,r.j,e)),dr(i,0,15);break;case 45:i=r.g,r.h!==Ua?s=null:(s=Fa(i,r.j,e),l=i.g-i.h+1,yg(i,l-1,l,i.h),dr(i,0,l-1),dr(i,i.g,15-i.g),r.j=e);break;case 46:dr(r.l,0,15);break;case 47:i=null,r.h!==to&&(i=Fa(r.i,r.j,e)),s=r.l,r.l=r.i,r.i=s,Sg(r),r.j=e,s=i}e=s;break e}e=null}else s=i.La,is(r.g,eo,i.xa),is(r.g,eo,s);return e}function iS(e,i){var r=[];try{for(;i.ha();){var s=_t(i).value,a=(s&224)>>5,l=s&31;if(a===7&&l!=0&&(a=_t(i).value&63),a!=0){e.j.has(a)||e.j.set(a,new KT(a));for(var h=e.j.get(a),d=i.Z();i.Z()-d<l;){a=i;var g=_t(a),_=g.value,x=g.pts;if(_===16){var T=_t(a);_=_<<16|T.value}if(0<=_&&31>=_){var S=x;if(h.g){var A=h.g;switch(a=null,_){case 8:!bg(A)||0>=A.g&&0>=A.h||(0>=A.g?(A.g=A.B-1,A.h--):A.g--,A.i[A.h][A.g]=null);break;case 13:if(A.isVisible()&&(a=un(A,S,h.i)),A.h+1>=A.F){S=A;for(var M=0,O=1;16>O;O++,M++)S.i[M]=S.i[O];for(O=0;1>O;O++,M++)S.i[M]=yh()}else A.h++;A.g=0;break;case 14:A.isVisible()&&(a=un(A,S,h.i)),A.i[A.h]=yh(),A.g=0;break;case 12:A.isVisible()&&(a=un(A,S,h.i)),_h(A),S=A,S.h=0,S.g=0}var P=a}else P=null}else if(128<=_&&159>=_)P=ZT(h,a,_,x);else{if(4096<=_&&4127>=_)S=_&255,8<=S&&15>=S?a.skip(1):16<=S&&23>=S?a.skip(2):24<=S&&31>=S&&a.skip(3);else if(4224<=_&&4255>=_)S=_&255,128<=S&&135>=S?a.skip(4):136<=S&&143>=S&&a.skip(5);else if(32<=_&&127>=_)a=_,h.g&&(a===127?ln(h.g,""):ln(h.g,String.fromCharCode(a)));else if(160<=_&&255>=_)h.g&&ln(h.g,String.fromCharCode(_));else if(4128<=_&&4223>=_){if(a=_&255,h.g)if(Mg.has(a)){var k=Mg.get(a);ln(h.g,k)}else ln(h.g,"_")}else 4256<=_&&4351>=_&&h.g&&((_&255)!=160?ln(h.g,"_"):ln(h.g,"[CC]"));P=null}(a=P)&&r.push(a)}}}}catch(z){if(z instanceof F&&z.code===3e3)nr("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.");else throw z}return r}function Pg(e){for(var i=0;e;)i^=e&1,e>>=1;return i===1}function vh(){}vh.prototype.init=function(){},vh.prototype.parse=function(){return[]};function kg(e,i){var r=null,s=null,a=null,l=e.K();return i&1&&(a=e.$a()),i&2&&e.skip(4),i&8&&(r=e.K()),i&16&&(s=e.K()),{trackId:l,Ce:r,xf:s,rh:a}}function Og(e,i){return{we:i==1?e.$a():e.K()}}function wh(e,i){return i==1?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),{timescale:e.K()}}function Dg(e,i,r){var s=e.K(),a=[],l=null;r&1&&(l=e.K()),r&4&&e.skip(4);for(var h=0;h<s;h++){var d={ee:null,sampleSize:null,ed:null};r&256&&(d.ee=e.K()),r&512&&(d.sampleSize=e.K()),r&1024&&e.skip(4),r&2048&&(d.ed=i==0?e.K():e.Pe()),a.push(d)}return{wh:s,Re:a,wf:l}}function Th(){this.j=new Map,this.i=this.h=0,this.g=Sh}Th.prototype.init=function(e){function i(l){l=l.name,l in Ba&&(r.g=Ba[l])}var r=this,s=[],a=[];if(new qe().box("moov",rt).box("mvex",rt).P("trex",function(l){var h=l.reader;h.skip(4),h.skip(4),l=h.K(),h=h.K(),r.h=l,r.i=h}).box("trak",rt).P("tkhd",function(l){var h=l.reader;l.version==1?(h.skip(8),h.skip(8)):(h.skip(4),h.skip(4)),l=h.K(),s.push(l)}).box("mdia",rt).P("mdhd",function(l){l=wh(l.reader,l.version),a.push(l.timescale)}).box("minf",rt).box("stbl",rt).P("stsd",$s).box("avc1",i).box("avc3",i).box("hev1",i).box("hvc1",i).box("dvh1",i).box("dvhe",i).box("encv",Xp).box("sinf",rt).box("frma",function(l){l=l.reader.K(),l=Aa(l),l in Ba&&(r.g=Ba[l])}).parse(e,!0),!s.length||!a.length||s.length!=a.length)throw new F(2,2,2010);this.g==Sh&&Ve("Unable to determine bitstream format for CEA parsing!"),s.forEach(function(l,h){r.j.set(l,a[h])})},Th.prototype.parse=function(e){var i=this;if(this.g==Sh)return[];var r=[],s=this.h,a=this.i,l=[],h=null,d=null,g=null,_=9e4;return new qe().box("moof",function(x){h=x.start,rt(x)}).box("traf",rt).P("trun",function(x){x=Dg(x.reader,x.version,x.flags),l=x.Re,d=x.wf}).P("tfhd",function(x){x=kg(x.reader,x.flags),s=x.Ce||i.h,a=x.xf||i.i,x=x.trackId,i.j.has(x)&&(_=i.j.get(x))}).P("tfdt",function(x){g=Og(x.reader,x.version).we}).box("mdat",function(x){if(g===null)throw new F(2,2,2010);e:{var T=x.reader,S=g,A=_,M=s,O=a,P=l,k=0,z=O;for(P.length&&(z=P[0].sampleSize||O),T.skip((h||0)+(d||0)-x.start-8);T.ha();){x=T.K();var D=T.Ra();switch(i.g){case Ch:D&=31,D=D==6;break;case ro:D=D>>1&63,D=D==39||D==40;break;default:break e}if(D){D=0,P.length>k&&(D=P[k].ed||0),D=(S+D)/A;for(var N=[],j,V=T.Za(x-1),G=j=0;G<V.length;)j==2&&V[G]==3?(j=0,V=[].concat(I(V)),V.splice(G,1),V=new Uint8Array(V)):V[G]==0?j++:j=0,G++;for(j=V,G=0;G<j.length;){for(V=0;j[G]==255;)V+=255,G++;V+=j[G++];for(var Y=0;j[G]==255;)Y+=255,G++;Y+=j[G++],V==4&&N.push(j.subarray(G,G+Y)),G+=Y}for(N=y(N),j=N.next();!j.done;j=N.next())r.push({ig:j.value,pts:D})}else try{T.skip(x-1)}catch(K){break}z-=x+4,z==0&&(S=P.length>k?S+(P[k].ee||M):S+M,k++,z=P.length>k&&P[k].sampleSize||O)}}}).parse(e,!1),r};var Sh=0,Ch=1,ro=2,Ba={avc1:Ch,avc3:Ch,hev1:ro,hvc1:ro,dvh1:ro,dvhe:ro};function Fg(e){this.h=new vh,e.includes("video/mp4")&&(this.h=new Th),this.g=new JT}Fg.prototype.init=function(e){this.h.init(e)};function rS(e,i){i=e.h.parse(i),i=y(i);for(var r=i.next();!r.done;r=i.next()){var s=r.value,a=Ie(s.ig);if(0<a.length&&(r=e.g,s=s.pts,a=new Be(a,0),a.Ra()===181&&a.$d()===49&&a.K()===1195456820&&a.Ra()===3)){var l=a.Ra();if(l&64){l&=31,a.skip(1);for(var h=0;h<l;h++){var d=a.Ra(),g=(d&4)>>2,_=a.Ra(),x=a.Ra();g&&(d&=3,d===0||d===1?r.h.push({pts:s,type:d,xa:_,La:x,order:r.h.length}):(r.g.push({pts:s,type:d,value:_,order:r.g.length}),r.g.push({pts:s,type:2,value:x,order:r.g.length})))}}}}return eS(e.g)}function fi(e,i,r,s,a){this.ya=e,this.Ba=i,this.ka=r,this.Od=s===void 0?null:s,this.timescale=a}fi.prototype.lc=function(){return this.Ba},fi.prototype.hc=function(){return this.ka};function nS(e,i){return e&&i?e.lc()==i.lc()&&e.hc()==i.hc()&&_e(e.ya(),i.ya()):e==i}ie("shaka.media.InitSegmentReference",fi),fi.prototype.getEndByte=fi.prototype.hc,fi.prototype.getStartByte=fi.prototype.lc;function Me(e,i,r,s,a,l,h,d,g,_,x,T,S,A,M){_=_===void 0?[]:_,A=A===void 0?ja:A,this.startTime=e,this.j=this.endTime=i,this.u=r,this.Ba=s,this.ka=a,this.h=l,this.timestampOffset=h,this.appendWindowStart=d,this.appendWindowEnd=g,this.i=_,this.tilesLayout=x===void 0?"":x,this.s=T===void 0?null:T,this.g=S===void 0?null:S,this.status=A,this.l=M===void 0?null:M,this.o=null,this.m=0}p=Me.prototype,p.ya=function(){return this.u()},p.getStartTime=function(){return this.startTime},p.Ef=function(){return this.endTime},p.lc=function(){return this.Ba},p.hc=function(){return this.ka},p.Vf=function(){return this.tilesLayout},p.Uf=function(){return this.s},p.Eb=function(){return this.status},p.bg=function(){this.status=Ng},p.Ye=function(e){this.o=e},p.Sf=function(){return this.o},p.offset=function(e){this.startTime+=e,this.endTime+=e,this.j+=e;for(var i=y(this.i),r=i.next();!r.done;r=i.next())r=r.value,r.startTime+=e,r.endTime+=e,r.j+=e},p.oe=function(e){this.g==null?Kt("Sync attempted without sync time!"):(e=this.g-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},ie("shaka.media.SegmentReference",Me),Me.prototype.syncAgainst=Me.prototype.oe,Me.prototype.offset=Me.prototype.offset,Me.prototype.getThumbnailSprite=Me.prototype.Sf,Me.prototype.setThumbnailSprite=Me.prototype.Ye,Me.prototype.markAsUnavailable=Me.prototype.bg,Me.prototype.getStatus=Me.prototype.Eb,Me.prototype.getTileDuration=Me.prototype.Uf,Me.prototype.getTilesLayout=Me.prototype.Vf,Me.prototype.getEndByte=Me.prototype.hc,Me.prototype.getStartByte=Me.prototype.lc,Me.prototype.getEndTime=Me.prototype.Ef,Me.prototype.getStartTime=Me.prototype.getStartTime,Me.prototype.getUris=Me.prototype.ya;var ja=0,Ng=1;Me.Status={Hg:ja,oh:Ng,Vg:2};function Ug(e){return!e||e.length==1&&1e-6>e.end(0)-e.start(0)?null:e.length==1&&0>e.start(0)?0:e.length?e.start(0):null}function Ah(e){return!e||e.length==1&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Eh(e,i){return!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0)||i>e.end(e.length-1)?!1:i>=e.start(0)}function zg(e,i){if(!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0))return 0;var r=0;e=y(Dr(e));for(var s=e.next();!s.done;s=e.next()){var a=s.value;s=a.start,a=a.end,a>i&&(r+=a-Math.max(s,i))}return r}function sS(e,i,r){return!e||!e.length||e.length==1&&1e-6>e.end(0)-e.start(0)?null:(e=Dr(e).findIndex(function(s,a,l){return s.start>i&&(a==0||l[a-1].end-i<=r)}),0<=e?e:null)}function Dr(e){if(!e)return[];for(var i=[],r=0;r<e.length;r++)i.push({start:e.start(r),end:e.end(r)});return i}function Bg(){}function jg(e,i){var r=(e[i]&127)<<21;return r|=(e[i+1]&127)<<14,r|=(e[i+2]&127)<<7,r|=e[i+3]&127}function oS(e){var i={key:e.type,description:"",data:""};if(e.type==="TXXX"){if(2>e.size||e.data[0]!==3)return null;var r=e.data.subarray(1).indexOf(0);if(r===-1)return null;var s=at(Ie(e.data,1,r));return e=at(Ie(e.data,2+r)).replace(/\0*$/,""),i.description=s,i.data=e,i}return e.type==="WXXX"?2>e.size||e.data[0]!==3||(r=e.data.subarray(1).indexOf(0),r===-1)?null:(s=at(Ie(e.data,1,r)),e=at(Ie(e.data,2+r)).replace(/\0*$/,""),i.description=s,i.data=e,i):e.type==="PRIV"?2>e.size||(s=e.data.indexOf(0),s===-1)?null:(s=at(Ie(e.data,0,s)),e=ui(e.data.subarray(s.length+1)),i.description=s,i.data=e,i):e.type[0]==="T"?2>e.size||e.data[0]!==3?null:(e=at(e.data.subarray(1)).replace(/\0*$/,""),i.data=e,i):e.type[0]==="W"?(e=at(e.data).replace(/\0*$/,""),i.data=e,i):e.data?(i.data=ui(e.data),i):null}function Ha(e){for(var i=0,r=[];i+10<=e.length&&e[i]===73&&e[i+1]===68&&e[i+2]===51&&255>e[i+3]&&255>e[i+4]&&128>e[i+6]&&128>e[i+7]&&128>e[i+8]&&128>e[i+9];){var s=jg(e,i+6);for(e[i+5]>>6&1&&(i+=10),i+=10,s=i+s;i+10<s;){var a=e.subarray(i),l=jg(a,4);a={type:String.fromCharCode(a[0],a[1],a[2],a[3]),size:l,data:a.subarray(10,10+l)},(l=oS(a))&&r.push(l),i+=a.size+10}i+10<=e.length&&e[i]===51&&e[i+1]===68&&e[i+2]===73&&255>e[i+3]&&255>e[i+4]&&128>e[i+6]&&128>e[i+7]&&128>e[i+8]&&128>e[i+9]&&(i+=10)}return r}ie("shaka.util.Id3Utils",Bg),Bg.getID3Frames=Ha;function Va(){this.o=null,this.s=!1,this.l=this.m=null,this.B=[],this.g=this.h=null,this.u=[],this.j=null,this.i=[]}Va.prototype.parse=function(e){if(564>e.length)return this;for(var i=Math.max(0,Hg(e)),r=e.length-(e.length+i)%188,s=!1,a=i;a<r;a+=188)if(e[a]===71){var l=!!(e[a+1]&64),h=((e[a+1]&31)<<8)+e[a+2];if(1<(e[a+3]&48)>>4){var d=a+5+e[a+4];if(d===a+188)continue}else d=a+4;switch(h){case 0:l&&(d+=e[d]+1),this.o=(e[d+10]&31)<<8|e[d+11];break;case 17:case 8191:break;case this.o:l&&(d+=e[d]+1),l=e,h={audio:-1,video:-1,Ed:-1,audioCodec:"",videoCodec:""};var g=d+3+((l[d+1]&15)<<8|l[d+2])-4;for(d+=12+((l[d+10]&15)<<8|l[d+11]);d<g;){var _=(l[d+1]&31)<<8|l[d+2];switch(l[d]){case 15:h.audio===-1&&(h.audio=_,h.audioCodec="aac");break;case 21:h.Ed===-1&&(h.Ed=_);break;case 27:h.video===-1&&(h.video=_,h.videoCodec="avc");break;case 3:case 4:h.audio===-1&&(h.audio=_,h.audioCodec="mp3");break;case 36:h.video===-1&&(h.video=_,h.videoCodec="hvc")}d+=((l[d+3]&15)<<8|l[d+4])+5}l=h,this.l==null&&(this.l=l.video),this.g==null&&(this.g=l.audio),this.j==null&&(this.j=l.Ed),s&&!this.s&&(s=!1,a=i-188),this.s=!0;break;case this.l:l=e.subarray(d,a+188),this.m==null&&(d=bh(l))&&d.pts!=null&&(this.m=d.pts/9e4),this.B.push(l);break;case this.g:l=e.subarray(d,a+188),this.h==null&&(d=bh(l))&&d.pts!=null&&(this.h=d.pts/9e4),this.u.push(l);break;case this.j:this.i.push(e.subarray(d,a+188));break;default:s=!0}}return this};function bh(e){if((e[0]<<16|e[1]<<8|e[2])!==1)return null;var i={data:new Uint8Array(0),vh:6+(e[4]<<8|e[5]),pts:null,dts:null},r=e[7];return r&192&&(i.pts=536870912*(e[9]&14)+4194304*(e[10]&255)+16384*(e[11]&254)+128*(e[12]&255)+(e[13]&254)/2,i.dts=i.pts,r&64&&(i.dts=536870912*(e[14]&14)+4194304*(e[15]&255)+16384*(e[16]&254)+128*(e[17]&255)+(e[18]&254)/2)),i.data=e.subarray(9+e[8]),i}function aS(e){for(var i=[],r=new Uint8Array(0),s=e.i.length-1;0<=s;s--){r=Vs(e.i[s],r);var a=bh(r);a&&(i.unshift({cueTime:a.pts?a.pts/9e4:null,data:a.data,frames:Ha(a.data),dts:a.dts,pts:a.pts}),r=new Uint8Array(0))}return i}Va.prototype.getStartTime=function(){return{audio:this.h,video:this.m}};function Hg(e){for(var i=Math.min(1e3,e.length-564),r=0;r<i;){if(e[r]===71&&e[r+188]===71&&e[r+376]===71)return r;r++}return-1}ie("shaka.util.TsParser",Va);function no(e,i,r){this.g=null,this.i=-1,this.j=e,this.h=i,this.l=r,typeof libDPIModule>"u"&&Ve("Could not Find LCEVC Library dependencies on this page"),typeof LcevcDil>"u"?Ve("Could not Find LCEVC Library on this page"):LcevcDil.SupportObject.SupportStatus||Ve(LcevcDil.SupportObject.SupportError),typeof LcevcDil<"u"&&typeof libDPIModule<"u"&&this.h instanceof HTMLCanvasElement&&LcevcDil.SupportObject.SupportStatus&&!this.g&&LcevcDil.SupportObject.webGLSupport(this.h)&&(this.h.classList.remove("shaka-hidden"),this.g=new LcevcDil.LcevcDil(this.j,this.h,this.l))}no.prototype.release=function(){this.g&&(this.g.close(),this.g=null)};function Vg(e,i){var r=lS;switch(i.mimeType){case"video/webm":r=uS;break;case"video/mp4":r=hS}e.g&&(e.i=i.id,e.g.setLevelSwitching(i.id,!0),e.g.setContainerFormat(r))}ie("shaka.lcevc.Dil",no),no.prototype.release=no.prototype.release;var lS=0,uS=1,hS=2;function Wg(e,i,r,s){var a=this;this.j=e,this.F=null,this.m=i,this.h={},this.L={},this.O={},this.g=null,this.H=!1,this.V=r||function(){},this.D=s||null,this.i={},this.u=new Ye,this.o={},this.s=null,this.J=new Ke,this.l=cS(this,this.J),this.G=new sn(function(){return dS(a)}),this.M="",this.B=!1,this.W=new Ke}function cS(e,i){var r=new MediaSource;return e.u.ma(r,"sourceopen",function(){URL.revokeObjectURL(e.M),i.resolve()}),e.M=Mh(r),e.j.src=e.M,r}p=Wg.prototype,p.destroy=function(){return this.G.destroy()};function dS(e){var i,r,s,a,l,h,d,g;return B(function(_){if(_.g==1){i=[];for(r in e.i)for(s=e.i[r],a=s[0],e.i[r]=s.slice(0,1),a&&i.push(a.p.catch(Iw)),l=y(s.slice(1)),h=l.next();!h.done;h=l.next())d=h.value,d.p.reject(new F(2,7,7003,void 0));e.g&&i.push(e.g.destroy()),e.m&&i.push(e.m.destroy());for(g in e.o)i.push(e.o[g].destroy());return b(_,Promise.all(i),2)}e.u&&(e.u.release(),e.u=null),e.j&&(e.j.removeAttribute("src"),e.j.load(),e.j=null),e.F=null,e.l=null,e.g=null,e.m=null,e.h={},e.o={},e.s=null,e.i={},e.D=null,Q(_)})}p.init=function(e,i,r){r=r===void 0?!1:r;var s=this,a,l,h,d,g,_,x,T;return B(function(S){if(S.g==1)return a=Mt,b(S,s.J,2);for(s.B=r,l={},h=y(e.keys()),d=h.next();!d.done;l={na:l.na},d=h.next())l.na=d.value,g=e.get(l.na),_=Hi(g.mimeType,g.codecs),l.na==a.X?so(s,_,r):(!i&&ce(_)||!Ku(_,l.na)||(s.o[l.na]=new op(_),_=lp(l.na,_)),x=_+s.F.sourceBufferExtraFeatures,T=s.l.addSourceBuffer(x),s.u.C(T,"error",function(A){return function(){s.i[A.na][0].p.reject(new F(2,3,3014,s.j.error?s.j.error.code:0))}}(l)),s.u.C(T,"updateend",function(A){return function(){return cn(s,A.na)}}(l)),s.h[l.na]=T,s.L[l.na]=_,s.i[l.na]=[],s.O[l.na]=!!g.drmInfos.length);Q(S)})},p.configure=function(e){this.F=e};function so(e,i,r){e.g||(e.g=new ar(e.m));var s=e.g;e=e.H,i!="application/cea-608"&&i!="application/cea-708"&&(s.j=(0,wt[i])(),s.j.setSequenceMode?s.j.setSequenceMode(r):Ve('Text parsers should have a "setSequenceMode" method!'),s.u=e)}function Gg(e){return e.l?e.l.readyState=="ended":!0}function Xg(e,i){return i==ze?e.g.g:Ug(hn(e,i))}function Wa(e,i){return i==ze?e.g.h:Ah(hn(e,i))}function fS(e,i,r){return i==ze?(e=e.g,e.h==null||e.h<r?0:e.h-Math.max(r,e.g)):(e=hn(e,i),zg(e,r))}p.Na=function(){var e={total:Dr(this.j.buffered),audio:Dr(hn(this,"audio")),video:Dr(hn(this,"video")),text:[]};if(this.g){var i=this.g.g,r=this.g.h;i!=null&&r!=null&&e.text.push({start:i,end:r})}return e};function hn(e,i){try{return e.h[i].buffered}catch(r){return null}}function qg(e,i,r,s,a,l,h){l=l===void 0?!1:l,h=h===void 0?!1:h;var d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae;return B(function(ne){switch(ne.g){case 1:if(d=Mt,i!=d.X){ne.A(2);break}if(!e.B){ne.A(3);break}return b(ne,e.W,4);case 4:g=ne.h,e.g.s=g;case 3:return b(ne,Mw(e.g,r,s?s.startTime:null,s?s.endTime:null),5);case 5:return ne.return();case 2:if(_=Ie(r),x=e.L[i],e.o[i]&&(x=e.o[i].o),0>Hg(_)?rs.includes(x)&&(M=Ha(_),M.length&&s&&(O={cueTime:s.startTime,data:_,frames:M,dts:s.startTime,pts:s.startTime},e.V([O],0,s.endTime))):(T=new Va().parse(_),S=s.startTime-(T.getStartTime()[i]||0),A=aS(T),A.length&&e.V(A,S,s?s.endTime:null)),!e.o[i]){a&&i==d.va&&(e.g||so(e,"text/vtt",e.B),e.s||(e.s=new Fg(x)),s?(P=rS(e.s,r),P.length&&(k=e.h[d.va].timestampOffset,fp(e.g,P,s.startTime,s.endTime,k))):e.s.init(r)),ne.A(6);break}return l&&e.o[i].g.resetCaptions(),b(ne,Lw(e.o[i],r),7);case 7:z=ne.h,e.g||so(e,"text/vtt",e.B),z.captions&&z.captions.length&&(D=e.h[d.va].timestampOffset,N=kw(z.captions),fp(e.g,N,s?s.startTime:null,s?s.endTime:null,D)),r=z.data;case 6:if(r=yS(e,r,s?s.startTime:null,i),j=e.h[i],V=xS,!e.B||j.mode==V||!s){ne.A(8);break}if(G=e.l.duration,Y=i==d.va||!(d.va in e.h),!Y){ne.A(9);break}return K=[j.appendWindowStart,j.appendWindowEnd],j.appendWindowStart=0,j.appendWindowEnd=1/0,le=j.timestampOffset,j.timestampOffset=0,b(ne,Ht(e,i,function(){return Yg(e,i,r)}),10);case 10:return b(ne,Ht(e,i,function(){return Ga(e,i)}),11);case 11:return j.timestampOffset=le,j.appendWindowStart=K[0],j.appendWindowEnd=K[1],pe=Ug(hn(e,i)),me=(s.startTime||0)-(pe||0),e.W.resolve(me),b(ne,Ht(e,i,function(){return Ih(e,i,0,G)}),12);case 12:if(i!=d.va){ne.A(9);break}return b(ne,Ht(e,i,function(){e.j.currentTime-=.001,cn(e,i)}),9);case 9:return j.mode=V,b(ne,e.Aa(G),8);case 8:return s&&e.B&&i!=d.X&&(l||h)&&(Ae=s.startTime,Ht(e,i,function(){return Ga(e,i)}),Ht(e,i,function(){return Rh(e,i,Ae)})),b(ne,Ht(e,i,function(){Yg(e,i,r)}),16);case 16:Q(ne)}})}function pS(e,i){var r=Wa(e,"video")||0;cp(e.g,i,r)}function gS(e){e.g&&cp(e.g,"",0)}p.remove=function(e,i,r){var s=this,a;return B(function(l){return a=Mt,e==a.X?b(l,s.g.remove(i,r),0):b(l,Ht(s,e,function(){return Ih(s,e,i,r)}),0)})};function $g(e,i){var r;return B(function(s){return r=Mt,i==r.X?e.g?b(s,e.g.remove(0,1/0),0):s.return():b(s,Ht(e,i,function(){return Ih(e,i,0,e.l.duration)}),0)})}p.flush=function(e){var i=this,r;return B(function(s){return r=Mt,e==r.X?s.return():b(s,Ht(i,e,function(){i.j.currentTime-=.001,cn(i,e)}),0)})};function mS(e,i,r,s,a,l){var h;return B(function(d){return h=Mt,i==h.X?(l||(e.g.s=r),Pw(e.g,s,a),d.return()):b(d,Promise.all([Ht(e,i,function(){return Ga(e,i)}),l?Promise.resolve():Ht(e,i,function(){return Rh(e,i,r)}),Ht(e,i,function(){e.h[i].appendWindowStart=0,e.h[i].appendWindowEnd=a,e.h[i].appendWindowStart=s,cn(e,i)})]),0)})}function _S(e,i,r){var s;return B(function(a){return s=Mt,i==s.X?a.return():(Ht(e,i,function(){return Ga(e,i)}),b(a,Ht(e,i,function(){return Rh(e,i,r)}),0))})}p.endOfStream=function(e){var i=this;return B(function(r){return b(r,Kg(i,function(){Gg(i)||(e?i.l.endOfStream(e):i.l.endOfStream())}),0)})},p.Aa=function(e){var i=this;return B(function(r){return b(r,Kg(i,function(){if(e<i.l.duration)for(var s in i.h){var a={start:function(){},p:new Ke};i.i[s].unshift(a)}i.l.duration=e}),0)})},p.getDuration=function(){return this.l.duration};function Yg(e,i,r){if(i=="video"&&e.D){var s=e.D;s.g&&s.g.appendBuffer(r,"video",s.i)}e.h[i].appendBuffer(r)}function Ih(e,i,r,s){s<=r?cn(e,i):e.h[i].remove(r,s)}function Ga(e,i){var r=e.h[i].appendWindowStart,s=e.h[i].appendWindowEnd;e.h[i].abort(),e.h[i].appendWindowStart=r,e.h[i].appendWindowEnd=s,cn(e,i)}function Rh(e,i,r){0>r&&(r+=.001),e.h[i].timestampOffset=r,cn(e,i)}function cn(e,i){var r=e.i[i][0];r&&(r.p.resolve(),Lh(e,i))}function Ht(e,i,r){return Xe(e.G),r={start:r,p:new Ke},e.i[i].push(r),e.i[i].length==1&&Zg(e,i),r.p}function Kg(e,i){var r,s,a,l,h,d;return B(function(g){switch(g.g){case 1:Xe(e.G),r=[],s={};for(a in e.h)s.Ub=new Ke,l={start:function(_){return function(){return _.Ub.resolve()}}(s),p:s.Ub},e.i[a].push(l),r.push(s.Ub),e.i[a].length==1&&l.start(),s={Ub:s.Ub};return fe(g,2),b(g,Promise.all(r),4);case 4:we(g,3);break;case 2:throw h=oe(g),h;case 3:try{i()}catch(_){throw new F(2,3,3015,_)}finally{for(d in e.h)Lh(e,d)}Q(g)}})}function Lh(e,i){e.i[i].shift(),Zg(e,i)}function Zg(e,i){var r=e.i[i][0];if(r)try{r.start()}catch(s){s.name=="QuotaExceededError"?r.p.reject(new F(2,3,3017,i)):r.p.reject(new F(2,3,3015,s)),Lh(e,i)}}function yS(e,i,r,s){var a=e.O[s];return r==null&&a&&(Wn()||zs())&&e.L[s].split(";")[0].split("/")[1]=="mp4"&&(i=FT(i)),i}var Mh=u.URL.createObjectURL,xS="sequence",rs=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function de(e,i,r){this.i=e,this.m=i,this.o=this.j=1/0,this.g=1,this.h=this.l=null,this.s=0,this.u=!0,this.B=0,this.D=r===void 0?!0:r,this.F=0,this.G=!1}p=de.prototype,p.getDuration=function(){return this.j},p.Kf=function(){return this.g},p.Xe=function(e){this.i=e},p.Aa=function(e){this.j=e},p.Pf=function(){return this.i},p.Ve=function(e){this.s=e},p.yc=function(e){this.u=e},p.me=function(e){this.o=e},p.We=function(e){this.m=e},p.Df=function(){return this.m},p.Ib=function(e){if(e.length!=0){var i=e[0].startTime,r=e[0].endTime;e=y(e);for(var s=e.next();!s.done;s=e.next())s=s.value,i=Math.min(i,s.startTime),r=Math.max(r,s.endTime),this.g=Math.max(this.g,s.endTime-s.startTime);this.Td(i),this.h=Math.max(this.h,r),this.i!=null&&this.D&&!this.G&&(this.i=(Date.now()+this.s)/1e3-this.h-this.g)}},p.Md=function(){this.G=!0},p.Td=function(e){this.l=this.l==null?e:Math.min(this.l,e)},p.Sd=function(e){this.g=Math.max(this.g,e)},p.offset=function(e){this.l!=null&&(this.l+=e),this.h!=null&&(this.h+=e)},p.U=function(){return this.j==1/0&&!this.u},p.jb=function(){return this.j!=1/0&&!this.u},p.Pa=function(){return Math.max(this.B,this.gb()-this.o)},p.Ze=function(e){this.B=e},p.gb=function(){return this.U()||this.jb()?Math.min(Math.max(0,(Date.now()+this.s)/1e3-this.g-this.i)+this.F,this.j):this.h?Math.min(this.h,this.j):this.j},p.kc=function(e){var i=Math.max(this.l,this.B);return this.o==1/0?Math.ceil(1e3*i)/1e3:Math.max(i,Math.min(this.gb()-this.o+e,this.Oa()))},p.Db=function(){return this.kc(0)},p.Oa=function(){return Math.max(0,this.gb()-(this.U()||this.jb()?this.m:0))},p.df=function(){return!(this.i==null||this.h!=null&&this.D)},p.Ue=function(e){this.F=e},ie("shaka.media.PresentationTimeline",de),de.prototype.setAvailabilityTimeOffset=de.prototype.Ue,de.prototype.usingPresentationStartTime=de.prototype.df,de.prototype.getSeekRangeEnd=de.prototype.Oa,de.prototype.getSeekRangeStart=de.prototype.Db,de.prototype.getSafeSeekRangeStart=de.prototype.kc,de.prototype.getSegmentAvailabilityEnd=de.prototype.gb,de.prototype.setUserSeekStart=de.prototype.Ze,de.prototype.getSegmentAvailabilityStart=de.prototype.Pa,de.prototype.isInProgress=de.prototype.jb,de.prototype.isLive=de.prototype.U,de.prototype.offset=de.prototype.offset,de.prototype.notifyMaxSegmentDuration=de.prototype.Sd,de.prototype.notifyMinSegmentStartTime=de.prototype.Td,de.prototype.lockStartTime=de.prototype.Md,de.prototype.notifySegments=de.prototype.Ib,de.prototype.getDelay=de.prototype.Df,de.prototype.setDelay=de.prototype.We,de.prototype.setSegmentAvailabilityDuration=de.prototype.me,de.prototype.setStatic=de.prototype.yc,de.prototype.setClockOffset=de.prototype.Ve,de.prototype.getPresentationStartTime=de.prototype.Pf,de.prototype.setDuration=de.prototype.Aa,de.prototype.setPresentationStartTime=de.prototype.Xe,de.prototype.getMaxSegmentDuration=de.prototype.Kf,de.prototype.getDuration=de.prototype.getDuration;function Qg(e,i,r){this.l=r,this.j=e,this.s=Jg(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.u=i,this.i=function(){}}Qg.prototype.release=function(){this.l=this.j=null,this.i=function(){}};function vS(e,i){e.i=i}function wS(e){this.g=e}function Jg(e){if(e.g.paused||e.g.playbackRate==0||e.g.buffered.length==0)var i=!1;else e:{i=e.g.currentTime,e=y(Dr(e.g.buffered));for(var r=e.next();!r.done;r=e.next())if(r=r.value,!(i<r.start-.1||i>r.end-.5)){i=!0;break e}i=!1}return i}function Ph(e,i,r,s,a){var l=this;this.o=a,this.g=e,this.s=i,this.D=r,this.i=new Ye,this.m=!1,this.B=e.readyState,this.u=0,this.h=s,this.l=!1,this.i.C(e,"waiting",function(){return kh(l)}),this.j=new Ee(function(){kh(l)}).Ca(.25)}Ph.prototype.release=function(){this.i&&(this.i.release(),this.i=null),this.j!=null&&(this.j.stop(),this.j=null),this.h&&(this.h.release(),this.h=null),this.g=this.s=this.o=null},Ph.prototype.Wd=function(){this.l=!0,kh(this)};function kh(e){if(e.g.readyState!=0){if(e.g.seeking){if(!e.m)return}else e.m=!1;if(!e.g.paused||e.g.currentTime==0&&(e.g.autoplay||e.g.currentTime!=0)){e.g.readyState!=e.B&&(e.B=e.g.readyState);var i;if(!(i=!e.h)){i=e.h;var r=i.j,s=Jg(r),a=r.g.currentTime,l=Date.now()/1e3;(i.g!=a||i.s!=s)&&(i.m=l,i.g=a,i.s=s,i.h=!1),a=l-i.m,(s=a>=i.u&&s&&!i.h)&&(i.i(i.g,a),i.h=!0,i.g=r.g.currentTime,i.o++,i.l(new ye("stalldetected"))),i=!s}i&&(i=e.g.currentTime,r=e.g.buffered,s=sS(r,i,e.D.gapDetectionThreshold),s==null||s==0&&!e.l||(a=r.start(s),a>=e.s.Oa()||.001>a-i||(s!=0&&r.end(s-1),e.g.currentTime=a,e.u++,e.o(new ye("gapjumped")))))}}}function ns(e,i,r,s){i==HTMLMediaElement.HAVE_NOTHING||e.readyState>=i?s():(i=TS.value().get(i),r.ma(e,i,s))}var TS=new Hn(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function em(e,i,r){var s=this;this.g=e,this.l=i,this.j=r,this.m=!1,this.h=new Ye,this.i=new nm(e),ns(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){im(s,s.j)})}em.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.i!=null&&(this.i.release(),this.i=null),this.l=function(){},this.g=null};function Oh(e){return e.m?e.g.currentTime:e.j}function tm(e,i){0<e.g.readyState?sm(e.i,i):ns(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){im(e,e.j)})}function im(e,i){.001>Math.abs(e.g.currentTime-i)?rm(e):(e.h.ma(e.g,"seeking",function(){rm(e)}),sm(e.i,e.g.currentTime&&e.g.currentTime!=0?e.g.currentTime:i))}function rm(e){e.m=!0,e.h.C(e.g,"seeking",function(){return e.l()})}function nm(e){var i=this;this.h=e,this.m=10,this.l=this.j=this.i=0,this.g=new Ee(function(){0>=i.i||i.h.currentTime!=i.j?i.g.stop():(i.h.currentTime=i.l,i.i--)})}nm.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null};function sm(e,i){e.j=e.h.currentTime,e.l=i,e.i=e.m,e.h.currentTime=i,e.g.Ca(.1)}function om(e){this.g=e,this.j=!1,this.h=null,this.i=new Ye}p=om.prototype,p.yd=function(){function e(){i.h==null||i.h==0?i.j=!0:(i.i.ma(i.g,"seeking",function(){i.j=!0}),i.g.currentTime=Math.max(0,i.g.currentTime+i.h))}var i=this;ns(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,function(){e()})},p.release=function(){this.i&&(this.i.release(),this.i=null),this.g=null},p.zd=function(e){this.h=this.j?this.h:e},p.Ic=function(){return(this.j?this.g.currentTime:this.h)||0},p.ue=function(){return 0},p.te=function(){return 0},p.Ne=function(){};function am(e,i,r,s,a,l){var h=this;this.i=e,this.g=i.presentationTimeline,this.B=i.minBufferTime||0,this.l=r,this.u=a,this.s=null,this.o=CS(e,r,l),this.j=new Ph(e,i.presentationTimeline,r,this.o,l),this.h=new em(e,function(){e:{var d=h.j;d.m=!0,d.l=!1;var g=Oh(h.h);if(d=um(h,g),.001<Math.abs(d-g)&&(g=Date.now()/1e3,!h.s||h.s<g-1)){h.s=g,tm(h.h,d),d=void 0;break e}h.u(),d=void 0}return d},SS(this,s)),this.m=new Ee(function(){if(h.i.readyState!=0&&!h.i.paused){var d=Oh(h.h),g=h.g.Db(),_=h.g.Oa();3>_-g&&(g=_-3),d<g&&(d=um(h,d),h.i.currentTime=d)}})}p=am.prototype,p.yd=function(){this.m.Ca(.25)},p.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.u=function(){}},p.zd=function(e){tm(this.h,e)},p.Ic=function(){var e=Oh(this.h);return 0<this.i.readyState&&!this.i.paused?hm(this,e):e},p.ue=function(){return this.o?this.o.o:0},p.te=function(){return this.j.u};function SS(e,i){return i==null?i=1/0>e.g.getDuration()?e.g.Db():e.g.Oa():0>i&&(i=e.g.Oa()+i),lm(e,hm(e,i))}p.Ne=function(){this.j.Wd()};function lm(e,i){var r=e.g.getDuration();return i>=r?r-e.l.durationBackoff:i}function um(e,i){var r=Math.max(e.B,e.l.rebufferingGoal),s=e.l.safeSeekOffset,a=e.g.Db(),l=e.g.Oa(),h=e.g.getDuration();3>l-a&&(a=l-3);var d=e.g.kc(r),g=e.g.kc(s);return r=e.g.kc(r+s),i>=h?lm(e,i):i>l?l:i<a?Eh(e.i.buffered,g)?g:r:i>=d||Eh(e.i.buffered,i)?i:r}function hm(e,i){var r=e.g.Db();return i<r?r:(e=e.g.Oa(),i>e?e:i)}function CS(e,i,r){if(!i.stallEnabled)return null;var s=i.stallSkip;return i=new Qg(new wS(e),i.stallThreshold,r),vS(i,function(){s?e.currentTime+=s:(e.pause(),e.play())}),i}function Fe(e){this.g=e,this.h=null,this.i=0,this.j=!1}p=Fe.prototype,p.release=function(){this.j||(this.g=[],this.h&&this.h.stop(),this.h=null)},p.cg=function(){this.j=!0};function AS(e,i){e=y(e.g);for(var r=e.next();!r.done;r=e.next())i(r.value)}p.find=function(e){for(var i=this.g.length-1,r=i;0<=r;--r){var s=this.g[r],a=r<i?this.g[r+1].startTime:s.endTime;if(e>=s.startTime&&e<a)return r+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},p.get=function(e){return this.g.length==0?null:(e-=this.i,0>e||e>=this.g.length?null:this.g[e])},p.offset=function(e){if(!this.j)for(var i=y(this.g),r=i.next();!r.done;r=i.next())r.value.offset(e)},p.pc=function(e){if(!this.j&&e.length){var i=Math.round(1e3*e[0].startTime)/1e3;this.g=this.g.filter(function(r){return Math.round(1e3*r.startTime)/1e3<i}),this.g.push.apply(this.g,I(e))}},p.Hb=function(e,i){var r=this;e=e.filter(function(s){return s.endTime>i&&(r.g.length==0||s.endTime>r.g[0].startTime)}),this.pc(e),this.eb(i)},p.eb=function(e){if(!this.j){var i=this.g.length;this.g=this.g.filter(function(r){return r.endTime>e}),this.i+=i-this.g.length}},p.Wa=function(e,i,r){if(r=r===void 0?!1:r,!this.j){for(;this.g.length&&this.g[this.g.length-1].startTime>=i;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),r||this.i++;this.g.length!=0&&(e=this.g[this.g.length-1],this.g[this.g.length-1]=new Me(e.startTime,i,e.u,e.Ba,e.ka,e.h,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.i,e.tilesLayout,e.s,e.g,e.status,e.l))}},p.fd=function(e,i){var r=this;this.j||(this.h&&this.h.stop(),this.h=new Ee(function(){var s=i();s?r.g.push.apply(r.g,I(s)):(r.h.stop(),r.h=null)}),this.h.Ca(e))},Fe.prototype[Symbol.iterator]=function(){return this.Cb(0)},Fe.prototype.Cb=function(e){var i=this.find(e);if(i==null)return null;i--;var r=this.get(i+1),s=-1;if(r&&0<r.i.length)for(var a=r.i.length-1;0<=a;--a){var l=r.i[a];if(e>=l.startTime&&e<l.endTime){i++,s=a-1;break}}return new Ri(this,i,s)};function Dh(e,i,r){return new Fe([new Me(e,e+i,function(){return r},0,null,null,e,e,e+i)])}ie("shaka.media.SegmentIndex",Fe),Fe.forSingleSegment=Dh,Fe.prototype.getIteratorForTime=Fe.prototype.Cb,Fe.prototype.updateEvery=Fe.prototype.fd,Fe.prototype.fit=Fe.prototype.Wa,Fe.prototype.evict=Fe.prototype.eb,Fe.prototype.mergeAndEvict=Fe.prototype.Hb,Fe.prototype.offset=Fe.prototype.offset,Fe.prototype.get=Fe.prototype.get,Fe.prototype.find=Fe.prototype.find,Fe.prototype.markImmutable=Fe.prototype.cg,Fe.prototype.release=Fe.prototype.release;function Ri(e,i,r){this.i=e,this.g=i,this.h=r}Ri.prototype.vf=function(){return this.g},Ri.prototype.current=function(){var e=this.i.get(this.g);return e&&0<e.i.length&&e.ya().length&&this.h>=e.i.length&&(this.g++,this.h=0,e=this.i.get(this.g)),e&&0<e.i.length?e.i[this.h]:e},Ri.prototype.next=function(){var e=this.i.get(this.g);return e&&0<e.i.length?(this.h++,e.ya().length&&this.h==e.i.length&&(this.g++,this.h=0)):(this.g++,this.h=0),e=this.current(),{value:e,done:!e}},ie("shaka.media.SegmentIterator",Ri),Ri.prototype.next=Ri.prototype.next,Ri.prototype.current=Ri.prototype.current,Ri.prototype.currentPosition=Ri.prototype.vf;function ut(){Fe.call(this,[]),this.l=[]}he(ut,Fe),p=ut.prototype,p.clone=function(){var e=new ut;return e.l=this.l.slice(),e},p.release=function(){for(var e=y(this.l),i=e.next();!i.done;i=e.next())i.value.release();this.l=[]},p.find=function(e){for(var i=0,r=y(this.l),s=r.next();!s.done;s=r.next()){s=s.value;var a=s.find(e);if(a!=null)return a+i;i+=s.i+s.g.length}return null},p.get=function(e){for(var i=0,r=y(this.l),s=r.next();!s.done;s=r.next()){s=s.value;var a=s.get(e-i);if(a)return a;i+=s.i+s.g.length}return null},p.offset=function(){},p.pc=function(){},p.eb=function(){},p.Hb=function(){},p.Wa=function(){},p.fd=function(){},ie("shaka.media.MetaSegmentIndex",ut),ut.prototype.updateEvery=ut.prototype.fd,ut.prototype.fit=ut.prototype.Wa,ut.prototype.mergeAndEvict=ut.prototype.Hb,ut.prototype.evict=ut.prototype.eb,ut.prototype.merge=ut.prototype.pc,ut.prototype.offset=ut.prototype.offset,ut.prototype.get=ut.prototype.get,ut.prototype.find=ut.prototype.find,ut.prototype.release=ut.prototype.release;function oo(e){var i=this;this.g=e,this.j=!1,this.i=this.g.Tc(),this.h=new Ee(function(){i.g.Me(.25*i.i)})}oo.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},oo.prototype.set=function(e){this.i=e,cm(this)},oo.prototype.Pc=function(){return this.g.Pc()};function cm(e){e.h.stop();var i=e.j?0:e.i;if(0<=i)try{e.g.Tc()!=i&&e.g.le(i);return}catch(r){}e.h.Ca(.25),e.g.Tc()!=0&&e.g.le(0)}function dm(e){var i=this;this.h=e,this.g=new Set,this.i=new Ee(function(){fm(i,!1)}).Ca(.25)}dm.prototype.release=function(){this.i.stop();for(var e=y(this.g),i=e.next();!i.done;i=e.next())i.value.release();this.g.clear()};function fm(e,i){for(var r=y(e.g),s=r.next();!s.done;s=r.next())s.value.j(e.h.currentTime,i)}function Xa(e){Oe.call(this),this.g=new Map,this.h=e}he(Xa,Oe),Xa.prototype.release=function(){this.g.clear(),Oe.prototype.release.call(this)};function ES(e,i){var r=e.g.get(i);return r||(r={rc:[],Ae:null,contentType:i},e.g.set(i,r)),r}function bS(e,i,r){var s=ES(e,i.contentType);IS(e,s),e={Od:i,position:r},s=s.rc,i=s.findIndex(function(a){return a.position>=r}),0<=i?s.splice(i,s[i].position==r?1:0,e):s.push(e)}Xa.prototype.j=function(e){for(var i=y(this.g.values()),r=i.next();!r.done;r=i.next()){r=r.value;e:{for(var s=r.rc,a=s.length-1;0<=a;a--){var l=s[a];if(l.position<=e){s=l.Od;break e}}s=null}if((a=s)&&(a=r.Ae,a=!(a===s||a&&s&&a.bandwidth==s.bandwidth&&a.audioSamplingRate==s.audioSamplingRate&&a.codecs==s.codecs&&a.contentType==s.contentType&&a.frameRate==s.frameRate&&a.height==s.height&&a.mimeType==s.mimeType&&a.channelsCount==s.channelsCount&&a.pixelAspectRatio==s.pixelAspectRatio&&a.width==s.width)),a)e:{if(a=e,l=s.contentType,(l=this.h()[l])&&0<l.length){var h=l[l.length-1].end;if(a>=l[0].start&&a<h){a=!0;break e}}a=!1}a&&(r.Ae=s,JSON.stringify(s),r=new ye("qualitychange",new Map([["quality",s],["position",e]])),this.dispatchEvent(r))}};function IS(e,i){if((e=e.h()[i.contentType])&&0<e.length){var r=e[0].start,s=e[e.length-1].end,a=i.rc;i.rc=a.filter(function(l,h){return!(l.position<=r&&h+1<a.length&&a[h+1].position<=r||l.position>=s)})}else i.rc=[]}function Fh(e){Oe.call(this);var i=this;this.g=new Set,this.i=e,this.h=new Ee(function(){for(var r=i.i(),s=y(i.g),a=s.next();!a.done;a=s.next())a=a.value,a.endTime<r.start&&(i.g.delete(a),a=new ye("regionremove",new Map([["region",a]])),i.dispatchEvent(a))}).Ca(2)}he(Fh,Oe),Fh.prototype.release=function(){this.g.clear(),this.h.stop(),Oe.prototype.release.call(this)};function qa(e){Oe.call(this);var i=this;this.i=e,this.g=new Map,this.l=[{rb:null,qb:ss,ib:function(r,s){return dn(i,"enter",r,s)}},{rb:ao,qb:ss,ib:function(r,s){return dn(i,"enter",r,s)}},{rb:lo,qb:ss,ib:function(r,s){return dn(i,"enter",r,s)}},{rb:ss,qb:ao,ib:function(r,s){return dn(i,"exit",r,s)}},{rb:ss,qb:lo,ib:function(r,s){return dn(i,"exit",r,s)}},{rb:ao,qb:lo,ib:function(r,s){return dn(i,"skip",r,s)}},{rb:lo,qb:ao,ib:function(r,s){return dn(i,"skip",r,s)}}],this.h=new Ye,this.h.C(this.i,"regionremove",function(r){i.g.delete(r.region)})}he(qa,Oe),qa.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Oe.prototype.release.call(this)},qa.prototype.j=function(e,i){for(var r=y(this.i.g),s=r.next();!s.done;s=r.next()){s=s.value;var a=this.g.get(s),l=e<s.startTime?ao:e>s.endTime?lo:ss;this.g.set(s,l);for(var h=y(this.l),d=h.next();!d.done;d=h.next())d=d.value,d.rb==a&&d.qb==l&&d.ib(s,i)}};function dn(e,i,r,s){i=new ye(i,new Map([["region",r],["seeking",s]])),e.dispatchEvent(i)}var ao=1,ss=2,lo=3;function Nh(e,i,r,s,a){return e=ci(e,s,a),(i!=0||r!=null)&&(e.headers.Range=r?"bytes="+i+"-"+r:"bytes="+i+"-"),e}function pm(e,i){var r=this;this.g=i,this.m=e,this.i=null,this.u=1,this.o=this.l=null,this.D=!1,this.j=new Map,this.B=!1,this.F=null,this.s=!1,this.h=new sn(function(){return RS(r)})}p=pm.prototype,p.destroy=function(){return this.h.destroy()};function RS(e){var i,r,s,a;return B(function(l){if(l.g==1){for(i=[],r=y(e.j.values()),s=r.next();!s.done;s=r.next())a=s.value,uo(a),i.push(ym(a));return b(l,Promise.all(i),2)}e.j.clear(),e.g=null,e.m=null,e.i=null,Q(l)})}p.configure=function(e){this.i=e,this.F=new Op({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0)},p.start=function(){var e=this;return B(function(i){if(i.g==1)return b(i,OS(e),2);Xe(e.h),e.B=!0,Q(i)})};function LS(e,i){var r,s,a,l,h;B(function(d){switch(d.g){case 1:return r=Mt,fe(d,2),b(d,$g(e.g.R,r.X),4);case 4:we(d,3);break;case 2:s=oe(d),e.g&&e.g.onError(s);case 3:a=Hi(i.mimeType,i.codecs),so(e.g.R,a,e.m.sequenceMode),l=e.g.R.m,(l.isTextVisible()||e.i.alwaysStreamText)&&(h=_m(i),e.j.set(r.X,h),pi(e,h,0)),Q(d)}})}function MS(e){var i=e.j.get(ze);i&&(uo(i),ym(i).catch(function(){}),e.j.delete(ze)),e.o=null}function gm(e,i){var r=e.j.get("video");if(r){var s=r.stream;s&&(i?(i=s.trickModeVideo)&&!r.ob&&(os(e,i,!1,0,!1),r.ob=s):(s=r.ob)&&(r.ob=null,os(e,s,!0,0,!1)))}}function mm(e,i,r,s,a,l){r=r===void 0?!1:r,s=s===void 0?0:s,a=a===void 0?!1:a,l=l===void 0?!1:l,e.l=i,e.B&&(i.video&&os(e,i.video,r,s,a,l),i.audio&&os(e,i.audio,r,s,a,l))}function $a(e,i){e.o=i,e.B&&os(e,i,!0,0,!1)}function os(e,i,r,s,a,l){var h=e.j.get(i.type);h||i.type!=ze?h&&(h.ob&&(i.trickModeVideo?(h.ob=i,i=i.trickModeVideo):h.ob=null),h.stream!=i||a)&&(i.type==ze&&so(e.g.R,Hi(i.mimeType,i.codecs),e.m.sequenceMode),h.stream.closeSegmentIndex&&h.stream.closeSegmentIndex(),h.stream=i,h.aa=null,h.ve=!!l,r&&(h.ac?h.hd=!0:h.ra?(h.bb=!0,h.Nc=s,h.hd=!0):(uo(h),jh(e,h,!0,s).catch(function(d){e.g&&e.g.onError(d)}))),PS(e,h).catch(function(d){e.g&&e.g.onError(d)})):LS(e,i)}function PS(e,i){var r,s;return B(function(a){if(a.g==1)return i.ta?(r=i.stream,s=i.ta,r.segmentIndex?a.A(2):b(a,r.createSegmentIndex(),2)):a.return();if(i.ta!=s||i.stream!=r)return a.return();var l=e.g.Sc(),h=Wa(e.g.R,i.type),d=i.stream.segmentIndex.find(i.pa?i.pa.endTime:l),g=d==null?null:i.stream.segmentIndex.get(d);d=g&&g.ka?g.ka-g.Ba:null,g&&!d&&(d=(g.endTime-g.getStartTime())*(i.stream.bandwidth||0)/8),d?((g=g.h)&&(d+=(g.ka?g.ka-g.Ba:null)||0),g=e.g.getBandwidthEstimate(),l=8*d/g<(h||0)-l-Math.max(e.m.minBufferTime||0,e.i.rebufferingGoal)||i.ta.h.g>d):l=!1,l&&i.ta.abort(),Q(a)})}p.vc=function(){if(this.g)for(var e=this.g.Sc(),i=y(this.j.keys()),r=i.next();!r.done;r=i.next()){var s=r.value;r=this.j.get(s),r.aa=null;var a=this.g.R;if(s==ze?(a=a.g,a=a.g==null||a.h==null?!1:e>=a.g&&e<a.h):(a=hn(a,s),a=Eh(a,e)),!a){if((Wa(this.g.R,s)!=null||r.ra)&&kS(this,r),r.ta&&(r.ta.abort(),r.ta=null),s===ze&&(s=this.g.R,s.s))for(s=s.s.g,s.l=0,s.h=[],s.g=[],a=s.i,a.i=[],a.h=[],a.g=0,xh(s),s=y(s.j.values()),a=s.next();!a.done;a=s.next())Rg(a.value);r.vc=!0}}};function kS(e,i){i.ac||i.bb||(i.ra?(i.bb=!0,i.Nc=0):Xg(e.g.R,i.type)==null?i.Ka==null&&pi(e,i,0):(uo(i),jh(e,i,!1,0).catch(function(r){e.g&&e.g.onError(r)})))}function OS(e){var i,r,s,a,l,h,d,g,_,x;return B(function(T){if(T.g==1){if(i=Mt,!e.l)throw new F(2,5,5006);return r=new Map,s=new Set,e.l.audio&&(r.set(i.Hc,e.l.audio),s.add(e.l.audio)),e.l.video&&(r.set(i.va,e.l.video),s.add(e.l.video)),e.o&&(r.set(i.X,e.o),s.add(e.o)),a=e.g.R,l=e.i.forceTransmux,b(T,a.init(r,l,e.m.sequenceMode),2)}for(Xe(e.h),e.updateDuration(),h=y(r.keys()),d=h.next();!d.done;d=h.next())g=d.value,_=r.get(g),e.j.has(g)||(x=_m(_),e.j.set(g,x),pi(e,x,0));Q(T)})}function _m(e){return{stream:e,type:e.type,aa:null,pa:null,Zc:null,Kd:null,Jd:null,Id:null,ob:null,endOfStream:!1,ra:!1,Ka:null,bb:!1,Nc:0,hd:!1,ac:!1,vc:!0,Rd:!1,be:!1,nc:!1,ta:null}}p.updateDuration=function(){var e=this.m.presentationTimeline.getDuration();1/0>e?this.g.R.Aa(e):this.g.R.Aa(Math.pow(2,32))};function DS(e,i){var r,s,a,l,h;return B(function(d){switch(d.g){case 1:if(Xe(e.h),i.ra||i.Ka==null||i.ac)return d.return();if(i.Ka=null,!i.bb){d.A(2);break}return b(d,jh(e,i,i.hd,i.Nc),3);case 3:return d.return();case 2:if(i.stream.segmentIndex){d.A(4);break}return r=i.stream,b(d,i.stream.createSegmentIndex(),5);case 5:if(r!=i.stream)return r.closeSegmentIndex&&r.closeSegmentIndex(),i.ra||i.Ka||pi(e,i,0),d.return();case 4:fe(d,6),s=FS(e,i),s!=null&&(pi(e,i,s),i.nc=!1),we(d,7);break;case 6:return a=oe(d),b(d,xm(e,a),8);case 8:return d.return();case 7:if(l=Array.from(e.j.values()),!e.B||!l.every(function(g){return g.endOfStream})){d.A(0);break}return b(d,e.g.R.endOfStream(),10);case 10:Xe(e.h),h=e.g.R.getDuration(),h!=0&&h<e.m.presentationTimeline.getDuration()&&e.m.presentationTimeline.Aa(h),Q(d)}})}function FS(e,i){if(zh(i))return pS(e.g.R,i.stream.originalId||""),null;i.type==ze&&gS(e.g.R);var r=e.g.Sc(),s=i.pa?i.pa.endTime:r,a=fS(e.g.R,i.type,r),l=Math.max(e.m.minBufferTime||0,e.i.rebufferingGoal,e.i.bufferingGoal)*e.u,h=e.m.presentationTimeline.getDuration()-s,d=Wa(e.g.R,i.type);if(1e-6>h&&d)return i.endOfStream=!0,i.type=="video"&&(e=e.j.get(ze))&&zh(e)&&(e.endOfStream=!0),null;if(i.endOfStream=!1,a>=l)return e.i.updateIntervalSeconds/2;if(a=NS(e,i,r,d),!a)return e.i.updateIntervalSeconds;for(l=1/0,h=Array.from(e.j.values()),h=y(h),d=h.next();!d.done;d=h.next())d=d.value,zh(d)||d.aa&&!d.aa.current()||(l=Math.min(l,d.pa?d.pa.endTime:r));return s>=l+e.m.presentationTimeline.g?e.i.updateIntervalSeconds:(US(e,i,r,a).catch(function(){}),null)}function NS(e,i,r,s){if(i.aa)return i.aa.current();if(i.pa||s)return r=i.pa?i.pa.endTime:s,i.Rd=!0,i.aa=i.stream.segmentIndex.Cb(r),i.aa&&i.aa.next().value;e=e.i.inaccurateManifestTolerance,s=Math.max(r-e,0);var a=null;return e&&(i.aa=i.stream.segmentIndex.Cb(s),a=i.aa&&i.aa.next().value),a||(i.aa=i.stream.segmentIndex.Cb(r),a=i.aa&&i.aa.next().value),a}function US(e,i,r,s){var a,l,h,d,g,_,x,T,S,A,M,O,P,k,z;return B(function(D){switch(D.g){case 1:if(a=Mt,l=i.stream,h=i.aa,i.ra=!0,fe(D,2),s.Eb()==2)throw new F(1,1,1011);return b(D,HS(e,i,s),4);case 4:return Xe(e.h),e.s?D.return():(d=l.mimeType=="video/mp4"||l.mimeType=="audio/mp4",g=u.ReadableStream,e.i.lowLatencyMode&&g&&d&&!s.l?(T=new Uint8Array(0),A=S=!1,M=function(N){var j,V,G;return B(function(Y){return S||(A=!0,Xe(e.h),e.s)?Y.return():(T=BS(T,N),j=!1,V=0,new qe().box("mdat",function(K){V=K.size+K.start,j=!0}).parse(T,!1,!0),j?(G=T.subarray(0,V),T=T.subarray(V),b(Y,Uh(e,i,r,l,s,G),0)):Y.A(0))})},b(D,Bh(e,i,s,M),11)):(_=Bh(e,i,s),b(D,_,7)));case 7:if(x=D.h,Xe(e.h),e.s)return D.return();if(!s.l){D.A(8);break}return b(D,zS(x,s,h),9);case 9:x=D.h;case 8:return Xe(e.h),i.bb?(i.ra=!1,pi(e,i,0),D.return()):b(D,Uh(e,i,r,l,s,x),6);case 11:if(O=D.h,A){D.A(6);break}return S=!0,Xe(e.h),e.s?D.return():i.bb?(i.ra=!1,pi(e,i,0),D.return()):b(D,Uh(e,i,r,l,s,O),6);case 6:if(Xe(e.h),e.s)return D.return();i.pa=s,h.next(),i.ra=!1,i.be=!1,P=e.g.R.Na(),k=P[i.type],JSON.stringify(k),i.bb||e.g.Wd(s.startTime,s.endTime,i.type),pi(e,i,0),we(D,0);break;case 2:if(z=oe(D),Xe(e.h,z),e.s)return D.return();if(i.ra=!1,z.code==7001)i.ra=!1,uo(i),pi(e,i,0),D.A(0);else if(i.type==a.X&&e.i.ignoreTextStreamFailures)e.j.delete(a.X),D.A(0);else if(z.code==3017)jS(e,i,z),D.A(0);else return i.nc=!0,z.severity=2,b(D,xm(e,z),0)}})}function zS(e,i,r){var s,a,l,h;return B(function(d){if(d.g==1)return s=i.l,s.cryptoKey?d.A(2):b(d,s.fetchKey(),3);if(a=s.iv,!a)for(a=Ie(new ArrayBuffer(16)),l=s.firstMediaSequenceNumber+r.g,h=a.byteLength-1;0<=h;h--)a[h]=l&255,l>>=8;return d.return(u.crypto.subtle.decrypt({name:"AES-CBC",iv:a},s.cryptoKey,e))})}function BS(e,i){var r=new Uint8Array(e.length+i.length);return r.set(e),r.set(i,e.length),r}function jS(e,i,r){if(!Array.from(e.j.values()).some(function(a){return a!=i&&a.be})){var s=Math.round(100*e.u);if(20<s)e.u-=.2;else if(4<s)e.u-=.04;else{i.nc=!0,e.s=!0,e.g.onError(r);return}i.be=!0}pi(e,i,4)}function HS(e,i,r){var s,a,l,h,d,g,_,x;return B(function(T){return s=[],a=Math.max(0,r.appendWindowStart-.1),l=r.appendWindowEnd+.01,h=r.timestampOffset,(h!=i.Kd||a!=i.Jd||l!=i.Id)&&(d=function(){var S;return B(function(A){if(A.g==1)return fe(A,2),i.Jd=a,i.Id=l,i.Kd=h,b(A,mS(e.g.R,i.type,h,a,l,e.m.sequenceMode),4);if(A.g!=2)return we(A,0);throw S=oe(A),i.Jd=null,i.Id=null,i.Kd=null,S})},s.push(d())),!nS(r.h,i.Zc)&&(i.Zc=r.h)&&(g=Bh(e,i,r.h),_=function(){var S,A,M,O;return B(function(P){switch(P.g){case 1:return fe(P,2),b(P,g,4);case 4:return S=P.h,Xe(e.h),A=new qe,A.box("moov",rt).box("trak",rt).box("mdia",rt).P("mdhd",function(k){k=wh(k.reader||0,k.version||0),r.h.timescale=k.timescale}).parse(S),M=i.stream.closedCaptions&&0<i.stream.closedCaptions.size,b(P,e.g.xe(i.type,S),5);case 5:return b(P,qg(e.g.R,i.type,S,null,M),6);case 6:we(P,0);break;case 2:throw O=oe(P),i.Zc=null,O}})},e.g.fg(r.startTime,r.h),s.push(_())),e.m.sequenceMode&&(x=i.pa?i.pa.m:null,r.m!=x||i.Rd)&&(i.Rd=!1,s.push(_S(e.g.R,i.type,r.startTime))),b(T,Promise.all(s),0)})}function Uh(e,i,r,s,a,l){var h,d,g,_,x,T;return B(function(S){switch(S.g){case 1:return h=s.closedCaptions&&0<s.closedCaptions.size,g=s.emsgSchemeIdUris!=null&&0<s.emsgSchemeIdUris.length||e.i.dispatchAllEmsgBoxes,_=e.i.parsePrftBox&&!e.D,(g||_)&&(d=new qe),g&&d.P("emsg",function(A){var M=s.emsgSchemeIdUris;if(A.version===0)var O=A.reader.sc(),P=A.reader.sc(),k=A.reader.K(),z=A.reader.K(),D=A.reader.K(),N=A.reader.K(),j=a.startTime+z/k;else k=A.reader.K(),j=A.reader.$a()/k+a.timestampOffset,z=j-a.startTime,D=A.reader.K(),N=A.reader.K(),O=A.reader.sc(),P=A.reader.sc();A=A.reader.Za(A.reader.S.byteLength-A.reader.Z()),(M&&M.includes(O)||e.i.dispatchAllEmsgBoxes)&&(O=="urn:mpeg:dash:event:2012"?e.g.gg():O=="https://aomedia.org/emsg/ID3"?(M=Ha(A),M.length&&a&&e.g.hg([{cueTime:a.startTime,data:A,frames:M,dts:a.startTime,pts:a.startTime}],0,a.endTime)):(M=new Map().set("detail",{startTime:j,endTime:j+D/k,schemeIdUri:O,value:P,timescale:k,presentationTimeDelta:z,eventDuration:D,id:N,messageData:A}),M=new ye("emsg",M),e.g.onEvent(M)))}),_&&d.P("prft",function(A){e:{if(!e.D&&a.h.timescale){A.reader.K();var M=A.reader.K(),O=A.reader.K();if(M=1e3*M+O/Math.pow(2,32)*1e3,A.version===0)var P=A.reader.K();else try{P=A.reader.$a()}catch(k){e.D=!0,P=void 0;break e}A=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+M).getTime(),P=new Map().set("detail",{wallClockTime:A,programStartDate:new Date(A-P/a.h.timescale*1e3)}),P=new ye("prft",P),e.g.onEvent(P),e.D=!0}P=void 0}return P}),(g||_)&&d.parse(l),b(S,VS(e,i,r),2);case 2:return Xe(e.h),x=i.vc,i.vc=!1,T=i.ve,i.ve=!1,b(S,e.g.xe(i.type,l),3);case 3:return b(S,qg(e.g.R,i.type,l,a,h,x,T),4);case 4:Xe(e.h),Q(S)}})}function VS(e,i,r){var s,a,l,h;return B(function(d){if(d.g==1)return s=Math.max(e.i.bufferBehind,e.m.presentationTimeline.g),a=Xg(e.g.R,i.type),a==null?d.return():(l=r-a,h=l-s,.01>=h?d.return():b(d,e.g.R.remove(i.type,a,a+h),2));Xe(e.h),Q(d)})}function zh(e){return e&&e.type==ze&&(e.stream.mimeType=="application/cea-608"||e.stream.mimeType=="application/cea-708")}function Bh(e,i,r,s){var a,l,h,d,g;return B(function(_){return _.g==1?(a=Or,l=Nh(r.ya(),r.Ba,r.ka,e.i.retryParameters,s),h=i.stream,e.g.modifySegmentRequest(l,{type:h.type,init:r instanceof fi,duration:r.endTime-r.startTime,mimeType:h.mimeType,codecs:h.codecs,bandwidth:h.bandwidth}),d=e.g.kb.request(a,l),i.ta=d,b(_,d.promise,2)):(g=_.h,i.ta=null,_.return(g.data))})}function jh(e,i,r,s){var a,l;return B(function(h){if(h.g==1)return i.bb=!1,i.hd=!1,i.Nc=0,i.ac=!0,i.pa=null,i.Zc=null,i.aa=null,s?(a=e.g.Sc(),l=e.g.R.getDuration(),b(h,e.g.R.remove(i.type,a+s,l),3)):b(h,$g(e.g.R,i.type),4);if(h.g!=3)return Xe(e.h),r?b(h,e.g.R.flush(i.type),3):h.A(3);Xe(e.h),i.ac=!1,i.endOfStream=!1,i.ra||i.Ka||pi(e,i,0),Q(h)})}function pi(e,i,r){var s=i.type;(s!=ze||e.j.has(s))&&(i.Ka=new Us(function(){var a;return B(function(l){if(l.g==1)return fe(l,2),b(l,DS(e,i),4);if(l.g!=2)return we(l,0);a=oe(l),e.g&&e.g.onError(a),Q(l)})}).N(r))}function uo(e){e.Ka!=null&&(e.Ka.stop(),e.Ka=null)}function ym(e){return B(function(i){return e.ta?b(i,e.ta.abort(),0):i.A(0)})}function xm(e,i){return B(function(r){if(r.g==1)return b(r,Dp(e.F),2);Xe(e.h),e.g.onError(i),i.handled||e.i.failureCallback(i),Q(r)})}function vm(e,i){var r=cs(),s=this;this.j=i,this.i=e,this.l=r,this.o=null,this.m=[],this.h=this.g=null,this.u=Promise.resolve().then(function(){return GS(s)}),this.s=new sn(function(){return WS(s)})}vm.prototype.destroy=function(){return this.s.destroy()};function WS(e){var i,r,s;return B(function(a){if(a.g==1)return e.h&&e.h.abort(),wm(e),b(a,e.u,2);for(e.g&&e.g.Ia.mb(),i=y(e.m),r=i.next();!r.done;r=i.next())s=r.value,s.Ia.mb();e.g=null,e.m=[],e.j=null,Q(a)})}function ho(e,i){var r={Jb:function(){},bd:function(){},mb:function(){},onError:function(){},dd:function(){},uh:function(){}};return e.m.push({create:i,Ia:r}),e.h&&e.h.abort(),wm(e),r}function GS(e){return B(function(i){if(e.s.g)i=i.A(0);else{if(e.m.length==0||e.g&&!e.g.hb)var r=!1;else{e.g&&(e.g.Ia.mb(),e.g=null),r=e.m.shift();var s=r.create(e.l);s?(r.Ia.Jb(),e.g={node:s.node,payload:s.payload,hb:s.hb,Ia:r.Ia}):r.Ia.dd(),r=!0}r?r=Promise.resolve():e.g?r=XS(e):(e.j.eg(e.i),e.o=new Ke,r=e.o),i=b(i,r,1)}return i})}function XS(e){var i,r;return B(function(s){switch(s.g){case 1:return e.i=e.j.Mf(e.i,e.l,e.g.node,e.g.payload),fe(s,2),e.h=e.j.yf(e.i,e.l,e.g.payload),b(s,e.h.promise,4);case 4:e.h=null,e.i==e.g.node&&(e.g.Ia.bd(),e.g=null),we(s,0);break;case 2:return i=oe(s),i.code==7001?e.g.Ia.mb():e.g.Ia.onError(i),e.g=null,e.h=null,r=e,b(s,e.j.handleError(e.l,i),5);case 5:r.i=s.h,Q(s)}})}function wm(e){e.o&&(e.o.resolve(),e.o=null)}function Tm(e){var i=[],r=700<=e.fontWeight,s=e.fontStyle=="italic",a=e.textDecoration.includes("underline");return r&&i.push("b"),s&&i.push("i"),a&&i.push("u"),r=i.reduce(function(l,h){return l+"<"+h+">"},""),i=i.reduceRight(function(l,h){return l+"</"+h+">"},""),e.lineBreak?`
`:e.nestedCues.length?e.nestedCues.map(Tm).join(""):r+e.payload+i}function Hh(e,i){e=y(e);for(var r=e.next();!r.done;r=e.next())if(r=r.value,r.isContainer)Hh(r.nestedCues,i);else{var s=r.clone();s.nestedCues=[],s.payload=Tm(r),i.push(s)}return i}function Qt(e){this.g=null;for(var i=y(Array.from(e.textTracks)),r=i.next();!r.done;r=i.next())r=r.value,r.mode="disabled",r.label=="Shaka Player TextTrack"&&(this.g=r);this.g||(this.g=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.g.mode="hidden"}p=Qt.prototype,p.remove=function(e,i){return this.g?(Sm(this.g,function(r){return r.startTime<i&&r.endTime>e}),!0):!1},p.append=function(e){var i=Hh(e,[]),r=[];e=this.g.cues?Array.from(this.g.cues):[];var s={};i=y(i);for(var a=i.next();!a.done;s={sb:s.sb},a=i.next())s.sb=a.value,e.some(function(l){return function(h){return h.startTime==l.sb.startTime&&h.endTime==l.sb.endTime&&h.text==l.sb.payload}}(s))||(a=qS(s.sb))&&r.push(a);for(e=r.slice().sort(function(l,h){return l.startTime!=h.startTime?l.startTime-h.startTime:l.endTime!=h.endTime?l.endTime-h.startTime:"line"in VTTCue.prototype?r.indexOf(h)-r.indexOf(l):r.indexOf(l)-r.indexOf(h)}),e=y(e),s=e.next();!s.done;s=e.next())this.g.addCue(s.value)},p.destroy=function(){return this.g&&(Sm(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},p.isTextVisible=function(){return this.g.mode=="showing"},p.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"};function qS(e){if(e.startTime>=e.endTime)return null;var i=new VTTCue(e.startTime,e.endTime,e.payload);i.lineAlign=e.lineAlign,i.positionAlign=e.positionAlign,e.size&&(i.size=e.size);try{i.align=e.textAlign}catch(r){}return e.textAlign=="center"&&i.align!="center"&&(i.align="middle"),e.writingMode=="vertical-lr"?i.vertical="lr":e.writingMode=="vertical-rl"&&(i.vertical="rl"),e.lineInterpretation==1&&(i.snapToLines=!1),e.line!=null&&(i.line=e.line),e.position!=null&&(i.position=e.position),i}function Sm(e,i){var r=e.mode;e.mode=r=="showing"?"showing":"hidden";for(var s=y(Array.from(e.cues)),a=s.next();!a.done;a=s.next())(a=a.value)&&i(a)&&e.removeCue(a);e.mode=r}ie("shaka.text.SimpleTextDisplayer",Qt),Qt.prototype.setTextVisibility=Qt.prototype.setTextVisibility,Qt.prototype.isTextVisible=Qt.prototype.isTextVisible,Qt.prototype.destroy=Qt.prototype.destroy,Qt.prototype.append=Qt.prototype.append,Qt.prototype.remove=Qt.prototype.remove;function Cm(){}function Ya(e){for(;e.firstChild;)e.removeChild(e.firstChild)}ie("shaka.util.Dom",Cm),Cm.removeAllChildren=Ya;function Jt(e,i){var r=this;this.j=!1,this.i=[],this.B=e,this.m=i,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.m.appendChild(this.g),this.u=new Ee(function(){co(r)}).Ca(.25),this.h=new Map,this.s=new Ye,this.s.C(document,"fullscreenchange",function(){co(r,!0)}),this.l=null,"ResizeObserver"in u&&(this.l=new ResizeObserver(function(){co(r,!0)}),this.l.observe(this.g)),this.o=new Map}p=Jt.prototype,p.append=function(e){var i=[].concat(I(this.i)),r={};e=y(e);for(var s=e.next();!s.done;r={Cc:r.Cc},s=e.next())r.Cc=s.value,i.some(function(a){return function(l){return Un(l,a.Cc)}}(r))||this.i.push(r.Cc);co(this)},p.destroy=function(){this.m.removeChild(this.g),this.g=null,this.j=!1,this.i=[],this.u&&this.u.stop(),this.h.clear(),this.s&&(this.s.release(),this.s=null),this.l&&(this.l.disconnect(),this.l=null)},p.remove=function(e,i){if(!this.g)return!1;var r=this.i.length;return this.i=this.i.filter(function(s){return s.startTime<e||s.endTime>=i}),co(this,r>this.i.length),!0},p.isTextVisible=function(){return this.j},p.setTextVisibility=function(e){this.j=e};function $S(e,i){for(;i!=null;){if(i==e.g)return!0;i=i.parentElement}return!1}function Am(e,i,r,s,a){var l=!1,h=[],d=[];i=y(i);for(var g=i.next();!g.done;g=i.next()){g=g.value,a.push(g);var _=e.h.get(g),x=g.startTime<=s&&g.endTime>s,T=_?_.ef:null;_&&(h.push(_.Bd),_.tc&&h.push(_.tc),x||(l=!0,e.h.delete(g),_=null)),x&&(d.push(g),_?$S(e,T)||(l=!0):(YS(e,g,a),_=e.h.get(g),T=_.ef,l=!0)),0<g.nestedCues.length&&T&&Am(e,g.nestedCues,T,s,a),a.pop()}if(l){for(s=y(h),a=s.next();!a.done;a=s.next())a=a.value,a.parentElement&&a.parentElement.removeChild(a);for(d.sort(function(S,A){return S.startTime!=A.startTime?S.startTime-A.startTime:S.endTime-A.endTime}),d=y(d),g=d.next();!g.done;g=d.next())s=e.h.get(g.value),s.tc?(r.appendChild(s.tc),s.tc.appendChild(s.Bd)):r.appendChild(s.Bd)}}function co(e,i){if(e.g){var r=e.B.currentTime;if(!e.j||i!==void 0&&i){i=y(e.o.values());for(var s=i.next();!s.done;s=i.next())Ya(s.value);Ya(e.g),e.h.clear(),e.o.clear()}if(e.j){i=new Map,s=y(e.h.keys());for(var a=s.next();!a.done;a=s.next())a=a.value,i.set(a,e.h.get(a));Am(e,e.i,e.g,r,[])}}}function YS(e,i,r){var s=1<r.length,a=s?"span":"div";i.lineBreak&&(a="br"),s=!s&&0<i.nestedCues.length;var l=document.createElement(a);if(a!="br"&&KS(e,l,i,r,s),r=null,i.region&&i.region.id)if(r=i.region,a=r.id+"_"+r.width+"x"+r.height+(r.heightUnits==ji?"%":"px")+"-"+r.viewportAnchorX+"x"+r.viewportAnchorY+(r.viewportAnchorUnits==ji?"%":"px"),e.o.has(a))r=e.o.get(a);else{var h=document.createElement("span"),d=r.heightUnits==ji?"%":"px",g=r.widthUnits==ji?"%":"px",_=r.viewportAnchorUnits==ji?"%":"px";h.id="shaka-text-region---"+a,h.classList.add("shaka-text-region"),h.style.height=r.height+d,h.style.width=r.width+g,h.style.position="absolute",h.style.top=r.viewportAnchorY+_,h.style.left=r.viewportAnchorX+_,h.style.display="flex",h.style.flexDirection="column",h.style.alignItems="center",h.style.justifyContent=i.displayAlign=="before"?"flex-start":i.displayAlign=="center"?"center":"flex-end",e.o.set(a,h),r=h}a=l,s&&(a=document.createElement("span"),a.classList.add("shaka-text-wrapper"),a.style.backgroundColor=i.backgroundColor,a.style.lineHeight="normal",l.appendChild(a)),e.h.set(i,{Bd:l,ef:a,tc:r})}function KS(e,i,r,s,a){var l=i.style,h=r.nestedCues.length==0,d=1<s.length;l.whiteSpace="pre-wrap";var g=r.payload.replace(/\s+$/g,function(x){return"".repeat(x.length)});if(l.webkitTextStrokeColor=r.textStrokeColor,l.webkitTextStrokeWidth=r.textStrokeWidth,l.color=r.color,l.direction=r.direction,l.opacity=r.opacity,l.paddingLeft=Vh(r.linePadding,r,e.m),l.paddingRight=Vh(r.linePadding,r,e.m),l.textShadow=r.textShadow,r.backgroundImage)l.backgroundImage="url('"+r.backgroundImage+"')",l.backgroundRepeat="no-repeat",l.backgroundSize="contain",l.backgroundPosition="center",l.width="100%",l.height="100%";else{if(r.nestedCues.length)var _=i;else _=document.createElement("span"),i.appendChild(_);r.border&&(_.style.border=r.border),a||((i=ZS(s,function(x){return x.backgroundColor}))?_.style.backgroundColor=i:g&&(_.style.backgroundColor="rgba(0, 0, 0, 0.8)")),g&&(_.textContent=g)}d&&!s[s.length-1].isContainer?l.display="inline":(l.display="flex",l.flexDirection="column",l.alignItems="center",l.justifyContent=r.displayAlign=="before"?"flex-start":r.displayAlign=="center"?"center":"flex-end"),h||(l.margin="0"),l.fontFamily=r.fontFamily,l.fontWeight=r.fontWeight.toString(),l.fontStyle=r.fontStyle,l.letterSpacing=r.letterSpacing,l.fontSize=Vh(r.fontSize,r,e.m),r.line!=null&&r.lineInterpretation==1&&(l.position="absolute",r.writingMode==ks?(l.width="100%",r.lineAlign==Yr?l.top=r.line+"%":r.lineAlign=="end"&&(l.bottom=100-r.line+"%")):r.writingMode=="vertical-lr"?(l.height="100%",r.lineAlign==Yr?l.left=r.line+"%":r.lineAlign=="end"&&(l.right=100-r.line+"%")):(l.height="100%",r.lineAlign==Yr?l.right=r.line+"%":r.lineAlign=="end"&&(l.left=100-r.line+"%"))),l.lineHeight=r.lineHeight,r.position!=null&&(r.writingMode==ks?l.paddingLeft=r.position:l.paddingTop=r.position),r.positionAlign=="line-left"?l.cssFloat="left":r.positionAlign=="line-right"&&(l.cssFloat="right"),l.textAlign=r.textAlign,l.textDecoration=r.textDecoration.join(" "),l.writingMode=r.writingMode,"writingMode"in document.documentElement.style&&l.writingMode==r.writingMode||(l.webkitWritingMode=r.writingMode),r.size&&(r.writingMode==ks?l.width=r.size+"%":l.height=r.size+"%")}function Vh(e,i,r){var s=(s=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(s[1]),unit:s[2]}:null;if(!s)return e;var a=s.value;switch(s.unit){case"%":return a/100*r.clientHeight/i.cellResolution.rows+"px";case"c":return r.clientHeight*a/i.cellResolution.rows+"px";default:return e}}function ZS(e,i){for(var r=e.length-1;0<=r;r--){var s=i(e[r]);if(s||s===0)return s}return null}ie("shaka.text.UITextDisplayer",Jt),Jt.prototype.setTextVisibility=Jt.prototype.setTextVisibility,Jt.prototype.isTextVisible=Jt.prototype.isTextVisible,Jt.prototype.remove=Jt.prototype.remove,Jt.prototype.destroy=Jt.prototype.destroy,Jt.prototype.append=Jt.prototype.append;function QS(e,i){function r(l){for(var h=l,d=y(i),g=d.next();!g.done;g=d.next())g=g.value,g.end&&g.start<l&&(h+=g.end-g.start);return l=Math.floor(h/3600),d=Math.floor(h/60%60),g=Math.floor(h%60),h=Math.floor(1e3*h%1e3),(10>l?"0":"")+l+":"+(10>d?"0":"")+d+":"+(10>g?"0":"")+g+"."+(100>h?10>h?"00":"0":"")+h}var s=Hh(e,[]);e=`WEBVTT

`,s=y(s);for(var a=s.next();!a.done;a=s.next())a=a.value,e+=r(a.startTime)+" --> "+r(a.endTime)+function(l){var h=[];switch(l.textAlign){case"left":h.push("align:left");break;case"right":h.push("align:right");break;case sr:h.push("align:middle");break;case"start":h.push("align:start");break;case"end":h.push("align:end")}switch(l.writingMode){case"vertical-lr":h.push("vertical:lr");break;case"vertical-rl":h.push("vertical:rl")}return h.length?" "+h.join(" "):""}(a)+`
`,e+=a.payload+`

`;return e}ie("shaka.text.WebVttGenerator",function(){});function JS(e,i){this.h=e,this.g=i,this.j="",this.o=void 0,this.i=!1,this.m=!0,this.l=!1}function Em(e,i,r){try{if(e.g.enabled){var s={d:1e3*r.duration,st:e.h.U()?a1:o1};s.ot=t1(r);var a=s.ot===Za||s.ot===qh||s.ot===Qa||s.ot===Yh;a&&(s.bl=i1(e,r.type)),r.bandwidth&&(s.br=r.bandwidth/1e3),a&&s.ot!==Yh&&(s.tb=r1(e,s.ot)/1e3),Gh(e,i,s)}}catch(l){nr("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",l)}}function e1(e,i,r){try{if(!e.g.enabled)return i;var s=Wh(e);e:{switch(r){case"video/webm":case"video/mp4":var a=Qa;break e;case"application/x-mpegurl":a=bm;break e}a=void 0}s.ot=a,s.su=!0;var l=Ka(s);return Xh(i,l)}catch(h){return nr("CMCD_SRC_ERROR","Could not generate src CMCD data.",h),i}}function Wh(e){return e.j||(e.j=e.g.sessionId||u.crypto.randomUUID()),{v:1,sf:e.o,sid:e.j,cid:e.g.contentId,mtp:e.h.getBandwidthEstimate()/1e3}}function Gh(e,i,r){r=r===void 0?{}:r;var s=s===void 0?e.g.useHeaders:s;if(e.g.enabled){Object.assign(r,Wh(e)),r.pr=e.h.Rc();var a=r.ot===Za||r.ot===Qa;if(e.l&&a&&(r.bs=!0,r.su=!0,e.l=!1),r.su==null&&(r.su=e.m),s)e=n1(r),Object.keys(e).length&&Object.assign(i.headers,e);else{var l=Ka(r);l&&(i.uris=i.uris.map(function(h){return Xh(h,l)}))}}}function t1(e){var i=e.type;if(e.init)return s1;if(i=="video")return e.codecs.includes(",")?Qa:Za;if(i=="audio")return qh;if(i=="text")return e.mimeType==="application/mp4"?Yh:$h}function i1(e,i){if(i=e.h.Na()[i],!i.length)return NaN;var r=e.h.getCurrentTime();return(e=i.find(function(s){return s.start<=r&&s.end>=r}))?1e3*(e.end-r):NaN}function r1(e,i){var r=e.h.Xa();if(!r.length)return NaN;e=r[0],r=y(r);for(var s=r.next();!s.done;s=r.next())s=s.value,s.type==="variant"&&s.bandwidth>e.bandwidth&&(e=s);switch(i){case Za:return e.videoBandwidth||NaN;case qh:return e.audioBandwidth||NaN;default:return e.bandwidth}}function Ka(e){function i(T){return 100*r(T/100)}function r(T){return Math.round(T)}function s(T){return!Number.isNaN(T)&&T!=null&&T!==""&&T!==!1}var a=[],l={br:r,d:r,bl:i,dl:i,mtp:i,nor:function(T){return encodeURIComponent(T)},rtp:i,tb:r},h=Object.keys(e||{}).sort();h=y(h);for(var d=h.next();!d.done;d=h.next()){d=d.value;var g=e[d];if(s(g)&&(d!=="v"||g!==1)&&(d!="pr"||g!==1)){var _=l[d];_&&(g=_(g)),_=typeof g;var x=void 0;x=_==="string"&&d!=="ot"&&d!=="sf"&&d!=="st"?d+"="+JSON.stringify(g):_==="boolean"?d:_==="symbol"?d+"="+g.description:d+"="+g,a.push(x)}}return a.join(",")}function n1(e){var i=Object.keys(e),r={},s=["Object","Request","Session","Status"],a=[{},{},{},{}],l={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};i=y(i);for(var h=i.next();!h.done;h=i.next())h=h.value,a[l[h]!=null?l[h]:1][h]=e[h];for(e=0;e<a.length;e++)(l=Ka(a[e]))&&(r["CMCD-"+s[e]]=l);return r}function Xh(e,i){return!i||e.includes("offline:")?e:(e=new Zt(e),e.g.set("CMCD",i),e.toString())}var bm="m",qh="a",Za="v",Qa="av",s1="i",$h="c",Yh="tt",o1="v",a1="l";ie("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",dh:"s",Yg:"o"});function Kh(){}function Zh(e,i,r,s,a){var l=a in s,h=!0,d;for(d in i){var g=a+"."+d,_=l?s[a]:r[d];l||d in r?i[d]===void 0?_===void 0||l?delete e[d]:e[d]=Qn(_):_.constructor==Object&&i[d]&&i[d].constructor==Object?(e[d]||(e[d]=Qn(_)),g=Zh(e[d],i[d],_,s,g),h=h&&g):typeof i[d]!=typeof _||i[d]==null||typeof i[d]!="function"&&i[d].constructor!=_.constructor?(Kt("Invalid config, wrong type for "+g),h=!1):(typeof r[d]=="function"&&r[d].length!=i[d].length&&Ve("Unexpected number of arguments for "+g),e[d]=i[d]):(Kt("Invalid config, unrecognized key "+g),h=!1)}return h}function Qh(e,i){for(var r={},s=r,a=0,l=0;a=e.indexOf(".",a),!(0>a);)(a==0||e[a-1]!="\\")&&(l=e.substring(l,a).replace(/\\\./g,"."),s[l]={},s=s[l],l=a+1),a+=1;return s[e.substring(l).replace(/\\\./g,".")]=i,r}function Jh(e,i){return e&&i}ie("shaka.util.ConfigUtils",Kh),Kh.convertToConfigObject=Qh,Kh.mergeConfigObjects=Zh;function Li(){}function Im(e){return e=Jr(e),new Zt(e).Ha}function fo(e,i,r){function s(d){Wt(l).setUint32(h,d.byteLength,!0),h+=4,l.set(Ie(d),h),h+=d.byteLength}if(!r||!r.byteLength)throw new F(2,6,6015);var a;typeof i=="string"?a=$u(i,!0):a=i,e=Jr(e),e=$u(e,!0);var l=new Uint8Array(12+e.byteLength+a.byteLength+r.byteLength),h=0;return s(e),s(a),s(r),l}ie("shaka.util.FairPlayUtils",Li),Li.commonFairPlayResponse=function(e,i){if(e===2){try{var r=at(i.data)}catch(a){return}e=!1,r=r.trim(),r.substr(0,5)==="<ckc>"&&r.substr(-6)==="</ckc>"&&(r=r.slice(5,-6),e=!0);try{var s=JSON.parse(r);s.ckc&&(r=s.ckc,e=!0),s.CkcMessage&&(r=s.CkcMessage,e=!0),s.License&&(r=s.License,e=!0)}catch(a){}e&&(i.data=ui(or(r)))}},Li.conaxFairPlayRequest=function(e,i){e===2&&(i.headers["Content-Type"]="application/octet-stream")},Li.ezdrmFairPlayRequest=function(e,i){e===2&&(i.headers["Content-Type"]="application/octet-stream")},Li.verimatrixFairPlayRequest=function(e,i){e===2&&(e=Ie(i.body),e=en(e),i.headers["Content-Type"]="application/x-www-form-urlencoded",i.body=Mr("spc="+e))},Li.conaxInitDataTransform=function(e,i,r){if(i!=="skd")return e;i=r.serverCertificate,r=Jr(e).split("skd://").pop().split("?").shift(),r=u.atob(r);var s=new ArrayBuffer(2*r.length);s=new Uint16Array(s);for(var a=0,l=r.length;a<l;a++)s[a]=r.charCodeAt(a);return fo(e,s,i)},Li.ezdrmInitDataTransform=function(e,i,r){return i!=="skd"?e:(i=r.serverCertificate,r=Jr(e).split(";").pop(),fo(e,r,i))},Li.verimatrixInitDataTransform=function(e,i,r){return i!=="skd"?e:(i=r.serverCertificate,r=Jr(e).split("skd://").pop(),fo(e,r,i))},Li.initDataTransform=fo,Li.defaultGetContentId=Im,Li.isFairPlaySupported=function(){var e;return B(function(i){return i.g==1?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},fe(i,2),b(i,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):i.g!=2?i.return(!0):(oe(i),i.return(!1))})};function ec(){}function as(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var i={retryParameters:Kn(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:function(h,d,g){return g.keySystem=="com.apple.fps.1_0"&&d=="skd"&&(d=g.serverCertificate,g=Im(h),h=fo(h,g,d)),h},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:zs()},r={retryParameters:Kn(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(h){return Jh([h],h)},sequenceMode:!1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3}},s={retryParameters:Kn(),failureCallback:function(h){return Jh([h])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,durationBackoff:1,forceTransmux:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1};(tt("Web0S")||Wn()||tt("CrKey"))&&(s.stallSkip=0);var a={trackSelectionCallback:function(h){return B(function(d){return d.return(h)})},downloadSizeCallback:function(h){var d;return B(function(g){return g.g==1?navigator.storage&&navigator.storage.estimate?b(g,navigator.storage.estimate(),3):g.return(!0):(d=g.h,g.return(d.usage+h<.95*d.quota))})},progressCallback:function(h,d){return Jh([h,d])},usePersistentLicense:!0,numberOfParallelDownloads:5},l={drm:i,manifest:r,streaming:s,mediaSource:{sourceBufferExtraFeatures:""},offline:a,abrFactory:function(){return new lt},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1},autoShowText:3,preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1}};return a.trackSelectionCallback=function(h){return B(function(d){return d.return(l1(h,l.preferredAudioLanguage))})},l}function ls(e,i,r){var s={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return Zh(e,i,r||as(),s,"")}function l1(e,i){var r=e.filter(function(h){return h.type=="variant"}),s=[],a=pa(i,r.map(function(h){return h.language}));a&&(s=r.filter(function(h){return De(h.language)==a})),s.length==0&&(s=r.filter(function(h){return h.primary})),s.length==0&&(r.map(function(h){return h.language}),s=r);var l=s.filter(function(h){return h.height&&480>=h.height});for(l.length&&(l.sort(function(h,d){return d.height-h.height}),s=l.filter(function(h){return h.height==l[0].height})),i=[],s.length&&(r=Math.floor(s.length/2),s.sort(function(h,d){return h.bandwidth-d.bandwidth}),i.push(s[r])),e=y(e),s=e.next();!s.done;s=e.next())s=s.value,s.type!=ze&&s.type!="image"||i.push(s);return i}ie("shaka.util.PlayerConfiguration",ec),ec.mergeConfigObjects=ls,ec.createDefault=as;function u1(){this.g=null,this.h=[]}function Ja(e,i){if(e.g==null)e.g={timestamp:Date.now()/1e3,state:i,duration:0};else{var r=Date.now()/1e3;e.g.duration=r-e.g.timestamp,e.g.state!=i&&(e.h.push(e.g),e.g={timestamp:r,state:i,duration:0})}}function tc(e,i){var r=0;e.g&&e.g.state==i&&(r+=e.g.duration),e=y(e.h);for(var s=e.next();!s.done;s=e.next())s=s.value,r+=s.state==i?s.duration:0;return r}function h1(e){function i(l){return{timestamp:l.timestamp,state:l.state,duration:l.duration}}for(var r=[],s=y(e.h),a=s.next();!a.done;a=s.next())r.push(i(a.value));return e.g&&r.push(i(e.g)),r}function c1(){this.i=this.h=null,this.g=[]}function ic(e,i,r){e.i!=i&&(e.i=i,e.g.push({timestamp:Date.now()/1e3,id:i.id,type:"text",fromAdaptation:r,bandwidth:null}))}function Rm(){this.u=this.B=this.G=this.D=this.s=this.j=this.F=this.m=this.i=this.M=this.O=this.H=this.J=this.L=this.l=this.o=NaN,this.g=new u1,this.h=new c1}function W(e,i){Oe.call(this);var r=this;this.l=dc,this.Uc=this.g=null,this.ca=!1,this.Xc=new Ye,this.Xb=new Ye,this.s=new Ye,this.Nb=this.i=this.Yc=this.J=this.j=this.ua=this.L=this.cf=this.V=this.Fa=this.M=this.Vc=this.H=this.xb=this.B=this.G=this.m=this.D=null,this.dc=!1,this.Nd=this.u=null,this.Yd=1e9,this.h=us(this),this.ec={width:1/0,height:1/0},this.o=null,this.ub=new $n(this.h.preferredAudioLanguage,this.h.preferredVariantRole,this.h.preferredAudioChannelCount),this.vb=this.h.preferredTextLanguage,this.cc=this.h.preferredTextRole,this.$b=this.h.preferForcedSubs,this.Zb=[],this.fc=null,i&&i(this),this.D=E1(this),this.D.je(this.h.streaming.forceHTTPS),this.F=null,sl&&(this.F=sl()),this.Xc.C(u,"online",function(){r.ce()}),this.O={name:"detach"},this.W={name:"attach"},this.ea={name:"unload"},this.Zd={name:"manifest-parser"},this.Xd={name:"manifest"},this.wb={name:"media-source"},this.Qd={name:"drm-engine"},this.ba={name:"load"},this.de={name:"src-equals-drm-engine"},this.yb={name:"src-equals"};var s=new Map;s.set(this.W,function(a,l){return Vi(p1(r,a,l))}),s.set(this.O,function(a){return a.mediaElement&&(r.Xb.nb(),a.mediaElement=null),r.F&&r.F.release(),r.g=null,a=Promise.resolve(),Vi(a)}),s.set(this.ea,function(a){return Vi(Lm(r,a))}),s.set(this.wb,function(a){return a=g1(r,a),Vi(a)}),s.set(this.Zd,function(a,l){return a=m1(r,a,l),Vi(a)}),s.set(this.Xd,function(a){return _1(r,a)}),s.set(this.Qd,function(a){return a=y1(r,a),Vi(a)}),s.set(this.ba,function(a,l){return Vi(x1(r,a,l))}),s.set(this.de,function(a,l){return a=v1(r,a,l),Vi(a)}),s.set(this.yb,function(a,l){return w1(r,a,l)}),this.Ga=new vm(this.O,{Mf:function(a,l,h,d){var g=null;return a==r.O&&(g=h==r.O?r.O:r.W),a==r.W&&(g=h==r.O||l.mediaElement!=d.mediaElement?r.O:h==r.W?r.W:h==r.wb||h==r.ba?r.wb:h==r.yb?r.de:null),a==r.wb&&(g=h==r.ba&&l.mediaElement==d.mediaElement?r.Zd:r.ea),a==r.Zd&&(g=hc(r.ba,r.Xd,r.ea,h,l,d)),a==r.Xd&&(g=hc(r.ba,r.Qd,r.ea,h,l,d)),a==r.Qd&&(g=hc(r.ba,r.ba,r.ea,h,l,d)),a==r.de&&(g=h==r.yb&&l.mediaElement==d.mediaElement?r.yb:r.ea),(a==r.ba||a==r.yb)&&(g=r.ea),a==r.ea&&(g=d.mediaElement&&l.mediaElement==d.mediaElement?r.W:r.O),g},yf:function(a,l,h){return r.dispatchEvent(dt("onstatechange",new Map().set("state",a.name))),s.get(a)(l,h)},handleError:function(a){return B(function(l){return l.g==1?b(l,Lm(r,a),2):l.return(a.mediaElement?r.W:r.O)})},eg:function(a){r.dispatchEvent(dt("onstateidle",new Map().set("state",a.name)))}}),this.af=new Ee(function(){th(r.i.variants,r.h.restrictions,r.ec)&&il(r)}),e&&this.Yb(e,!0)}he(W,Oe);function el(e){e.L!=null&&(e.L.release(),e.L=null)}function d1(e,i){if(i.lcevc.enabled){var r=e.Xa();r&&r[0]&&r[0].videoMimeType==ol.ts&&(Gu()||navigator.userAgent.match(/Edge\//))&&(i.streaming.forceTransmux||Ve("LCEVC Warning: For MPEG-2 TS decoding the config.streaming.forceTransmux must be enabled.")),el(e),e.L==null&&(e.L=new no(e.g,e.cf,i.lcevc),e.G&&(e.G.D=e.L))}else el(e)}function dt(e,i){return new ye(e,i)}p=W.prototype,p.destroy=function(){var e=this,i;return B(function(r){switch(r.g){case 1:return e.l==Mi?r.return():(el(e),e.l=Mi,i=ho(e.Ga,function(){return{node:e.O,payload:cs(),hb:!1}}),b(r,new Promise(function(s){i.Jb=function(){},i.bd=function(){s()},i.mb=function(){s()},i.onError=function(){s()},i.dd=function(){s()}}),2));case 2:return b(r,e.Ga.destroy(),3);case 3:if(e.Xc&&(e.Xc.release(),e.Xc=null),e.Xb&&(e.Xb.release(),e.Xb=null),e.s&&(e.s.release(),e.s=null),e.Nd=null,e.u=null,e.h=null,e.o=null,e.Uc=null,e.V=null,!e.D){r.A(4);break}return b(r,e.D.destroy(),5);case 5:e.D=null;case 4:Oe.prototype.release.call(e),Q(r)}})},p.Yb=function(e,i){if(i=i===void 0?!0:i,this.l==Mi)return Promise.reject(pn());var r=cs();r.mediaElement=e,Ii()||(i=!1);var s=i?this.wb:this.W;return e=ho(this.Ga,function(){return{node:s,payload:r,hb:!1}}),e.Jb=function(){},cc(e)},p.lf=function(e){this.cf=e},p.detach=function(){var e=this;if(this.l==Mi)return Promise.reject(pn());var i=ho(this.Ga,function(){return{node:e.O,payload:cs(),hb:!1}});return i.Jb=function(){},cc(i)},p.re=function(e){var i=this;if(e=e===void 0?!0:e,this.l==Mi)return Promise.reject(pn());this.dc=!1,Ii()||(e=!1),el(this);var r=cs(),s=ho(this.Ga,function(a){var l=a.mediaElement&&e?i.wb:a.mediaElement?i.W:i.O;return r.mediaElement=a.mediaElement,{node:l,payload:r,hb:!1}});return s.Jb=function(){},cc(s)},p.Fg=function(e){this.fc=e},p.load=function(e,i,r){var s=this;if(this.fc=null,this.dc=!1,this.l==Mi)return Promise.reject(pn());this.dispatchEvent(dt("loading"));var a=cs();a.uri=e,a.ne=Date.now()/1e3,r&&(a.mimeType=r),i!==void 0&&(a.startTime=i);var l=f1(this,a)?this.yb:this.ba,h=ho(this.Ga,function(d){return d.mediaElement==null?null:(a.mediaElement=d.mediaElement,{node:l,payload:a,hb:!0})});return this.o=new Rm,this.V=L1(this),h.Jb=function(){},new Promise(function(d,g){h.dd=function(){return g(new F(2,7,7002))},h.bd=function(){d(),s.dispatchEvent(dt("loaded"))},h.mb=function(){return g(pn())},h.onError=function(_){return g(_)}})};function f1(e,i){if(!Ii())return!0;var r=i.mimeType,s=i.uri||"";if(r||(r=ts(s),r=ol[r]),r){if((i.mediaElement||rp()).canPlayType(r)=="")return!1;if(!Ii()||!(r in di||ts(s)in an)||e.h.streaming.preferNativeHls)return!0;if(la())return e.h.streaming.useNativeHlsOnSafari}return!1}function p1(e,i,r){return i.mediaElement==null&&(i.mediaElement=r.mediaElement,e.Xb.C(i.mediaElement,"error",function(){var s=uc(e);s&&fn(e,s)})),e.g=i.mediaElement,Promise.resolve()}function Lm(e,i){var r,s,a,l,h,d,g,_,x;return B(function(T){switch(T.g){case 1:return e.l!=Mi&&(e.l=dc),r=e.Zb.map(function(S){return S()}),e.Zb=[],b(T,Promise.all(r),2);case 2:if(e.dispatchEvent(dt("unloading")),i.mimeType=null,i.startTime=null,i.uri=null,e.Fa&&(e.Fa.release(),e.Fa=null),i.mediaElement&&e.s.nb(),e.af.stop(),e.xb&&(e.xb.release(),e.xb=null),e.Vc&&(e.Vc.stop(),e.Vc=null),!e.J){T.A(3);break}return b(T,e.J.stop(),4);case 4:e.J=null,e.Yc=null;case 3:if(!e.u){T.A(5);break}return b(T,e.u.stop(),5);case 5:if(!e.j){T.A(7);break}return b(T,e.j.destroy(),8);case 8:e.j=null;case 7:if(e.H&&(e.H.release(),e.H=null),e.B&&(e.B.release(),e.B=null),!e.G){T.A(9);break}return b(T,e.G.destroy(),10);case 10:e.G=null;case 9:if(e.F&&e.F.onAssetUnload(),!i.mediaElement||!i.mediaElement.src){T.A(11);break}return b(T,new Promise(function(S){return new Ee(S).N(.1)}),12);case 12:for(i.mediaElement.removeAttribute("src"),i.mediaElement.load();i.mediaElement.lastChild;)i.mediaElement.removeChild(i.mediaElement.firstChild);case 11:if(!e.m){T.A(13);break}return b(T,e.m.destroy(),14);case 14:e.m=null;case 13:if(e.Nb=null,e.M=null,e.i){for(s=y(e.i.variants),a=s.next();!a.done;a=s.next())for(l=a.value,h=y([l.audio,l.video]),d=h.next();!d.done;d=h.next())(g=d.value)&&g.segmentIndex&&g.segmentIndex.release();for(_=y(e.i.textStreams),d=_.next();!d.done;d=_.next())x=d.value,x.segmentIndex&&x.segmentIndex.release()}e.i=null,e.o=new Rm,e.Ud=null,ac(e),Q(T)}})}function g1(e,i){var r,s,a,l,h;return B(function(d){if(d.g==1)return r=e.h.textDisplayFactory,s=r(),e.Ud=r,a=R1(i.mediaElement,s,function(g,_,x){Mm(e,g,_,x)},e.L),a.configure(e.h.mediaSource),l=e.h.manifest,h=l.segmentRelativeVttTiming,a.H=h,b(d,a.J,2);e.G=a,Q(d)})}function m1(e,i,r){var s,a,l,h;return B(function(d){if(d.g==1)return i.mimeType=r.mimeType,i.uri=r.uri,s=i.uri,a=e.D,e.Nb=s,l=e,b(d,dg(s,a,e.h.manifest.retryParameters,i.mimeType),2);l.Yc=d.h,e.J=e.Yc(),h=Qn(e.h.manifest),r.mediaElement&&r.mediaElement.nodeName==="AUDIO"&&(h.disableVideo=!0),e.J.configure(h),Q(d)})}function _1(e,i){var r=i.uri;i=e.D,e.Fa=new Fh(function(){return e.uc()}),e.Fa.addEventListener("regionadd",function(l){l=l.region,_o(e,"timelineregionadded",l),e.F&&e.F.onDashTimedMetadata(l)}),e.ua=null,e.h.streaming.observeQualityChanges&&(e.ua=new Xa(function(){return e.Na()}),e.ua.addEventListener("qualitychange",function(l){var h=l.quality;l=l.position,h=new Map().set("mediaQuality",{bandwidth:h.bandwidth,audioSamplingRate:h.audioSamplingRate,codecs:h.codecs,contentType:h.contentType,frameRate:h.frameRate,height:h.height,mimeType:h.mimeType,channelsCount:h.channelsCount,pixelAspectRatio:h.pixelAspectRatio,width:h.width}).set("position",l),e.dispatchEvent(dt("mediaqualitychanged",h))}));var s={networkingEngine:i,modifyManifestRequest:function(l,h){var d=e.V;try{d.g.enabled&&(d.o=h.format,Gh(d,l,{ot:bm,su:!d.i}))}catch(g){nr("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",g)}},modifySegmentRequest:function(l,h){Em(e.V,l,h)},filter:function(l){return Bm(e,l)},makeTextStreamsForClosedCaptions:function(l){return k1(e,l)},onTimelineRegionAdded:function(l){var h=e.Fa;e:{for(var d=y(h.g),g=d.next();!g.done;g=d.next())if(g=g.value,g.schemeIdUri==l.schemeIdUri&&g.id==l.id&&g.startTime==l.startTime&&g.endTime==l.endTime){d=g;break e}d=null}d==null&&(h.g.add(l),l=new ye("regionadd",new Map([["region",l]])),h.dispatchEvent(l))},onEvent:function(l){return e.dispatchEvent(l)},onError:function(l){return fn(e,l)},isLowLatencyMode:function(){return e.h.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return e.h.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){e.configure("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&e.j.updateDuration()},newDrmInfo:function(l){var h=e.m?e.m.g:null;h&&e.m.u&&oc(e,h.keySystem,l)}},a=Date.now()/1e3;return new it(function(){var l,h,d,g;return B(function(_){if(_.g==1)return l=e,b(_,e.J.start(r,s),2);if(l.i=_.h,h=dt("manifestparsed"),e.dispatchEvent(h),e.i.variants.length==0)throw new F(2,4,4036);A1(e.i),d=Date.now()/1e3,g=d-a,e.o.F=g,Q(_)})}(),function(){return e.J.stop()})}function y1(e,i){var r,s;return B(function(a){return a.g==1?(r=Date.now()/1e3,s=!0,e.m=Om(e,{kb:e.D,onError:function(l){fn(e,l)},cd:function(l){qm(e,l)},onExpirationUpdated:function(l,h){$m(e,l,h)},onEvent:function(l){e.dispatchEvent(l),l.type=="drmsessionupdate"&&s&&(s=!1,e.o.j=Date.now()/1e3-r,e.L&&(l=e.L,l.g&&l.h.classList.add("shaka-hidden")))}}),e.m.configure(e.h.drm),b(a,eg(e.m,e.i.variants,e.i.offlineSessionIds),2)):a.g!=3?b(a,e.m.Yb(i.mediaElement),3):b(a,Bm(e,e.i),0)})}function x1(e,i,r){var s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D;return B(function(N){switch(N.g){case 1:for(i.startTime=r.startTime,e.fc!=null&&(i.startTime=e.fc,e.fc=null),s=i.mediaElement,a=i.uri,e.Nb=a,e.H=new oo({Tc:function(){return s.playbackRate},Pc:function(){return s.defaultPlaybackRate},le:function(j){s.playbackRate=j},Me:function(j){s.currentTime+=j}}),l=function(){return tl(e)},h=function(){return Hm(e)},e.s.C(s,"playing",l),e.s.C(s,"pause",l),e.s.C(s,"ended",l),e.s.C(s,"ratechange",h),d1(e,e.h),d=e.h.abrFactory,e.u&&e.Nd==d||(e.Nd=d,e.u=d(),typeof e.u.setMediaElement!="function"&&(Ip("AbrManager","Please use an AbrManager with setMediaElement function."),e.u.setMediaElement=function(){}),e.u.configure(e.h.abr)),e.ub=new $n(e.h.preferredAudioLanguage,e.h.preferredVariantRole,e.h.preferredAudioChannelCount),e.vb=e.h.preferredTextLanguage,e.cc=e.h.preferredTextRole,e.$b=e.h.preferForcedSubs,Ym(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd),e.u.init(function(j,V,G){e.j&&j!=e.j.l&&mo(e,j,!0,V===void 0?!1:V,G===void 0?0:G)}),e.u.setMediaElement(s),gp(e.i,e.h.preferredVideoCodecs,e.h.preferredAudioCodecs,e.h.preferredAudioChannelCount,e.h.preferredDecodingAttributes),e.j=M1(e),e.j.configure(e.h.streaming),e.l=ei,s.textTracks&&e.s.C(s.textTracks,"addtrack",function(j){if(j.track)switch(j=j.track,j.kind){case"chapters":km(e,j)}}),e.dispatchEvent(dt("streaming")),g=null,(_=e.j.l)||(g=il(e)),x=[],T=_||g,S=y([T.video,T.audio]),A=S.next();!A.done;A=S.next())(M=A.value)&&!M.segmentIndex&&x.push(M.createSegmentIndex());if(!(0<x.length)){N.A(2);break}return b(N,Promise.all(x),2);case 2:if(e.B=b1(e,i.startTime),e.xb=I1(e),O=Math.max(e.i.minBufferTime,e.h.streaming.rebufferingGoal),Dm(e,O),_){N.A(4);break}if(mo(e,g,!0,!1,0),!e.h.streaming.startAtSegmentBoundary){N.A(5);break}return P=e.B.Ic(),b(N,D1(g,P),6);case 6:k=N.h,e.B.zd(k);case 5:Vm(e,null,rn(g));case 4:return e.B.yd(),z=e.Fb().find(function(j){return j.active}),z||((D=sh(e.i.textStreams,e.vb,e.cc,e.$b)[0]||null)&&ic(e.o.h,D,!0),g&&(D?(g.audio&&F1(e,g.audio,D)&&(e.ca=!0),e.ca&&e.G.m.setTextVisibility(!0),Gm(e)):e.ca=!1),D&&(e.h.streaming.alwaysStreamText||e.Hd())&&$a(e.j,D)),b(N,e.j.start(),7);case 7:e.h.abr.enabled&&(e.u.enable(),Xm(e)),xp(e.j?e.j.l:null,e.i),Zm(e.i),gi(e),go(e),e.i.variants.some(function(j){return j.primary}),e.dc=!0,e.s.ma(s,"loadedmetadata",function(){e.o.m=Date.now()/1e3-r.ne}),Q(N)}})}function v1(e,i,r){var s,a,l,h,d,g,_;return B(function(x){return x.g==1?(s=Mt,a=Date.now()/1e3,l=!0,e.m=Om(e,{kb:e.D,onError:function(T){fn(e,T)},cd:function(T){qm(e,T)},onExpirationUpdated:function(T,S){$m(e,T,S)},onEvent:function(T){e.dispatchEvent(T),T.type=="drmsessionupdate"&&l&&(l=!1,e.o.j=Date.now()/1e3-a)}}),e.m.configure(e.h.drm),h=r.uri||"",d=ts(h),g=ol[d],g=="application/x-mpegurl"&&la()&&(g="application/vnd.apple.mpegurl"),g||(g="video/mp4"),_={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:r.mimeType?r.mimeType.split(";")[0]:g,codecs:r.mimeType?hp(r.mimeType):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",label:null,type:s.va,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},e.m.V=!0,b(x,eg(e.m,[_],[]),2)):b(x,e.m.Yb(i.mediaElement),0)})}function w1(e,i,r){function s(){return tl(e)}i.uri=r.uri,i.startTime=r.startTime,e.Nb=i.uri;var a=i.mediaElement;e.B=new om(a);var l=!1;e.Zb.push(function(){l=!0}),i.startTime!=null&&e.B.zd(i.startTime),e.H=new oo({Tc:function(){return a.playbackRate},Pc:function(){return a.defaultPlaybackRate},le:function(g){a.playbackRate=g},Me:function(g){a.currentTime+=g}}),Dm(e,e.h.streaming.rebufferingGoal),e.s.C(a,"playing",s),e.s.C(a,"pause",s),e.s.C(a,"ended",s),e.s.C(a,"ratechange",function(){return Hm(e)}),a.preload!="none"&&e.s.ma(a,"loadedmetadata",function(){e.o.m=Date.now()/1e3-r.ne}),a.audioTracks&&(e.s.C(a.audioTracks,"addtrack",function(){return gi(e)}),e.s.C(a.audioTracks,"removetrack",function(){return gi(e)}),e.s.C(a.audioTracks,"change",function(){return gi(e)})),a.textTracks&&(e.s.C(a.textTracks,"addtrack",function(g){if(g.track)switch(g=g.track,g.kind){case"metadata":C1(e,g);break;case"chapters":km(e,g);break;default:gi(e)}}),e.s.C(a.textTracks,"removetrack",function(){return gi(e)}),e.s.C(a.textTracks,"change",function(){return gi(e)}));var h=ts(i.uri);a.src=e1(e.V,i.uri,ol[h]),(Wn()||tt("Web0S"))&&a.load(),e.l=mi,e.dispatchEvent(dt("streaming"));var d=new Ke;return ns(a,HTMLMediaElement.HAVE_METADATA,e.s,function(){e.B.yd(),d.resolve()}),ns(a,HTMLMediaElement.HAVE_CURRENT_DATA,e.s,function(){var g;return B(function(_){if(_.g==1)return T1(e),g=po(e),g.find(function(x){return x.mode!="disabled"})?(0<g.length&&(e.ca=!0),_.A(2)):b(_,new Promise(function(x){e.s.ma(a.textTracks,"change",x),new Ee(x).N(1)}),2);if(l)return _.return();S1(e),Q(_)})}),a.error?d.reject(uc(e)):a.preload=="none"&&(Ve('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),d.resolve()),e.s.ma(a,"error",function(){d.reject(uc(e))}),new it(d,function(){return d.reject(new F(2,7,7001)),Promise.resolve()}).Y(function(){e.dc=!0})}function T1(e){var i=e.h.preferredAudioLanguage;if(i!=""){e.ge(i);var r=e.h.preferredVariantRole;r!=""&&e.ge(i,r)}}function S1(e){var i=e.h.preferredTextLanguage,r=e.h.preferForcedSubs;if(i!=""){e.he(i,"",r);var s=e.h.preferredTextRole;s!=""&&e.he(i,s,r)}}function C1(e,i){if(i.kind=="metadata"){i.mode="hidden",e.s.C(i,"cuechange",function(){if(i.activeCues)for(var s=y(i.activeCues),a=s.next();!a.done;a=s.next())a=a.value,Pm(e,a.startTime,a.endTime,a.type,a.value),e.F&&e.F.onCueMetadataChange(a.value)});var r=new Ee(function(){var s=P1(e);s=y(s);for(var a=s.next();!a.done;a=s.next())a.value.mode="hidden"}).Mb().N(.5);e.Zb.push(function(){r.stop()})}}function Mm(e,i,r,s){i=y(i);for(var a=i.next();!a.done;a=i.next())if(a=a.value,a.data&&a.cueTime&&a.frames){var l=a.cueTime+r,h=s;h&&l>h&&(h=l);for(var d=y(a.frames),g=d.next();!g.done;g=d.next())Pm(e,l,h,"org.id3",g.value);e.F&&e.F.onHlsTimedMetadata(a,l)}}function Pm(e,i,r,s,a){i=new Map().set("startTime",i).set("endTime",r).set("metadataType",s).set("payload",a),e.dispatchEvent(dt("metadata",i))}function km(e,i){if(i&&i.kind=="chapters"){i.mode="hidden";var r=new Ee(function(){i.mode="hidden"}).Mb().N(.5);e.Zb.push(function(){r.stop()})}}function A1(e){function i(r){return r.video&&r.audio||r.video&&r.video.codecs.includes(",")}e.variants.some(i)&&(e.variants=e.variants.filter(i))}function Om(e,i){return new Ma(i,e.h.drm.updateExpirationTime)}function E1(e){return new Ge(function(i,r){e.u&&e.u.segmentDownloaded(i,r)},function(i,r,s){i=new Map().set("headers",i).set("request",r).set("requestType",s),e.dispatchEvent(dt("downloadheadersreceived",i))},function(i,r,s,a){i=new Map().set("request",i).set("error",r).set("httpResponseCode",s).set("aborted",a),e.dispatchEvent(dt("downloadfailed",i))})}function b1(e,i){return new am(e.g,e.i,e.h.streaming,i,function(){e.xb&&fm(e.xb,!0),e.j&&e.j.vc(),e.M&&rc(e)},function(r){return e.dispatchEvent(r)})}function I1(e){var i=new qa(e.Fa);i.addEventListener("enter",function(s){_o(e,"timelineregionenter",s.region)}),i.addEventListener("exit",function(s){_o(e,"timelineregionexit",s.region)}),i.addEventListener("skip",function(s){var a=s.region;s.seeking||(_o(e,"timelineregionenter",a),_o(e,"timelineregionexit",a))});var r=new dm(e.g);return r.g.add(i),e.ua&&r.g.add(e.ua),r}function Dm(e,i){e.M=new nT,e.M.g=Yn,kp(e.M,i,Math.min(.5,i/2)),ac(e),e.Vc=new Ee(function(){rc(e)}).Ca(.25)}function rc(e){switch(e.l){case mi:if(e.g.ended)var i=!0;else{var r=Ah(e.g.buffered);i=r!=null&&r>=e.g.duration-1}break;case ei:e:if(e.g.ended||Gg(e.G))i=!0;else{if(e.i.presentationTimeline.U()){r=e.i.presentationTimeline.gb();var s=Ah(e.g.buffered);if(s!=null&&s>=r){i=!0;break e}}i=!1}break;default:i=!1}s=zg(e.g.buffered,e.g.currentTime),r=e.M;var a=i,l=r.h.get(r.g);i=r.g,s=a||s>=l?va:Yn,r.g=s,i!=s&&ac(e)}function R1(e,i,r,s){return new Wg(e,i,r,s)}function L1(e){return new JS({getBandwidthEstimate:function(){return e.u?e.u.getBandwidthEstimate():NaN},Na:function(){return e.Na()},getCurrentTime:function(){return e.g?e.g.currentTime:0},Xa:function(){return e.Xa()},Rc:function(){return e.Rc()},U:function(){return e.U()}},e.h.cmcd)}function M1(e){return new pm(e.i,{Sc:function(){return e.B?e.B.Ic():0},getBandwidthEstimate:function(){return e.u.getBandwidthEstimate()},modifySegmentRequest:function(i,r){Em(e.V,i,r)},R:e.G,kb:e.D,onError:function(i){return fn(e,i)},onEvent:function(i){return e.dispatchEvent(i)},gg:function(){e.J&&e.J.update&&e.J.update()},Wd:function(i,r,s){e.B&&e.B.Ne(),rc(e),i=new Map().set("start",i).set("end",r).set("contentType",s),e.dispatchEvent(dt("segmentappended",i))},fg:function(i,r){(r=r.Od)&&e.ua&&bS(e.ua,r,i)},xe:function(i,r){var s=e.m;if(s.h.parseInbandPsshEnabled&&["audio","video"].includes(i)){r=new Yp(Ie(r));var a=0,l=y(r.data);for(i=l.next();!i.done;i=l.next())a+=i.value.length;if(a==0)s=Promise.resolve();else{for(a=new Uint8Array(a),l=0,r=y(r.data),i=r.next();!i.done;i=r.next())i=i.value,a.set(i,l),l+=i.length;Qs(s,"cenc",a),s=s.o}}else s=Promise.resolve();return s},hg:function(i,r,s){Mm(e,i,r,s)}})}p.configure=function(e,i){arguments.length==2&&typeof e=="string"&&(e=Qh(e,i)),e.streaming&&"forceTransmuxTS"in e.streaming&&(Ip("streaming.forceTransmuxTS configuration","Please Use streaming.forceTransmux instead."),e.streaming.forceTransmux=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&e.streaming.lowLatencyMode&&(e.streaming.inaccurateManifestTolerance==null&&(e.streaming.inaccurateManifestTolerance=0),e.streaming.rebufferingGoal==null&&(e.streaming.rebufferingGoal=.01));var r=ls(this.h,e,us(this));return Fm(this),r};function Fm(e){if(e.J){var i=Qn(e.h.manifest);e.g&&e.g.nodeName==="AUDIO"&&(i.disableVideo=!0),e.J.configure(i)}if(e.m&&e.m.configure(e.h.drm),e.j){e.j.configure(e.h.streaming);try{jm(e,e.i)}catch(l){fn(e,l)}e.u&&go(e),i=e.j.l,!i||i.allowedByApplication&&i.allowedByKeySystem||rl(e)}if(e.D&&e.D.je(e.h.streaming.forceHTTPS),e.G&&(e.G.configure(e.h.mediaSource),e.G.H=e.h.manifest.segmentRelativeVttTiming,i=e.h.textDisplayFactory,e.Ud!=i)){var r=i(),s=e.G,a=s.m;s.m=r,a&&(r.setTextVisibility(a.isTextVisible()),a.destroy()),s.g&&(s.g.i=r),e.Ud=i,e.j&&(i=e.j,(r=i.j.get(ze))&&os(i,r.stream,!0,0,!0))}e.u&&(e.u.configure(e.h.abr),e.h.abr.enabled?e.u.enable():e.u.disable(),Xm(e)),e.M&&(i=e.h.streaming.rebufferingGoal,e.i&&(i=Math.max(i,e.i.minBufferTime)),kp(e.M,i,Math.min(.5,i/2))),e.i&&Ym(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd)}p.getConfiguration=function(){var e=us(this);return ls(e,this.h,us(this)),e},p.Bf=function(){if(this.g){var e=this.g.buffered.length;e=e?this.g.buffered.end(e-1):0;var i=this.getConfiguration().streaming.bufferingGoal;if(i=Math.min(this.g.currentTime+i,this.uc().end),e>=i)return 1;if(!(e<=this.g.currentTime)&&e<i)return(e-this.g.currentTime)/(i-this.g.currentTime)}return 0},p.rg=function(){for(var e in this.h)delete this.h[e];ls(this.h,us(this),us(this)),Fm(this)},p.Hf=function(){return this.l},p.Lf=function(){return this.g},p.jc=function(){return this.D},p.Dd=function(){return this.Nb},p.Ge=function(){return this.F?this.F:null},p.U=function(){return this.i?this.i.presentationTimeline.U():this.g&&this.g.src?this.g.duration==1/0:!1},p.jb=function(){return this.i?this.i.presentationTimeline.jb():!1},p.Zf=function(){if(this.i){var e=this.i.variants;return e.length?!e[0].video:!1}return this.g&&this.g.src?this.g.videoTracks?this.g.videoTracks.length==0:this.g.videoHeight==0:!1},p.uc=function(){if(!this.dc)return{start:0,end:0};if(this.i){var e=this.i.presentationTimeline;return{start:e.Db(),end:e.Oa()}}return this.g&&this.g.src&&(e=this.g.seekable,e.length)?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},p.Xf=function(){this.U()&&(this.g.currentTime=this.uc().end)},p.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},p.drmInfo=function(){return this.m?this.m.g:null},p.ic=function(){return this.m?this.m.ic():1/0},p.Qc=function(){return this.m?this.m.Qc():{}},p.Fd=function(){return this.M?this.M.g==Yn:!1},p.Rc=function(){return this.g?this.H?this.H.i:1:0},p.Ag=function(e){e==0?Ve("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.H.set(e),this.l==ei&&(this.u.playbackRateChanged(e),gm(this.j,1<Math.abs(e))))},p.pf=function(){var e=this.H.Pc();this.l==mi&&this.H.set(e),this.l==ei&&(this.H.set(e),this.u.playbackRateChanged(e),gm(this.j,!1))},p.Xa=function(){if(this.i){for(var e=this.j?this.j.l:null,i=[],r=0,s=y(this.i.variants),a=s.next();!a.done;a=s.next())if(a=a.value,Xs(a)){var l=rn(a);l.active=a==e,l.active||r==1||e==null||a.video!=e.video||a.audio!=e.audio||(l.active=!0),l.active&&r++,i.push(l)}return i}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map(function(h){return _a(h)}):[]},p.Fb=function(){if(this.i){for(var e=this.j?this.j.o:null,i=[],r=y(this.i.textStreams),s=r.next();!s.done;s=r.next()){s=s.value;var a=ma(s);a.active=s==e,i.push(a)}return i}return this.g&&this.g.src&&this.g.textTracks?po(this).map(function(l){return wp(l)}):[]},p.Ff=function(){return this.i?this.i.imageStreams.map(function(e){return rh(e)}):[]},p.Tf=function(e,i){var r=this,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V;return B(function(G){return G.g==1?r.i?(s=r.i.imageStreams.find(function(Y){return Y.id==e}))?s.segmentIndex?G.A(3):b(G,s.createSegmentIndex(),3):G.return(null):G.A(2):G.g!=2?(a=s.segmentIndex.find(i),a==null||(l=s.segmentIndex.get(a),h=l.tilesLayout||s.tilesLayout,d=/(\d+)x(\d+)/.exec(h),!d)?G.return(null):(g=s.width||0,_=s.height||0,x=parseInt(d[1],10),T=parseInt(d[2],10),S=g/x,A=_/T,M=x*T,O=l.j-l.startTime,P=l.s||O/M,k=l.startTime,D=z=0,1<M&&(N=Math.floor((i-l.startTime)/P),k=l.startTime+N*P,z=N%x*S,D=Math.floor(N/x)*A),j=!1,(V=l.o)&&(j=!0,A=V.height,z=V.positionX,D=V.positionY,S=V.width),G.return({imageHeight:_,imageWidth:g,height:A,positionX:z,positionY:D,startTime:k,duration:P,uris:l.ya(),width:S,sprite:j}))):G.return(null)})},p.Se=function(e){if(this.i&&this.j){var i=this.i.textStreams.find(function(s){return s.id==e.id});i&&i!=this.j.o&&(ic(this.o.h,i,!1),$a(this.j,i),nl(this),this.vb=i.language)}else if(this.g&&this.g.src&&this.g.textTracks){i=po(this),i=y(i);for(var r=i.next();!r.done;r=i.next())r=r.value,nh(r)==e.id?r.mode=this.ca?"showing":"hidden":r.mode="disabled";nl(this)}},p.Te=function(e,i,r){if(i=i===void 0?!1:i,r=r===void 0?0:r,this.i&&this.j){this.h.abr.enabled&&Ve("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var s=this.i.variants.find(function(a){return a.id==e.id});s&&Xs(s)&&(mo(this,s,!1,i,r),this.ub=new Pp(s),go(this))}else if(this.g&&this.g.audioTracks){for(i=Array.from(this.g.audioTracks),i=y(i),r=i.next();!r.done;r=i.next())if(r=r.value,nh(r)==e.id){lc(this,r);break}}},p.Af=function(){return Jm(this.Xa())},p.Rf=function(){return Jm(this.Fb())},p.zf=function(){return Array.from(Qm(this.Xa()))},p.Qf=function(){return Array.from(Qm(this.Fb()))},p.ge=function(e,i,r){if(r=r===void 0?0:r,this.i&&this.B){this.ub=new $n(e,i||"",r,""),i=function(d,g){return d.video||g.video?d.video&&g.video?Math.abs((d.video.height||0)-(g.video.height||0))+Math.abs((d.video.width||0)-(g.video.width||0)):1/0:0},e=this.j.l;var s=this.ub.create(this.i.variants);r=null,s=y(s.values());for(var a=s.next();!a.done;a=s.next())a=a.value,(!r||i(r,e)>i(a,e))&&(r=a);r?(i=rn(r),this.Te(i,!0)):rl(this)}else if(this.g&&this.g.audioTracks){a=Array.from(this.g.audioTracks),e=De(e),s=r=null,a=y(a);for(var l=a.next();!l.done;l=a.next()){l=l.value;var h=_a(l);De(h.language)==e&&(r=l,i?h.roles.includes(i)&&(s=l):h.roles.length==0&&(s=l))}s?lc(this,s):r&&lc(this,r)}},p.he=function(e,i,r){if(r=r===void 0?!1:r,this.i&&this.B)this.vb=e,this.cc=i||"",this.$b=r,(e=sh(this.i.textStreams,this.vb,this.cc,this.$b)[0]||null)&&e!=this.j.o&&(ic(this.o.h,e,!1),this.h.streaming.alwaysStreamText||this.Hd())&&($a(this.j,e),nl(this));else{var s=De(e);(e=this.Fb().find(function(a){return De(a.language)==s&&(!i||a.roles.includes(i))&&a.forced==r}))&&this.Se(e)}},p.tg=function(e){if(this.i&&this.B){for(var i=null,r=y(this.i.variants),s=r.next();!s.done;s=r.next())if(s=s.value,s.audio.label==e){i=s;break}i!=null&&(this.ub=new $n(i.language,"",0,e),rl(this))}},p.Hd=function(){var e=this.ca;return this.G?this.G.m.isTextVisible():this.g&&this.g.src&&this.g.textTracks?po(this).some(function(i){return i.mode=="showing"}):e},p.He=function(){return this.g&&this.g.src&&this.g.textTracks?Nm(this).map(function(e){return wp(e)}):[]},p.Cf=function(e){var i=De(e),r=Nm(this).filter(function(d){return De(d.language)==i});if(!r||!r.length)return[];e=[];var s=new Set;r=y(r);for(var a=r.next();!a.done;a=r.next())if((a=a.value)&&a.cues){a=y(a.cues);for(var l=a.next();!l.done;l=a.next()){var h=l.value;(l=h.id)&&l!=""||(l=h.startTime+"-"+h.endTime+"-"+h.text),h={id:l,title:h.text,startTime:h.startTime,endTime:h.endTime},s.has(l)||(e.push(h),s.add(l))}}return e};function po(e){return Array.from(e.g.textTracks).filter(function(i){return i.kind!="metadata"&&i.kind!="chapters"&&i.label!="Shaka Player TextTrack"})}function P1(e){return Array.from(e.g.textTracks).filter(function(i){return i.kind=="metadata"})}function Nm(e){return Array.from(e.g.textTracks).filter(function(i){return i.kind=="chapters"})}p.yg=function(e){if(e=!!e,this.ca!=e){if(this.ca=e,this.l==ei)this.G.m.setTextVisibility(e),this.h.streaming.alwaysStreamText||(e?this.j.o||(e=sh(this.i.textStreams,this.vb,this.cc,this.$b),0<e.length&&($a(this.j,e[0]),nl(this))):MS(this.j));else if(this.g&&this.g.src&&this.g.textTracks){var i=po(this);i=y(i);for(var r=i.next();!r.done;r=i.next())r=r.value,r.mode!="disabled"&&(r.mode=e?"showing":"hidden")}Gm(this)}},p.Of=function(){if(!this.U())return null;var e=this.Ga.l,i=0;if(this.B)i=this.B.Ic();else if(e){if(e.startTime==null)return new Date;i=e.startTime}return this.i?new Date(1e3*(this.i.presentationTimeline.i+i)):this.g&&this.g.getStartDate?(e=this.g.getStartDate(),isNaN(e.getTime())?null:new Date(e.getTime()+1e3*i)):null},p.Ie=function(){if(!this.U())return null;if(this.i)return new Date(1e3*this.i.presentationTimeline.i);if(this.g&&this.g.getStartDate){var e=this.g.getStartDate();return isNaN(e.getTime())?null:e}return null},p.Na=function(){if(this.l==ei)return this.G.Na();var e={total:[],audio:[],video:[],text:[]};return this.l==mi&&(e.total=Dr(this.g.buffered)),e},p.getStats=function(){if(this.l!=ei&&this.l!=mi)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};tl(this);var e=this.g,i=e.currentTime/e.duration;if(!isNaN(i)){var r=this.o;i=Math.round(100*i),r.i=isNaN(r.i)?i:Math.max(r.i,i)}if(this.B&&(this.o.M=this.B.te(),this.o.O=this.B.ue()),e.getVideoPlaybackQuality){r=e.getVideoPlaybackQuality(),i=this.o;var s=Number(r.totalVideoFrames);i.L=Number(r.droppedVideoFrames),i.J=s,this.o.H=Number(r.corruptedVideoFrames)}this.m?(r=this.m,r=r.H?r.H:NaN):r=NaN,this.o.s=r,this.l==ei&&((r=this.j.l)&&(this.o.B=(this.H?this.H.i:1)*r.bandwidth),r&&r.video&&(i=this.o,s=r.video.height||NaN,i.o=r.video.width||NaN,i.l=s),this.U()&&(r=this.Ie().valueOf()+1e3*this.uc().end,this.o.D=(Date.now()-r)/1e3),this.i&&this.i.presentationTimeline&&(this.o.G=this.i.presentationTimeline.g),r=this.u.getBandwidthEstimate(),this.o.u=r),this.l==mi&&(r=this.o,i=e.videoHeight||NaN,r.o=e.videoWidth||NaN,r.l=i);var a=this.o;e=a.o,r=a.l,i=a.B,s=a.J;var l=a.L,h=a.H,d=a.O,g=a.M,_=a.u,x=a.i,T=a.m,S=a.F,A=a.j,M=tc(a.g,"playing"),O=tc(a.g,"paused"),P=tc(a.g,"buffering"),k=a.s,z=a.D,D=a.G,N=h1(a.g),j=[];a=y(a.h.g);for(var V=a.next();!V.done;V=a.next())V=V.value,j.push({timestamp:V.timestamp,id:V.id,type:V.type,fromAdaptation:V.fromAdaptation,bandwidth:V.bandwidth});return{width:e,height:r,streamBandwidth:i,decodedFrames:s,droppedFrames:l,corruptedFrames:h,stallsDetected:d,gapsJumped:g,estimatedBandwidth:_,completionPercent:x,loadLatency:T,manifestTimeSeconds:S,drmTimeSeconds:A,playTime:M,pauseTime:O,bufferingTime:P,licenseTime:k,liveLatency:z,maxSegmentDuration:D,stateHistory:N,switchHistory:j}},p.hf=function(e,i,r,s,a,l,h){h=h===void 0?!1:h;var d=this,g,_,x,T,S,A,M,O,P,k,z;return B(function(D){switch(D.g){case 1:if(d.l!=ei&&d.l!=mi)throw new F(1,7,7004);if(s){D.A(2);break}return b(D,nc(d,e),3);case 3:s=D.h;case 2:if(g=[],d.F)try{g=d.F.getServerSideCuePoints()}catch(N){}if(d.l!=mi){D.A(4);break}return h&&(r="forced"),b(D,Um(d,e,i,r,s,l||"",g),5);case 5:if(_=d.Fb(),x=_.find(function(N){return N.language==i&&N.label==(l||"")&&N.kind==r}))return gi(d),D.return(x);throw new F(1,2,2012);case 4:if(T=Mt,S=d.i.presentationTimeline.getDuration(),S==1/0)throw new F(1,4,4033);if(!g.length){D.A(6);break}return b(D,sc(d,e,d.D,d.h.streaming.retryParameters),7);case 7:A=D.h,M=zm(d,A,s,g),O=new Blob([M],{type:"text/vtt"}),e=Mh(O),s="text/vtt";case 6:if(P={id:d.Yd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Dh(0,S,[e]),mimeType:s||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:i,label:l||null,type:T.X,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!h,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},k=Hi(P.mimeType,P.codecs),z=da(k),!z)throw new F(2,2,2014,s);return d.i.textStreams.push(P),gi(d),D.return(ma(P))}})},p.jf=function(e,i){var r=this,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z;return B(function(D){switch(D.g){case 1:if(r.l!=ei&&r.l!=mi)throw new F(1,7,7004);if(r.l==mi)throw new F(1,2,2016);if(i){D.A(2);break}return b(D,nc(r,e),3);case 3:i=D.h;case 2:if(i!="text/vtt")throw new F(1,2,2017,e);if(s=Mt,a=r.i.presentationTimeline.getDuration(),a==1/0)throw new F(1,4,4045);return b(D,sc(r,e,r.D,r.h.streaming.retryParameters),4);case 4:if(l=D.h,h=wt[i],!h)throw new F(2,2,2014,i);for(d=h(),g={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},_=Ie(l),x=d.parseMedia(_,g),T=[],S={},A=y(x),M=A.next();!M.done;S={Rb:S.Rb},M=A.next())O=M.value,S.Rb=Gt([e],[O.payload])[0],P=new Me(O.startTime,O.endTime,function(N){return function(){return[N.Rb]}}(S),0,null,null,0,0,1/0),S.Rb.includes("#xywh")&&(k=S.Rb.split("#xywh=")[1].split(","),k.length===4&&P.Ye({height:parseInt(k[3],10),positionX:parseInt(k[0],10),positionY:parseInt(k[1],10),width:parseInt(k[2],10)})),T.push(P);return z={id:r.Yd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Fe(T),mimeType:i||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",label:null,type:s.Wb,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1"},r.i.imageStreams.push(z),gi(r),D.return(rh(z))}})},p.gf=function(e,i,r){var s=this,a,l,h,d;return B(function(g){switch(g.g){case 1:if(s.l!=ei&&s.l!=mi)throw new F(1,7,7004);if(r){g.A(2);break}return b(g,nc(s,e),3);case 3:r=g.h;case 2:if(a=[],s.F)try{a=s.F.getServerSideCuePoints()}catch(_){}return b(g,Um(s,e,i,"chapters",r,"",a),4);case 4:if(l=g.h,h=s.He(),d=h.find(function(_){return _.language==i}),!d){g.A(5);break}return b(g,new Promise(function(_,x){s.s.ma(l,"load",_),s.s.ma(l,"error",function(){x(new F(1,2,2015))})}),6);case 6:return g.return(d);case 5:throw new F(1,2,2012)}})};function nc(e,i){var r,s;return B(function(a){switch(a.g){case 1:return r=ts(i),(s=U1[r])?a.return(s):(fe(a,2),b(a,fg(i,e.D,e.h.streaming.retryParameters),4));case 4:s=a.h,we(a,3);break;case 2:oe(a);case 3:if(s)return a.return(s);throw new F(1,2,2011,r)}})}function Um(e,i,r,s,a,l,h){var d,g,_,x;return B(function(T){if(T.g==1)return a!="text/vtt"||h.length?b(T,sc(e,i,e.D,e.h.streaming.retryParameters),3):T.A(2);T.g!=2&&(d=T.h,g=zm(e,d,a,h),_=new Blob([g],{type:"text/vtt"}),i=Mh(_),a="text/vtt"),x=document.createElement("track");var S=e.V,A=i;try{if(S.g.enabled){var M=Wh(S);M.ot=$h,M.su=!0;var O=Ka(M),P=Xh(A,O)}else P=A}catch(k){nr("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",k),P=A}return x.src=P,x.label=l,x.kind=s,x.srclang=r,e.g.getAttribute("crossorigin")||e.g.setAttribute("crossorigin","anonymous"),e.g.appendChild(x),T.return(x)})}function sc(e,i,r,s){var a,l,h;return B(function(d){if(d.g==1){a=Or,l=ci([i],s),l.method="GET";var g=e.V;try{g.g.enabled&&Gh(g,l,{ot:$h,su:!0})}catch(_){nr("CMCD_TEXT_ERROR","Could not generate text CMCD data.",_)}return b(d,r.request(a,l).promise,2)}return h=d.h,d.return(h.data)})}function zm(e,i,r,s){var a=wt[r];if(a)return r=a(),e={periodStart:0,segmentStart:0,segmentEnd:e.g.duration,vttOffset:0},i=Ie(i),i=r.parseMedia(i,e),QS(i,s);throw new F(2,2,2014,r)}p.ke=function(e,i){this.ec.width=e,this.ec.height=i},p.ce=function(e){if(this.l==ei){var i=this.j;if(e=e===void 0?.1:e,i.h.g)i=!1;else if(i.s)i=!1;else{for(var r=y(i.j.values()),s=r.next();!s.done;s=r.next())s=s.value,!s.nc||s.ra||s.Ka||(s.nc=!1,pi(i,s,e));i=!0}}else i=!1;return i},p.If=function(){return Ve("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},p.Jf=function(){return this.Yc};function us(e){var i=as();return i.streaming.failureCallback=function(r){if(e.U()){var s=null;r.code==1001||r.code==1002?s=1:r.code==1003&&(s=.1),s!=null&&(r.severity=1,e.ce(s))}},i.textDisplayFactory=function(){return e.Uc?new Jt(e.g,e.Uc):new Qt(e.g)},i}p.$e=function(e){this.Uc=e};function k1(e,i){for(var r=new Set,s=y(i.textStreams),a=s.next();!a.done;a=s.next())a=a.value,a.mimeType!="application/cea-608"&&a.mimeType!="application/cea-708"||r.add(a.originalId);for(s=y(i.variants),a=s.next();!a.done;a=s.next())if((a=a.value.video)&&a.closedCaptions){for(var l=y(a.closedCaptions.keys()),h=l.next();!h.done;h=l.next())if(h=h.value,!r.has(h)){var d=h.startsWith("CC")?"application/cea-608":"application/cea-708",g=new ut;d={id:e.Yd++,originalId:h,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:g,mimeType:d,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:a.closedCaptions.get(h),label:null,type:ze,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:a.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},i.textStreams.push(d),r.add(h)}}}function Bm(e,i){return B(function(r){if(r.g==1)return b(r,O1(e,i),2);jm(e,i),Q(r)})}function O1(e,i){var r;return B(function(s){if(s.g==1)return r=e.j?e.j.l:null,b(s,jw(r,i),2);Zm(i),Q(s)})}function jm(e,i){if(e.l!=Mi){th(i.variants,e.h.restrictions,e.ec)&&e.j&&gi(e);var r=e.m?e.m.g:null;if(r&&e.m.u)for(var s=y(i.variants),a=s.next();!a.done;a=s.next())a=a.value,oc(e,r.keySystem,a.video),oc(e,r.keySystem,a.audio);Km(e,i)}}function oc(e,i,r){if(r){r=y(r.drmInfos);for(var s=r.next();!s.done;s=r.next())if(s=s.value,s.keySystem==i){s=y(s.initData||[]);for(var a=s.next();!a.done;a=s.next())a=a.value,Qs(e.m,a.initDataType,a.initData)}}}function D1(e,i){var r,s,a,l,h;return B(function(d){return d.g==1?(r=e.audio,s=e.video,a=function(g,_){var x,T,S;return B(function(A){return A.g==1?g?b(A,g.createSegmentIndex(),2):A.return(null):(T=(x=g.segmentIndex.Cb(_))?x.next().value:null,T?(S=T.startTime,A.return(S)):A.return(null))})},b(d,a(r,i),2)):d.g!=3?(l=d.h,b(d,a(s,i),3)):(h=d.h,h!=null&&l!=null?d.return(Math.max(h,l)):h!=null?d.return(h):l!=null?d.return(l):d.return(i))})}function ac(e){var i=e.Fd();if(e.o&&e.M&&e.B){var r=e.H;r.j=i,cm(r),e.V&&(r=e.V,i||r.i||(r.i=!0),r.i&&i&&(r.l=!0),r.m=i),tl(e)}i=new Map().set("buffering",i),e.dispatchEvent(dt("buffering",i))}function Hm(e){var i=e.g.playbackRate;i!=0&&(e.H&&e.H.set(i),i=dt("ratechange"),e.dispatchEvent(i))}function tl(e){if(e.o&&e.M){var i=e.o.g;e.M.g==Yn?Ja(i,"buffering"):e.g.paused?Ja(i,"paused"):e.g.ended?Ja(i,"ended"):Ja(i,"playing")}}function go(e){try{Km(e,e.i)}catch(r){return fn(e,r),!1}var i=e.i.variants.filter(function(r){return Xs(r)});return i=e.ub.create(i),e.u.setVariants(Array.from(i.values())),!0}function il(e){return go(e)?e.u.chooseVariant():null}function rl(e){var i=il(e);i&&mo(e,i,!0,!0,0)}function mo(e,i,r,s,a){var l=e.j.l;if(i==l)s&&mm(e.j,i,s,a,!0);else{var h=e.o.h;h.h!=i&&(h.h=i,h.g.push({timestamp:Date.now()/1e3,id:i.id,type:"variant",fromAdaptation:r,bandwidth:i.bandwidth})),mm(e.j,i,s,a,void 0,r),s=null,l&&(s=rn(l)),i=rn(i),r?Vm(e,s,i):Wm(e,s,i)}}function lc(e,i){var r=Array.from(e.g.audioTracks).find(function(s){return s.enabled});i.enabled=!0,i.id!==r.id&&(r.enabled=!1),r=_a(r),i=_a(i),Wm(e,r,i)}function F1(e,i,r){if(e.h.autoShowText==0)return!1;if(e.h.autoShowText==1)return!0;var s=De(e.h.preferredTextLanguage);return r=De(r.language),e.h.autoShowText==2?fa(r,s):e.h.autoShowText==3?(e=De(i.language),fa(r,s)&&!fa(e,r)):(Ve("Invalid autoShowText setting!"),!1)}function Vm(e,i,r){i=new Map().set("oldTrack",i).set("newTrack",r),e.L&&Vg(e.L,r),r=dt("adaptation",i),hs(e,r)}function gi(e){var i=dt("trackschanged");hs(e,i)}function Wm(e,i,r){i=new Map().set("oldTrack",i).set("newTrack",r),e.L&&Vg(e.L,r),r=dt("variantchanged",i),hs(e,r)}function nl(e){var i=dt("textchanged");hs(e,i)}function Gm(e){var i=dt("texttrackvisibility");hs(e,i)}function Xm(e){var i=new Map().set("newStatus",e.h.abr.enabled);hs(e,dt("abrstatuschanged",i))}function N1(e,i){if(i.code!=1002&&i.code!=1011||i.category!=1||!navigator.onLine)return!1;var r=e.h.streaming.maxDisabledTime;if(r==0)if(i.code==1011)r=1;else return!1;i=e.Xa().find(function(h){return h.active});for(var s=e.i,a=y(s.variants),l=a.next();!l.done;l=a.next())l=l.value,l.id===i.id&&(l.disabledUntilTime=Date.now()/1e3+r);return th(s.variants,e.h.restrictions,e.ec),i=il(e),i?(s=e.Na().video.reduce(function(h,d){return h+d.end-d.start},0),mo(e,i,!1,!0,s),e.af.N(r),!0):!1}function fn(e,i){if(e.l!=Mi)if(N1(e,i))i.handled=!0;else{var r=dt("error",new Map().set("detail",i));e.dispatchEvent(r),r.defaultPrevented&&(i.handled=!0)}}function _o(e,i,r){r=new Map().set("detail",{schemeIdUri:r.schemeIdUri,value:r.value,startTime:r.startTime,endTime:r.endTime,id:r.id,eventElement:r.eventElement}),e.dispatchEvent(dt(i,r))}function uc(e){if(!e.g.error)return null;var i=e.g.error.code;if(i==1)return null;var r=e.g.error.msExtendedCode;return r&&(0>r&&(r+=Math.pow(2,32)),r=r.toString(16)),new F(2,3,3016,i,r,e.g.error.message)}function qm(e,i){if(e.j){var r=Object.keys(i),s=r.length==1&&r[0]=="00",a=!1;if(r.length){r=y(e.i.variants);for(var l=r.next();!l.done;l=r.next()){l=l.value;var h=[];l.audio&&h.push(l.audio),l.video&&h.push(l.video),h=y(h);for(var d=h.next();!d.done;d=h.next()){var g=d.value;if(d=l.allowedByKeySystem,g.keyIds.size){l.allowedByKeySystem=!0,g=y(g.keyIds);for(var _=g.next();!_.done;_=g.next())_=_.value,_=i[s?"00":_],l.allowedByKeySystem=l.allowedByKeySystem&&!!_&&!t_.includes(_)}d!=l.allowedByKeySystem&&(a=!0)}}}(!a||go(e))&&((i=e.j.l)&&!i.allowedByKeySystem&&rl(e),a&&gi(e))}}function $m(e,i,r){e.J&&e.J.onExpirationUpdated&&e.J.onExpirationUpdated(i,r),i=dt("expirationupdated"),e.dispatchEvent(i)}function Ym(e,i,r){0<i&&(e.U()||e.Ze(i)),i=e.getDuration(),r<i&&(e.U()||e.Aa(r))}function Km(e,i){e=e.m?e.m.Qc():{};var r=Object.keys(e);r=r.length&&r[0]=="00";var s=!1,a=!1,l=new Set,h=new Set;i=y(i.variants);for(var d=i.next();!d.done;d=i.next()){d=d.value;var g=[];d.audio&&g.push(d.audio),d.video&&g.push(d.video),g=y(g);for(var _=g.next();!_.done;_=g.next())if(_=_.value,_.keyIds.size){_=y(_.keyIds);for(var x=_.next();!x.done;x=_.next()){x=x.value;var T=e[r?"00":x];T?t_.includes(T)&&h.add(T):l.add(x)}}d.allowedByApplication?d.allowedByKeySystem&&(s=!0):a=!0}if(!s)throw e={hasAppRestrictions:a,missingKeys:Array.from(l),restrictedKeyStatuses:Array.from(h)},new F(2,4,4012,e)}function Zm(e){if(!e.variants.some(Xs))throw new F(2,4,4032)}function hs(e,i){B(function(r){if(r.g==1)return b(r,Promise.resolve(),2);e.l!=Mi&&e.dispatchEvent(i),Q(r)})}function Qm(e){var i=new Set;e=y(e);for(var r=e.next();!r.done;r=e.next())r=r.value,r.language?i.add(De(r.language)):i.add("und");return i}function Jm(e){var i=new Map,r=new Map;e=y(e);for(var s=e.next();!s.done;s=e.next()){s=s.value;var a="und",l=[];s.language&&(a=De(s.language)),s.type=="variant"?l=s.audioRoles:l=s.roles,l&&l.length||(l=[""]),i.has(a)||i.set(a,new Set),l=y(l);for(var h=l.next();!h.done;h=l.next())h=h.value,i.get(a).add(h),s.label&&(r.has(a)||r.set(a,new Map),r.get(a).set(h,s.label))}var d=[];return i.forEach(function(g,_){g=y(g);for(var x=g.next();!x.done;x=g.next()){x=x.value;var T=null;r.has(_)&&r.get(_).has(x)&&(T=r.get(_).get(x)),d.push({language:_,role:x,label:T})}}),d}function pn(){return new F(2,7,7e3)}function hc(e,i,r,s,a,l){return s==e&&a.mediaElement==l.mediaElement&&a.uri==l.uri&&a.mimeType==l.mimeType?i:r}function cs(){return{mediaElement:null,mimeType:null,startTime:null,ne:NaN,uri:null}}function cc(e){return new Promise(function(i,r){e.mb=function(){return r(pn())},e.bd=function(){return i()},e.onError=function(s){return r(s)},e.dd=function(){return r(pn())}})}ie("shaka.Player",W),W.prototype.setVideoContainer=W.prototype.$e,W.prototype.getManifestParserFactory=W.prototype.Jf,W.prototype.getManifest=W.prototype.If,W.prototype.retryStreaming=W.prototype.ce,W.prototype.setMaxHardwareResolution=W.prototype.ke,W.prototype.addChaptersTrack=W.prototype.gf,W.prototype.addThumbnailsTrack=W.prototype.jf,W.prototype.addTextTrackAsync=W.prototype.hf,W.prototype.getStats=W.prototype.getStats,W.prototype.getBufferedInfo=W.prototype.Na,W.prototype.getPresentationStartTimeAsDate=W.prototype.Ie,W.prototype.getPlayheadTimeAsDate=W.prototype.Of,W.prototype.setTextTrackVisibility=W.prototype.yg,W.prototype.getChapters=W.prototype.Cf,W.prototype.getChaptersTracks=W.prototype.He,W.prototype.isTextTrackVisible=W.prototype.Hd,W.prototype.selectVariantsByLabel=W.prototype.tg,W.prototype.selectTextLanguage=W.prototype.he,W.prototype.selectAudioLanguage=W.prototype.ge,W.prototype.getTextLanguages=W.prototype.Qf,W.prototype.getAudioLanguages=W.prototype.zf,W.prototype.getTextLanguagesAndRoles=W.prototype.Rf,W.prototype.getAudioLanguagesAndRoles=W.prototype.Af,W.prototype.selectVariantTrack=W.prototype.Te,W.prototype.selectTextTrack=W.prototype.Se,W.prototype.getThumbnails=W.prototype.Tf,W.prototype.getImageTracks=W.prototype.Ff,W.prototype.getTextTracks=W.prototype.Fb,W.prototype.getVariantTracks=W.prototype.Xa,W.prototype.cancelTrickPlay=W.prototype.pf,W.prototype.trickPlay=W.prototype.Ag,W.prototype.getPlaybackRate=W.prototype.Rc,W.prototype.isBuffering=W.prototype.Fd,W.prototype.getKeyStatuses=W.prototype.Qc,W.prototype.getExpiration=W.prototype.ic,W.prototype.drmInfo=W.prototype.drmInfo,W.prototype.keySystem=W.prototype.keySystem,W.prototype.goToLive=W.prototype.Xf,W.prototype.seekRange=W.prototype.uc,W.prototype.isAudioOnly=W.prototype.Zf,W.prototype.isInProgress=W.prototype.jb,W.prototype.isLive=W.prototype.U,W.prototype.getAdManager=W.prototype.Ge,W.prototype.getAssetUri=W.prototype.Dd,W.prototype.getNetworkingEngine=W.prototype.jc,W.prototype.getMediaElement=W.prototype.Lf,W.prototype.getLoadMode=W.prototype.Hf,W.prototype.resetConfiguration=W.prototype.rg,W.prototype.getBufferFullness=W.prototype.Bf,W.prototype.getConfiguration=W.prototype.getConfiguration,W.prototype.configure=W.prototype.configure,W.prototype.load=W.prototype.load,W.prototype.updateStartTime=W.prototype.Fg,W.prototype.unload=W.prototype.re,W.prototype.detach=W.prototype.detach,W.prototype.attachCanvas=W.prototype.lf,W.prototype.attach=W.prototype.Yb,W.probeSupport=function(e){e=e===void 0?!0:e;var i,r,s,a,l,h;return B(function(d){if(d.g==1)return i={},e?b(d,IT(),3):d.A(2);d.g!=2&&(i=d.h);var g={};if(Ii()){for(var _ in di)g[_]=!0;for(var x in an)g[x]=!0}_={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"},x=y(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var T=x.next();!T.done;T=x.next())T=T.value,g[T]=Ii()?!!di[T]:Vn(T);for(var S in _)g[S]=Ii()?!!an[S]:Vn(_[S]);for(r=g,S='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(I(rs)),g={},S=y(S),_=S.next();!_.done;_=S.next())_=_.value,g[_]=Ii()?da(_)?!0:ce(_)||Ku(_):Vn(_),x=_.split(";")[0],g[x]=g[x]||g[_];s=g,a={manifest:r,media:s,drm:i},l=fc;for(h in l)a[h]=l[h]();return d.return(a)})},W.isBrowserSupported=function(){if(u.Promise||Ve("A Promise implementation or polyfill is required"),!(u.Promise&&u.Uint8Array&&Array.prototype.forEach)||tt("Trident/"))return!1;var e=Xu();return e&&13>e||!(u.MediaKeys&&u.navigator&&u.navigator.requestMediaKeySystemAccess&&u.MediaKeySystemAccess&&u.MediaKeySystemAccess.prototype.getConfiguration)?!1:Ii()?!0:Vn("application/x-mpegurl")},W.setAdManagerFactory=function(e){sl=e},W.registerSupportPlugin=function(e,i){fc[e]=i},W.prototype.destroy=W.prototype.destroy;var Mi=0,dc=1,ei=2,mi=3;W.LoadMode={DESTROYED:Mi,NOT_LOADED:dc,MEDIA_SOURCE:ei,SRC_EQUALS:mi},W.version="v4.3.5";var e_=["4","3"];Rp=new function(e){this.g=e,this.i=Jw,this.h=eT}(new ah(Number(e_[0]),Number(e_[1])));var t_=["output-restricted","internal-error"],fc={},sl=null,ol={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"},U1={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function i_(){this.h=[],this.j=this.i=this.g=0}function Se(e,i,r){var s=this;this.h=e,this.g=i,this.m=r,this.i=!1,this.l=this.g.getVolume(),this.j=new Ye,this.j.C(this.g,google.ima.AdEvent.Type.PAUSED,function(){s.i=!0}),this.j.C(this.g,google.ima.AdEvent.Type.RESUMED,function(){s.i=!1})}p=Se.prototype,p.getDuration=function(){return this.h.getDuration()},p.getMinSuggestedDuration=function(){return this.h.getMinSuggestedDuration()},p.getRemainingTime=function(){return this.g.getRemainingTime()},p.isPaused=function(){return this.i},p.isSkippable=function(){return 0<=this.h.getSkipTimeOffset()},p.getTimeUntilSkippable=function(){var e=this.h.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},p.canSkipNow=function(){return this.g.getAdSkippableState()},p.skip=function(){return this.g.skip()},p.pause=function(){return this.g.pause()},p.play=function(){return this.g.resume()},p.getVolume=function(){return this.g.getVolume()},p.setVolume=function(e){return this.g.setVolume(e)},p.isMuted=function(){return this.g.getVolume()==0},p.isLinear=function(){return this.h.isLinear()},p.resize=function(e,i){var r=!1,s=this.m;document.fullscreenEnabled?r=!!document.fullscreenElement:s.webkitSupportsFullscreen&&(r=s.webkitDisplayingFullscreen),this.g.resize(e,i,r?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},p.setMuted=function(e){e?(this.l=this.getVolume(),this.setVolume(0)):this.setVolume(this.l)},p.getSequenceLength=function(){var e=this.h.getAdPodInfo();return e==null?1:e.getTotalAds()},p.getPositionInSequence=function(){var e=this.h.getAdPodInfo();return e==null?1:e.getAdPosition()},p.getTitle=function(){return this.h.getTitle()},p.getDescription=function(){return this.h.getDescription()},p.release=function(){this.g=this.h=null},ie("shaka.ads.ClientSideAd",Se),Se.prototype.release=Se.prototype.release,Se.prototype.getDescription=Se.prototype.getDescription,Se.prototype.getTitle=Se.prototype.getTitle,Se.prototype.getPositionInSequence=Se.prototype.getPositionInSequence,Se.prototype.getSequenceLength=Se.prototype.getSequenceLength,Se.prototype.setMuted=Se.prototype.setMuted,Se.prototype.resize=Se.prototype.resize,Se.prototype.isLinear=Se.prototype.isLinear,Se.prototype.isMuted=Se.prototype.isMuted,Se.prototype.setVolume=Se.prototype.setVolume,Se.prototype.getVolume=Se.prototype.getVolume,Se.prototype.play=Se.prototype.play,Se.prototype.pause=Se.prototype.pause,Se.prototype.skip=Se.prototype.skip,Se.prototype.canSkipNow=Se.prototype.canSkipNow,Se.prototype.getTimeUntilSkippable=Se.prototype.getTimeUntilSkippable,Se.prototype.isSkippable=Se.prototype.isSkippable,Se.prototype.isPaused=Se.prototype.isPaused,Se.prototype.getRemainingTime=Se.prototype.getRemainingTime,Se.prototype.getMinSuggestedDuration=Se.prototype.getMinSuggestedDuration,Se.prototype.getDuration=Se.prototype.getDuration;function pc(e,i,r,s){var a=this;this.o=e,this.i=i,this.s=null,this.u=NaN,this.l=s,this.j=null,this.h=new Ye,google.ima.settings.setLocale(r),e=new google.ima.AdDisplayContainer(this.o,this.i),e.initialize(),this.m=new google.ima.AdsLoader(e),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.3.5"),this.g=null,this.h.ma(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(l){z1(a,l)}),this.h.C(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(l){r_(a,l)}),this.h.C(this.i,"ended",function(){a.m.contentComplete()})}pc.prototype.stop=function(){this.g&&this.g.stop(),this.o&&Ya(this.o)},pc.prototype.release=function(){this.stop(),this.s&&this.s.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy()};function r_(e,i){i.getError(),ll(e,null),e.l(new ye("ad-cue-points-changed",new Map().set("cuepoints",[])))}function z1(e,i){e.l(new ye("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.u))),e.g=i.getAdsManager(e.i),e.l(new ye("ima-ad-manager-loaded",new Map().set("imaAdManager",e.g)));var r=e.g.getCuePoints();if(r.length){i=[],r=y(r);for(var s=r.next();!s.done;s=r.next())i.push({start:s.value,end:null});e.l(new ye("ad-cue-points-changed",new Map().set("cuepoints",i)))}B1(e);try{e.g.init(e.i.offsetWidth,e.i.offsetHeight,al(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),e.h.C(e.i,"loadeddata",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,al(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in u?(e.s=new ResizeObserver(function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,al(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.s.observe(e.i)):e.h.C(document,"fullscreenchange",function(){e.g.resize(e.i.offsetWidth,e.i.offsetHeight,al(e)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),e.i.addEventListener("play",function(){e.g.start()},{once:!0})}catch(a){ll(e,null)}}function al(e){return document.fullscreenEnabled?!!document.fullscreenElement:(e=e.i,e.webkitSupportsFullscreen?e.webkitDisplayingFullscreen:!1)}function B1(e){function i(r,s){r=new Map().set("originalEvent",r),e.l(new ye(s,r))}e.h.C(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(r){r_(e,r)}),e.h.C(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(r){n_(e,r)}),e.h.C(e.g,google.ima.AdEvent.Type.STARTED,function(r){n_(e,r)}),e.h.C(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(r){i(r,"ad-first-quartile")}),e.h.C(e.g,google.ima.AdEvent.Type.MIDPOINT,function(r){i(r,"ad-midpoint")}),e.h.C(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(r){i(r,"ad-third-quartile")}),e.h.C(e.g,google.ima.AdEvent.Type.COMPLETE,function(r){i(r,"ad-complete")}),e.h.C(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(r){ll(e,r)}),e.h.C(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(r){ll(e,r)}),e.h.C(e.g,google.ima.AdEvent.Type.SKIPPED,function(r){i(r,"ad-skipped")}),e.h.C(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(r){i(r,"ad-volume-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(r){i(r,"ad-muted")}),e.h.C(e.g,google.ima.AdEvent.Type.PAUSED,function(r){e.j&&(e.j.i=!0,i(r,"ad-paused"))}),e.h.C(e.g,google.ima.AdEvent.Type.RESUMED,function(r){e.j&&(e.j.i=!1,i(r,"ad-resumed"))}),e.h.C(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(r){e.j&&i(r,"ad-skip-state-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.CLICK,function(r){i(r,"ad-clicked")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(r){i(r,"ad-progress")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(r){i(r,"ad-buffering")}),e.h.C(e.g,google.ima.AdEvent.Type.IMPRESSION,function(r){i(r,"ad-impression")}),e.h.C(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(r){i(r,"ad-duration-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(r){i(r,"ad-closed")}),e.h.C(e.g,google.ima.AdEvent.Type.LOADED,function(r){i(r,"ad-loaded")}),e.h.C(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(r){i(r,"all-ads-completed")}),e.h.C(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(r){i(r,"ad-linear-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_METADATA,function(r){i(r,"ad-metadata")}),e.h.C(e.g,google.ima.AdEvent.Type.LOG,function(r){i(r,"ad-recoverable-error")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(r){i(r,"ad-break-ready")}),e.h.C(e.g,google.ima.AdEvent.Type.INTERACTION,function(r){i(r,"ad-interaction")})}function n_(e,i){var r=i.getAd();r?(e.j=new Se(r,e.g,e.i),i=new Map().set("ad",e.j).set("sdkAdObject",r).set("originalEvent",i),e.l(new ye("ad-started",i)),e.j.isLinear()&&(e.o.setAttribute("ad-active","true"),e.i.pause(),e.j.setVolume(e.i.muted?0:e.i.volume))):Ve("The IMA SDK fired a "+i.type+" event with no associated ad. Unable to play ad!")}function ll(e,i){e.l(new ye("ad-stopped",new Map().set("originalEvent",i))),e.j&&e.j.isLinear()&&(e.o.removeAttribute("ad-active"),e.i.ended||e.i.play())}function Ce(e,i){this.i=e,this.h=null,this.g=i}p=Ce.prototype,p.getDuration=function(){return this.h?this.h.duration:-1},p.getMinSuggestedDuration=function(){return this.getDuration()},p.getRemainingTime=function(){return this.h?this.h.duration-this.h.currentTime:-1},p.isPaused=function(){return this.g.paused},p.isSkippable=function(){return this.i.isSkippable()},p.getTimeUntilSkippable=function(){var e=this.i.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},p.canSkipNow=function(){return this.getTimeUntilSkippable()==0},p.skip=function(){this.g.currentTime+=this.getRemainingTime()},p.pause=function(){return this.g.pause()},p.play=function(){return this.g.play()},p.getVolume=function(){return this.g.volume},p.setVolume=function(e){this.g.volume=e},p.isMuted=function(){return this.g.muted},p.isLinear=function(){return!0},p.resize=function(){},p.setMuted=function(e){this.g.muted=e},p.getSequenceLength=function(){var e=this.i.getAdPodInfo();return e==null?1:e.getTotalAds()},p.getPositionInSequence=function(){var e=this.i.getAdPodInfo();return e==null?1:e.getAdPosition()},p.getTitle=function(){return this.i.getTitle()},p.getDescription=function(){return this.i.getDescription()},p.release=function(){this.g=this.h=this.i=null},ie("shaka.ads.ServerSideAd",Ce),Ce.prototype.release=Ce.prototype.release,Ce.prototype.getDescription=Ce.prototype.getDescription,Ce.prototype.getTitle=Ce.prototype.getTitle,Ce.prototype.getPositionInSequence=Ce.prototype.getPositionInSequence,Ce.prototype.getSequenceLength=Ce.prototype.getSequenceLength,Ce.prototype.setMuted=Ce.prototype.setMuted,Ce.prototype.resize=Ce.prototype.resize,Ce.prototype.isLinear=Ce.prototype.isLinear,Ce.prototype.isMuted=Ce.prototype.isMuted,Ce.prototype.setVolume=Ce.prototype.setVolume,Ce.prototype.getVolume=Ce.prototype.getVolume,Ce.prototype.play=Ce.prototype.play,Ce.prototype.pause=Ce.prototype.pause,Ce.prototype.skip=Ce.prototype.skip,Ce.prototype.canSkipNow=Ce.prototype.canSkipNow,Ce.prototype.getTimeUntilSkippable=Ce.prototype.getTimeUntilSkippable,Ce.prototype.isSkippable=Ce.prototype.isSkippable,Ce.prototype.isPaused=Ce.prototype.isPaused,Ce.prototype.getRemainingTime=Ce.prototype.getRemainingTime,Ce.prototype.getMinSuggestedDuration=Ce.prototype.getMinSuggestedDuration,Ce.prototype.getDuration=Ce.prototype.getDuration;function ul(e,i,r,s){var a=this;this.s=e,this.l=i,this.j=null,this.G=NaN,this.i=s,this.F=!1,this.u=this.m=this.o=null,this.B="",this.D=[],this.h=new Ye,e=new google.ima.dai.api.UiSettings,e.setLocale(r),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new ye("ima-stream-manager-loaded",new Map().set("imaStreamManager",this.g))),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(l){j1(a,l)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){a.B.length?a.j.resolve(a.B):a.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),a.j=null}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(l){l=l.getAd(),a.m=new Ce(l,a.l),a.u&&(a.m.h=a.u),a.i(new ye("ad-started",new Map().set("ad",a.m))),a.s.setAttribute("ad-active","true")}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){a.s.removeAttribute("ad-active");var l=a.l.currentTime;a.o&&a.o>l&&(a.l.currentTime=a.o,a.o=null)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(l){a.u=l.getStreamData().adProgressData,a.m&&(a.m.h=a.u)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){a.i(new ye("ad-first-quartile"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){a.i(new ye("ad-midpoint"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){a.i(new ye("ad-third-quartile"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){a.i(new ye("ad-complete")),a.i(new ye("ad-stopped")),a.s.removeAttribute("ad-active"),a.m=null}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){a.i(new ye("ad-skipped")),a.i(new ye("ad-stopped"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(l){var h=l.getStreamData();l=[],h=y(h.cuepoints);for(var d=h.next();!d.done;d=h.next())d=d.value,l.push({start:d.start,end:d.end});a.D=l,a.i(new ye("ad-cue-points-changed",new Map().set("cuepoints",l)))})}ul.prototype.stop=function(){this.B="",this.o=null,this.D=[]},ul.prototype.release=function(){this.stop(),this.h&&this.h.release()},ul.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var i={};i[e.key]=e.data,this.g.onTimedMetadata(i)}};function j1(e,i){e.i(new ye("ads-loaded",new Map().set("loadTime",Date.now()/1e3-e.G))),i=i.getStreamData().url,e.j.resolve(i),e.j=null,e.F||e.h.C(e.l,"seeked",function(){var r=e.l.currentTime;if(r!=0){e.g.streamTimeForContentTime(r);var s=e.g.previousCuePointForStreamTime(r);s&&!s.played&&(e.o=r,e.l.currentTime=s.start)}})}function ae(){Oe.call(this),this.g=this.i=null,this.h=new i_,this.j=navigator.language}he(ae,Oe),p=ae.prototype,p.setLocale=function(e){this.j=e},p.initClientSide=function(e,i){var r=this;if(!u.google||!google.ima||!google.ima.AdsLoader)throw new F(2,10,1e4);this.i&&this.i.release(),this.i=new pc(e,i,this.j,function(s){if(s&&s.type)switch(s.type){case"ads-loaded":r.h.h.push(s.loadTime);break;case"ad-started":r.h.g++;break;case"ad-complete":r.h.i++;break;case"ad-skipped":r.h.j++}r.dispatchEvent(s)})},p.release=function(){this.i&&(this.i.release(),this.i=null),this.g&&(this.g.release(),this.g=null),Oe.prototype.release.call(this)},p.onAssetUnload=function(){this.i&&this.i.stop(),this.g&&this.g.stop(),this.dispatchEvent(new ye("ad-stopped")),this.h=new i_},p.requestClientSideAds=function(e){if(!this.i)throw new F(1,10,10001);var i=this.i;i.u=Date.now()/1e3,i.m.requestAds(e)},p.initServerSide=function(e,i){var r=this;if(!u.google||!google.ima||!google.ima.dai)throw new F(2,10,10002);this.g&&this.g.release(),this.g=new ul(e,i,this.j,function(s){if(s&&s.type)switch(s.type){case"ads-loaded":r.h.h.push(s.loadTime);break;case"ad-started":r.h.g++;break;case"ad-complete":r.h.i++;break;case"ad-skipped":r.h.j++}r.dispatchEvent(s)})},p.requestServerSideStream=function(e,i){if(i=i===void 0?"":i,!this.g)throw new F(1,10,10003);e.adTagParameters||(e.adTagParameters={});var r=e.adTagParameters;return(r.mpt||r.mpv)&&Ve('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.3.5",r=this.g,r.j?e=Promise.reject(new F(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(r.F=!0),r.j=new Ke,r.g.requestStream(e),r.B=i||"",r.G=Date.now()/1e3,e=r.j),e},p.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new F(1,10,10003);(e.mpt||e.mpv)&&Ve('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.3.5",this.g.g.replaceAdTagParameters(e)},p.getServerSideCuePoints=function(){if(!this.g)throw new F(1,10,10003);return this.g.D},p.getStats=function(){var e=this.h;return{loadTimes:e.h,started:e.g,playedCompletely:e.i,skipped:e.j}},p.onDashTimedMetadata=function(e){if(this.g&&e.schemeIdUri=="urn:google:dai:2018"){var i=e.schemeIdUri,r=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.g.g.processMetadata(i,r,e.startTime)}},p.onHlsTimedMetadata=function(e,i){this.g&&this.g.g.processMetadata("ID3",e.data,i)},p.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)},ie("shaka.ads.AdManager",ae),ae.prototype.onCueMetadataChange=ae.prototype.onCueMetadataChange,ae.prototype.onHlsTimedMetadata=ae.prototype.onHlsTimedMetadata,ae.prototype.onDashTimedMetadata=ae.prototype.onDashTimedMetadata,ae.prototype.getStats=ae.prototype.getStats,ae.prototype.getServerSideCuePoints=ae.prototype.getServerSideCuePoints,ae.prototype.replaceServerSideAdTagParameters=ae.prototype.replaceServerSideAdTagParameters,ae.prototype.requestServerSideStream=ae.prototype.requestServerSideStream,ae.prototype.initServerSide=ae.prototype.initServerSide,ae.prototype.requestClientSideAds=ae.prototype.requestClientSideAds,ae.prototype.onAssetUnload=ae.prototype.onAssetUnload,ae.prototype.release=ae.prototype.release,ae.prototype.initClientSide=ae.prototype.initClientSide,ae.prototype.setLocale=ae.prototype.setLocale,ae.ADS_LOADED="ads-loaded",ae.AD_STARTED="ad-started",ae.AD_FIRST_QUARTILE="ad-first-quartile",ae.AD_MIDPOINT="ad-midpoint",ae.AD_THIRD_QUARTILE="ad-third-quartile",ae.AD_COMPLETE="ad-complete",ae.AD_STOPPED="ad-stopped",ae.AD_SKIPPED="ad-skipped",ae.AD_VOLUME_CHANGED="ad-volume-changed",ae.AD_MUTED="ad-muted",ae.AD_PAUSED="ad-paused",ae.AD_RESUMED="ad-resumed",ae.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",ae.CUEPOINTS_CHANGED="ad-cue-points-changed",ae.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",ae.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",ae.AD_CLICKED="ad-clicked",ae.AD_PROGRESS="ad-progress",ae.AD_BUFFERING="ad-buffering",ae.AD_IMPRESSION="ad-impression",ae.AD_DURATION_CHANGED="ad-duration-changed",ae.AD_CLOSED="ad-closed",ae.AD_LOADED="ad-loaded",ae.ALL_ADS_COMPLETED="all-ads-completed",ae.AD_LINEAR_CHANGED="ad-linear-changed",ae.AD_METADATA="ad-metadata",ae.AD_RECOVERABLE_ERROR="ad-recoverable-error",ae.AD_BREAK_READY="ad-break-ready",ae.AD_INTERACTION="ad-interaction",sl=function(){return new ae};function s_(e){return JSON.stringify(e,function(i,r){if(typeof r!="function"){if(r instanceof Event||r instanceof ye){var s={};for(a in r)(i=r[a])&&typeof i=="object"?a=="detail"&&(s[a]=i):a in Event||(s[a]=i);return s}if(r instanceof Error){var a=new Set(["name","message","stack"]);for(s in r)a.add(s);for(i=y(Object.getOwnPropertyNames(r)),s=i.next();!s.done;s=i.next())a.add(s.value);for(i={},a=y(a),s=a.next();!s.done;s=a.next())s=s.value,i[s]=r[s];r={__type__:"Error",contents:i}}else if(r instanceof TimeRanges){for(a={__type__:"TimeRanges",length:r.length,start:[],end:[]},r=y(Dr(r)),s=r.next();!s.done;s=r.next())s=s.value,i=s.end,a.start.push(s.start),a.end.push(i);r=a}else r=r instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(r)}:typeof r=="number"?isNaN(r)?"NaN":isFinite(r)?r:0>r?"-Infinity":"Infinity":r;return r}})}function gc(e){return JSON.parse(e,function(i,r){if(r=="NaN")var s=NaN;else if(r=="-Infinity")s=-1/0;else if(r=="Infinity")s=1/0;else if(r&&typeof r=="object"&&r.__type__=="TimeRanges")s=H1(r);else if(r&&typeof r=="object"&&r.__type__=="Uint8Array")s=new Uint8Array(r.entries);else if(r&&typeof r=="object"&&r.__type__=="Error"){i=r.contents,r=Error(i.message);for(s in i)r[s]=i[s];s=r}else s=r;return s})}function H1(e){return{length:e.length,start:function(i){return e.start[i]},end:function(i){return e.end[i]}}}var o_="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),V1="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),mc=["loop","playbackRate"],W1=["pause","play"],hl={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10},cl={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},_c={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},a_=[["getConfiguration","configure"]],l_=[["isTextTrackVisible","setTextTrackVisibility"]],G1="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),X1=["attach","attachCanvas","detach","load","unload"];function yc(e,i,r,s,a,l,h){var d=this;this.G=e,this.M=h,this.j=new Ee(i),this.O=r,this.u=!1,this.s=s,this.F=a,this.J=l,this.h=this.m=!1,this.L="",this.o=null,this.B=function(){return vc(d)},this.D=function(g,_){switch(g=gc(_),g.type){case"event":var x=g.targetName,T=Np(g.event);d.s(x,T);break;case"update":x=g.update;for(T in x){g=d.g[T]||{};for(var S in x[T])g[S]=x[T][S]}d.u&&(d.O(),d.u=!1);break;case"asyncComplete":if(T=g.id,S=g.error,g=d.i[T],delete d.i[T],g)if(S){T=new F(S.severity,S.category,S.code);for(x in S)T[x]=S[x];g.reject(T)}else g.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.l=null,xo.add(this)}p=yc.prototype,p.destroy=function(){return xo.delete(this),wc(this),_i&&c_(this),this.j&&(this.j.stop(),this.j=null),this.F=this.s=null,this.h=this.m=!1,this.D=this.B=this.l=this.i=this.g=this.o=null,Promise.resolve()},p.sa=function(){return this.h},p.ae=function(){return this.L},p.init=function(){if(this.G.length)if(u.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.Mb();var e=new chrome.cast.SessionRequest(this.G,[],null,this.M,null);e=new chrome.cast.ApiConfig(e,function(i){for(var r=y(xo),s=r.next();!s.done;s=r.next())h_(s.value,i)},function(i){for(var r=y(xo),s=r.next();!s.done;s=r.next())s=s.value,dl=i=="available",s.j.Mb()},"origin_scoped"),chrome.cast.initialize(e,function(){},function(){}),dl&&this.j.N($1),(e=_i)&&e.status!=chrome.cast.SessionStatus.STOPPED?h_(this,e):_i=null}else u.__onGCastApiAvailable!==d_&&(fl=u.__onGCastApiAvailable||null,u.__onGCastApiAvailable=d_)},p.ie=function(e){this.o=e,this.h&&yo(this,{type:"appData",appData:this.o})},p.cast=function(e){var i=this;return B(function(r){if(!i.m)throw new F(1,8,8e3);if(!dl)throw new F(1,8,8001);if(i.h)throw new F(1,8,8002);return i.l=new Ke,chrome.cast.requestSession(function(s){return xc(i,e,s)},function(s){return u_(i,s)}),b(r,i.l,0)})};function q1(e){if(e.h){var i=e.J();chrome.cast.requestSession(function(r){return xc(e,i,r)},function(r){return u_(e,r)})}}p.Ab=function(){if(this.h){if(wc(this),_i){c_(this);try{_i.stop(function(){},function(){})}catch(e){}_i=null}vc(this)}},p.get=function(e,i){var r=this;if(e=="video"){if(W1.includes(i))return function(){return r.Qe.apply(r,[e,i].concat(I(Vt.apply(0,arguments))))}}else if(e=="player"){if(_c[i]&&!this.get("player","isLive")())return function(){};if(G1.includes(i))return function(){return r.Qe.apply(r,[e,i].concat(I(Vt.apply(0,arguments))))};if(X1.includes(i))return function(){return r.og.apply(r,[e,i].concat(I(Vt.apply(0,arguments))))};if(hl[i]||cl[i])return function(){return r.g[e][i]}}return this.g[e][i]},p.set=function(e,i,r){this.g[e][i]=r,yo(this,{type:"set",targetName:e,property:i,value:r})};function xc(e,i,r){_i=r,r.addUpdateListener(e.B),r.addMessageListener("urn:x-cast:com.google.shaka.v2",e.D),vc(e),yo(e,{type:"init",initState:i,appData:e.o}),e.l.resolve()}function u_(e,i){var r=8003;switch(i.code){case"cancel":r=8004;break;case"timeout":r=8005;break;case"receiver_unavailable":r=8006}e.l.reject(new F(2,8,r,i))}p.Qe=function(e,i){yo(this,{type:"call",targetName:e,methodName:i,args:Vt.apply(2,arguments)})},p.og=function(e,i){var r=Vt.apply(2,arguments),s=new Ke,a=this.H.toString();this.H++,this.i[a]=s;try{yo(this,{type:"asyncCall",targetName:e,methodName:i,args:r,id:a})}catch(l){s.reject(l)}return s};function h_(e,i){var r=e.J();e.l=new Ke,e.u=!0,xc(e,r,i)}function c_(e){var i=_i;i.removeUpdateListener(e.B),i.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.D)}function vc(e){var i=_i?_i.status=="connected":!1;if(e.h&&!i){e.F();for(var r in e.g)e.g[r]={};wc(e)}e.h=i,e.L=i?_i.receiver.friendlyName:"",e.j.Mb()}function wc(e){for(var i in e.i){var r=e.i[i];delete e.i[i],r.reject(new F(1,7,7e3))}}function yo(e,i){i=s_(i);var r=_i;try{r.sendMessage("urn:x-cast:com.google.shaka.v2",i,function(){},sa)}catch(s){throw i=new F(2,8,8005,s),r=new ye("error",new Map().set("detail",i)),e.s("player",r),e.Ab(),i}}var $1=.02,dl=!1,_i=null,fl=null,xo=new Set;function d_(e){if(fl?u.__onGCastApiAvailable=fl:delete u.__onGCastApiAvailable,fl=null,e)for(var i=y(xo),r=i.next();!r.done;r=i.next())r.value.init();typeof u.__onGCastApiAvailable=="function"&&u.__onGCastApiAvailable(e)}function ht(e,i,r,s){s=s===void 0?!1:s,Oe.call(this);var a=this;this.i=e,this.h=i,this.m=this.o=this.j=this.s=this.l=null,this.D=r,this.B=s,this.u=new Map,this.g=new yc(r,function(){return p_(a)},function(){return g_(a)},function(l,h){return __(a,l,h)},function(){return m_(a)},function(){return Tc(a)},s),Y1(this)}he(ht,Oe),p=ht.prototype,p.destroy=function(e){return e&&this.g.Ab(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,Oe.prototype.release.call(this),Promise.all(e)},p.Wf=function(){return this.l},p.Nf=function(){return this.s},p.nf=function(){return this.g.m&&dl},p.sa=function(){return this.g.sa()},p.ae=function(){return this.g.ae()},p.cast=function(){var e=this,i;return B(function(r){return r.g==1?(i=Tc(e),b(r,e.g.cast(i),2)):e.h?b(r,e.h.re(),0):r.return()})},p.ie=function(e){this.g.ie(e)},p.zg=function(){q1(this.g)},p.Ab=function(){this.g.Ab()},p.qf=function(e,i){i=i===void 0?!1:i;var r=this;return B(function(s){if(s.g==1)return e==r.D&&i==r.B?s.return():(r.D=e,r.B=i,r.g.Ab(),b(s,r.g.destroy(),2));r.g=null,r.g=new yc(e,function(){return p_(r)},function(){return g_(r)},function(a,l){return __(r,a,l)},function(){return m_(r)},function(){return Tc(r)},i),r.g.init(),Q(s)})};function Y1(e){e.g.init(),e.m=new Ye;for(var i=y(o_),r=i.next();!r.done;r=i.next())e.m.C(e.i,r.value,function(l){e.g.sa()||(l=Np(l),e.j.dispatchEvent(l))});for(var s in wa)e.m.C(e.h,wa[s],function(l){e.g.sa()||e.o.dispatchEvent(l)});e.l={},i={};for(var a in e.i)i.Sb=a,Object.defineProperty(e.l,i.Sb,{configurable:!1,enumerable:!0,get:function(l){return function(){return Z1(e,l.Sb)}}(i),set:function(l){return function(h){var d=l.Sb;e.g.sa()?e.g.set("video",d,h):e.i[d]=h}}(i)}),i={Sb:i.Sb};e.s={},f_(e,function(l){Object.defineProperty(e.s,l,{configurable:!1,enumerable:!0,get:function(){return Q1(e,l)}})}),K1(e),e.j=new Oe,e.j.Wc=e.l,e.o=new Oe,e.o.Wc=e.s}function K1(e){var i=new Map;f_(e,function(r,s){i.has(s)?(s=i.get(s),r.length<s.length?e.u.set(r,s):e.u.set(s,r)):i.set(s,r)})}function f_(e,i){function r(g){return g=="constructor"||typeof s[g]!="function"?!1:!a.has(g)}var s=e.h,a=new Set,l;for(l in s)r(l)&&(a.add(l),i(l,s[l]));for(e=Object.getPrototypeOf(s),l=Object.getPrototypeOf({});e&&e!=l;){for(var h=y(Object.getOwnPropertyNames(e)),d=h.next();!d.done;d=h.next())d=d.value,r(d)&&(a.add(d),i(d,s[d]));e=Object.getPrototypeOf(e)}}function Tc(e){var i={video:{},player:{},playerAfterLoad:{},manifest:e.h.Dd(),startTime:null};e.i.pause();for(var r=y(mc),s=r.next();!s.done;s=r.next())s=s.value,i.video[s]=e.i[s];for(e.i.ended||(i.startTime=e.i.currentTime),r=y(a_),s=r.next();!s.done;s=r.next()){var a=s.value;s=a[1],a=e.h[a[0]](),i.player[s]=a}for(r=y(l_),s=r.next();!s.done;s=r.next())a=s.value,s=a[1],a=e.h[a[0]](),i.playerAfterLoad[s]=a;return i}function p_(e){var i=new ye("caststatuschanged");e.dispatchEvent(i)}function g_(e){var i=new ye(e.l.paused?"pause":"play");e.j.dispatchEvent(i)}function m_(e){for(var i=y(a_),r=i.next();!r.done;r=i.next()){var s=r.value;r=s[1],s=e.g.get("player",s[0])(),e.h[r](s)}var a=e.g.get("player","getAssetUri")();r=e.g.get("video","ended"),i=Promise.resolve();var l=e.i.autoplay;s=null,r||(s=e.g.get("video","currentTime")),a&&(e.i.autoplay=!1,i=e.h.load(a,s));var h={};for(r=y(mc),s=r.next();!s.done;s=r.next())s=s.value,h[s]=e.g.get("video",s);i.then(function(){if(e.i){for(var d=y(mc),g=d.next();!g.done;g=d.next())g=g.value,e.i[g]=h[g];for(d=y(l_),g=d.next();!g.done;g=d.next()){var _=g.value;g=_[1],_=e.g.get("player",_[0])(),e.h[g](_)}e.i.autoplay=l,a&&e.i.play()}},function(d){d=new Map().set("detail",d),d=new ye("error",d),e.h.dispatchEvent(d)})}function Z1(e,i){if(i=="addEventListener")return function(s,a,l){return e.j.addEventListener(s,a,l)};if(i=="removeEventListener")return function(s,a,l){return e.j.removeEventListener(s,a,l)};if(e.g.sa()&&Object.keys(e.g.g.video).length==0){var r=e.i[i];if(typeof r!="function")return r}return e.g.sa()?e.g.get("video",i):(i=e.i[i],typeof i=="function"&&(i=i.bind(e.i)),i)}function Q1(e,i){if(e.u.has(i)&&(i=e.u.get(i)),i=="addEventListener")return function(r,s,a){return e.o.addEventListener(r,s,a)};if(i=="removeEventListener")return function(r,s,a){return e.o.removeEventListener(r,s,a)};if(i=="getMediaElement")return function(){return e.l};if(i=="getSharedConfiguration")return e.g.get("player","getConfiguration");if(i=="getNetworkingEngine")return function(){return e.h.jc()};if(i=="getDrmEngine")return function(){return e.h.m};if(i=="getAdManager")return function(){return e.h.Ge()};if(i=="setVideoContainer")return function(r){return e.h.$e(r)};if(e.g.sa()){if(i=="getManifest"||i=="drmInfo")return function(){return Ve(i+"() does not work while casting!"),null};if(i=="attach"||i=="detach")return function(){return Ve(i+"() does not work while casting!"),Promise.resolve()}}return e.g.sa()&&Object.keys(e.g.g.video).length==0&&(hl[i]||cl[i])||!e.g.sa()?e.h[i].bind(e.h):e.g.get("player",i)}function __(e,i,r){e.g.sa()&&(i=="video"?e.j.dispatchEvent(r):i=="player"&&e.o.dispatchEvent(r))}ie("shaka.cast.CastProxy",ht),ht.prototype.changeReceiverId=ht.prototype.qf,ht.prototype.forceDisconnect=ht.prototype.Ab,ht.prototype.suggestDisconnect=ht.prototype.zg,ht.prototype.setAppData=ht.prototype.ie,ht.prototype.cast=ht.prototype.cast,ht.prototype.receiverName=ht.prototype.ae,ht.prototype.isCasting=ht.prototype.sa,ht.prototype.canCast=ht.prototype.nf,ht.prototype.getPlayer=ht.prototype.Nf,ht.prototype.getVideo=ht.prototype.Wf,ht.prototype.destroy=ht.prototype.destroy;function bt(e,i,r,s){Oe.call(this);var a=this;this.g=e,this.h=i,this.j=new Ye,this.H={video:e,player:i},this.D=r||function(){},this.J=s||function(l){return l},this.i=null,this.F=!1,this.o=!0,this.m=0,this.B=!1,this.u=!0,this.s=this.l=null,this.G=new Ee(function(){Sc(a)}),J1(this)}he(bt,Oe),p=bt.prototype,p.isConnected=function(){return this.F},p.$f=function(){return this.o},p.wg=function(e){this.i=e},p.uf=function(){this.i=null},p.xg=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},p.vg=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},p.ug=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},p.destroy=function(){var e=this,i,r;return B(function(s){if(s.g==1)return e.j&&(e.j.release(),e.j=null),i=[],e.h&&(i.push(e.h.destroy()),e.h=null),e.G&&(e.G.stop(),e.G=null),e.g=null,e.H=null,e.D=null,e.F=!1,e.o=!0,e.l=null,e.s=null,Oe.prototype.release.call(e),b(s,Promise.all(i),2);r=cast.receiver.CastReceiverManager.getInstance(),r.stop(),Q(s)})};function J1(e){var i=cast.receiver.CastReceiverManager.getInstance();i.onSenderConnected=function(){return y_(e)},i.onSenderDisconnected=function(){return y_(e)},i.onSystemVolumeChanged=function(){var a=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();a&&fr(e,{type:"update",update:{video:{volume:a.level,muted:a.muted}}},e.l),fr(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=i.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(a){return iC(e,a)},e.l=i.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(a){return tC(e,a)},i.start(),i=y(o_);for(var r=i.next();!r.done;r=i.next())e.j.C(e.g,r.value,function(a){return x_(e,"video",a)});for(var s in wa)e.j.C(e.h,wa[s],function(a){return x_(e,"player",a)});cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.ke(3840,2160):e.h.ke(1920,1080),e.j.C(e.g,"loadeddata",function(){e.B=!0}),e.j.C(e.h,"loading",function(){e.o=!1,ds(e)}),e.j.C(e.g,"playing",function(){e.o=!1,ds(e)}),e.j.C(e.g,"pause",function(){ds(e)}),e.j.C(e.h,"unloading",function(){e.o=!0,ds(e)}),e.j.C(e.g,"ended",function(){new Ee(function(){e.g&&e.g.ended&&(e.o=!0,ds(e))}).N(nC)})}function y_(e){e.m=0,e.u=!0,e.F=cast.receiver.CastReceiverManager.getInstance().getSenders().length!=0,ds(e)}function ds(e){var i;B(function(r){if(r.g==1)return b(r,Promise.resolve(),2);if(!e.h)return r.return();i=new ye("caststatuschanged"),e.dispatchEvent(i),v_(e)||pr(e),Q(r)})}function eC(e,i,r){var s,a,l,h,d,g,_,x,T,S;B(function(A){switch(A.g){case 1:for(s in i.player)a=i.player[s],e.h[s](a);return e.D(r),l=e.g.autoplay,i.manifest?(e.g.autoplay=!1,fe(A,5),b(A,e.h.load(i.manifest,i.startTime),7)):b(A,Promise.resolve(),3);case 7:we(A,3);break;case 5:return h=oe(A),d=new Map().set("detail",h),g=new ye("error",d),e.h&&e.h.dispatchEvent(g),A.return();case 3:if(!e.h)return A.return();for(_ in i.video)x=i.video[_],e.g[_]=x;for(T in i.playerAfterLoad)S=i.playerAfterLoad[T],e.h[T](S);e.g.autoplay=l,i.manifest&&(e.g.play(),pr(e)),Q(A)}})}function x_(e,i,r){e.h&&(Sc(e),fr(e,{type:"event",targetName:i,event:r},e.l))}function Sc(e){e.G.N(rC);for(var i={video:{},player:{}},r=y(V1),s=r.next();!s.done;s=r.next())s=s.value,i.video[s]=e.g[s];if(e.h.U())for(var a in _c)e.m%_c[a]==0&&(i.player[a]=e.h[a]());for(var l in hl)e.m%hl[l]==0&&(i.player[l]=e.h[l]());(r=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(i.video.volume=r.level,i.video.muted=r.muted),fr(e,{type:"update",update:i},e.l);for(var h in cl)e.m%cl[h]==0&&(i={player:{}},i.player[h]=e.h[h](),fr(e,{type:"update",update:i},e.l));e.B&&(e.m+=1),v_(e)}function v_(e){return e.u&&(e.g.duration||e.h.U())?(Cc(e),e.u=!1,!0):!1}function Cc(e,i){var r={contentId:e.h.Dd(),streamType:e.h.U()?"LIVE":"BUFFERED",contentType:""};e.h.U()||(r.duration=e.g.duration),e.i&&(r.metadata=e.i),pr(e,i===void 0?0:i,r)}function tC(e,i){var r=gc(i.data);switch(r.type){case"init":e.m=0,e.B=!1,e.u=!0,eC(e,r.initState,r.appData),Sc(e);break;case"appData":e.D(r.appData);break;case"set":var s=r.targetName,a=r.property;if(r=r.value,s=="video"){if(i=cast.receiver.CastReceiverManager.getInstance(),a=="volume"){i.setSystemVolumeLevel(r);break}else if(a=="muted"){i.setSystemVolumeMuted(r);break}}e.H[s][a]=r;break;case"call":s=e.H[r.targetName],s[r.methodName].apply(s,r.args);break;case"asyncCall":s=r.targetName,a=r.methodName,s=="player"&&a=="load"&&(e.m=0,e.B=!1);var l=r.id,h=i.senderId;i=e.H[s],r=i[a].apply(i,r.args),s=="player"&&a=="load"&&(r=r.then(function(){e.u=!0})),r.then(function(){return w_(e,h,l,null)},function(d){return w_(e,h,l,d)})}}function iC(e,i){var r=gc(i.data);switch(r.type){case"PLAY":e.g.play(),pr(e);break;case"PAUSE":e.g.pause(),pr(e);break;case"SEEK":i=r.currentTime;var s=r.resumeState;i!=null&&(e.g.currentTime=Number(i)),s&&s=="PLAYBACK_START"?(e.g.play(),pr(e)):s&&s=="PLAYBACK_PAUSE"&&(e.g.pause(),pr(e));break;case"STOP":e.h.re().then(function(){e.h&&pr(e)});break;case"GET_STATUS":Cc(e,Number(r.requestId));break;case"VOLUME":s=r.volume,i=s.level,s=s.muted;var a=e.g.volume,l=e.g.muted;i!=null&&(e.g.volume=Number(i)),s!=null&&(e.g.muted=s),a==e.g.volume&&l==e.g.muted||pr(e);break;case"LOAD":e.m=0,e.B=!1,e.u=!1,i=r.media,s=r.currentTime,a=e.J(i.contentId),l=r.autoplay||!0,e.D(i.customData),l&&(e.g.autoplay=!0),e.h.load(a,s).then(function(){e.h&&Cc(e)}).catch(function(h){var d="LOAD_FAILED";h.category==7&&h.code==7e3&&(d="LOAD_CANCELLED"),fr(e,{requestId:Number(r.requestId),type:d},e.s)});break;default:fr(e,{requestId:Number(r.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}function w_(e,i,r,s){e.h&&fr(e,{type:"asyncComplete",id:r,error:s},e.l,i)}function fr(e,i,r,s){e.F&&(e=s_(i),s?r.getCastChannel(s).send(e):r.broadcast(e))}function pr(e,i,r){r=r===void 0?null:r;var s={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?sC:e.h.Fd()?aC:e.g.paused?lC:oC,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};r&&(s.media=r),fr(e,{requestId:i===void 0?0:i,type:"MEDIA_STATUS",status:[s]},e.s)}ie("shaka.cast.CastReceiver",bt),bt.prototype.destroy=bt.prototype.destroy,bt.prototype.setContentArtist=bt.prototype.ug,bt.prototype.setContentImage=bt.prototype.vg,bt.prototype.setContentTitle=bt.prototype.xg,bt.prototype.clearContentMetadata=bt.prototype.uf,bt.prototype.setContentMetadata=bt.prototype.wg,bt.prototype.isIdle=bt.prototype.$f,bt.prototype.isConnected=bt.prototype.isConnected;var rC=.5,nC=5,sC="IDLE",oC="PLAYING",aC="BUFFERING",lC="PAUSED";function T_(e,i,r){var s=fC(e),a=null;e=[];var l=[],h=new Set(s.map(function(d){return d.keyId}));if(h.delete(null),1<h.size)throw new F(2,4,4010);if(i||(l=s.filter(function(d){return d.fe=="urn:mpeg:dash:mp4protection:2011"?(a=d.init||a,!1):!0}),l.length&&(e=dC(a,l,r,h),e.length==0&&(e=[Zr("",a)]))),s.length&&(i||!l.length))for(e=[],i=y(Object.values(r)),r=i.next();!r.done;r=i.next())r=r.value,r!="org.w3.clearkey"&&e.push(Zr(r,a));if(h=Array.from(h)[0]||null)for(i=y(e),r=i.next();!r.done;r=i.next())for(r=y(r.value.initData),s=r.next();!s.done;s=r.next())s.value.keyId=h;return{Be:h,sh:a,drmInfos:e,Fe:!0}}function uC(e,i,r,s){var a=T_(e,r,s);if(i.Fe)e=i.drmInfos.length==1&&!i.drmInfos[0].keySystem,r=a.drmInfos.length==0,(i.drmInfos.length==0||e&&!r)&&(i.drmInfos=a.drmInfos),i.Fe=!1;else if(0<a.drmInfos.length&&(i.drmInfos=i.drmInfos.filter(function(l){return a.drmInfos.some(function(h){return h.keySystem==l.keySystem})}),i.drmInfos.length==0))throw new F(2,4,4008);return a.Be||i.Be}function hC(e){var i=0,r=Wt(e),s=r.getUint32(i,!0);if(s!=e.byteLength)return[];e:{for(e=i+6,i=[];e<r.byteLength-1;){s=r.getUint16(e,!0),e+=2;var a=r.getUint16(e,!0);if(e+=2,a&1||a+e>r.byteLength){r=[];break e}var l=Ie(r,e,a);i.push({type:s,value:l}),e+=a}r=i}return r}function cC(e){e=y(e.getElementsByTagName("DATA"));for(var i=e.next();!i.done;i=e.next()){i=y(i.value.childNodes);for(var r=i.next();!r.done;r=i.next())if(r=r.value,r instanceof Element&&r.tagName=="LA_URL")return r.textContent}return""}function pl(e){return e=ba(e.node,"urn:microsoft:playready","pro"),!e||(e=or(e.textContent),e=hC(e).filter(function(i){return i.type===gC})[0],!e)?"":(e=Lr(e.value,!0),(e=Zs(e,"WRMHEADER"))?cC(e):"")}function dC(e,i,r,s){var a=[];i=y(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;var h=r[l.fe];if(h){var d;if(d=ba(l.node,"urn:microsoft:playready","pro")){d=or(d.textContent);var g=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);d=[{initData:ch(d,g,new Set,0),initDataType:"cenc",keyId:l.keyId}]}else d=null;if(g=null,l.fe==="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e")if(g=s,g.size==0)g=null;else{var _=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),x=new Uint8Array([]);g=[{initData:ch(x,_,g,1),initDataType:"cenc",keyId:l.keyId}]}d=Zr(h,l.init||e||d||g),(h=mC.get(h))&&(d.licenseServerUri=h(l)),a.push(d)}}return a}function fC(e){var i=[];e=y(e);for(var r=e.next();!r.done;r=e.next())(r=pC(r.value))&&i.push(r);return i}function pC(e){var i=e.getAttribute("schemeIdUri"),r=on(e,"urn:mpeg:cenc:2013","default_KID"),s=Kp(e,"urn:mpeg:cenc:2013","pssh").map(Ia);if(!i)return null;if(i=i.toLowerCase(),r&&(r=r.replace(/-/g,"").toLowerCase(),r.includes(" ")))throw new F(2,4,4009);var a=[];try{a=s.map(function(l){return{initDataType:"cenc",initData:or(l),keyId:null}})}catch(l){throw new F(2,4,4007)}return{node:e,fe:i,keyId:r,init:0<a.length?a:null}}var gC=1,mC=new Map().set("com.widevine.alpha",function(e){return(e=ba(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",pl).set("com.microsoft.playready.recommendation",pl).set("com.microsoft.playready.software",pl).set("com.microsoft.playready.hardware",pl).set("org.w3.clearkey",function(e){return(e=ba(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&e.getAttribute("Lic_type")==="EME-1.0"&&e.textContent?e.textContent:""});function gl(e,i,r,s,a){var l={RepresentationID:i,Number:r,Bandwidth:s,Time:a};return e.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(h,d,g,_){if(h=="$$")return"$";var x=l[d];if(x==null)return h;switch(d=="RepresentationID"&&g&&(g=void 0),d=="Time"&&(x=Math.round(x)),_){case void 0:case"d":case"i":case"u":h=x.toString();break;case"o":h=x.toString(8);break;case"x":h=x.toString(16);break;case"X":h=x.toString(16).toUpperCase();break;default:h=x.toString()}return g=u.parseInt(g,10)||1,Array(Math.max(0,g-h.length)+1).join("0")+h})}function S_(e,i){var r=Gi(e,i,"timescale"),s=1;r&&(s=La(r)||1);var a=Gi(e,i,"duration");r=La(a||""),e.I.contentType=="image"&&(r=Ks(a||"")),r&&(r/=s);var l=Gi(e,i,"startNumber");a=Number(Gi(e,i,"presentationTimeOffset"))||0;var h=Wi(l||"");if((l==null||h==null)&&(h=1),l=ml(e,i,"SegmentTimeline"),i=null,l){i=s,e=e.T.duration||1/0,l=st(l,"S");for(var d=[],g=-a,_=0;_<l.length;++_){var x=l[_],T=l[_+1],S=Ze(x,"t",Wi),A=Ze(x,"d",Wi);if(x=Ze(x,"r",pT),S!=null&&(S-=a),!A)break;if(S=S!=null?S:g,x=x||0,0>x)if(T){if(T=Ze(T,"t",Wi),T==null)break;if(S>=T)break;x=Math.ceil((T-S)/A)-1}else{if(e==1/0)break;if(S/i>=e)break;x=Math.ceil((e*i-S)/A)-1}for(0<d.length&&S!=g&&(d[d.length-1].end=S/i),T=0;T<=x;++T)g=S+A,d.push({start:S/i,end:g/i,Dg:S}),S=g}i=d}return{timescale:s,ia:r,Lb:h,Sa:a/s||0,se:a,timeline:i}}function Gi(e,i,r){return[i(e.I),i(e.fa),i(e.$)].filter(Rr).map(function(s){return s.getAttribute(r)}).reduce(function(s,a){return s||a})}function ml(e,i,r){return[i(e.I),i(e.fa),i(e.$)].filter(Rr).map(function(s){return Ea(s,r)}).reduce(function(s,a){return s||a})}function _C(e,i,r,s,a,l){for(var h=on(e,"http://www.w3.org/1999/xlink","href"),d=on(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",g=y(Array.from(e.attributes)),_=g.next();!_.done;_=g.next())_=_.value,_.namespaceURI=="http://www.w3.org/1999/xlink"&&e.removeAttributeNS(_.namespaceURI,_.localName);if(5<=l)return nn(new F(2,4,4028));if(d!="onLoad")return nn(new F(2,4,4027));var x=Gt([s],[h]);return a.request(0,ci(x,i)).Y(function(T){if(T=Jp(T.data,e.tagName),!T)return nn(new F(2,4,4001,h));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;T.childNodes.length;){var S=T.childNodes[0];T.removeChild(S),e.appendChild(S)}for(T=y(Array.from(T.attributes)),S=T.next();!S.done;S=T.next())e.setAttributeNode(S.value.cloneNode(!1));return _l(e,i,r,x[0],a,l+1)})}function _l(e,i,r,s,a,l){if(l=l===void 0?0:l,on(e,"http://www.w3.org/1999/xlink","href")){var h=_C(e,i,r,s,a,l);return r&&(h=h.Y(void 0,function(){return _l(e,i,r,s,a,l)})),h}h=[];for(var d=y(Array.from(e.childNodes)),g=d.next();!g.done;g=d.next())g=g.value,g instanceof Element&&(on(g,"http://www.w3.org/1999/xlink","href")=="urn:mpeg:dash:resolve-to-zero:2013"?e.removeChild(g):g.tagName!="SegmentTimeline"&&h.push(_l(g,i,r,s,a,l)));return Fp(h).Y(function(){return e})}function yC(e,i,r,s,a,l,h){var d,g=new qe().P("sidx",function(_){d=xC(i,s,a,l,h,r,_)});if(e&&g.parse(e),d)return d;throw new F(2,3,3004)}function xC(e,i,r,s,a,l,h){var d=[];h.reader.skip(4);var g=h.reader.K();if(g==0)throw new F(2,3,3005);if(h.version==0)var _=h.reader.K(),x=h.reader.K();else _=h.reader.$a(),x=h.reader.$a();h.reader.skip(2);var T=h.reader.$d();for(e=e+h.size+x,x=0;x<T;x++){var S=h.reader.K(),A=(S&2147483648)>>>31;S&=2147483647;var M=h.reader.K();if(h.reader.skip(4),A==1)throw new F(2,3,3006);d.push(new Me(_/g+r,(_+M)/g+r,function(){return l},e,e+S-1,i,r,s,a)),_+=M,e+=S}return h.parser.stop(),d}function Fr(e){this.h=Wt(e),this.g=new Be(this.h,0)}Fr.prototype.ha=function(){return this.g.ha()};function gr(e){var i=C_(e);if(7<i.length)throw new F(2,3,3002);var r=0;i=y(i);for(var s=i.next();!s.done;s=i.next())r=256*r+s.value;i=C_(e);e:{s=y(vC);for(var a=s.next();!a.done;a=s.next())if(Kr(i,new Uint8Array(a.value))){s=!0;break e}s=!1}if(s)i=e.h.byteLength-e.g.Z();else{if(i.length==8&&i[1]&224)throw new F(2,3,3001);for(a=s=0;a<i.length;a++){var l=i[a];s=a==0?l&(1<<8-i.length)-1:256*s+l}i=s}return i=e.g.Z()+i<=e.h.byteLength?i:e.h.byteLength-e.g.Z(),s=Wt(e.h,e.g.Z(),i),e.g.skip(i),new wC(r,s)}function C_(e){var i=e.g.Z(),r=e.g.Ra();if(r==0)throw new F(2,3,3002);return r=8-Math.floor(Math.log2(r)),e.g.skip(r-1),Ie(e.h,i,r)}var vC=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function wC(e,i){this.id=e,this.g=i}function Ac(e){if(8<e.g.byteLength)throw new F(2,3,3002);if(e.g.byteLength==8&&e.g.getUint8(0)&224)throw new F(2,3,3001);for(var i=0,r=0;r<e.g.byteLength;r++){var s=e.g.getUint8(r);i=256*i+s}return i}function TC(e,i,r,s,a,l,h,d,g){function _(){return a}var x=[];e=new Fr(e.g);for(var T=null,S=null;e.ha();){var A=gr(e);if(A.id==187){var M=SC(A);M&&(A=r*M.Eg,M=i+M.ng,T!=null&&x.push(new Me(T+h,A+h,_,S,M-1,l,h,d,g)),T=A,S=M)}}return T!=null&&x.push(new Me(T+h,s+h,_,S,null,l,h,d,g)),x}function SC(e){var i=new Fr(e.g);if(e=gr(i),e.id!=179)throw new F(2,3,3013);if(e=Ac(e),i=gr(i),i.id!=183)throw new F(2,3,3012);i=new Fr(i.g);for(var r=0;i.ha();){var s=gr(i);if(s.id==241){r=Ac(s);break}}return{Eg:e,ng:r}}function A_(e,i){if(i=ml(e,i,"Initialization"),!i)return null;var r=e.I.wa,s=i.getAttribute("sourceURL");s&&(r=Gt(e.I.wa,[s])),s=0;var a=null;return(i=Ze(i,"range",Ra))&&(s=i.start,a=i.end),new fi(function(){return r},s,a,R_(e))}function CC(e,i){var r=Number(Gi(e,fs,"presentationTimeOffset"))||0,s=Gi(e,fs,"timescale"),a=1;s&&(a=La(s)||1);var l=r/a||0,h=A_(e,fs);AC(e,h);var d=Up(e);return{Bb:function(){var g=ml(d,fs,"RepresentationIndex"),_=d.I.wa;return g&&(g=g.getAttribute("sourceURL"))&&(_=Gt(d.I.wa,[g])),g=b_(d),E_(d,i,h,_,g.start,g.end,l)}}}function E_(e,i,r,s,a,l,h){var d,g,_,x,T,S,A,M,O,P,k,z,D,N,j;return B(function(V){if(V.g==1)return d=e.presentationTimeline,g=!e.Ma||!e.T.Gd,_=e.T.start,x=e.T.duration,T=e.I.mimeType.split("/")[1],S=i,A=null,M=[S(s,a,l),T=="webm"?S(r.ya(),r.Ba,r.ka):null],S=null,b(V,Promise.all(M),2);if(O=V.h,P=O[0],k=O[1]||null,z=null,D=_-h,N=_,j=x?_+x:1/0,T=="mp4")var G=yC(P,a,s,r,D,N,j);else{if(G=new Fr(k),gr(G).id!=440786851)throw new F(2,3,3008);var Y=gr(G);if(Y.id!=408125543)throw new F(2,3,3009);G=Y.g.byteOffset,Y=new Fr(Y.g);for(var K=null;Y.ha();){var le=gr(Y);if(le.id==357149030){K=le;break}}if(!K)throw new F(2,3,3010);for(K=new Fr(K.g),le=1e6,Y=null;K.ha();){var pe=gr(K);if(pe.id==2807729)le=Ac(pe);else if(pe.id==17545)if(pe.g.byteLength==4)Y=pe.g.getFloat32(0);else if(pe.g.byteLength==8)Y=pe.g.getFloat64(0);else throw new F(2,3,3003)}if(Y==null)throw new F(2,3,3011);if(K=le/1e9,Y*=K,le=gr(new Fr(P)),le.id!=475249515)throw new F(2,3,3007);G=TC(le,G,K,Y,s,r,D,N,j)}return z=G,d.Ib(z),A=new Fe(z),g&&A.Wa(N,j,!0),V.return(A)})}function fs(e){return e.wc}function b_(e){var i=ml(e,fs,"RepresentationIndex");return e=Gi(e,fs,"indexRange"),e=Ra(e||""),i&&(e=Ze(i,"range",Ra,e)),e}function AC(e,i){if(I_(e,i),!b_(e))throw new F(2,4,4002)}function I_(e,i){var r=e.I.mimeType.split("/")[1];if(e.I.contentType!=ze&&r!="mp4"&&r!="webm")throw new F(2,4,4006);if(r=="webm"&&!i)throw new F(2,4,4005)}function R_(e){var i=e.I;return{bandwidth:e.bandwidth,audioSamplingRate:i.audioSamplingRate,codecs:i.codecs,contentType:i.contentType,frameRate:i.frameRate||null,height:i.height||null,mimeType:i.mimeType,channelsCount:i.ad,pixelAspectRatio:i.pixelAspectRatio||null,width:i.width||null}}function EC(e,i){var r=A_(e,L_),s=bC(e);if(!s.ia&&!s.timeline&&1<s.Gb.length)throw new F(2,4,4002);if(!s.ia&&!e.T.duration&&!s.timeline&&s.Gb.length==1)throw new F(2,4,4002);if(s.timeline&&s.timeline.length==0)throw new F(2,4,4002);var a=null,l=null;e.$.id&&e.I.id&&(l=i[e.$.id+","+e.I.id])&&(a=l.segmentIndex);var h=IC(e.T.start,e.T.duration,e.I.wa,s,r);return i=!a,a?a.Hb(h,e.presentationTimeline.Pa()):a=new Fe(h),e.presentationTimeline.Ib(h),e.Ma&&e.T.Gd||a.Wa(e.T.start,e.T.duration?e.T.start+e.T.duration:1/0,i),l&&(l.segmentIndex=a),{Bb:function(){return a&&a.g.length!=0||a.pc(h),Promise.resolve(a)}}}function L_(e){return e.ab}function bC(e){var i=RC(e);e=S_(e,L_);var r=e.Lb;r==0&&(r=1);var s=0;return e.ia?s=e.ia*(r-1):e.timeline&&0<e.timeline.length&&(s=e.timeline[0].start),{ia:e.ia,startTime:s,Lb:r,Sa:e.Sa,timeline:e.timeline,Gb:i}}function IC(e,i,r,s,a){var l=s.Gb.length;s.timeline&&s.timeline.length!=s.Gb.length&&(l=Math.min(s.timeline.length,s.Gb.length));for(var h=e-s.Sa,d=i?e+i:1/0,g=[],_=s.startTime,x={},T=0;T<l;x={od:x.od},T++){var S=s.Gb[T];x.od=Gt(r,[S.dg]);var A=void 0;A=s.ia!=null?_+s.ia:s.timeline?s.timeline[T].end:_+i,g.push(new Me(e+_,e+A,function(M){return function(){return M.od}}(x),S.start,S.end,a,h,e,d)),_=A}return g}function RC(e){return[e.I.ab,e.fa.ab,e.$.ab].filter(Rr).map(function(i){return st(i,"SegmentURL")}).reduce(function(i,r){return 0<i.length?i:r}).map(function(i){i.getAttribute("indexRange")&&!e.Ke&&(e.Ke=!0);var r=i.getAttribute("media");return i=Ze(i,"mediaRange",Ra,{start:0,end:null}),{dg:r,start:i.start,end:i.end}})}function LC(e,i,r,s,a,l){var h=DC(e),d=MC(e);PC(d);var g=Up(e);if(d.oc)return I_(e,h),{Bb:function(){var A=gl(d.oc,g.I.id,null,g.bandwidth||null,null);return A=Gt(g.I.wa,[A]),E_(g,i,h,A,0,null,d.Sa)}};if(d.ia)return s||e.fa.contentType==="image"||(e.presentationTimeline.Sd(d.ia),e.presentationTimeline.Td(e.T.start)),{Bb:function(){return kC(g,d,a,h,l)}};var _=null;s=s=null,e.$.id&&e.I.id&&(s=e.$.id+","+e.I.id,s=r[s])&&(_=s.segmentIndex);var x=OC(g,d,h);r=e.T.start;var T=e.T.duration?e.T.start+e.T.duration:1/0,S=!(e.Ma&&e.T.Gd);return _?(S&&new Fe(x).Wa(r,T,!0),_.Hb(x,e.presentationTimeline.Pa())):_=new Fe(x),e.presentationTimeline.Ib(x),S&&_.Wa(r,T),s&&e.Ma&&(s.segmentIndex=_),{Bb:function(){return _&&_.g.length!=0||_.pc(x),Promise.resolve(_)}}}function yl(e){return e.xc}function MC(e){var i=S_(e,yl),r=Gi(e,yl,"media");return e=Gi(e,yl,"index"),{ia:i.ia,timescale:i.timescale,Lb:i.Lb,Sa:i.Sa,se:i.se,timeline:i.timeline,Pd:r,oc:e}}function PC(e){var i=e.oc?1:0;if(i+=e.timeline?1:0,i+=e.ia?1:0,i==0)throw new F(2,4,4002);if(i!=1&&(e.oc&&(e.timeline=null),e.ia=null),!e.oc&&!e.Pd)throw new F(2,4,4002)}function kC(e,i,r,s,a){function l(K){var le=(K-A)*S,pe=le+i.Sa,me=le+_;le=me+S;var Ae=Math.min(le,d());return me=new Me(me,Ae,function(){var ne=gl(O,k,K,P,pe*M);return Gt(z,[ne])},0,null,s,D,_,d()),me.j=le,me}function h(){var K=[Math.max(g.Pa(),_),Math.min(g.gb(),d())].map(function(le){return le-_});return[Math.ceil(K[0]/S),Math.ceil(K[1]/S)-1].map(function(le){return le+A})}function d(){var K=x!=null&&a[x]||T;return K?_+K:1/0}var g=e.presentationTimeline,_=e.T.start,x=e.$.id,T=e.T.duration,S=i.ia,A=i.Lb,M=i.timescale,O=i.Pd,P=e.bandwidth||null,k=e.I.id,z=e.I.wa,D=_-i.Sa,N=h();e=e.Ma?Math.max(N[0],N[1]-r+1):N[0],N=N[1],r=[];for(var j=e;j<=N;++j){var V=l(j);r.push(V)}var G=new Fe(r);if(r=g.gb()<d(),j=g.U(),r||j){var Y=Math.max(e,N+1);G.fd(S,function(){var K=g.Pa();G.eb(K);var le=y(h());le.next(),le=le.next().value;for(var pe=[];Y<=le;){var me=l(Y);pe.push(me),Y++}return K>d()&&!pe.length?null:pe})}return Promise.resolve(G)}function OC(e,i,r){var s=e.T.start,a=e.T.duration,l=s-i.Sa;a=a?s+a:1/0;for(var h=[],d={},g=0;g<i.timeline.length;d={nd:d.nd,rd:d.rd,ud:d.ud,kd:d.kd,wd:d.wd,ld:d.ld},g++){var _=i.timeline[g],x=_.start,T=_.Dg;_=_.end,d.ud=g+i.Lb,d.wd=T+i.se,d.rd=e.I.id,d.kd=e.bandwidth||null,d.nd=i.Pd,d.ld=e.I.wa,h.push(new Me(s+x,s+_,function(S){return function(){var A=gl(S.nd,S.rd,S.ud,S.kd||null,S.wd);return Gt(S.ld,[A]).map(function(M){return M.toString()})}}(d),0,null,r,l,s,a))}return h}function DC(e){var i=Gi(e,yl,"initialization");if(!i)return null;var r=e.I.id,s=e.bandwidth||null,a=e.I.wa;return new fi(function(){var l=gl(i,r,null,s,null);return Gt(a,[l])},0,null,R_(e))}function M_(){this.l=[],this.g=[],this.h=[],this.j=[],this.i=[],this.m=new Set}M_.prototype.release=function(){for(var e=y(this.g.concat(this.h,this.j,this.i)),i=e.next();!i.done;i=e.next())i=i.value,i.segmentIndex&&i.segmentIndex.release();this.g=[],this.h=[],this.j=[],this.i=[],this.l=[]};function FC(e,i,r){var s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae,ne,nt,Qe;return B(function(ct){switch(ct.g){case 1:if(s=Mt,NC(i),zC(i),UC(i),BC(i),!r&&i.length==1){a=i[0],e.g=a.Kc,e.h=a.gd,e.j=a.textStreams,e.i=a.imageStreams,ct.A(2);break}for(l=-1,h=0;h<i.length;h++)d=i[h],e.m.has(d.id)||(e.m.add(d.id),l==-1&&(l=h));if(l==-1)return ct.return();for(g=i.map(function(ti){return ti.Kc}),_=i.map(function(ti){return ti.gd}),x=i.map(function(ti){return ti.textStreams}),T=i.map(function(ti){return ti.imageStreams}),S=y(x),A=S.next();!A.done;A=S.next())M=A.value,M.push(U_(s.X));for(O=y(T),P=O.next();!P.done;P=O.next())k=P.value,k.push(U_(s.Wb));return b(ct,Nr(e.g,g,l,vo,ps),3);case 3:return b(ct,Nr(e.h,_,l,vo,ps),4);case 4:return b(ct,Nr(e.j,x,l,vo,ps),5);case 5:return b(ct,Nr(e.i,T,l,vo,ps),2);case 2:if(z=0,D=[],e.h.length&&e.g.length)for(K=y(e.g),le=K.next();!le.done;le=K.next())for(pe=le.value,me=y(e.h),Ae=me.next();!Ae.done;Ae=me.next())ne=Ae.value,nt=Pa(pe.drmInfos,ne.drmInfos),pe.drmInfos.length&&ne.drmInfos.length&&!nt.length||(Qe=z++,D.push({id:Qe,language:pe.language,primary:pe.primary,audio:pe,video:ne,bandwidth:(pe.bandwidth||0)+(ne.bandwidth||0),drmInfos:nt,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(N=e.h.concat(e.g),j=y(N),V=j.next();!V.done;V=j.next())G=V.value,Y=z++,D.push({id:Y,language:G.language,primary:G.primary,audio:G.type==s.Hc?G:null,video:G.type==s.va?G:null,bandwidth:G.bandwidth||0,drmInfos:G.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});e.l=D,Q(ct)}})}function NC(e){e=y(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=[],s=y(i.Kc),a=s.next();!a.done;a=s.next()){a=a.value;for(var l=!1,h=y(r),d=h.next();!d.done;d=h.next())d=d.value,a.id!=d.id&&a.channelsCount==d.channelsCount&&a.language==d.language&&a.bandwidth==d.bandwidth&&a.label==d.label&&a.codecs==d.codecs&&a.mimeType==d.mimeType&&Ue(a.roles,d.roles)&&a.audioSamplingRate==d.audioSamplingRate&&a.primary==d.primary&&(l=!0);l||r.push(a)}i.Kc=r}}function UC(e){e=y(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=[],s=y(i.textStreams),a=s.next();!a.done;a=s.next()){a=a.value;for(var l=!1,h=y(r),d=h.next();!d.done;d=h.next())d=d.value,a.id!=d.id&&a.language==d.language&&a.label==d.label&&a.codecs==d.codecs&&a.mimeType==d.mimeType&&a.bandwidth==d.bandwidth&&Ue(a.roles,d.roles)&&(l=!0);l||r.push(a)}i.textStreams=r}}function zC(e){e=y(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=[],s=y(i.gd),a=s.next();!a.done;a=s.next()){a=a.value;for(var l=!1,h=y(r),d=h.next();!d.done;d=h.next())d=d.value,a.id!=d.id&&a.width==d.width&&a.frameRate==d.frameRate&&a.codecs==d.codecs&&a.mimeType==d.mimeType&&a.label==d.label&&Ue(a.roles,d.roles)&&cT(a.closedCaptions,d.closedCaptions)&&a.bandwidth==d.bandwidth&&(l=!0);l||r.push(a)}i.gd=r}}function BC(e){e=y(e);for(var i=e.next();!i.done;i=e.next()){i=i.value;for(var r=[],s=y(i.imageStreams),a=s.next();!a.done;a=s.next()){a=a.value;for(var l=!1,h=y(r),d=h.next();!d.done;d=h.next())d=d.value,a.id!=d.id&&a.width==d.width&&a.codecs==d.codecs&&a.mimeType==d.mimeType&&(l=!0);l||r.push(a)}i.imageStreams=r}}function P_(e){var i,r,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe;return B(function(me){switch(me.g){case 1:if(i=Mt,e.length==1)return me.return(e[0]);for(r=e.map(function(Ae){return Ae.filter(function(ne){return ne.type==i.Hc})}),s=e.map(function(Ae){return Ae.filter(function(ne){return ne.type==i.va})}),a=e.map(function(Ae){return Ae.filter(function(ne){return ne.type==i.X})}),l=e.map(function(Ae){return Ae.filter(function(ne){return ne.type==i.Wb})}),h=y(a),d=h.next();!d.done;d=h.next())g=d.value,g.push(N_(i.X));for(_=y(l),x=_.next();!x.done;x=_.next())T=x.value,T.push(N_(i.Wb));return b(me,Nr([],r,0,xl,vl),2);case 2:return S=me.h,b(me,Nr([],s,0,xl,vl),3);case 3:return A=me.h,b(me,Nr([],a,0,xl,vl),4);case 4:return M=me.h,b(me,Nr([],l,0,xl,vl),5);case 5:if(O=me.h,P=0,A.length&&S.length)for(j=y(S),V=j.next();!V.done;V=j.next())for(G=V.value,Y=y(A),K=Y.next();!K.done;K=Y.next())le=K.value,pe=P++,le.variantIds.push(pe),G.variantIds.push(pe);else for(k=A.concat(S),z=y(k),D=z.next();!D.done;D=z.next())N=D.value,N.variantIds=[P++];return me.return(A.concat(S).concat(M).concat(O))}})}function Nr(e,i,r,s,a){var l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y;return B(function(K){switch(K.g){case 1:for(l=Mt,h=[],d=0;d<i.length;d++)d>=r?h.push(new Set(i[d])):h.push(new Set);g=y(e),_=g.next();case 2:if(_.done){K.A(4);break}return x=_.value,b(K,jC(x,i,r,a,h),5);case 5:if(T=K.h,!T)throw new F(2,4,4037);_=g.next(),K.A(2);break;case 4:for(S=y(h),A=S.next();!A.done;A=S.next())for(M=A.value,O=y(M),P=O.next();!P.done;P=O.next())k=P.value,(z=HC(k,i,s,a,h))&&e.push(z);for(D=y(h),A=D.next();!A.done;A=D.next())for(N=A.value,j={},V=y(N),P=V.next();!P.done;j={Va:j.Va},P=V.next())if(j.Va=P.value,G=j.Va.type==l.X&&!j.Va.language,Y=j.Va.type==l.Wb&&!j.Va.tilesLayout,!G&&!Y&&e.some(function(le){return function(pe){return pe.mimeType==le.Va.mimeType&&kr(pe.codecs)==kr(le.Va.codecs)}}(j)))throw new F(2,4,4037);return K.return(e)}})}function jC(e,i,r,s,a){return B(function(l){return l.g==1?(D_(i,e),e.matchedStreams?e.segmentIndex?b(l,k_(e,r),2):l.A(2):l.return(!1)):(O_(e,r,s,a),l.return(!0))})}function k_(e,i){var r,s,a,l,h,d,g;return B(function(_){if(_.g==1){for(r=[],s=e.matchedStreams,a=y(s),l=a.next();!l.done;l=a.next())h=l.value,r.push(h.createSegmentIndex()),h.trickModeVideo&&!h.trickModeVideo.segmentIndex&&r.push(h.trickModeVideo.createSegmentIndex());return b(_,Promise.all(r),2)}if(e.segmentIndex instanceof ut)for(d=0;d<s.length;d++)g=s[d],g.segmentIndex&&d>=i&&e.segmentIndex.l.push(g.segmentIndex);Q(_)})}function HC(e,i,r,s,a){var l=r(e);return D_(i,l),l.createSegmentIndex&&(l.createSegmentIndex=function(){return B(function(h){return l.segmentIndex?h.A(0):(l.segmentIndex=new ut,b(h,k_(l,0),0))})}),l.matchedStreams?(O_(l,0,s,a),l):null}function O_(e,i,r,s){for(var a=e.matchedStreams,l=0;l<a.length;l++)if(l>=i){var h=a[l];r(e,h);var d=!0;e.type=="audio"&&tn(e.language,h.language)==0&&(d=!1),d&&s[l].delete(h)}}function vo(e){var i=Object.assign({},e);return i.originalId=null,i.createSegmentIndex=function(){return Promise.resolve()},i.closeSegmentIndex=function(){if(i.segmentIndex&&(i.segmentIndex.release(),i.segmentIndex=null),i.matchedStreams)for(var r=y(i.matchedStreams),s=r.next();!s.done;s=r.next())s=s.value,s.segmentIndex&&(s.segmentIndex.release(),s.segmentIndex=null)},i.segmentIndex=null,i.emsgSchemeIdUris=[],i.keyIds=new Set,i.closedCaptions=null,i.trickModeVideo=null,i}function xl(e){return e=Object.assign({},e),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function ps(e,i){e.roles=Array.from(new Set(e.roles.concat(i.roles))),i.emsgSchemeIdUris&&(e.emsgSchemeIdUris=Array.from(new Set(e.emsgSchemeIdUris.concat(i.emsgSchemeIdUris)))),e.keyIds=function(l,h){return new Set([].concat(I(l),I(h)))}(e.keyIds,i.keyIds),e.originalId==null?e.originalId=i.originalId:e.originalId+=","+(i.originalId||"");var r=Pa(e.drmInfos,i.drmInfos);if(i.drmInfos.length&&e.drmInfos.length&&!r.length)throw new F(2,4,4038);if(e.drmInfos=r,e.encrypted=e.encrypted||i.encrypted,i.closedCaptions){e.closedCaptions||(e.closedCaptions=new Map),r=y(i.closedCaptions);for(var s=r.next();!s.done;s=r.next()){var a=y(s.value);s=a.next().value,a=a.next().value,e.closedCaptions.set(s,a)}}i.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=vo(i.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),ps(e.trickModeVideo,i.trickModeVideo)):e.trickModeVideo&&ps(e.trickModeVideo,i)}function vl(e,i){e.roles=Array.from(new Set(e.roles.concat(i.roles)));var r=i.keyIds;if(r=new Set([].concat(I(e.keyIds),I(r))),e.keyIds=r,e.encrypted=e.encrypted&&i.encrypted,e.segments.push.apply(e.segments,I(i.segments)),i.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),i=y(i.closedCaptions),r=i.next();!r.done;r=i.next()){var s=y(r.value);r=s.next().value,s=s.next().value,e.closedCaptions.set(r,s)}}function D_(e,i){var r=[];e=y(e);for(var s=e.next();!s.done;s=e.next()){var a=i,l={audio:F_,video:F_,text:VC,image:WC}[a.type],h={audio:GC,video:XC,text:qC,image:$C}[a.type],d=null;s=y(s.value);for(var g=s.next();!g.done;g=s.next())g=g.value,!l(a,g)||d&&!h(a,d,g)||(d=g);if(a=d,!a)return;r.push(a)}i.matchedStreams=r}function F_(e,i){var r;return!(r=i.mimeType!=e.mimeType||kr(i.codecs)!=kr(e.codecs))&&(r=e.drmInfos)&&(e=e.drmInfos,i=i.drmInfos,r=!(!(e.length&&i.length)||0<Pa(e,i).length)),!r}function VC(e,i){return e.language?i.language?!(tn(e.language,i.language)==0||i.kind!=e.kind):!0:!1}function WC(e){return!!e.tilesLayout}function GC(e,i,r){if(e.id==r.id)return!0;var s=tn(e.language,i.language),a=tn(e.language,r.language);return a>s?!0:a<s?!1:e.roles.length?(s=i.roles.filter(function(l){return e.roles.includes(l)}),a=r.roles.filter(function(l){return e.roles.includes(l)}),a.length>s.length?!0:a.length<s.length?!1:r.roles.length<i.roles.length):!r.roles.length&&i.roles.length?!0:r.roles.length&&!i.roles.length?!1:!i.primary&&r.primary?!0:i.primary&&!r.primary?!1:(s=wo(e.channelsCount,i.channelsCount,r.channelsCount),s==Pi?!0:s==mr?!1:(s=wo(e.audioSamplingRate,i.audioSamplingRate,r.audioSamplingRate),s==Pi?!0:s==mr?!1:!!(e.bandwidth&&z_(e.bandwidth,i.bandwidth,r.bandwidth)==Pi)))}function XC(e,i,r){if(e.id==r.id)return!0;var s=wo(e.width*e.height,i.width*i.height,r.width*r.height);if(s==Pi)return!0;if(s==mr)return!1;if(e.frameRate){if(s=wo(e.frameRate,i.frameRate,r.frameRate),s==Pi)return!0;if(s==mr)return!1}return!!(e.bandwidth&&z_(e.bandwidth,i.bandwidth,r.bandwidth)==Pi)}function qC(e,i,r){if(e.id==r.id)return!0;var s=tn(e.language,i.language),a=tn(e.language,r.language);if(a>s)return!0;if(a<s)return!1;if(!i.primary&&r.primary)return!0;if(i.primary&&!r.primary)return!1;if(e.roles.length){if(s=i.roles.filter(function(l){return e.roles.includes(l)}),a=r.roles.filter(function(l){return e.roles.includes(l)}),a.length>s.length)return!0;if(a.length<s.length)return!1}else{if(!r.roles.length&&i.roles.length)return!0;if(r.roles.length&&!i.roles.length)return!1}return!(r.mimeType!=e.mimeType||r.codecs!=e.codecs||i.mimeType==e.mimeType&&i.codecs==e.codecs)}function $C(e,i,r){return e.id==r.id?!0:wo(e.width*e.height,i.width*i.height,r.width*r.height)==Pi}function N_(e){return{id:0,originalId:"",primary:!1,type:e,mimeType:"",codecs:"",language:"",label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function U_(e){return{id:0,originalId:"",createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Fe([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function wo(e,i,r){if(i==e&&e!=r)return mr;if(r==e&&e!=i)return Pi;if(i>e){if(r<=e||r-e<i-e)return Pi;if(r-e>i-e)return mr}else{if(r>e)return mr;if(e-r<e-i)return Pi;if(e-r>e-i)return mr}return B_}function z_(e,i,r){return i=Math.abs(e-i),e=Math.abs(e-r),e<i?Pi:i<e?mr:B_}var Pi=1,B_=0,mr=-1;function To(){var e=this;this.h=this.g=null,this.m=[],this.i=null,this.G=1,this.l={},this.L={},this.j=new M_,this.F=0,this.H=new Gr(5),this.D=new Ee(function(){eA(e)}),this.o=new Ta,this.s=null,this.J=[],this.u=1/0,this.B=!1}p=To.prototype,p.configure=function(e){this.g=e},p.start=function(e,i){var r=this,s;return B(function(a){if(a.g==1)return r.B=i.isLowLatencyMode(),r.m=[e],r.h=i,b(a,Ec(r),2);if(s=a.h,r.h&&H_(r,s),!r.h)throw new F(2,7,7001);return a.return(r.i)})},p.stop=function(){for(var e=y(Object.values(this.l)),i=e.next();!i.done;i=e.next())i=i.value,i.segmentIndex&&i.segmentIndex.release();return this.j&&this.j.release(),this.g=this.h=null,this.m=[],this.i=null,this.l={},this.j=null,this.D!=null&&(this.D.stop(),this.D=null),this.o.destroy()},p.update=function(){var e=this,i;return B(function(r){if(r.g==1)return fe(r,2),b(r,Ec(e),4);if(r.g!=2)return we(r,0);if(i=oe(r),!e.h||!i)return r.return();e.h.onError(i),Q(r)})},p.onExpirationUpdated=function(){};function Ec(e){var i,r,s,a,l,h,d;return B(function(g){return g.g==1?(i=ci(e.m,e.g.retryParameters),r=e.h.networkingEngine,e.h.modifyManifestRequest(i,{format:"d"}),s=Date.now(),a=r.request(0,i),Jn(e.o,a),b(g,a.promise,2)):g.g!=3?(l=g.h,e.h?(l.uri&&!e.m.includes(l.uri)&&e.m.unshift(l.uri),b(g,YC(e,l.data,l.uri),3)):g.return(0)):(h=Date.now(),d=(h-s)/1e3,e.H.sample(1,d),g.return(d))})}function YC(e,i,r){var s,a,l,h;return B(function(d){if(d.g==1){if(s=Jp(i,"MPD"),!s)throw new F(2,4,4001,r);return e.g.dash.disableXlinkProcessing?d.return(j_(e,s,r)):(a=e.g.dash.xlinkFailGracefully,l=_l(s,e.g.retryParameters,a,r,e.h.networkingEngine),Jn(e.o,l),b(d,l.promise,2))}return h=d.h,d.return(j_(e,h,r))})}function j_(e,i,r){var s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae,ne,nt,Qe;return B(function(ct){switch(ct.g){case 1:if((s=e.g.dash.manifestPreprocessor)&&s(i),a=[r],l=st(i,"Location").map(Ia).filter(Rr),0<l.length&&(h=Gt(a,l),a=e.m=h),d=st(i,"BaseURL"),g=d.map(Ia),_=Gt(a,g),x=0,d&&d.length&&(x=Ze(d[0],"availabilityTimeOffset",Ks)||0),T=e.g.dash.ignoreMinBufferTime,S=0,T||(S=Ze(i,"minBufferTime",cr)||0),e.F=Ze(i,"minimumUpdatePeriod",cr,-1),A=Ze(i,"availabilityStartTime",Qp),M=Ze(i,"timeShiftBufferDepth",cr),O=e.g.dash.ignoreSuggestedPresentationDelay,P=null,O||(P=Ze(i,"suggestedPresentationDelay",cr)),k=e.g.dash.ignoreMaxSegmentDuration,z=null,k||(z=Ze(i,"maxSegmentDuration",cr)),D=i.getAttribute("type")||"static",e.i)for(N=e.i.presentationTimeline,j=y(Object.values(e.l)),V=j.next();!V.done;V=j.next())G=V.value,G.segmentIndex&&G.segmentIndex.eb(N.Pa());else Y=e.g.defaultPresentationDelay||1.5*S,K=P!=null?P:Y,N=new de(A,K,e.g.dash.autoCorrectDrift);return N.yc(D=="static"),N.U()&&!isNaN(e.g.availabilityWindowOverride)&&(M=e.g.availabilityWindowOverride),M==null&&(M=1/0),N.me(M),le=i.getAttribute("profiles")||"",pe={Ma:D!="static",presentationTimeline:N,$:null,T:null,fa:null,I:null,bandwidth:0,Ke:!1,zb:x,profiles:le.split(",")},me=KC(e,pe,_,i),Ae=me.duration,ne=me.periods,D!="static"&&me.De||N.Aa(Ae||1/0),e.u&&!e.B&&e.h.isAutoLowLatencyMode()&&(e.h.enableLowLatencyMode(),e.B=e.h.isLowLatencyMode()),e.B?N.Ue(e.u):e.u&&Ve("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),N.Sd(z||1),b(ct,FC(e.j,ne,pe.Ma),2);case 2:if(e.i){e.i.variants=e.j.l,e.i.textStreams=e.j.j.slice(),e.i.imageStreams=e.j.i,e.h.filter(e.i),ct.A(3);break}if(e.i={presentationTimeline:N,variants:e.j.l,textStreams:e.j.j.slice(),imageStreams:e.j.i,offlineSessionIds:[],minBufferTime:S||0,sequenceMode:e.g.dash.sequenceMode},!N.df()){ct.A(4);break}return nt=st(i,"UTCTiming"),b(ct,rA(e,_,nt),5);case 5:if(Qe=ct.h,!e.h)return ct.return();N.Ve(Qe);case 4:N.Md();case 3:e.h.makeTextStreamsForClosedCaptions(e.i),Q(ct)}})}function KC(e,i,r,s){var a=Ze(s,"mediaPresentationDuration",cr),l=[],h=0;s=st(s,"Period");for(var d=0;d<s.length;d++){var g=s[d],_=s[d+1],x=Ze(g,"start",cr,h),T=g.id,S=Ze(g,"duration",cr),A=null;if(_){var M=Ze(_,"start",cr);M!=null&&(A=M-x)}else a!=null&&(A=a-x);if(A==null&&(A=S),!(e.s!==null&&T!==null&&x!==null&&x<e.s)||e.J.includes(T)||d+1==s.length){if(x!==null&&(e.s===null||x>e.s)&&(e.s=x),h=ZC(e,i,r,{start:x,duration:A,node:g,Gd:A==null||!_}),l.push(h),i.$.id&&A&&(e.L[i.$.id]=A),A==null){h=null;break}h=x+A}}return e.J=l.map(function(O){return O.id}),a!=null?{periods:l,duration:a,De:!1}:{periods:l,duration:h,De:!0}}function ZC(e,i,r,s){i.$=bc(s.node,null,r),i.T=s,i.$.zb=i.zb,i.$.id||(i.$.id="__shaka_period_"+s.start);var a=st(s.node,"EventStream");r=i.presentationTimeline.Pa(),a=y(a);for(var l=a.next();!l.done;l=a.next())nA(e,s.start,s.duration,l.value,r);if(r=st(s.node,"AdaptationSet").map(function(x){return QC(e,i,x)}).filter(Rr),i.Ma){for(s=[],a=y(r),l=a.next();!l.done;l=a.next()){l=y(l.value.qg);for(var h=l.next();!h.done;h=l.next())s.push(h.value)}if(s.length!=new Set(s).size)throw new F(2,4,4018)}for(s=r.filter(function(x){return!x.qe}),r=r.filter(function(x){return x.qe}),r=y(r),a=r.next();!a.done;a=r.next()){a=a.value,l=a.qe.split(" "),h=y(s);for(var d=h.next();!d.done;d=h.next()){var g=d.value;if(l.includes(g.id)){d={},g=y(g.streams);for(var _=g.next();!_.done;d={Gc:d.Gc},_=g.next())d.Gc=_.value,d.Gc.trickModeVideo=a.streams.find(function(x){return function(T){return kr(x.Gc.codecs)==kr(T.codecs)}}(d))}}}if(a=e.g.disableAudio?[]:wl(s,"audio"),h=e.g.disableVideo?[]:wl(s,"video"),l=e.g.disableText?[]:wl(s,ze),r=e.g.disableThumbnails?[]:wl(s,"image"),!h.length&&!a.length)throw new F(2,4,4004);for(s=[],a=y(a),d=a.next();!d.done;d=a.next())s.push.apply(s,I(d.value.streams));for(a=[],h=y(h),d=h.next();!d.done;d=h.next())a.push.apply(a,I(d.value.streams));for(h=[],l=y(l),d=l.next();!d.done;d=l.next())h.push.apply(h,I(d.value.streams));for(l=[],r=y(r),d=r.next();!d.done;d=r.next())l.push.apply(l,I(d.value.streams));return{id:i.$.id,Kc:s,gd:a,textStreams:h,imageStreams:l}}function wl(e,i){return e.filter(function(r){return r.contentType==i})}function QC(e,i,r){function s(V){switch(V){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}i.fa=bc(r,i.$,null);var a=!1,l=st(r,"Role"),h=l.map(function(V){return V.getAttribute("value")}).filter(Rr),d=void 0,g=i.fa.contentType==ze;g&&(d="subtitle"),l=y(l);for(var _=l.next();!_.done;_=l.next()){_=_.value;var x=_.getAttribute("schemeIdUri");if(x==null||x=="urn:mpeg:dash:role:2011")switch(_=_.getAttribute("value"),_){case"main":a=!0;break;case"caption":case"subtitle":d=_}}var T;x=st(r,"EssentialProperty"),l=null,_=!1,x=y(x);for(var S=x.next();!S.done;S=x.next()){S=S.value;var A=S.getAttribute("schemeIdUri");A=="http://dashif.org/guidelines/trickmode"?l=S.getAttribute("value"):A=="urn:mpeg:mpegB:cicp:TransferCharacteristics"?T=s(parseInt(S.getAttribute("value"),10)):_=!0}for(x=st(r,"SupplementalProperty"),x=y(x),S=x.next();!S.done;S=x.next())S=S.value,S.getAttribute("schemeIdUri")=="urn:mpeg:mpegB:cicp:TransferCharacteristics"&&(T=s(parseInt(S.getAttribute("value"),10)));x=st(r,"Accessibility");var M=new Map;for(x=y(x),S=x.next();!S.done;S=x.next())if(A=S.value,S=A.getAttribute("schemeIdUri"),A=A.getAttribute("value"),S=="urn:scte:dash:cc:cea-608:2015")if(S=1,A!=null){A=A.split(";");for(var O=y(A),P=O.next();!P.done;P=O.next()){var k=P.value,z=P=void 0;k.includes("=")?(k=k.split("="),P=k[0].startsWith("CC")?k[0]:"CC"+k[0],z=k[1]||"und"):(P="CC"+S,A.length==2?S+=2:S++,z=k),M.set(P,De(z))}}else M.set("CC1","und");else if(S=="urn:scte:dash:cc:cea-708:2015")if(S=1,A!=null)for(A=y(A.split(";")),P=A.next();!P.done;P=A.next())P=P.value,k=O=void 0,P.includes("=")?(P=P.split("="),O="svc"+P[0],k=P[1].split(",")[0].split(":").pop()):(O="svc"+S,S++,k=P),M.set(O,De(k));else M.set("svc1","und");else S=="urn:mpeg:dash:role:2011"&&A!=null&&(h.push(A),A=="captions"&&(d="caption"));if(_)return null;_=st(r,"ContentProtection");var D=T_(_,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),N=De(r.getAttribute("lang")||"und"),j=r.getAttribute("label");if((_=st(r,"Label"))&&_.length&&(_=_[0],_.textContent&&(j=_.textContent)),_=st(r,"Representation"),r=_.map(function(V){return(V=JC(e,i,D,d,N,j,a,h,M,V))&&(V.hdr=V.hdr||T),V}).filter(function(V){return!!V}),r.length==0){if(l=i.fa.contentType=="image",e.g.dash.ignoreEmptyAdaptationSet||g||l)return null;throw new F(2,4,4003)}if(!i.fa.contentType||i.fa.contentType=="application")for(i.fa.contentType=W_(r[0].mimeType,r[0].codecs),g=y(r),x=g.next();!x.done;x=g.next())x.value.type=i.fa.contentType;for(g=y(r),x=g.next();!x.done;x=g.next())for(x=x.value,S=y(D.drmInfos),A=S.next();!A.done;A=S.next())A=A.value,A.keyIds=A.keyIds&&x.keyIds?new Set([].concat(I(A.keyIds),I(x.keyIds))):A.keyIds||x.keyIds;return g=_.map(function(V){return V.getAttribute("id")}).filter(Rr),{id:i.fa.id||"__fake__"+e.G++,contentType:i.fa.contentType,language:N,th:a,streams:r,drmInfos:D.drmInfos,qe:l,qg:g}}function JC(e,i,r,s,a,l,h,d,g,_){if(i.I=bc(_,i.fa,null),e.u=Math.min(e.u,i.I.zb),!iA(i.I))return null;var x=i.T.start;i.bandwidth=Ze(_,"bandwidth",La)||0;var T=i.I.contentType,S=T==ze||T=="application";T=T=="image";try{var A=function(G,Y,K){return sA(e,G,Y,K)};if(i.I.wc)var M=CC(i,A);else if(i.I.ab)M=EC(i,e.l);else if(i.I.xc)M=LC(i,A,e.l,!!e.i,e.g.dash.initialSegmentLimit,e.L);else{var O=i.I.wa,P=i.T.duration||0;M={Bb:function(){return Promise.resolve(Dh(x,P,O))}}}}catch(G){if((S||T)&&G.code==4002)return null;throw G}A=st(_,"ContentProtection"),A=uC(A,r,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),A=new Set(A?[A]:[]);var k=!1;st(_,"SupplementalProperty").some(function(G){return G.getAttribute("schemeIdUri")=="tag:dolby.com,2018:dash:EC3_ExtensionType:2018"&&G.getAttribute("value")=="JOC"})&&(k=!0);var z=!1;S&&(z=d.includes("forced_subtitle")||d.includes("forced-subtitle"));var D;if(T&&((_=st(_,"EssentialProperty").find(function(G){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(G.getAttribute("schemeIdUri"))}))&&(D=_.getAttribute("value")),!D))return null;var N;_=i.I.codecs,i.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(_.includes("hvc1.2.4.L153.B0")||_.includes("hev1.2.4.L153.B0"))&&(N="PQ");var j=i.I.id?i.$.id+","+i.I.id:"",V={id:e.G++,originalId:i.I.id,createSegmentIndex:function(){var G,Y;return B(function(K){if(K.g==1)return G=j&&i.Ma&&e.l[j]?e.l[j]:V,G.segmentIndex?K.A(0):(Y=G,b(K,M.Bb(),3));Y.segmentIndex=K.h,Q(K)})},closeSegmentIndex:function(){V.segmentIndex&&(V.segmentIndex.release(),V.segmentIndex=null)},segmentIndex:null,mimeType:i.I.mimeType,codecs:i.I.codecs,frameRate:i.I.frameRate,pixelAspectRatio:i.I.pixelAspectRatio,bandwidth:i.bandwidth,width:i.I.width,height:i.I.height,kind:s,encrypted:0<r.drmInfos.length,drmInfos:r.drmInfos,keyIds:A,language:a,label:l,type:i.fa.contentType,primary:h,trickModeVideo:null,emsgSchemeIdUris:i.I.emsgSchemeIdUris,roles:d,forced:z,channelsCount:i.I.ad,audioSamplingRate:i.I.audioSamplingRate,spatialAudio:k,closedCaptions:g,hdr:N,tilesLayout:D,matchedStreams:[]};return j&&i.Ma&&!e.l[j]&&(e.l[j]=V),V}function eA(e){var i,r;B(function(s){switch(s.g){case 1:return i=0,fe(s,2),b(s,Ec(e),4);case 4:i=s.h,we(s,3);break;case 2:r=oe(s),e.h&&(r.severity=1,e.h.onError(r));case 3:if(!e.h)return s.return();H_(e,i),Q(s)}})}function H_(e,i){0>e.F||e.D.N(Math.max(3,e.F-i,rr(e.H)))}function bc(e,i,r){i=i||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,ad:null,audioSamplingRate:null,zb:0},r=r||i.wa;var s=st(e,"BaseURL"),a=s.map(Ia),l=e.getAttribute("contentType")||i.contentType,h=e.getAttribute("mimeType")||i.mimeType,d=e.getAttribute("codecs")||i.codecs,g=Ze(e,"frameRate",gT)||i.frameRate,_=e.getAttribute("sar")||i.pixelAspectRatio,x=st(e,"InbandEventStream"),T=i.emsgSchemeIdUris.slice();x=y(x);for(var S=x.next();!S.done;S=x.next())S=S.value.getAttribute("schemeIdUri"),T.includes(S)||T.push(S);x=st(e,"AudioChannelConfiguration"),x=tA(x)||i.ad,S=Ze(e,"audioSamplingRate",Wi)||i.audioSamplingRate,l||(l=W_(h,d));var A=Ea(e,"SegmentBase"),M=Ea(e,"SegmentTemplate"),O=A&&Ze(A,"availabilityTimeOffset",Ks)||0,P=M&&Ze(M,"availabilityTimeOffset",Ks)||0;return s=s&&s.length&&Ze(s[0],"availabilityTimeOffset",Ks)||0,s=i.zb+s+O+P,{wa:Gt(r,a),wc:A||i.wc,ab:Ea(e,"SegmentList")||i.ab,xc:M||i.xc,width:Ze(e,"width",Wi)||i.width,height:Ze(e,"height",Wi)||i.height,contentType:l,mimeType:h,codecs:d,frameRate:g,pixelAspectRatio:_,emsgSchemeIdUris:T,id:e.getAttribute("id"),ad:x,audioSamplingRate:S,zb:s}}function tA(e){e=y(e);for(var i=e.next();!i.done;i=e.next()){var r=i.value;if((i=r.getAttribute("schemeIdUri"))&&(r=r.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(i=parseInt(r,10),!i)continue;return i;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(i=parseInt(r,16),!i)continue;for(e=0;i;)i&1&&++e,i>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(i=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(r=parseInt(r,10))&&0<r&&r<i.length)return i[r]}}return null}function iA(e){var i=e.wc?1:0;return i+=e.ab?1:0,i+=e.xc?1:0,i==0?e.contentType==ze||e.contentType=="application":(i!=1&&(e.wc&&(e.ab=null),e.xc=null),!0)}function V_(e,i,r,s){var a,l,h,d,g,_;return B(function(x){if(x.g==1)return a=Gt(i,[r]),l=ci(a,e.g.retryParameters),l.method=s,h=e.h.networkingEngine.request(4,l),Jn(e.o,h),b(x,h.promise,2);if(d=x.h,s=="HEAD"){if(!d.headers||!d.headers.date)return x.return(0);g=d.headers.date}else g=at(d.data);return _=Date.parse(g),isNaN(_)?x.return(0):x.return(_-Date.now())})}function rA(e,i,r){var s,a,l,h,d,g,_,x;return B(function(T){switch(T.g){case 1:s=r.map(function(S){return{scheme:S.getAttribute("schemeIdUri"),value:S.getAttribute("value")}}),a=e.g.dash.clockSyncUri,!s.length&&a&&s.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:a}),l=y(s),h=l.next();case 2:if(h.done){T.A(4);break}switch(d=h.value,fe(T,5),g=d.scheme,_=d.value,g){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return T.A(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return T.A(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return x=Date.parse(_),T.return(isNaN(x)?0:x-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":Ve("NTP UTCTiming scheme is not supported");break;default:Ve("Unrecognized scheme in UTCTiming element",g)}T.A(9);break;case 7:return b(T,V_(e,i,_,"HEAD"),10);case 10:return T.return(T.h);case 8:return b(T,V_(e,i,_,"GET"),11);case 11:return T.return(T.h);case 9:we(T,3);break;case 5:oe(T);case 3:h=l.next(),T.A(2);break;case 4:return Ve("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),T.return(0)}})}function nA(e,i,r,s,a){var l=s.getAttribute("schemeIdUri")||"",h=s.getAttribute("value")||"",d=Ze(s,"timescale",Wi)||1;s=y(st(s,"Event"));for(var g=s.next();!g.done;g=s.next()){g=g.value;var _=Ze(g,"presentationTime",Wi)||0,x=Ze(g,"duration",Wi)||0;_=_/d+i,x=_+x/d,r!=null&&(_=Math.min(_,i+r),x=Math.min(x,i+r)),x<a||(g={schemeIdUri:l,value:h,startTime:_,endTime:x,id:g.getAttribute("id")||"",eventElement:g},e.h.onTimelineRegionAdded(g))}}function sA(e,i,r,s){var a,l,h,d,g;return B(function(_){return _.g==1?(a=Or,l=Nh(i,r,s,e.g.retryParameters),h=e.h.networkingEngine,d=h.request(a,l),Jn(e.o,d),b(_,d.promise,2)):(g=_.h,_.return(g.data))})}function W_(e,i){return da(Hi(e,i))?ze:e.split("/")[0]}ie("shaka.dash.DashParser",To),an.mpd=function(){return new To},di["application/dash+xml"]=function(){return new To},di["video/vnd.mpeg.dash.mpd"]=function(){return new To};function G_(e,i,r,s){this.h=e,this.type=i,this.g=r,this.segments=s||null}function Ic(e,i,r,s){this.id=e,this.name=i,this.g=r,this.value=s===void 0?null:s}Ic.prototype.toString=function(){function e(s){return s.name+"="+(isNaN(Number(s.value))?'"'+s.value+'"':s.value)}var i="#"+this.name,r=this.g?this.g.map(e):[];return this.value&&r.unshift(this.value),0<r.length&&(i+=":"+r.join(",")),i},Ic.prototype.getAttribute=function(e){var i=this.g.filter(function(r){return r.name==e});return i.length?i[0]:null};function xe(e,i,r){return(e=e.getAttribute(i))?e.value:r||null}function ft(e,i){if(e=e.getAttribute(i),!e)throw new F(2,4,4023,i);return e.value}function X_(e,i,r){r=r===void 0?[]:r,this.g=i,this.i=e,this.h=r}function q_(e,i){this.name=e,this.value=i}function Xi(e,i){return e.filter(function(r){return r.name==i})}function $_(e,i){return e.filter(function(r){return ft(r,"TYPE")==i})}function Nt(e,i){return e=Xi(e,i),e.length?e[0]:null}function Tl(e,i){var r=0;return r=r===void 0?0:r,(e=Nt(e,i))?Number(e.value):r}function gs(e,i){return Gt([e],[i])[0]}function gn(e){this.h=e,this.g=0}function ms(e){Ur(e,/[ \t]+/gm)}function Ur(e,i){return i.lastIndex=e.g,i=i.exec(e.h),i=i==null?null:{position:i.index,length:i[0].length,results:i},e.g==e.h.length||i==null||i.position!=e.g?null:(e.g+=i.length,i.results)}function mn(e){return e.g==e.h.length?null:(e=Ur(e,/[^ \t\n]*/gm))?e[0]:null}function oA(){this.g=0}function Rc(e,i,r){i=at(i),i=i.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`).trim();var s=i.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(s[0]))throw new F(2,4,4015);i=0;for(var a=!0,l=y(s),h=l.next();!h.done;h=l.next())if(h=h.value,/^#(?!EXT)/m.test(h)||a)a=!1;else if(h=Lc(e,h),--e.g,Y_.includes(h.name)){i=1;break}else h.name=="EXT-X-STREAM-INF"&&(a=!0);for(l=[],a=!0,h=0;h<s.length;h++){var d=s[h],g=s[h+1];if(/^#(?!EXT)/m.test(d)||a)a=!1;else{if(d=Lc(e,d),aA.includes(d.name)){if(i!=1)throw new F(2,4,4017);var _=s.splice(h,s.length-h);s=r,a=[],h=[],g=[],d=null,_=y(_);for(var x=_.next();!x.done;x=_.next())x=x.value,/^(#EXT)/.test(x)?(x=Lc(e,x),Y_.includes(x.name)?l.push(x):x.name=="EXT-X-MAP"?d=x:x.name=="EXT-X-PART"?g.push(x):x.name=="EXT-X-PRELOAD-HINT"?xe(x,"TYPE")=="PART"?g.push(x):xe(x,"TYPE")=="MAP"&&(x.name="EXT-X-MAP",d=x):h.push(x)):/^#(?!EXT)/m.test(x)||(x=gs(s,x.trim()),d&&h.push(d),a.push(new X_(x,h,g)),h=[],g=[]);return g.length&&(d&&h.push(d),a.push(new X_("",h,g))),new G_(r,i,l,a)}l.push(d),d.name=="EXT-X-STREAM-INF"&&(d.g.push(new q_("URI",g)),a=!0)}}return new G_(r,i,l)}function Lc(e,i){e=e.g++;var r=i.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new F(2,4,4016,i);i=r[1];var s=r[2];r=[];var a;if(s){s=new gn(s);var l;(l=Ur(s,/^([^,=]+)(?:,|$)/g))&&(a=l[1]);for(var h=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;l=Ur(s,h);)r.push(new q_(l[1],l[2]||l[3])),ms(s)}return new Ic(e,i,r,a)}var Y_="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP".split(" "),aA="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function K_(){}function Z_(e){try{var i=Mc(e);return Zn({uri:e,Oe:e,data:i.data,headers:{"content-type":i.contentType}})}catch(r){return nn(r)}}function Mc(e){var i=e.split(":");if(2>i.length||i[0]!="data")throw new F(2,1,1004,e);if(i=i.slice(1).join(":").split(","),2>i.length)throw new F(2,1,1004,e);var r=i[0];e=u.decodeURIComponent(i.slice(1).join(",")),i=r.split(";"),r=i[0];var s=!1;1<i.length&&i[i.length-1]=="base64"&&(s=!0,i.pop());var a;return s?a=or(e):a=Mr(e),{data:a,contentType:r}}ie("shaka.net.DataUriPlugin",K_),K_.parse=Z_,lr("data",Z_);function So(){var e=this;this.g=this.i=null,this.Fa=1,this.o=new Map,this.u=new Map,this.F=new Map,this.F.set("video",new Map),this.F.set("audio",new Map),this.F.set(ze,new Map),this.F.set("image",new Map),this.ua=new Set,this.h=new Map,this.j=null,this.M="",this.W=new oA,this.O=0,this.B=-1,this.H=1/0,this.Ga=!1,this.m=new Ee(function(){AA(e)}),this.ea=Cl,this.D=null,this.ca=0,this.J=1/0,this.V=this.da=0,this.G=new Ta,this.L=new Map,this.s=new Map,this.ba=new Map,this.l=!1}p=So.prototype,p.configure=function(e){this.g=e},p.start=function(e,i){var r=this,s;return B(function(a){return a.g==1?(r.i=i,r.l=i.isLowLatencyMode(),b(a,zc(r,e),2)):a.g!=3?(s=a.h,r.M=s.uri,b(a,cA(r,s.data,e),3)):a.return(r.D)})},p.stop=function(){this.m&&(this.m.stop(),this.m=null);var e=[];return this.G&&(e.push(this.G.destroy()),this.G=null),this.g=this.i=null,this.ua.clear(),this.D=null,this.h.clear(),this.u.clear(),this.s.clear(),this.o.clear(),Promise.all(e)},p.update=function(){var e=this,i,r,s,a,l,h,d,g,_;return B(function(x){if(x.g==1){if(!yi(e))return x.return();for(i=[],r=Array.from(e.h.values()),s=r.filter(function(T){return T.stream.segmentIndex}),a=y(s),l=a.next();!l.done;l=a.next())h=l.value,i.push(lA(e,h));return b(x,Promise.all(i),2)}ry(e,s.map(function(T){return T.stream})),d=s.some(function(T){return T.mc==0}),s.length&&!d&&(g=EA,Sl(e,g.ff),_=s.map(function(T){return T.Ya}),e.j.Aa(Math.min.apply(Math,I(_))),e.i.updateDuration()),Q(x)})};function Pc(e,i){return yi(e)?e.F.get(i.type):i.$c}function lA(e,i){var r,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k;return B(function(z){if(z.g==1)return r=i.Jc,s=new Zt(r),e.l&&i.Mc&&aa(s,new Bn("_HLS_skip=YES")),b(z,zc(e,s.toString()),2);if(a=z.h,!i.stream.segmentIndex)return z.return();if(l=Rc(e.W,a.data,a.uri),l.type!=1)throw new F(2,4,4017);h=Xi(l.g,"EXT-X-DEFINE"),d=ey(e,h),g=i.stream,_=Pc(e,i),x=oy(l,g.mimeType),T=x.keyIds,S=x.drmInfos,A=function(D,N){return D.size===N.size&&[].concat(I(D)).every(function(j){return N.has(j)})},A(g.keyIds,T)||(g.keyIds=T,g.drmInfos=S,e.i.newDrmInfo(g)),M=hy(e,l,g.type,_,d),g.segmentIndex.Hb(M,e.j.Pa()),M.length&&(O=Tl(l.g,"EXT-X-MEDIA-SEQUENCE"),P=_.get(O),g.segmentIndex.eb(P)),k=M[M.length-1],Nt(l.g,"EXT-X-ENDLIST")&&(i.mc=!0,i.Ya=k.endTime),Q(z)})}p.onExpirationUpdated=function(){};function uA(e,i){for(var r=e.B==-1,s=y(i),a=s.next();!a.done;a=s.next()){a=a.value;var l=a.stream.segmentIndex,h=Pc(e,a);if(l=l.g[0]||null){h=y(h);for(var d=h.next();!d.done;d=h.next()){d=y(d.value);var g=d.next().value;if(d.next().value==l.startTime){r&&(e.B=Math.max(e.B,g)),a.Cd=g;break}}}}if(!(0>e.B))for(i=y(i),a=i.next();!a.done;a=i.next())r=a.value,(s=r.stream.segmentIndex)&&(s.g.splice(0,e.B-r.Cd),(s=s.g[0]||null)&&(s=-s.startTime,r.stream.segmentIndex.offset(s),Q_(e,r,s)))}function hA(e,i){if(e.H==1/0){i=y(i);for(var r=i.next();!r.done;r=i.next()){var s=r.value.stream.segmentIndex.g[0]||null;s!=null&&s.g!=null&&(e.H=Math.min(e.H,s.g))}}if(i=e.H,i!=1/0)for(s=y(e.h.values()),r=s.next();!r.done;r=s.next()){r=r.value;var a=r.stream.segmentIndex;if(a!=null){var l=a.g[0]||null;if(l.g==null)Kt("Missing EXT-X-PROGRAM-DATE-TIME for stream",r.Ac,"Expect AV sync issues!");else for(Q_(e,r,l.g-i-l.startTime),r=y(a),a=r.next();!a.done;a=r.next())a.value.oe(i)}}}function Q_(e,i,r){i.Ya+=r,e=Pc(e,i),i=y(e);for(var s=i.next();!s.done;s=i.next()){var a=y(s.value);s=a.next().value,a=a.next().value,e.set(s,a+r)}}function cA(e,i,r){var s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae,ne,nt,Qe,ct,ti;return B(function(wi){switch(wi.g){case 1:s=Rc(e.W,i,e.M),a=Xi(s.g,"EXT-X-DEFINE");for(var $i=y(a),St=$i.next();!St.done;St=$i.next()){var zt=St.value;St=xe(zt,"NAME"),zt=xe(zt,"VALUE"),St&&zt&&(e.o.has(St)||e.o.set(St,zt))}if(l=[],h=[],d=[],s.type==1)return V=e.g.hls.mediaPlaylistFullMimeType,s.segments.length&&(G=new Zt(s.segments[0].i),Y=G.qa.split(".").pop(),(K=cy[Y])?V=K:Y!=="ts"&&Y!=="mp4"&&(jc[Y]?(K=jc[Y],le=e.g.hls.defaultAudioCodec,V=K+'; codecs="'+le+'"'):Hc[Y]&&(K=Hc[Y],pe=e.g.hls.defaultVideoCodec,V=K+'; codecs="'+pe+'"'))),me=V.split(";")[0],Ae=me.split("/")[0],ne=hp(V),nt=new Map,b(wi,ny(e,s,r,r,ne,Ae,"",!0,"Media Playlist",null,nt,null,!1,!1,me),5);for(g=Xi(s.g,"EXT-X-MEDIA"),_=Xi(s.g,"EXT-X-STREAM-INF"),x=Xi(s.g,"EXT-X-IMAGE-STREAM-INF"),T=Xi(s.g,"EXT-X-SESSION-KEY"),$i=y(_),St=$i.next();!St.done;St=$i.next()){var _r=St.value;zt=xe(_r,"AUDIO"),St=xe(_r,"VIDEO");var Ti=xe(_r,"SUBTITLES");if(_r=ty(e,_r),Ti){var nv=jn(ze,_r);e.s.set(Ti,nv),gt(_r,nv)}zt&&(Ti=jn("audio",_r),Ti||(Ti=e.g.hls.defaultAudioCodec),e.s.set(zt,Ti)),St&&(zt=jn("video",_r),zt||(zt=e.g.hls.defaultVideoCodec),e.s.set(St,zt))}for(S=Xi(s.g,"EXT-X-SESSION-DATA"),A=y(S),M=A.next();!M.done;M=A.next())O=M.value,P=xe(O,"DATA-ID"),k=xe(O,"URI"),z=xe(O,"LANGUAGE"),D=xe(O,"VALUE"),N=new Map().set("id",P),k&&N.set("uri",gs(e.M,k)),z&&N.set("language",z),D&&N.set("value",D),j=new ye("sessiondata",N),e.i&&e.i.onEvent(j);for(pA(e,g),$i=$_(g,"CLOSED-CAPTIONS"),$i=y($i),St=$i.next();!St.done;St=$i.next())Ti=St.value,St=kc(Ti),zt=ft(Ti,"GROUP-ID"),Ti=ft(Ti,"INSTREAM-ID"),e.L.get(zt)||e.L.set(zt,new Map),e.L.get(zt).set(Ti,St);return l=gA(e,_,T),h=dA(e,g),b(wi,fA(e,x),4);case 4:d=wi.h,wi.A(3);break;case 5:Qe=wi.h,e.h.set(r,Qe),l.push({id:0,language:"und",disabledUntilTime:0,primary:!0,audio:Ae=="audio"?Qe.stream:null,video:Ae=="video"?Qe.stream:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.i)throw new F(2,7,7001);e.j=new de(null,0),e.j.yc(!0),s.type==1&&(yi(e)&&(ly(e),ct=e.O,e.m.N(ct)),ti=Array.from(e.h.values()),Fc(e,ti),J_(e)),e.D={presentationTimeline:e.j,variants:l,textStreams:h,imageStreams:d,offlineSessionIds:[],minBufferTime:0,sequenceMode:!0},e.i.makeTextStreamsForClosedCaptions(e.D),Q(wi)}})}function J_(e){if(yi(e)){if(e.O=e.J,e.ea==Vc){var i=Dc(e);e.g.hls.useSafariBehaviorForLive&&(i=e.j.m),isNaN(e.g.availabilityWindowOverride)||(i=e.g.availabilityWindowOverride),e.j.me(i)}}else e.j.Aa(Dc(e));e.j.Md()}function ey(e,i){var r=new Map;i=y(i);for(var s=i.next();!s.done;s=i.next()){var a=s.value;s=xe(a,"NAME");var l=xe(a,"VALUE");a=xe(a,"IMPORT"),s&&l&&r.set(s,l),a&&(s=e.o.get(a))&&r.set(a,s)}return r}function dA(e,i){var r=$_(i,"SUBTITLES");i=r.map(function(h){if(e.g.disableText)return null;try{return iy(e,h).stream}catch(d){if(e.g.hls.ignoreTextStreamFailures)return null;throw d}}),r=y(r);for(var s=r.next();!s.done;s=r.next()){var a=ft(s.value,"GROUP-ID");if((s=e.s.get(a))&&(a=e.u.get(a))){a=y(a);for(var l=a.next();!l.done;l=a.next())l=l.value,l.stream.codecs=s,l.stream.mimeType=Nc(ze,s)||Uc(ze)}}return i.filter(function(h){return h})}function fA(e,i){var r,s;return B(function(a){return a.g==1?(r=i.map(function(l){var h,d;return B(function(g){if(g.g==1)return e.g.disableThumbnails?g.return(null):(fe(g,2),b(g,_A(e,l),4));if(g.g!=2)return h=g.h,g.return(h.stream);if(d=oe(g),e.g.hls.ignoreImageStreamFailures)return g.return(null);throw d})}),b(a,Promise.all(r),2)):(s=a.h,a.return(s.filter(function(l){return l})))})}function pA(e,i){i=i.filter(function(s){var a=xe(s,"URI")||"";return xe(s,"TYPE")!="SUBTITLES"&&a!=""}),i=y(i);for(var r=i.next();!r.done;r=i.next())iy(e,r.value)}function gA(e,i,r){var s=[],a=new Set;if(0<r.length){r=y(r);for(var l=r.next();!l.done;l=r.next()){l=l.value;var h=ft(l,"METHOD");if(h!="NONE"&&h!="AES-128"&&(h=xe(l,"KEYFORMAT")||"identity",l=(h=fy[h])?h(l,""):null)){if(l.keyIds){h=y(l.keyIds);for(var d=h.next();!d.done;d=h.next())a.add(d.value)}s.push(l)}}}return i=i.map(function(g){var _=xe(g,"FRAME-RATE"),x=Number(xe(g,"AVERAGE-BANDWIDTH"))||Number(ft(g,"BANDWIDTH")),T=xe(g,"RESOLUTION");T=y(T?T.split("x"):[null,null]);var S=T.next().value,A=T.next().value,M=xe(g,"VIDEO-RANGE");g=mA(e,g),T=g.audio,g=g.video;for(var O=y(g),P=O.next();!P.done;P=O.next())(P=P.value.stream)&&(P.width=Number(S)||void 0,P.height=Number(A)||void 0,P.frameRate=Number(_)||void 0,P.hdr=M||void 0);for(_=e.g.disableAudio,(!T.length||_)&&(T=[null]),_=e.g.disableVideo,(!g.length||_)&&(g=[null]),_=[],T=y(T),S=T.next();!S.done;S=T.next())for(S=S.value,A=y(g),M=A.next();!M.done;M=A.next()){var k=M.value;(M=S?S.stream:null)&&(M.drmInfos=s,M.keyIds=a),(O=k?k.stream:null)&&(O.drmInfos=s,O.keyIds=a),P=S?S.stream.drmInfos:null;var z=k?k.stream.drmInfos:null;k=(k?k.Ac:"")+" - "+(S?S.Ac:""),M&&O&&P.length&&z.length&&!(0<Pa(P,z).length)||e.ua.has(k)||(M={id:e.Fa++,language:M?M.language:"und",primary:!!M&&M.primary||!!O&&O.primary,audio:M,video:O,bandwidth:x,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},_.push(M),e.ua.add(k))}return _}).reduce(Wu,[]),i=i.filter(function(g){return g!=null})}function mA(e,i){var r=ty(e,i),s=xe(i,"AUDIO"),a=xe(i,"VIDEO"),l=s||a;l=l&&e.u.has(l)?e.u.get(l):[],s={audio:s?l:[],video:a?l:[]},a=!1;var h=ft(i,"URI"),d=s.audio.find(function(x){return x&&x.Ac==h}),g=jn("video",r),_=jn("audio",r);return _&&!g?l="audio":!l.length&&_&&g?(l="video",r=[[g,_].join()]):s.audio.length&&d?(l="audio",a=!0):l=s.video.length&&!s.audio.length?"audio":"video",a||(e=yA(e,i,r,l),s[e.stream.type]=[e]),s}function ty(e,i){var r=[];e.g.disableVideo||r.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||r.push(e.g.hls.defaultAudioCodec),r=xe(i,"CODECS",r.join(",")).split(/\s*,\s*/),e=new Set,i=[],r=y(r);for(var s=r.next();!s.done;s=r.next()){s=s.value;var a=Ws(s)[0];e.has(a)||(i.push(s),e.add(a))}return i}function kc(e){return e=xe(e,"LANGUAGE")||"und",De(e)}function iy(e,i){var r=ft(i,"GROUP-ID"),s="",a=ft(i,"TYPE").toLowerCase();a=="subtitles"&&(a=ze);var l=a;if(l!=ze&&r&&e.s.has(r)&&(s=e.s.get(r)),a=_s(ft(i,"URI"),e.o),e.h.has(a))return e.h.get(a);var h=kc(i),d=xe(i,"NAME"),g=xe(i,"DEFAULT")=="YES",_=l=="audio"&&(_=xe(i,"CHANNELS"))?parseInt(_.split("/")[0],10):null,x=l=="audio"&&(x=xe(i,"CHANNELS"))?x.includes("/JOC"):!1,T=xe(i,"CHARACTERISTICS");return i=xe(i,"FORCED")=="YES",s=Oc(e,a,s,l,h,g,d,_,null,T,i,x),e.u.has(r)?e.u.get(r).push(s):e.u.set(r,[s]),e.h.has(a)?e.h.get(a):(e.h.set(a,s),s)}function _A(e,i){var r,s,a,l,h,d,g,_,x,T;return B(function(S){return S.g==1?(r=_s(ft(i,"URI"),e.o),s=xe(i,"CODECS","jpeg")||"",e.h.has(r)?S.return(e.h.get(r)):(a=kc(i),l=xe(i,"NAME"),h=xe(i,"CHARACTERISTICS"),d=Oc(e,r,s,"image",a,!1,l,null,null,h,!1,!1),e.h.has(r)?S.return(e.h.get(r)):(g=xe(i,"RESOLUTION"))?b(S,d.stream.createSegmentIndex(),3):S.A(2))):(S.g!=2&&(_=d.stream.segmentIndex.get(0),x=_.tilesLayout)&&(d.stream.width=Number(g.split("x")[0])*Number(x.split("x")[0]),d.stream.height=Number(g.split("x")[1])*Number(x.split("x")[1])),(T=xe(i,"BANDWIDTH"))&&(d.stream.bandwidth=Number(T)),e.h.set(r,d),S.return(d))})}function yA(e,i,r,s){var a=_s(ft(i,"URI"),e.o);return e.h.has(a)||(i=xe(i,"CLOSED-CAPTIONS"),i=s=="video"&&i&&i!="NONE"?e.L.get(i):null,r=Ns(s,r),s=Oc(e,a,r,s,"und",!1,null,null,i,null,!1,!1),e.h.has(a))?e.h.get(a):(e.h.set(a,s),s)}function Oc(e,i,r,s,a,l,h,d,g,_,x,T){function S(z){var D,N,j,V,G,Y,K,le,pe,me,Ae,ne,nt;return B(function(Qe){if(Qe.g==1)return b(Qe,zc(e,O.Jc),2);if(Qe.g!=3)return D=Qe.h,z.aborted?Qe.return():(N=D.uri,j=Rc(e.W,D.data,N),V=yi(e),b(Qe,ny(e,j,i,N,r,s,a,l,h,d,g,_,x,T),3));if(G=Qe.h,z.aborted)return Qe.return();if(Y=G.stream,yi(e)&&!V&&ly(e),O.Jc=N,O.Ya=G.Ya,O.Mc=G.Mc,O.mc=G.mc,O.$c=G.$c,O.Ld=!0,M.segmentIndex=Y.segmentIndex,M.encrypted=Y.encrypted,M.drmInfos=Y.drmInfos,M.keyIds=Y.keyIds,M.mimeType=Y.mimeType,rs.includes(M.mimeType)&&(M.codecs=""),M.drmInfos.length&&e.i.newDrmInfo(M),K=Mt,s==K.va||s==K.Hc)for(le=y(e.h.values()),pe=le.next();!pe.done;pe=le.next())me=pe.value,me.Ld||me.type!=s||(me.stream.mimeType=Y.mimeType,rs.includes(me.stream.mimeType)&&(me.stream.codecs=""));xA(e)&&(e.Ga?Fc(e,[O]):(e.Ga=!0,Ae=Array.from(e.h.values()),ne=Ae.filter(function(ct){return ct.stream.segmentIndex}),Fc(e,ne),J_(e),nt=e.O,0<nt&&e.m.N(nt))),Q(Qe)})}var A=gs(e.M,i),M=sy(e,r,s,a,l,h,d,g,_,x,T);rs.includes(M.mimeType)&&(M.codecs="");var O={stream:M,type:s,Ac:i,Jc:A,Ya:0,$c:new Map,Mc:!1,mc:!1,Cd:-1,Ld:!1},P=null,k=new AbortController;return M.createSegmentIndex=function(){return P||(k=new AbortController,P=new Promise(function(z){z(S(k.signal))}))},M.closeSegmentIndex=function(){P&&!M.segmentIndex&&k.abort(),M.segmentIndex&&(M.segmentIndex.release(),M.segmentIndex=null),P=null},O}function Dc(e){var i=1/0;e=y(e.h.values());for(var r=e.next();!r.done;r=e.next())r=r.value,r.stream.segmentIndex&&r.stream.type!="text"&&(i=Math.min(i,r.Ya));return i}function ry(e,i){var r=[];i=y(i);for(var s=i.next();!s.done;s=i.next())s=s.value,s.segmentIndex&&AS(s.segmentIndex,function(a){r.push(a)});e.j.Ib(r)}function Fc(e,i){if(!yi(e))for(var r=Dc(e),s=y(i),a=s.next();!a.done;a=s.next())a.value.stream.segmentIndex.Wa(0,r);for(r=y(i),a=r.next();!a.done;a=r.next())a=a.value.stream,rs.includes(a.mimeType)&&(a.codecs="");ry(e,i.map(function(l){return l.stream})),e.g.hls.ignoreManifestProgramDateTime?uA(e,i):hA(e,i)}function xA(e){if(!e.D)return!1;var i=[],r=[];e=y(e.D.variants);for(var s=e.next();!s.done;s=e.next())s=s.value,s.video&&i.push(s.video),s.audio&&r.push(s.audio);return!(0<i.length&&!i.some(function(a){return a.segmentIndex})||0<r.length&&!r.some(function(a){return a.segmentIndex}))}function ny(e,i,r,s,a,l,h,d,g,_,x,T,S,A,M){var O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae;return B(function(ne){if(ne.g==1){if(i.type!=1)throw new F(2,4,4017);return O=Xi(i.g,"EXT-X-DEFINE"),P=ey(e,O),ay(e,i),M?ne.A(2):b(ne,CA(e,l,a,i,P),3)}if(ne.g!=2&&(M=ne.h),k=oy(i,M),z=k.drmInfos,D=k.keyIds,N=k.encrypted,j=k.kf,N&&!z.length&&!j)throw new F(2,4,4026);return V=yi(e)?e.F.get(l):new Map,G=e.l,Y=hy(e,i,l,V,P),G!=e.l&&ay(e,i),K=Y[Y.length-1].endTime,le=new Fe(Y),me=(pe=Nt(i.g,"EXT-X-SERVER-CONTROL"))?pe.getAttribute("CAN-SKIP-UNTIL")!=null:!1,Ae=sy(e,a,l,h,d,g,_,x,T,S,A),Ae.segmentIndex=le,Ae.encrypted=N,Ae.drmInfos=z,Ae.keyIds=D,Ae.mimeType=M,ne.return({stream:Ae,type:l,Ac:r,Jc:s,Ya:K,Mc:me,mc:!1,Cd:-1,$c:V,Ld:!1})})}function sy(e,i,r,s,a,l,h,d,g,_,x){var T=Nc(r,i)||Uc(r);return{id:e.Fa++,originalId:l,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:T,codecs:i,kind:r==ze?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:s,label:l,type:r,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:g?g.split(","):[],forced:_,channelsCount:h,audioSamplingRate:null,spatialAudio:x,closedCaptions:d,hdr:void 0,tilesLayout:void 0}}function oy(e,i){var r=[];if(e.segments){e=y(e.segments);for(var s=e.next();!s.done;s=e.next())s=Xi(s.value.g,"EXT-X-KEY"),r.push.apply(r,I(s))}s=e=!1;var a=[],l=new Set;r=y(r);for(var h=r.next();!h.done;h=r.next()){h=h.value;var d=ft(h,"METHOD");if(d!="NONE"){if(e=!0,d=="AES-128")s=!0;else if(d=xe(h,"KEYFORMAT")||"identity",h=(d=fy[d])?d(h,i):null){if(h.keyIds){d=y(h.keyIds);for(var g=d.next();!g.done;g=d.next())l.add(g.value)}a.push(h)}}}return{drmInfos:a,keyIds:l,encrypted:e,kf:s}}function vA(e,i,r){if(!u.crypto||!u.crypto.subtle)throw Ve("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new F(2,4,4042);var s=0,a=xe(i,"IV","");if(a){var l=js(a.substr(2));if(l.byteLength!=16)throw new F(2,4,4043)}else s=Tl(r.g,"EXT-X-MEDIA-SEQUENCE");i=gs(r.h,ft(i,"URI"));var h=ci([i],e.g.retryParameters),d={method:"AES-128",iv:l,firstMediaSequenceNumber:s,fetchKey:function(){var g,_,x;return B(function(T){if(T.g==1)return b(T,Bc(e,h,6),2);if(T.g!=3){if(g=T.h,!g.data||g.data.byteLength!=16)throw new F(2,4,4044);return _={name:"AES-CBC"},x=d,b(T,u.crypto.subtle.importKey("raw",g.data,_,!0,["decrypt"]),3)}x.cryptoKey=T.h,d.fetchKey=void 0,Q(T)})}};return d}function ay(e,i){var r=Nt(i.g,"EXT-X-PLAYLIST-TYPE"),s=Nt(i.g,"EXT-X-ENDLIST");if(s=r&&r.value=="VOD"||s,r=r&&r.value=="EVENT"&&!s,r=!s&&!r,s)Sl(e,Cl);else{if(r?Sl(e,Vc):Sl(e,py),s=Nt(i.g,"EXT-X-TARGETDURATION"),!s)throw new F(2,4,4024,"EXT-X-TARGETDURATION");s=Number(s.value),r=Nt(i.g,"EXT-X-PART-INF"),e.l&&r?(e.da=Number(ft(r,"PART-TARGET")),e.J=Math.min(e.da,e.J),i=Nt(i.g,"EXT-X-SERVER-CONTROL"),e.V=i?Number(ft(i,"PART-HOLD-BACK")):0):e.J=Math.min(s,e.J),e.ca=Math.max(s,e.ca)}}function ly(e){var i=e.g.defaultPresentationDelay?e.g.defaultPresentationDelay:e.V?e.V:e.ca*e.g.hls.liveSegmentsDelay;e.j.Xe(0),e.j.We(i),e.j.yc(!1)}function wA(e,i,r,s){if(r=Nt(r,"EXT-X-MAP"),!r)return null;var a=ft(r,"URI");return s=_s(gs(i,a),s),i=[s,xe(r,"BYTERANGE","")].join("-"),e.ba.has(i)||(r=TA(s,r),e.ba.set(i,r)),e.ba.get(i)}function TA(e,i){var r=0,s=null;return(i=xe(i,"BYTERANGE"))&&(r=i.split("@"),s=Number(r[0]),r=Number(r[1]),s=r+s-1),new fi(function(){return[e]},r,s)}function SA(e,i,r,s,a,l,h,d,g){var _=s.g,x=_s(s.i,l),T=Nt(_,"EXTINF"),S=l=0,A=null;s.h.length&&!e.l&&Ve("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var M=null;if(!e.g.hls.ignoreManifestProgramDateTime){var O=Nt(_,"EXT-X-PROGRAM-DATE-TIME");O&&O.value&&(M=Qp(O.value))}if(O=ja,Nt(_,"EXT-X-GAP")&&(O=2),!T){if(s.h.length==0)throw new F(2,4,4024,"EXTINF");if(!e.l)return null}var P=[];if(e.l)for(var k={},z=0;z<s.h.length;k={pd:k.pd},z++){var D=s.h[z],N=z==0?r:P[P.length-1],j=z==0?a:N.endTime,V=Number(xe(D,"DURATION"))||e.da;if(V){V=j+V;var G=0,Y=null;D.name=="EXT-X-PRELOAD-HINT"?G=(G=xe(D,"BYTERANGE-START"))?Number(G):0:(G=xe(D,"BYTERANGE"),Y=y(uy(N,G)),G=Y.next().value,Y=Y.next().value),(N=xe(D,"URI"))&&(k.pd=gs(h,N),N=ja,xe(D,"GAP")=="YES"&&(N=2),P.push(new Me(j,V,function(K){return function(){return[K.pd]}}(k),G,Y,i,0,0,1/0,[],"",null,null,N)))}}return T?l=a+Number(T.value.split(",")[0]):l=P[P.length-1].endTime,(e=Nt(_,"EXT-X-BYTERANGE"))?(A=y(uy(r,e.value)),S=A.next().value,A=A.next().value):P.length&&(S=P[0].Ba,A=P[P.length-1].ka),r="",e=null,d=="image"&&(r="1x1",d=Nt(_,"EXT-X-TILES"))&&(r=ft(d,"LAYOUT"),(d=xe(d,"DURATION"))&&(e=Number(d))),new Me(a,l,function(){return x.length?[x]:[]},S,A,i,0,0,1/0,P,r,e,M,O,g)}function uy(e,i){var r=0,s=null;return i&&(r=i.split("@"),i=Number(r[0]),r=r[1]?Number(r[1]):e.ka+1,s=r+i-1),[r,s]}function hy(e,i,r,s,a){var l=i.segments,h=void 0,d=Tl(i.g,"EXT-X-DISCONTINUITY-SEQUENCE"),g=Tl(i.g,"EXT-X-MEDIA-SEQUENCE"),_=Nt(i.g,"EXT-X-SKIP");_=_?Number(xe(_,"SKIPPED-SEGMENTS")):0;var x=g+_,T=0;yi(e)&&s.has(x)&&(T=s.get(x));for(var S=[],A=null,M=0;M<l.length;M++){var O=l[M],P=M==0?T:A.endTime;x=g+_+M,Nt(O.g,"EXT-X-DISCONTINUITY")&&d++;for(var k=y(O.g),z=k.next();!z.done;z=k.next())z=z.value,z.name=="EXT-X-KEY"&&(ft(z,"METHOD")=="AES-128"?h=vA(e,z,i):h=void 0);s.set(x,P),k=wA(e,i.h,O.g,a),!e.l&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.l=e.i.isLowLatencyMode()),(A=O=SA(e,k,A,O,P,a,i.h,r,h))&&(O.m=d,e.g.hls.ignoreManifestProgramDateTime&&e.B!=null&&x<e.B||S.push(O))}if(i=S.some(function(D){return D.g!=null})){for(r={},s=0;s<S.length;r={Qb:r.Qb,Pb:r.Pb,Bc:r.Bc,Ta:r.Ta,Ob:r.Ob},s++)if(r.Ta=S[s],r.Ta.g==null)for(r.Pb=0,r.Qb=s,a=function(D){return function(){var N=S[D.Qb];if(N){if(N.g!=null)return N.g+D.Pb;D.Pb-=N.endTime-N.startTime,D.Qb+=1}return null}}(r),r.Ob=0,r.Bc=s,l=function(D){return function(){var N=S[D.Bc];if(N){if(N!=D.Ta&&(D.Ob+=N.endTime-N.startTime),N.g!=null)return N.g+D.Ob;--D.Bc}return null}}(r);r.Ta.g==null;)r.Ta.g=l(),r.Ta.g==null&&(r.Ta.g=a())}if(i)for(r=y(S),s=r.next();!s.done;s=r.next())for(a=s.value,s=a.g,a=y(a.i),l=a.next();!l.done;l=a.next())l=l.value,l.g=s,s+=l.endTime-l.startTime;if(e=e.H,i&&e!=1/0)for(i=y(S),s=i.next();!s.done;s=i.next())s.value.oe(e);return S}function _s(e,i){e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}");var r=e.match(/{\$\w*}/g);if(r){r=y(r);for(var s=r.next();!s.done;s=r.next()){s=s.value;var a=s.slice(2,s.length-1),l=i.get(a);if(l)e=e.replace(s,l);else throw new F(2,4,4039,a)}}return e}function Nc(e,i){if(e==ze){if(i=="vtt"||i=="wvtt")return"text/vtt";if(i&&i!=="")return"application/mp4"}return e!="image"||i&&i!="jpeg"?e=="audio"&&i=="mp4a.40.34"?"audio/mpeg":null:"image/jpeg"}function Uc(e){return e==ze?"text/vtt":dy[e].mp4}function CA(e,i,r,s,a){var l,h,d,g,_,x,T,S,A,M;return B(function(O){return O.g==1?(l=Or,h=Math.trunc((s.segments.length-1)/2),d=_s(s.segments[h].i,a),g=new Zt(d),_=g.qa.split(".").pop(),x=dy[i],(T=x[_])||(T=cy[_])||(T=Nc(i,r))?O.return(T):(S=ci([d],e.g.retryParameters),S.method="HEAD",b(O,Bc(e,S,l),2))):(A=O.h,(M=A.headers["content-type"])?O.return(M.split(";")[0]):O.return(Uc(i)))})}function zc(e,i){return i=ci([i],e.g.retryParameters),e.i.modifyManifestRequest(i,{format:"h"}),Bc(e,i,0)}function AA(e){var i,r;B(function(s){if(s.g==1)return e.i?(fe(s,2),b(s,e.update(),4)):s.return();if(s.g!=2)return yi(e)&&(i=e.O,e.m.N(i)),we(s,0);if(r=oe(s),!e.i)return s.return();r.severity=1,e.i.onError(r),e.m.N(.1),Q(s)})}function yi(e){return e.ea!=Cl}function Sl(e,i){e.ea=i,e.j&&e.j.yc(!yi(e)),yi(e)||e.m.stop()}function Bc(e,i,r){if(!e.G)throw new F(2,7,7001);return i=e.i.networkingEngine.request(r,i),Jn(e.G,i),i.promise}ie("shaka.hls.HlsParser",So);var cy={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},jc={mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},Hc={mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},dy={audio:jc,video:Hc,text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},fy={"com.apple.streamingkeydelivery":function(e,i){if(i=="video/mp2t")throw new F(2,4,4040);if(u.shakaMediaKeysPolyfill)throw new F(2,4,4041);return Zr("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var i=ft(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(i)?(i=ft(e,"URI"),i=Mc(i),i=Ie(i.data),i=Zr("com.widevine.alpha",[{initDataType:"cenc",initData:i}]),(e=xe(e,"KEYID"))&&(i.keyIds=new Set([e.toLowerCase().substr(2)])),i):null},"com.microsoft.playready":function(e){var i=ft(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(i)?(e=ft(e,"URI"),e=Mc(e),e=Ie(e.data),i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),e=ch(e,i,new Set,0),Zr("com.microsoft.playready",[{initDataType:"cenc",initData:e}])):null},identity:function(e){return e=ft(e,"METHOD"),["SAMPLE-AES","SAMPLE-AES-CTR"].includes(e)?Zr("org.w3.clearkey",null):null}},Cl="VOD",py="EVENT",Vc="LIVE",EA={ff:Cl,Og:py,Sg:Vc};tt("Tizen 3")||tt("Tizen 2")||ip()||(an.m3u8=function(){return new So},di["application/x-mpegurl"]=function(){return new So},di["application/vnd.apple.mpegurl"]=function(){return new So});function gy(e,i,r,s,a,l){if(200<=r&&299>=r&&r!=202)return{uri:a||s,Oe:s,data:i,status:r,headers:e,fromCache:!!e["x-shaka-from-cache"]};a=null;try{a=Jr(i)}catch(h){}throw new F(r==401||r==403?2:1,1,1001,s,r,a,e,l)}function Wc(){}function Al(e,i,r,s,a){var l=new MA;qs(i.headers).forEach(function(_,x){l.append(x,_)});var h=new RA,d={ye:!1,bf:!1};if(e=bA(e,r,{body:i.body||void 0,headers:l,method:i.method,signal:h.signal,credentials:i.allowCrossSiteCredentials?"include":void 0},d,s,a,i.streamDataCallback),e=new it(e,function(){return d.ye=!0,h.abort(),Promise.resolve()}),i=i.retryParameters.timeout){var g=new Ee(function(){d.bf=!0,h.abort()});g.N(i/1e3),e.finally(function(){g.stop()})}return e}function bA(e,i,r,s,a,l,h){var d,g,_,x,T,S,A,M,O,P,k,z,D;return B(function(N){switch(N.g){case 1:return d=IA,g=LA,S=T=0,A=Date.now(),fe(N,2),b(N,d(e,r),4);case 4:return _=N.h,l(my(_.headers)),M=_.clone().body.getReader(),P=(O=_.headers.get("Content-Length"))?parseInt(O,10):0,k=function(j){function V(){var G,Y;return B(function(K){switch(K.g){case 1:return fe(K,2),b(K,M.read(),4);case 4:G=K.h,we(K,3);break;case 2:return oe(K),K.return();case 3:if(G.done){K.A(5);break}if(T+=G.value.byteLength,!h){K.A(5);break}return b(K,h(G.value),5);case 5:Y=Date.now(),(100<Y-A||G.done)&&(a(Y-A,T-S,P-T),S=T,A=Y),G.done?j.close():(j.enqueue(G.value),V()),Q(K)}})}V()},new g({start:k}),b(N,_.arrayBuffer(),5);case 5:x=N.h,we(N,3);break;case 2:throw z=oe(N),s.ye?new F(1,1,7001,e,i):s.bf?new F(1,1,1003,e,i):new F(1,1,1002,e,z,i);case 3:return D=my(_.headers),N.return(gy(D,x,_.status,e,_.url,i))}})}function my(e){var i={};return e.forEach(function(r,s){i[s.trim()]=r}),i}function _y(){if(u.ReadableStream)try{new ReadableStream({})}catch(e){return!1}else return!1;return!(!u.fetch||!u.AbortController)}ie("shaka.net.HttpFetchPlugin",Wc),Wc.isSupported=_y,Wc.parse=Al;var IA=u.fetch,RA=u.AbortController,LA=u.ReadableStream,MA=u.Headers;_y()&&(lr("http",Al,2,!0),lr("https",Al,2,!0),lr("blob",Al,2,!0));function yy(){}function El(e,i,r,s,a){var l=new PA,h=Date.now(),d=0,g=new Promise(function(_,x){l.open(i.method,e,!0),l.responseType="arraybuffer",l.timeout=i.retryParameters.timeout,l.withCredentials=i.allowCrossSiteCredentials,l.onabort=function(){x(new F(1,1,7001,e,r))};var T=!1;l.onreadystatechange=function(){if(l.readyState==2&&!T){var A=xy(l);a(A),T=!0}},l.onload=function(){var A=xy(l),M=l.response;try{var O=gy(A,M,l.status,e,l.responseURL,r);_(O)}catch(P){x(P)}},l.onerror=function(A){x(new F(1,1,1002,e,A,r))},l.ontimeout=function(){x(new F(1,1,1003,e,r))},l.onprogress=function(A){var M=Date.now();(100<M-h||A.lengthComputable&&A.loaded==A.total)&&(s(M-h,A.loaded-d,A.total-A.loaded),d=A.loaded,h=M)};for(var S in i.headers)l.setRequestHeader(S.toLowerCase(),i.headers[S]);l.send(i.body)});return new it(g,function(){return l.abort(),Promise.resolve()})}function xy(e){var i=e.getAllResponseHeaders().trim().split(`\r
`);e={},i=y(i);for(var r=i.next();!r.done;r=i.next())r=r.value.split(": "),e[r[0].toLowerCase()]=r.slice(1).join(": ");return e}ie("shaka.net.HttpXHRPlugin",yy),yy.parse=El;var PA=u.XMLHttpRequest;lr("http",El,1,!0),lr("https",El,1,!0),lr("blob",El,1,!0);function vy(e,i,r,s){this.g=e,this.i=i,this.groupId=r,this.h=s}function Gc(e){return e.ya().map(function(i){return"{"+encodeURI(i)+"}"}).join("")+":"+e.Ba+":"+e.ka}function kA(e,i){return Nh(e.g.ya(),e.g.Ba,e.g.ka,i.streaming.retryParameters)}function wy(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function Ty(e,i){e.i+=i;var r=e.l;return e.l++,e.g.set(r,i),r}wy.prototype.close=function(e,i){if(this.g.has(e)){var r=this.g.get(e);this.g.delete(e),this.j+=r,this.h+=i}};function Sy(e){var i=this;this.o=e,this.j=new Map,this.i=new sn(function(){return Xc(i).catch(function(){})}),this.h=[],this.m=function(){},this.l=function(){},this.g=new wy}Sy.prototype.destroy=function(){return this.i.destroy()};function OA(e,i,r){e.m=i,e.l=r}function Xc(e){var i=e.h.map(function(r){return r()});return e.h=[],Promise.all(i)}function DA(e,i,r,s,a,l){Xe(e.i);var h=(e.j.get(i)||Promise.resolve()).then(function(){var d,g,_,x,T,S,A;return B(function(M){if(M.g==1)return b(M,NA(e,r),2);if(d=M.h,e.i.g)throw new F(2,9,7001);if(a)for(x in g=Ie(d),_=new Yp(g),_.data)T=Number(x),S=_.data[T],A=_.g[T],e.l(S,A);e.g.close(s,d.byteLength);var O=e.g;return e.m(O.i==0?0:O.j/O.i,e.g.h),M.return(l(d))})});e.j.set(i,h)}function FA(e){return B(function(i){return i.g==1?b(i,Promise.all(e.j.values()),2):i.return(e.g.h)})}function NA(e,i){var r,s,a,l;return B(function(h){return h.g==1?(r=Or,s=e.o.request(r,i),a=function(){return s.abort()},e.h.push(a),b(h,s.promise,2)):(l=h.h,gt(e.h,a),h.return(l.data))})}function bl(e,i){var r=this;this.i=e,this.h=e.objectStore(i),this.g=new Ke,e.onabort=function(s){s.preventDefault(),r.g.reject()},e.onerror=function(s){s.preventDefault(),r.g.reject()},e.oncomplete=function(){r.g.resolve()}}bl.prototype.abort=function(){var e=this;return B(function(i){if(i.g==1){try{e.i.abort()}catch(r){}return fe(i,2),b(i,e.g,4)}if(i.g!=2)return we(i,0);oe(i),Q(i)})};function qc(e,i){return new Promise(function(r,s){var a=e.h.openCursor();a.onerror=s,a.onsuccess=function(){var l;return B(function(h){if(h.g==1)return a.result==null?(r(),h.return()):(l=a.result,b(h,i(l.key,l.value,l),2));l.continue(),Q(h)})}})}bl.prototype.store=function(){return this.h},bl.prototype.promise=function(){return this.g};function $c(e){this.h=e,this.g=[]}$c.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))};function _n(e,i){return Il(e,i,"readwrite")}function Il(e,i,r){r=e.h.transaction([i],r);var s=new bl(r,i);return e.g.push(s),s.promise().then(function(){gt(e.g,s)},function(){gt(e.g,s)}),s}function yn(e,i,r){this.h=new $c(e),this.i=i,this.g=r}p=yn.prototype,p.destroy=function(){return this.h.destroy()},p.hasFixedKeySpace=function(){return!0},p.addSegments=function(){return Cy(this.i)},p.removeSegments=function(e,i){return Ay(this,this.i,e,i)},p.getSegments=function(e){var i=this,r;return B(function(s){return s.g==1?b(s,Ey(i,i.i,e),2):(r=s.h,s.return(r.map(function(a){return i.ze(a)})))})},p.addManifests=function(){return Cy(this.g)},p.updateManifest=function(){return Promise.reject(new F(2,9,9016,"Cannot modify values in "+this.g))};function UA(e,i,r){e=_n(e.h,e.g);var s=e.store();return s.get(i).onsuccess=function(){s.put(r,i)},e.promise()}p.updateManifestExpiration=function(e,i){var r=_n(this.h,this.g),s=r.store();return s.get(e).onsuccess=function(a){(a=a.target.result)&&(a.expiration=i,s.put(a,e))},r.promise()},p.removeManifests=function(e,i){return Ay(this,this.g,e,i)},p.getManifests=function(e){var i=this,r;return B(function(s){return s.g==1?b(s,Ey(i,i.g,e),2):(r=s.h,s.return(Promise.all(r.map(function(a){return i.bc(a)}))))})},p.getAllManifests=function(){var e=this,i,r;return B(function(s){return s.g==1?(i=Il(e.h,e.g,"readonly"),r=new Map,b(s,qc(i,function(a,l){var h;return B(function(d){if(d.g==1)return b(d,e.bc(l),2);h=d.h,r.set(a,h),Q(d)})}),2)):s.g!=3?b(s,i.promise(),3):s.return(r)})},p.ze=function(e){return e},p.bc=function(e){return Promise.resolve(e)};function Cy(e){return Promise.reject(new F(2,9,9011,"Cannot add new value to "+e))}p.add=function(e,i){var r=this,s,a,l,h,d,g,_;return B(function(x){if(x.g==1){for(s=_n(r.h,e),a=s.store(),l=[],h={},d=y(i),g=d.next();!g.done;h={Fc:h.Fc},g=d.next())_=g.value,h.Fc=a.add(_),h.Fc.onsuccess=function(T){return function(){l.push(T.Fc.result)}}(h);return b(x,s.promise(),2)}return x.return(l)})};function Ay(e,i,r,s){e=_n(e.h,i),i=e.store();var a={};r=y(r);for(var l=r.next();!l.done;a={Ec:a.Ec},l=r.next())a.Ec=l.value,i.delete(a.Ec).onsuccess=function(h){return function(){return s(h.Ec)}}(a);return e.promise()}function Ey(e,i,r){var s,a,l,h,d,g,_;return B(function(x){if(x.g==1){for(s=Il(e.h,i,"readonly"),a=s.store(),l={},h=[],d={},g=y(r),_=g.next();!_.done;d={Vb:d.Vb,Tb:d.Tb},_=g.next())d.Tb=_.value,d.Vb=a.get(d.Tb),d.Vb.onsuccess=function(T){return function(){T.Vb.result==null&&h.push(T.Tb),l[T.Tb]=T.Vb.result}}(d);return b(x,s.promise(),2)}if(h.length)throw new F(2,9,9012,"Could not find values for "+h);return x.return(r.map(function(T){return l[T]}))})}function Co(e){this.g=new $c(e)}Co.prototype.destroy=function(){return this.g.destroy()},Co.prototype.getAll=function(){var e=this,i,r;return B(function(s){return s.g==1?(i=Il(e.g,"session-ids","readonly"),r=[],b(s,qc(i,function(a,l){r.push(l)}),2)):s.g!=3?b(s,i.promise(),3):s.return(r)})},Co.prototype.add=function(e){var i=_n(this.g,"session-ids"),r=i.store();e=y(e);for(var s=e.next();!s.done;s=e.next())r.add(s.value);return i.promise()},Co.prototype.remove=function(e){var i=this,r;return B(function(s){return s.g==1?(r=_n(i.g,"session-ids"),b(s,qc(r,function(a,l,h){e.includes(l.sessionId)&&h.delete()}),2)):b(s,r.promise(),0)})};function Ut(){this.g=new Map}Ut.prototype.destroy=function(){for(var e=[],i=y(this.g.values()),r=i.next();!r.done;r=i.next())e.push(r.value.destroy());return this.g.clear(),Promise.all(e)},Ut.prototype.init=function(){var e=this;Ao.forEach(function(a,l){(a=a())&&e.g.set(l,a)});for(var i=[],r=y(this.g.values()),s=r.next();!s.done;s=r.next())i.push(s.value.init());return Promise.all(i)};function by(e){var i=null;if(e.g.forEach(function(r,s){r.getCells().forEach(function(a,l){a.hasFixedKeySpace()||i||(i={path:{za:s,ja:l},ja:a})})}),i)return i;throw new F(2,9,9013,"Could not find a cell that supports add-operations")}function zA(e,i){e.g.forEach(function(r,s){r.getCells().forEach(function(a,l){i({za:s,ja:l},a)})})}function Rl(e,i,r){if(e=e.g.get(i),!e)throw new F(2,9,9013,"Could not find mechanism with name "+i);if(i=e.getCells().get(r),!i)throw new F(2,9,9013,"Could not find cell with name "+r);return i}function BA(e,i){e.g.forEach(function(r){i(r.getEmeSessionCell())})}function jA(e){var i=Array.from(e.g.keys());if(!i.length)throw new F(2,9,9e3,"No supported storage mechanisms found");return e.g.get(i[0]).getEmeSessionCell()}function HA(e){var i,r,s;return B(function(a){return a.g==1?(i=Array.from(e.g.values()),r=0<i.length,r||(s=Ao,s.forEach(function(l){(l=l())&&i.push(l)})),b(a,Promise.all(i.map(function(l){return l.erase()})),2)):r?a.A(0):b(a,Promise.all(i.map(function(l){return l.destroy()})),0)})}function Iy(e,i){Ao.set(e,i)}ie("shaka.offline.StorageMuxer",Ut),Ut.unregister=function(e){Ao.delete(e)},Ut.register=Iy,Ut.prototype.destroy=Ut.prototype.destroy;var Ao=new Map;function Eo(){yn.apply(this,arguments)}he(Eo,yn),Eo.prototype.updateManifestExpiration=function(e,i){var r=this,s,a,l;return B(function(h){return s=_n(r.h,r.g),a=s.store(),l=new Ke,a.get(e).onsuccess=function(d){(d=d.target.result)?(d.expiration=i,a.put(d),l.resolve()):l.reject(new F(2,9,9012,"Could not find values for "+e))},b(h,Promise.all([s.promise(),l]),0)})},Eo.prototype.bc=function(e){var i,r,s,a,l,h;return B(function(d){if(d.g==1){for(i=[],r=0;r<e.periods.length;++r)s=r==e.periods.length-1?e.duration:e.periods[r+1].startTime,a=s-e.periods[r].startTime,l=VA(e.periods[r],a),i.push(l);return b(d,P_(i),2)}return h=d.h,d.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:e.expiration==null?1/0:e.expiration,streams:h,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})};function VA(e,i){GA(e);for(var r=y(e.streams),s=r.next();!s.done;s=r.next());return e.streams.map(function(a){return WA(a,e.startTime,i)})}function WA(e,i,r){var s=e.initSegmentUri?Ry(e.initSegmentUri):null,a=i+e.presentationTimeOffset,l=i+r;return{id:e.id,originalId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:s,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(h){var d=Ry(h.uri);return{startTime:i+h.startTime,endTime:i+h.endTime,dataKey:d,initSegmentKey:s,appendWindowStart:i,appendWindowEnd:l,timestampOffset:a,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}Eo.prototype.ze=function(e){return{data:e.data}};function Ry(e){var i;if((i=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(i=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(i[1]);throw new F(2,9,9004,"Could not parse uri "+e)}function GA(e){var i=e.streams.filter(function(d){return d.contentType=="audio"});if(e=e.streams.filter(function(d){return d.contentType=="video"}),!i.every(function(d){return d.variantIds})||!e.every(function(d){return d.variantIds})){for(var r=y(i),s=r.next();!s.done;s=r.next())s.value.variantIds=[];for(r=y(e),s=r.next();!s.done;s=r.next())s.value.variantIds=[];if(r=0,e.length&&!i.length){var a=r++,l=y(e);for(s=l.next();!s.done;s=l.next())s.value.variantIds.push(a)}if(!e.length&&i.length)for(a=r++,l=y(i),s=l.next();!s.done;s=l.next())s.value.variantIds.push(a);if(e.length&&i.length)for(i=y(i),s=i.next();!s.done;s=i.next())for(s=s.value,a=y(e),l=a.next();!l.done;l=a.next()){l=l.value;var h=r++;s.variantIds.push(h),l.variantIds.push(h)}}}function Ll(){yn.apply(this,arguments)}he(Ll,yn),Ll.prototype.bc=function(e){var i,r,s,a,l,h;return B(function(d){if(d.g==1){for(i=[],r=0;r<e.periods.length;++r){s=r==e.periods.length-1?e.duration:e.periods[r+1].startTime,a=s-e.periods[r].startTime;for(var g=e.periods[r],_=[],x=y(g.streams),T=x.next();!T.done;T=x.next())T=T.value,T.variantIds.length!=0&&_.push(XA(T,g.startTime,g.startTime+a));l=_,i.push(l)}return b(d,P_(i),2)}return h=d.h,d.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:e.expiration==null?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:h,sequenceMode:!1})})};function XA(e,i,r){return{id:e.id,originalId:e.originalId,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(s){return{startTime:i+s.startTime,endTime:i+s.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:i,appendWindowEnd:r,timestampOffset:i-e.presentationTimeOffset,dataKey:s.dataKey,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}function Yc(){yn.apply(this,arguments)}he(Yc,yn),p=Yc.prototype,p.hasFixedKeySpace=function(){return!1},p.addSegments=function(e){return this.add(this.i,e)},p.addManifests=function(e){return this.add(this.g,e)},p.updateManifest=function(e,i){return UA(this,e,i)},p.bc=function(e){return e.expiration==null&&(e.expiration=1/0),Promise.resolve(e)};function Ly(){this.m=this.j=this.i=this.h=this.g=this.l=null}p=Ly.prototype,p.init=function(){var e=this,i=new Ke,r=!1,s=new Ee(function(){r=!0,i.reject(new F(2,9,9017))});s.N(5);var a=u.indexedDB.open("shaka_offline_db",5);return a.onsuccess=function(){if(!r){var l=a.result;e.l=l;var h=l.objectStoreNames;h=h.contains("manifest")&&h.contains("segment")?new Eo(l,"segment","manifest"):null,e.g=h,h=l.objectStoreNames,h=h.contains("manifest-v2")&&h.contains("segment-v2")?new Ll(l,"segment-v2","manifest-v2"):null,e.h=h,h=l.objectStoreNames,h=h.contains("manifest-v3")&&h.contains("segment-v3")?new Ll(l,"segment-v3","manifest-v3"):null,e.i=h,h=l.objectStoreNames,h=h.contains("manifest-v5")&&h.contains("segment-v5")?new Yc(l,"segment-v5","manifest-v5"):null,e.j=h,l=l.objectStoreNames.contains("session-ids")?new Co(l):null,e.m=l,s.stop(),i.resolve()}},a.onupgradeneeded=function(){for(var l=a.result,h=y(["segment-v5","manifest-v5","session-ids"]),d=h.next();!d.done;d=h.next())d=d.value,l.objectStoreNames.contains(d)||l.createObjectStore(d,{autoIncrement:!0})},a.onerror=function(l){r||(i.reject(new F(2,9,9001,a.error)),s.stop(),l.preventDefault())},i},p.destroy=function(){var e=this;return B(function(i){switch(i.g){case 1:if(!e.g){i.A(2);break}return b(i,e.g.destroy(),2);case 2:if(!e.h){i.A(4);break}return b(i,e.h.destroy(),4);case 4:if(!e.i){i.A(6);break}return b(i,e.i.destroy(),6);case 6:if(!e.j){i.A(8);break}return b(i,e.j.destroy(),8);case 8:if(!e.m){i.A(10);break}return b(i,e.m.destroy(),10);case 10:e.l&&e.l.close(),Q(i)}})},p.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},p.getEmeSessionCell=function(){return this.m},p.erase=function(){var e=this;return B(function(i){switch(i.g){case 1:if(!e.g){i.A(2);break}return b(i,e.g.destroy(),2);case 2:if(!e.h){i.A(4);break}return b(i,e.h.destroy(),4);case 4:if(!e.i){i.A(6);break}return b(i,e.i.destroy(),6);case 6:if(!e.j){i.A(8);break}return b(i,e.j.destroy(),8);case 8:return e.l&&e.l.close(),b(i,qA(),10);case 10:return e.l=null,e.g=null,e.h=null,e.i=null,e.j=null,b(i,e.init(),0)}})};function qA(){var e=new Ke,i=u.indexedDB.deleteDatabase("shaka_offline_db");return i.onblocked=function(){},i.onsuccess=function(){e.resolve()},i.onerror=function(r){e.reject(new F(2,9,9001,i.error)),r.preventDefault()},e}Iy("idb",function(){return tt("CrKey")||zs()||!u.indexedDB?null:new Ly});function qi(e,i,r,s){this.g=e,this.i=i,this.h=r,this.l=s,this.j=["offline:",e,"/",i,"/",r,"/",s].join("")}qi.prototype.za=function(){return this.i},qi.prototype.ja=function(){return this.h},qi.prototype.key=function(){return this.l},qi.prototype.toString=function(){return this.j};function Kc(e){if(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e),e==null)return null;var i=e[1];if(i!="manifest"&&i!="segment")return null;var r=e[2];if(!r)return null;var s=e[3];return s&&i!=null?new qi(i,r,s,Number(e[4])):null}function My(e,i){this.h=e,this.g=i}function Py(e,i){var r=new de(null,0);r.Aa(i.duration);var s=i.streams.filter(function(_){return _.type=="audio"}),a=i.streams.filter(function(_){return _.type=="video"});s=$A(e,s,a,r),a=i.streams.filter(function(_){return _.type==ze}).map(function(_){return Ml(e,_,r)});var l=i.streams.filter(function(_){return _.type=="image"}).map(function(_){return Ml(e,_,r)}),h=i.drmInfo?[i.drmInfo]:[];if(i.drmInfo)for(var d=y(s.values()),g=d.next();!g.done;g=d.next())g=g.value,g.audio&&g.audio.encrypted&&(g.audio.drmInfos=h),g.video&&g.video.encrypted&&(g.video.drmInfos=h);return{presentationTimeline:r,minBufferTime:2,offlineSessionIds:i.sessionIds,variants:Array.from(s.values()),textStreams:a,imageStreams:l,sequenceMode:i.sequenceMode||!1}}function $A(e,i,r,s){for(var a=new Set,l=y(i),h=l.next();!h.done;h=l.next()){var d=y(h.value.variantIds);for(h=d.next();!h.done;h=d.next())a.add(h.value)}for(l=y(r),h=l.next();!h.done;h=l.next())for(d=y(h.value.variantIds),h=d.next();!h.done;h=d.next())a.add(h.value);for(l=new Map,a=y(a),h=a.next();!h.done;h=a.next())h=h.value,l.set(h,{id:h,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(i=y(i),a=i.next();!a.done;a=i.next())for(a=a.value,h=Ml(e,a,s),d=y(a.variantIds),a=d.next();!a.done;a=d.next())a=l.get(a.value),a.language=h.language,a.primary=a.primary||h.primary,a.audio=h;for(r=y(r),i=r.next();!i.done;i=r.next())for(a=i.value,i=Ml(e,a,s),h=y(a.variantIds),a=h.next();!a.done;a=h.next())a=l.get(a.value),a.primary=a.primary||i.primary,a.video=i;return l}function Ml(e,i,r){var s=i.segments.map(function(a){return YA(e,a)});return r.Ib(s),{id:i.id,originalId:i.originalId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new Fe(s),mimeType:i.mimeType,codecs:i.codecs,width:i.width||void 0,height:i.height||void 0,frameRate:i.frameRate,pixelAspectRatio:i.pixelAspectRatio,hdr:i.hdr,kind:i.kind,encrypted:i.encrypted,drmInfos:[],keyIds:i.keyIds,language:i.language,label:i.label,type:i.type,primary:i.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:i.roles,forced:i.forced,channelsCount:i.channelsCount,audioSamplingRate:i.audioSamplingRate,spatialAudio:i.spatialAudio,closedCaptions:i.closedCaptions,tilesLayout:i.tilesLayout}}function YA(e,i){var r=new qi("segment",e.h,e.g,i.dataKey);return new Me(i.startTime,i.endTime,function(){return[r.toString()]},0,null,i.initSegmentKey!=null?KA(e,i.initSegmentKey):null,i.timestampOffset,i.appendWindowStart,i.appendWindowEnd,[],i.tilesLayout||"")}function KA(e,i){var r=new qi("segment",e.h,e.g,i);return new fi(function(){return[r.toString()]},0,null)}function ky(){this.g=null}p=ky.prototype,p.configure=function(){},p.start=function(e,i){var r=this,s,a,l,h,d,g,_;return B(function(x){switch(x.g){case 1:if(s=Kc(e),r.g=s,s==null||s.g!="manifest")throw new F(2,1,9004,e);return a=new Ut,et(x),b(x,a.init(),4);case 4:return b(x,Rl(a,s.za(),s.ja()),5);case 5:return l=x.h,b(x,l.getManifests([s.key()]),6);case 6:return h=x.h,d=h[0],g=new My(s.za(),s.ja()),_=Py(g,d),i.makeTextStreamsForClosedCaptions(_),x.return(_);case 2:return Et(x),b(x,a.destroy(),7);case 7:pt(x,0)}})},p.stop=function(){return Promise.resolve()},p.update=function(){},p.onExpirationUpdated=function(e,i){var r=this,s,a,l,h,d,g,_;return B(function(x){switch(x.g){case 1:return s=r.g,a=new Ut,fe(x,2,3),b(x,a.init(),5);case 5:return b(x,Rl(a,s.za(),s.ja()),6);case 6:return l=x.h,b(x,l.getManifests([s.key()]),7);case 7:if(h=x.h,d=h[0],g=d.sessionIds.includes(e),_=d.expiration==null||d.expiration>i,!g||!_){x.A(3);break}return b(x,l.updateManifestExpiration(s.key(),i),3);case 3:return Et(x),b(x,a.destroy(),10);case 10:pt(x,0);break;case 2:oe(x),x.A(3)}})},di["application/x-offline-manifest"]=function(){return new ky};function Oy(){}function Dy(e){var i=Kc(e);return i&&i.g=="manifest"?(e={uri:e,Oe:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},e=Zn(e)):e=i&&i.g=="segment"?ZA(i.key(),i):nn(new F(2,1,9004,e)),e}function ZA(e,i){var r=new Ut;return Zn(void 0).Y(function(){return r.init()}).Y(function(){return Rl(r,i.za(),i.ja())}).Y(function(s){return s.getSegments([i.key()])}).Y(function(s){return{uri:i,data:s[0].data,headers:{}}}).finally(function(){return r.destroy()})}ie("shaka.offline.OfflineScheme",Oy),Oy.plugin=Dy,lr("offline",Dy);function Fy(e,i,r){var s,a,l,h,d,g;return B(function(_){switch(_.g){case 1:s=[];for(var x=[],T=y(r),S=T.next();!S.done;S=T.next()){S=S.value;for(var A=!1,M=y(x),O=M.next();!O.done;O=M.next())if(O=O.value,JA(O.info,S)){O.sessionIds.push(S.sessionId),A=!0;break}A||x.push({info:S,sessionIds:[S.sessionId]})}a=y(x),l=a.next();case 2:if(l.done){_.A(4);break}return h=l.value,d=QA(e,i,h),b(_,d,5);case 5:g=_.h,s=s.concat(g),l=a.next(),_.A(2);break;case 4:return _.return(s)}})}function QA(e,i,r){var s,a;return B(function(l){switch(l.g){case 1:return s=new Ma({kb:i,onError:function(){},cd:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),fe(l,2),s.configure(e),b(l,xT(s,r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:we(l,3);break;case 2:return oe(l),b(l,s.destroy(),5);case 5:return l.return([]);case 3:return fe(l,6),b(l,dh(s),8);case 8:we(l,7);break;case 6:return oe(l),b(l,s.destroy(),9);case 9:return l.return([]);case 7:return a=[],b(l,Promise.all(r.sessionIds.map(function(h){return B(function(d){if(d.g==1)return fe(d,2),b(d,wT(s,h),4);if(d.g!=2)return a.push(h),we(d,0);oe(d),Q(d)})})),10);case 10:return b(l,s.destroy(),11);case 11:return l.return(a)}})}function JA(e,i){function r(s,a){return s.robustness==a.robustness&&s.contentType==a.contentType}return e.keySystem==i.keySystem&&e.licenseUri==i.licenseUri&&Ue(e.audioCapabilities,i.audioCapabilities,r)&&Ue(e.videoCapabilities,i.videoCapabilities,r)}function eE(e,i,r){var s=i.presentationTimeline.getDuration();return i=Ny(i),{offlineUri:null,originalManifestUri:e,duration:s,size:0,expiration:1/0,tracks:i,appMetadata:r,isIncomplete:!1}}function Zc(e,i){var r=Py(new My(e.za(),e.ja()),i),s=i.appMetadata||{};return r=Ny(r),{offlineUri:e.toString(),originalManifestUri:i.originalManifestUri,duration:i.duration,size:i.size,expiration:i.expiration,tracks:r,appMetadata:s,isIncomplete:i.isIncomplete||!1}}function Ny(e){var i=[],r=Xw(e.variants);r=y(r);for(var s=r.next();!s.done;s=r.next())i.push(rn(s.value));for(e=y(e.textStreams),r=e.next();!r.done;r=e.next())i.push(ma(r.value));return i}function tE(){this.g={}}function iE(e,i){var r=i.audio,s=i.video;if(r&&!s&&(e.g[r.id]=r.bandwidth||i.bandwidth),!r&&s&&(e.g[s.id]=s.bandwidth||i.bandwidth),r&&s){var a=r.bandwidth||393216,l=s.bandwidth||i.bandwidth-a;0>=l&&(l=i.bandwidth),e.g[r.id]=a,e.g[s.id]=l}}function rE(e,i){e.g[i.id]=i.bandwidth||2048}function Uy(e,i){return e=e.g[i],e==null&&(e=0),e}function yt(e){var i=this;if(e&&e.constructor!=W)throw new F(2,9,9008);this.g=this.h=null,e?(this.h=e.h,this.g=e.jc()):(this.h=as(),this.g=new Ge),this.i=[],this.j=[];var r=!e;this.l=new sn(function(){var s,a,l,h,d;return B(function(g){switch(g.g){case 1:return b(g,Promise.all(i.j.map(function(_){return Xc(_)})),2);case 2:for(s=function(){},a=[],l=y(i.i),h=l.next();!h.done;h=l.next())d=h.value,a.push(d.then(s,s));return b(g,Promise.all(a),3);case 3:if(!r){g.A(4);break}return b(g,i.g.destroy(),4);case 4:i.h=null,i.g=null,Q(g)}})})}function Qc(){if(Ii())e:{for(var e=y(Ao.values()),i=e.next();!i.done;i=e.next())if(i=i.value,i=i()){i.destroy(),e=!0;break e}e=!1}else e=!1;return e}p=yt.prototype,p.destroy=function(){return this.l.destroy()},p.configure=function(e,i){return arguments.length==2&&typeof e=="string"&&(e=Qh(e,i)),ls(this.h,e)},p.getConfiguration=function(){var e=as();return ls(e,this.h,as()),e},p.jc=function(){return this.g},p.store=function(e,i,r){var s=this,a=this.getConfiguration(),l=new Sy(this.g);return this.j.push(l),i=nE(this,e,i||{},function(){var h;return B(function(d){return d.g==1?b(d,dg(e,s.g,a.manifest.retryParameters,r||null),2):(h=d.h,d.return(h()))})},a,l),i=new it(i,function(){return Xc(l)}),i.finally(function(){gt(s.j,l)}),xE(this,i)};function nE(e,i,r,s,a,l){var h,d,g,_,x,T,S,A,M,O,P,k,z,D;return B(function(N){switch(N.g){case 1:return Pl(),d=h=null,g=new Ut,T=x=_=null,fe(N,2,3),b(N,s(),5);case 5:return h=N.h,b(N,pE(e,i,h,a),6);case 6:if(S=N.h,Lt(e),A=!S.presentationTimeline.U()&&!S.presentationTimeline.jb(),!A)throw new F(2,9,9005,i);return b(N,gE(e,S,function(j){T=T||j},a),7);case 7:if(d=N.h,Lt(e),T)throw T;return b(N,oE(S,a),8);case 8:return b(N,g.init(),9);case 9:return Lt(e),b(N,by(g),10);case 10:return _=N.h,Lt(e),M=aE(d,S,i,r,a,l),O=M.ag,P=M.pe,b(N,_.ja.addManifests([O]),11);case 11:if(k=N.h,Lt(e),x=k[0],Lt(e),T)throw T;return b(N,sE(e,P,x,O,l,a,_.ja,S,d),12);case 12:return Lt(e),z=new qi("manifest",_.path.za,_.path.ja,x),N.return(Zc(z,O));case 3:return Et(N),b(N,g.destroy(),13);case 13:if(!h){N.A(14);break}return b(N,h.stop(),14);case 14:if(!d){N.A(16);break}return b(N,d.destroy(),16);case 16:pt(N,0);break;case 2:if(D=oe(N),x==null){N.A(18);break}return b(N,zy(x),18);case 18:throw T||D}})}function sE(e,i,r,s,a,l,h,d,g){var _,x,T,S,A,M,O,P,k,z;return B(function(D){switch(D.g){case 1:if(_={},x=0,T=function(N,j){var V,G,Y,K,le,pe,me;return B(function(Ae){if(Ae.g==1){for(V={},G=y(N),Y=G.next();!Y.done;V={cb:V.cb},Y=G.next())V.cb=Y.value,K=kA(V.cb,l),le=V.cb.i,pe=V.cb.h,me=function(ne){return function(nt){var Qe,ct,ti;return B(function(wi){if(wi.g==1)return b(wi,h.addSegments([{data:nt}]),2);Qe=wi.h,Lt(e),ct=ne.cb.g,ti=Gc(ct),_[ti]=Qe[0],x+=nt.byteLength,Q(wi)})}}(V),DA(a,V.cb.groupId,K,le,pe,me);return b(Ae,FA(a),2)}return j?(Lt(e),lE(d,s,g,l),b(Ae,h.updateManifest(r,s),0)):Ae.A(0)})},S=!1,fe(D,2),!Jc(d)||!S||jy(d)){D.A(4);break}return b(D,T(i.filter(function(N){return N.h}),!0),5);case 5:return Lt(e),i=i.filter(function(N){return!N.h}),A=_,M=x,_={},x=0,b(D,By(h,r,s,A,M,function(){return Lt(e)}),6);case 6:Lt(e);case 4:if(S){D.A(7);break}return b(D,T(i,!1),8);case 8:return Lt(e),O=_,P=x,_={},x=0,b(D,By(h,r,s,O,P,function(){return Lt(e)}),9);case 9:Lt(e);case 7:we(D,0);break;case 2:return k=oe(D),z=Object.values(_),b(D,h.removeSegments(z,function(){}),10);case 10:throw k}})}function zy(e){var i,r,s,a;return B(function(l){switch(l.g){case 1:return i=new Ut,b(l,i.init(),2);case 2:return b(l,by(i),3);case 3:return r=l.h,s=new qi("manifest",r.path.za,r.path.ja,e),b(l,i.destroy(),4);case 4:return a=new yt,b(l,a.remove(s.toString()),0)}})}function By(e,i,r,s,a,l){var h,d,g,_,x,T,S,A,M,O,P;return B(function(k){switch(k.g){case 1:for(h=!1,fe(k,2),d=!0,g=y(r.streams),_=g.next();!_.done;_=g.next())for(x=_.value,T=y(x.segments),S=T.next();!S.done;S=T.next())A=S.value,M=A.pendingSegmentRefId?s[A.pendingSegmentRefId]:null,M!=null&&(A.dataKey=M,A.pendingSegmentRefId=void 0),M=A.pendingInitSegmentRefId?s[A.pendingInitSegmentRefId]:null,M!=null&&(A.initSegmentKey=M,A.pendingInitSegmentRefId=void 0),A.pendingSegmentRefId&&(d=!1),A.pendingInitSegmentRefId&&(d=!1);return r.size+=a,d&&(r.isIncomplete=!1),b(k,e.updateManifest(i,r),4);case 4:h=!0,l(),we(k,0);break;case 2:return O=oe(k),b(k,zy(i),5);case 5:if(h){k.A(6);break}return P=Object.values(s),b(k,e.removeSegments(P,function(){}),6);case 6:throw O}})}function oE(e,i){var r,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k,z,D,N,j,V,G,Y,K,le,pe,me,Ae,ne;return B(function(nt){switch(nt.g){case 1:return r={width:1/0,height:1/0},Bw(e,i.restrictions,r),b(nt,_p(e,i.offline.usePersistentLicense),2);case 2:for(s=[],a=i.preferredAudioChannelCount,l=i.preferredDecodingAttributes,h=i.preferredVideoCodecs,d=i.preferredAudioCodecs,gp(e,h,d,a,l),g=y(e.variants),_=g.next();!_.done;_=g.next())x=_.value,s.push(rn(x));for(T=y(e.textStreams),S=T.next();!S.done;S=T.next())A=S.value,s.push(ma(A));for(M=y(e.imageStreams),O=M.next();!O.done;O=M.next())P=O.value,s.push(rh(P));return b(nt,i.offline.trackSelectionCallback(s),3);case 3:for(k=nt.h,z=e.presentationTimeline.getDuration(),D=0,N=y(k),j=N.next();!j.done;j=N.next())V=j.value,G=V.bandwidth*z/8,D+=G;return fe(nt,4),b(nt,i.offline.downloadSizeCallback(D),6);case 6:if(Y=nt.h,!Y)throw new F(2,9,9014);we(nt,5);break;case 4:throw K=oe(nt),K instanceof F?K:new F(2,9,9015);case 5:for(le=new Set,pe=new Set,me=new Set,Ae=y(k),j=Ae.next();!j.done;j=Ae.next())ne=j.value,ne.type=="variant"&&le.add(ne.id),ne.type=="text"&&pe.add(ne.id),ne.type=="image"&&me.add(ne.id);e.variants=e.variants.filter(function(Qe){return le.has(Qe.id)}),e.textStreams=e.textStreams.filter(function(Qe){return pe.has(Qe.id)}),e.imageStreams=e.imageStreams.filter(function(Qe){return me.has(Qe.id)}),TE(e),Q(nt)}})}function aE(e,i,r,s,a,l){var h=eE(r,i,s),d=a.offline.progressCallback;OA(l,function(A,M){h.size=M,d(h,A)},function(A,M){g&&a.offline.usePersistentLicense&&_==M&&Qs(e,"cenc",A)});var g=Jc(i)&&!jy(i),_=null;g&&(_=SE.get(e.g.keySystem));for(var x=new tE,T=y(i.textStreams),S=T.next();!S.done;S=T.next())x.g[S.value.id]=52;for(T=y(i.imageStreams),S=T.next();!S.done;S=T.next())rE(x,S.value);for(S=y(i.variants),T=S.next();!T.done;T=S.next())iE(x,T.value);return x=mE(l,x,i,a),l=x.streams,x=x.pe,S=e.g,T=a.offline.usePersistentLicense,S&&T&&(S.initData=[]),{ag:{creationTime:Date.now(),originalManifestUri:r,duration:i.presentationTimeline.getDuration(),size:0,expiration:e.ic(),streams:l,sessionIds:T?sg(e):[],drmInfo:S,appMetadata:s,isIncomplete:!0,sequenceMode:i.sequenceMode},pe:x}}function Jc(e){return e.variants.some(function(i){var r=i.audio&&i.audio.encrypted;return i.video&&i.video.encrypted||r})}function jy(e){return e.variants.some(function(i){return(i.video?i.video.drmInfos:[]).concat(i.audio?i.audio.drmInfos:[]).some(function(r){return r.initData&&r.initData.length})})}function lE(e,i,r,s){if(i.expiration=r.ic(),r=sg(r),i.sessionIds=s.offline.usePersistentLicense?r:[],Jc(e)&&s.offline.usePersistentLicense&&!r.length)throw new F(2,9,9007)}p.remove=function(e){return ed(this,uE(this,e))};function uE(e,i){var r,s,a,l,h,d;return B(function(g){switch(g.g){case 1:if(Pl(),r=Kc(i),r==null||r.g!="manifest")throw new F(2,9,9004,i);return s=r,a=new Ut,et(g),b(g,a.init(),4);case 4:return b(g,Rl(a,s.za(),s.ja()),5);case 5:return l=g.h,b(g,l.getManifests([s.key()]),6);case 6:return h=g.h,d=h[0],b(g,Promise.all([hE(e,d,a),cE(l,s,d)]),2);case 2:return Et(g),b(g,a.destroy(),8);case 8:pt(g,0)}})}function Hy(e,i){for(var r=[],s=y(e.streams),a=s.next();!a.done;a=s.next())a=a.value,i&&a.type=="video"?r.push({contentType:Hi(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):i||a.type!="audio"||r.push({contentType:Hi(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return r}function hE(e,i,r){return B(function(s){return b(s,wE(e.g,e.h.drm,r,i),0)})}function cE(e,i,r){function s(){}var a=vE(r);return Zc(i,r),Promise.all([e.removeSegments(a,s),e.removeManifests([i.key()],s)])}p.pg=function(){return ed(this,dE(this))};function dE(e){var i,r,s,a,l,h,d,g,_,x;return B(function(T){switch(T.g){case 1:return Pl(),i=e.g,r=e.h.drm,s=new Ut,a=!1,et(T),b(T,s.init(),4);case 4:l=[],BA(s,function(S){return l.push(S)}),h=y(l),d=h.next();case 5:if(d.done){T.A(2);break}return g=d.value,b(T,g.getAll(),8);case 8:return _=T.h,b(T,Fy(r,i,_),9);case 9:return x=T.h,b(T,g.remove(x),10);case 10:x.length!=_.length&&(a=!0),d=h.next(),T.A(5);break;case 2:return Et(T),b(T,s.destroy(),11);case 11:pt(T,3);break;case 3:return T.return(!a)}})}p.list=function(){return ed(this,fE())};function fE(){var e,i,r;return B(function(s){switch(s.g){case 1:return Pl(),e=[],i=new Ut,et(s),b(s,i.init(),4);case 4:return r=Promise.resolve(),zA(i,function(a,l){r=r.then(function(){var h;return B(function(d){if(d.g==1)return b(d,l.getAllManifests(),2);h=d.h,h.forEach(function(g,_){g=Zc(new qi("manifest",a.za,a.ja,_),g),e.push(g)}),Q(d)})})}),b(s,r,2);case 2:return Et(s),b(s,i.destroy(),6);case 6:pt(s,3);break;case 3:return s.return(e)}})}function pE(e,i,r,s){var a,l,h,d,g;return B(function(_){if(_.g==1)return a=null,l=e.g,h={networkingEngine:l,modifyManifestRequest:function(){},modifySegmentRequest:function(){},filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(x){a=x},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){}},r.configure(s.manifest),Lt(e),b(_,r.start(i,h),2);if(_.g!=3)return d=_.h,Lt(e),g=Vy(d),b(_,Promise.all(Wp(g,function(x){return x.createSegmentIndex()})),3);if(Lt(e),a)throw a;return _.return(d)})}function gE(e,i,r,s){var a;return B(function(l){switch(l.g){case 1:return a=new Ma({kb:e.g,onError:r,cd:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a.configure(s.drm),b(l,yT(a,i.variants,s.offline.usePersistentLicense),2);case 2:return b(l,dh(a),3);case 3:return b(l,rg(a),4);case 4:return l.return(a)}})}function mE(e,i,r,s){var a=new Map,l=Vy(r),h=new Map;l=y(l);for(var d=l.next();!d.done;d=l.next()){d=d.value;var g=_E(e,i,r,d,s,a);h.set(d.id,g)}for(e=y(r.variants),i=e.next();!i.done;i=e.next())i=i.value,i.audio&&h.get(i.audio.id).variantIds.push(i.id),i.video&&h.get(i.video.id).variantIds.push(i.id);return{streams:Array.from(h.values()),pe:Array.from(a.values())}}function _E(e,i,r,s,a,l){var h={id:s.id,originalId:s.originalId,primary:s.primary,type:s.type,mimeType:s.mimeType,codecs:s.codecs,frameRate:s.frameRate,pixelAspectRatio:s.pixelAspectRatio,hdr:s.hdr,kind:s.kind,language:s.language,label:s.label,width:s.width||null,height:s.height||null,encrypted:s.encrypted,keyIds:s.keyIds,segments:[],variantIds:[],roles:s.roles,forced:s.forced,channelsCount:s.channelsCount,audioSamplingRate:s.audioSamplingRate,spatialAudio:s.spatialAudio,closedCaptions:s.closedCaptions,tilesLayout:s.tilesLayout},d=a.offline.numberOfParallelDownloads,g=0;return yE(s,r.presentationTimeline.Pa(),function(_){var x=Gc(_),T=void 0;if(!l.has(x)){var S=_.endTime-_.startTime;S=Uy(i,s.id)*S,S=Ty(e.g,S),l.set(x,new vy(_,S,g,!1))}_.h&&(T=Gc(_.h),l.has(T)||(S=.5*Uy(i,s.id),S=Ty(e.g,S),l.set(T,new vy(_.h,S,g,!0)))),h.segments.push({pendingInitSegmentRefId:T,initSegmentKey:T?0:null,startTime:_.startTime,endTime:_.endTime,appendWindowStart:_.appendWindowStart,appendWindowEnd:_.appendWindowEnd,timestampOffset:_.timestampOffset,tilesLayout:_.tilesLayout,pendingSegmentRefId:x,dataKey:0}),g=(g+1)%d}),h}function yE(e,i,r){if(i=e.segmentIndex.find(i),i!=null)for(var s=e.segmentIndex.get(i);s;)r(s),s=e.segmentIndex.get(++i)}function Lt(e){if(e.l.g)throw new F(2,9,7001)}function Pl(){if(!Qc())throw new F(2,9,9e3)}function ed(e,i){return B(function(r){return r.g==1?(e.i.push(i),et(r),b(r,i,4)):r.g!=2?r.return(r.h):(Et(r),gt(e.i,i),pt(r,0))})}function xE(e,i){var r=i.promise;return e.i.push(r),i.finally(function(){gt(e.i,r)})}function vE(e){var i=new Set;e=y(e.streams);for(var r=e.next();!r.done;r=e.next()){r=y(r.value.segments);for(var s=r.next();!s.done;s=r.next())s=s.value,s.initSegmentKey!=null&&i.add(s.initSegmentKey),i.add(s.dataKey)}return Array.from(i)}function wE(e,i,r,s){var a,l,h;return B(function(d){return d.g==1?s.drmInfo?(a=jA(r),l=s.sessionIds.map(function(g){return{sessionId:g,keySystem:s.drmInfo.keySystem,licenseUri:s.drmInfo.licenseServerUri,serverCertificate:s.drmInfo.serverCertificate,audioCapabilities:Hy(s,!1),videoCapabilities:Hy(s,!0)}}),b(d,Fy(i,e,l),2)):d.return():d.g!=3?(h=d.h,b(d,a.remove(h),3)):b(d,a.add(l.filter(function(g){return!h.includes(g.sessionId)})),0)})}function Vy(e){for(var i=new Set,r=y(e.textStreams),s=r.next();!s.done;s=r.next())i.add(s.value);for(r=y(e.imageStreams),s=r.next();!s.done;s=r.next())i.add(s.value);for(e=y(e.variants),r=e.next();!r.done;r=e.next())r=r.value,r.audio&&i.add(r.audio),r.video&&i.add(r.video);return i}function TE(e){e.variants.map(function(l){return l.video});var i=new Set(e.variants.map(function(l){return l.audio}));e=e.textStreams;for(var r=y(i),s=r.next();!s.done;s=r.next()){s=y(i);for(var a=s.next();!a.done;a=s.next());}for(i=y(e),r=i.next();!r.done;r=i.next())for(r=y(e),s=r.next();!s.done;s=r.next());}ie("shaka.offline.Storage",yt),yt.deleteAll=function(){var e;return B(function(i){return i.g==1?(e=new Ut,et(i),b(i,HA(e),2)):i.g!=5?(Et(i),b(i,e.destroy(),5)):pt(i,0)})},yt.prototype.list=yt.prototype.list,yt.prototype.removeEmeSessions=yt.prototype.pg,yt.prototype.remove=yt.prototype.remove,yt.prototype.store=yt.prototype.store,yt.prototype.getNetworkingEngine=yt.prototype.jc,yt.prototype.getConfiguration=yt.prototype.getConfiguration,yt.prototype.configure=yt.prototype.configure,yt.prototype.destroy=yt.prototype.destroy,yt.support=Qc;var SE=new Map().set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");fc.offline=Qc;function Tt(){}function Pt(e,i){for(e={priority:i||0,mf:e},i=0;i<bo.length;i++)if(bo[i].priority<e.priority){bo.splice(i,0,e);return}bo.push(e)}ie("shaka.polyfill",Tt),Tt.register=Pt,Tt.installAll=function(){for(var e=y(bo),i=e.next();!i.done;i=e.next()){i=i.value;try{i.mf()}catch(r){Ve("Error installing polyfill!",r)}}};var bo=[];function Io(){this.g=new kl}function Wy(){u.AbortController||(u.AbortController=Io,u.AbortSignal=kl)}Io.prototype.abort=function(e){var i=this.g;i.h||(i.h=!0,i.g=e,i.g===void 0&&(i.g=new DOMException("signal is aborted without reason","AbortError")),e=new ye("abort"),i.onabort&&i.onabort(e),i.dispatchEvent(e))},L.Object.defineProperties(Io.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Tt.AbortController=Io,Io.install=Wy;function kl(){Oe.call(this),this.h=!1,this.g=void 0,this.onabort=null}he(kl,Oe),L.Object.defineProperties(kl.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Pt(Wy);function Gy(){}function Xy(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=y(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),i=e.next();!i.done;i=e.next())CE(i.value)}function CE(e){var i="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(i)},set:function(r){r==null||r==null?this.removeAttribute(i):this.setAttribute(i,r)}})}Tt.Aria=Gy,Gy.install=Xy,Pt(Xy);function qy(){}function $y(){rv()}Tt.EncryptionScheme=qy,qy.install=$y,Pt($y,-2);function Yy(){}function Ky(){if(u.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,e=Document.prototype,e.exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",ys),document.addEventListener("webkitfullscreenerror",ys),document.addEventListener("mozfullscreenchange",ys),document.addEventListener("mozfullscreenerror",ys),document.addEventListener("MSFullscreenChange",ys),document.addEventListener("MSFullscreenError",ys)}}function ys(e){var i=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),r=document.createEvent("Event");r.initEvent(i,e.bubbles,e.cancelable),e.target.dispatchEvent(r)}Tt.Fullscreen=Yy,Yy.install=Ky,Pt(Ky);function td(){}function Zy(){var e=!0;(la()||tt("PlayStation 5")||Bs()||tt("Web0S")||Wn()||tt("CrKey")||tt("PC=EOS")||tt("Hisense")||tt("VIDAA"))&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),Qy=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=AE)}function AE(e){var i,r,s,a,l,h,d,g,_,x,T,S,A,M,O,P,k;return B(function(z){switch(z.g){case 1:if(i={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},!e)return z.return(i);if(r=e.video,s=e.audio,e.type=="media-source"){if(!Ii())return z.return(i);if(r){if(tt("CrKey"))if(u.cast&&cast.__platform__&&cast.__platform__.canDisplayType){var D=r.contentType;r.width&&r.height&&(D+="; width="+r.width+"; height="+r.height),r.framerate&&(D+="; framerate="+r.framerate),r.transferFunction==="pq"&&(D+="; eotf=smpte2084"),D=cast.__platform__.canDisplayType(D)}else D=ce(r.contentType);else D=ce(r.contentType);if(a=D,!a)return z.return(i)}if(s&&(l=s.contentType,h=ce(l),!h))return z.return(i)}else if(e.type=="file"){if(r&&(d=r.contentType,g=Vn(d),!g)||s&&(_=s.contentType,x=Vn(_),!x))return z.return(i)}else return z.return(i);return e.keySystemConfiguration?(T=e.keySystemConfiguration,S=[],A=[],T.audio&&(M={robustness:T.audio.robustness||"",contentType:e.audio.contentType},S.push(M)),T.video&&(O={robustness:T.video.robustness||"",contentType:e.video.contentType},A.push(O)),P={initDataTypes:[T.initDataType],distinctiveIdentifier:T.distinctiveIdentifier,persistentState:T.persistentState,sessionTypes:T.sessionTypes},S.length&&(P.audioCapabilities=S),A.length&&(P.videoCapabilities=A),fe(z,3),b(z,navigator.requestMediaKeySystemAccess(T.keySystem,[P]),5)):(i.supported=!0,z.return(Promise.resolve(i)));case 5:k=z.h,we(z,4);break;case 3:oe(z);case 4:k&&(i.supported=!0,i.keySystemAccess=k);case 2:return z.return(i)}})}Tt.MediaCapabilities=td,td.install=Zy;var Qy=null;td.originalMcap=Qy,Pt(Zy,-1);function Jy(){}function ex(){var e=Xu();u.MediaSource&&(u.cast&&cast.__platform__&&cast.__platform__.canDisplayType?RE():e?12>=e?(tx(),EE()):15>=e&&tx():Gu()?bE():(tt("Tizen 2")||tt("Tizen 3")||tt("Tizen 4"))&&IE()),u.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&LE()}function tx(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var i=e.apply(this,Vt.apply(0,arguments));return i.abort=function(){},i}}function EE(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(i,r){return e.call(this,i,r-.001)}}function bE(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(i){return i.split(";")[0].split("/")[1]!="mp2t"&&e(i)}}function IE(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(i){return Ws(i)[0]!="opus"&&e(i)}}function RE(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(i){var r=i.split(/ *; */);return r.shift(),r.some(function(s){return s.startsWith("codecs=")})?cast.__platform__.canDisplayType(i):e(i)}}function LE(){var e=MediaSource.isTypeSupported;tt("Web0S")||(MediaSource.isTypeSupported=function(i){var r=i.split(/ *; */),s=r.findIndex(function(h){return h.startsWith("codecs=")});if(0>s)return e(i);var a=r[s].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),l=a.findIndex(function(h){return h.startsWith("vp09")});return 0<=l&&(a[l]="vp9",r[s]='codecs="'+a.join(",")+'"',i=r.join("; ")),e(i)})}Tt.MediaSource=Jy,Jy.install=ex,Pt(ex);function ix(){}function rx(){screen.orientation||u.orientation!=null&&ME()}function ME(){function e(){switch(u.orientation){case-90:i.type="landscape-secondary",i.angle=270;break;case 0:i.type="portrait-primary",i.angle=0;break;case 90:i.type="landscape-primary",i.angle=90;break;case 180:i.type="portrait-secondary",i.angle=180}}var i=new Ol;screen.orientation=i,e(),u.addEventListener("orientationchange",function(){e();var r=new ye("change");i.dispatchEvent(r)})}Tt.Orientation=ix,ix.install=rx;function Ol(){Oe.call(this),this.type="",this.angle=0}he(Ol,Oe),Ol.prototype.lock=function(e){function i(s){return screen.lockOrientation?screen.lockOrientation(s):screen.mozLockOrientation?screen.mozLockOrientation(s):screen.msLockOrientation?screen.msLockOrientation(s):!1}var r=!1;switch(e){case"natural":r=i("default");break;case"any":r=!0,this.unlock();break;default:r=i(e)}return r?Promise.resolve():(e=Error("screen.orientation.lock() is not available on this device"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},Ol.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Pt(rx);function id(){}var rd,nd,sd,od,ad,ld;function PE(e,i){try{var r=new Dl(e,i);return Promise.resolve(r)}catch(s){return Promise.reject(s)}}function kE(e){var i=this.mediaKeys;return i&&i!=e&&nx(i,null),delete this.mediaKeys,(this.mediaKeys=e)?nx(e,this):Promise.resolve()}function OE(e){if(e=Ie(e.initData),Wt(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=Lr(e.subarray(4),!0),e=Mr(e);var i=new Event("encrypted");i.initDataType="skd",i.initData=ui(e),this.dispatchEvent(i)}Tt.PatchedMediaKeysApple=id,id.uninstall=function(){rd&&(rd=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",nd),HTMLMediaElement.prototype.setMediaKeys=sd,u.MediaKeys=od,u.MediaKeySystemAccess=ad,navigator.requestMediaKeySystemAccess=ld,nd=ld=sd=ad=od=null,u.shakaMediaKeysPolyfill=!1)},id.install=function(e){u.HTMLVideoElement&&u.WebKitMediaKeys&&(e!==void 0&&e&&(rd=!0,nd=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),sd=HTMLMediaElement.prototype.setMediaKeys,od=u.MediaKeys,ad=u.MediaKeySystemAccess,ld=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=kE,u.MediaKeys=Fl,u.MediaKeySystemAccess=Dl,navigator.requestMediaKeySystemAccess=PE,u.shakaMediaKeysPolyfill=!0)};function Dl(e,i){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(e=y(i),i=e.next();!i.done;i=e.next()){var r=i.value;if(r.persistentState=="required")i=null;else{i={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label};var s=!1,a=!1;if(r.audioCapabilities)for(var l=y(r.audioCapabilities),h=l.next();!h.done;h=l.next())h=h.value,h.contentType&&(s=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,h.contentType.split(";")[0])&&(i.audioCapabilities.push(h),a=!0));if(r.videoCapabilities)for(r=y(r.videoCapabilities),h=r.next();!h.done;h=r.next())l=h.value,l.contentType&&(s=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,l.contentType.split(";")[0])&&(i.videoCapabilities.push(l),a=!0));s||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),i=a?i:null}if(i){this.g=i;return}}throw e=Error("Unsupported keySystem"),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}Dl.prototype.createMediaKeys=function(){var e=new Fl(this.keySystem);return Promise.resolve(e)},Dl.prototype.getConfiguration=function(){return this.g};function Fl(e){this.h=new WebKitMediaKeys(e),this.g=new Ye}Fl.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary")throw new TypeError("Session type "+e+" is unsupported on this platform.");return new ud(this.h)},Fl.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function nx(e,i){if(e.g.nb(),!i)return Promise.resolve();e.g.C(i,"webkitneedkey",OE);try{return ns(i,HTMLMediaElement.HAVE_METADATA,e.g,function(){i.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(r){return Promise.reject(r)}}function ud(e){Oe.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new Ye,this.sessionId="",this.expiration=NaN,this.closed=new Ke,this.keyStatuses=new sx}he(ud,Oe),p=ud.prototype,p.generateRequest=function(e,i){var r=this;this.h=new Ke;try{var s=this.l.createSession("video/mp4",Ie(i));this.i=s,this.sessionId=s.sessionId||"",this.j.C(this.i,"webkitkeymessage",function(a){r.h&&(r.h.resolve(),r.h=null),a=new Map().set("messageType",r.keyStatuses.Eb()==null?"license-request":"license-renewal").set("message",ui(a.message)),a=new ye("message",a),r.dispatchEvent(a)}),this.j.C(s,"webkitkeyadded",function(){r.g&&(Nl(r,"usable"),r.g.resolve(),r.g=null)}),this.j.C(s,"webkitkeyerror",function(){var a=Error("EME PatchedMediaKeysApple key error");if(a.errorCode=r.i.error,r.h!=null)r.h.reject(a),r.h=null;else if(r.g!=null)r.g.reject(a),r.g=null;else switch(r.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:Nl(r,"output-not-allowed");break;default:Nl(r,"internal-error")}}),Nl(this,"status-pending")}catch(a){this.h.reject(a)}return this.h},p.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},p.update=function(e){this.g=new Ke;try{this.i.update(Ie(e))}catch(i){this.g.reject(i)}return this.g},p.close=function(){try{this.i.close(),this.closed.resolve(),this.j.nb()}catch(e){this.closed.reject(e)}return this.closed},p.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};function Nl(e,i){var r=e.keyStatuses;r.size=i==null?0:1,r.g=i,i=new ye("keystatuseschange"),e.dispatchEvent(i)}function sx(){this.size=0,this.g=void 0}p=sx.prototype,p.Eb=function(){return this.g},p.forEach=function(e){this.g&&e(this.g,Oa.value())},p.get=function(e){if(this.has(e))return this.g},p.has=function(e){var i=Oa.value();return!!(this.g&&Kr(e,i))},p.entries=function(){},p.keys=function(){},p.values=function(){};function ox(){}function ax(){!u.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=DE,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=FE,u.MediaKeys=hd,u.MediaKeySystemAccess=cd,u.shakaMediaKeysPolyfill=!0)}function DE(){return Promise.reject(Error("The key system specified is not supported."))}function FE(e){return e==null?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}Tt.PatchedMediaKeysNop=ox,ox.install=ax;function hd(){throw new TypeError("Illegal constructor.")}hd.prototype.createSession=function(){},hd.prototype.setServerCertificate=function(){};function cd(){throw this.keySystem="",new TypeError("Illegal constructor.")}cd.prototype.getConfiguration=function(){},cd.prototype.createMediaKeys=function(){},Pt(ax,-10);function lx(){}function ux(){if(!(!u.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)md="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=NE,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=UE,u.MediaKeys=zl,u.MediaKeySystemAccess=Ul,u.shakaMediaKeysPolyfill=!0}}function dd(e){var i=md;return i?i+e.charAt(0).toUpperCase()+e.slice(1):e}function NE(e,i){try{var r=new Ul(e,i);return Promise.resolve(r)}catch(s){return Promise.reject(s)}}function UE(e){var i=this.mediaKeys;return i&&i!=e&&hx(i,null),delete this.mediaKeys,(this.mediaKeys=e)&&hx(e,this),Promise.resolve()}Tt.PatchedMediaKeysWebkit=lx,lx.install=ux;function Ul(e,i){this.g=this.keySystem=e;var r=!1;e=="org.w3.clearkey"&&(this.g="webkit-org.w3.clearkey",r=!1);var s=!1,a=document.getElementsByTagName("video");a=a.length?a[0]:document.createElement("video"),i=y(i);for(var l=i.next();!l.done;l=i.next()){l=l.value;var h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:l.initDataTypes,sessionTypes:["temporary"],label:l.label},d=!1;if(l.audioCapabilities)for(var g=y(l.audioCapabilities),_=g.next();!_.done;_=g.next())_=_.value,_.contentType&&(d=!0,a.canPlayType(_.contentType.split(";")[0],this.g)&&(h.audioCapabilities.push(_),s=!0));if(l.videoCapabilities)for(g=y(l.videoCapabilities),_=g.next();!_.done;_=g.next())_=_.value,_.contentType&&(d=!0,a.canPlayType(_.contentType,this.g)&&(h.videoCapabilities.push(_),s=!0));if(d||(s=a.canPlayType("video/mp4",this.g)||a.canPlayType("video/webm",this.g)),l.persistentState=="required"&&(r?(h.persistentState="required",h.sessionTypes=["persistent-license"]):s=!1),s){this.h=h;return}}throw r="Unsupported keySystem",(e=="org.w3.clearkey"||e=="com.widevine.alpha")&&(r="None of the requested configurations were supported."),e=Error(r),e.name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}Ul.prototype.createMediaKeys=function(){var e=new zl(this.g);return Promise.resolve(e)},Ul.prototype.getConfiguration=function(){return this.h};function zl(e){this.l=e,this.h=null,this.g=new Ye,this.i=[],this.j=new Map}function hx(e,i){e.h=i,e.g.nb();var r=md;i&&(e.g.C(i,r+"needkey",function(s){var a=new CustomEvent("encrypted");a.initDataType="cenc",a.initData=ui(s.initData),e.h.dispatchEvent(a)}),e.g.C(i,r+"keymessage",function(s){var a=fd(e,s.sessionId);a&&(s=new Map().set("messageType",a.keyStatuses.Eb()==null?"licenserequest":"licenserenewal").set("message",s.message),s=new ye("message",s),a.h&&(a.h.resolve(),a.h=null),a.dispatchEvent(s))}),e.g.C(i,r+"keyadded",function(s){(s=fd(e,s.sessionId))&&(Bl(s,"usable"),s.g&&s.g.resolve(),s.g=null)}),e.g.C(i,r+"keyerror",function(s){var a=fd(e,s.sessionId);a&&a.handleError(s)}))}zl.prototype.createSession=function(e){if(e=e||"temporary",e!="temporary"&&e!="persistent-license")throw new TypeError("Session type "+e+" is unsupported on this platform.");var i=this.h||document.createElement("video");return i.src||(i.src="about:blank"),e=new pd(i,this.l,e),this.i.push(e),e},zl.prototype.setServerCertificate=function(){return Promise.resolve(!1)};function fd(e,i){var r=e.j.get(i);return r||((r=e.i.shift())?(r.sessionId=i,e.j.set(i,r),r):null)}function pd(e,i,r){Oe.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=i,this.l=r,this.sessionId="",this.expiration=NaN,this.closed=new Ke,this.keyStatuses=new dx}he(pd,Oe),p=pd.prototype,p.handleError=function(e){var i=Error("EME v0.1b key error"),r=e.errorCode;r.systemCode=e.systemCode,i.errorCode=r,!e.sessionId&&this.h?(e.systemCode==45&&(i.message="Unsupported session type."),this.h.reject(i),this.h=null):e.sessionId&&this.g?(this.g.reject(i),this.g=null):(i=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Bl(this,"output-restricted"):i==1?Bl(this,"expired"):Bl(this,"internal-error"))};function cx(e,i,r){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if(e.l=="persistent-license")if(r)var s=Ie(Mr("LOAD_SESSION|"+r));else{var a=Mr("PERSISTENT|");s=Vs(a,i)}else s=Ie(i)}catch(h){return Promise.reject(h)}e.h=new Ke;var l=dd("generateKeyRequest");try{e.j[l](e.i,s)}catch(h){if(h.name!="InvalidStateError")return e.h=null,Promise.reject(h);new Ee(function(){try{e.j[l](e.i,s)}catch(d){e.h.reject(d),e.h=null}}).N(.01)}return e.h}function gd(e,i,r){if(e.g)e.g.then(function(){return gd(e,i,r)}).catch(function(){return gd(e,i,r)});else{if(e.g=i,e.i=="webkit-org.w3.clearkey"){var s=at(r),a=JSON.parse(s);a.keys[0].kty!="oct"&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),s=or(a.keys[0].k),a=or(a.keys[0].kid)}else s=Ie(r),a=null;var l=dd("addKey");try{e.j[l](e.i,s,a,e.sessionId)}catch(h){e.g.reject(h),e.g=null}}}function Bl(e,i){var r=e.keyStatuses;r.size=i==null?0:1,r.g=i,i=new ye("keystatuseschange"),e.dispatchEvent(i)}p.generateRequest=function(e,i){return cx(this,i,null)},p.load=function(e){return this.l=="persistent-license"?cx(this,null,e):Promise.reject(Error("Not a persistent session."))},p.update=function(e){var i=new Ke;return gd(this,i,e),i},p.close=function(){if(this.l!="persistent-license"){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=dd("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(i){}}return this.closed.resolve(),this.closed},p.remove=function(){return this.l!="persistent-license"?Promise.reject(Error("Not a persistent session.")):this.close()};function dx(){this.size=0,this.g=void 0}p=dx.prototype,p.Eb=function(){return this.g},p.forEach=function(e){this.g&&e(this.g,Oa.value())},p.get=function(e){if(this.has(e))return this.g},p.has=function(e){var i=Oa.value();return!!(this.g&&Kr(e,i))},p.entries=function(){},p.keys=function(){},p.values=function(){};var md="";Pt(ux);function fx(){}function px(){if(u.HTMLVideoElement){var e=HTMLVideoElement.prototype;e.requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=BE,Object.defineProperty(e,"disablePictureInPicture",{get:HE,set:VE,enumerable:!0,configurable:!0}),document.exitPictureInPicture=jE,document.addEventListener("webkitpresentationmodechanged",zE,!0))}}function zE(e){if(e=e.target,e.webkitPresentationMode=="picture-in-picture"){document.pictureInPictureElement=e;var i=new Event("enterpictureinpicture");e.dispatchEvent(i)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),i=new Event("leavepictureinpicture"),e.dispatchEvent(i)}function BE(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function jE(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function HE(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function VE(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}Tt.PiPWebkit=fx,fx.install=px,Pt(px);function gx(){}function mx(){u.crypto&&("randomUUID"in u.crypto||(u.crypto.randomUUID=WE))}function WE(){var e=URL.createObjectURL(new Blob),i=e.toString();return URL.revokeObjectURL(e),i.substr(i.lastIndexOf("/")+1)}Tt.RandomUUID=gx,gx.install=mx,Pt(mx);function _x(){}function yx(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=GE)}function GE(){return new Promise(function(e,i){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(r,s){e({usage:r,quota:s})},i)})}Tt.StorageEstimate=_x,_x.install=yx,Pt(yx);function xx(){}function vx(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:XE})}function XE(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}Tt.Symbol=xx,xx.install=vx,Pt(vx);function wx(){}function Tx(){if(u.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var i=e.apply(this);return i&&i.catch(function(){}),i}}}Tt.VideoPlayPromise=wx,wx.install=Tx,Pt(Tx);function Sx(){}function Cx(){if(u.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||ip())&&(e.getVideoPlaybackQuality=qE)}}function qE(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Tt.VideoPlaybackQuality=Sx,Sx.install=Cx,Pt(Cx);function Ax(){}function Ex(){if(!u.VTTCue&&u.TextTrackCue){var e=null,i=TextTrackCue.length;if(i==3)e=_d;else if(i==6)e=$E;else{try{var r=!!_d(1,2,"")}catch(s){r=!1}r&&(e=_d)}e&&(u.VTTCue=function(s,a,l){return e(s,a,l)})}}function _d(e,i,r){return new u.TextTrackCue(e,i,r)}function $E(e,i,r){return new u.TextTrackCue(e+"-"+i+"-"+r,e,i,r)}Tt.VTTCue=Ax,Ax.install=Ex,Pt(Ex);function ki(){}ki.prototype.parseInit=function(){},ki.prototype.setSequenceMode=function(){},ki.prototype.parseMedia=function(e,i){var r=null,s=[];e=at(e).split(/\r?\n/),e=y(e);for(var a=e.next();!a.done;a=e.next())if((a=a.value)&&!/^\s+$/.test(a)&&(a=YE.exec(a))){var l=KE.exec(a[1]);l=60*parseInt(l[1],10)+parseFloat(l[2].replace(",",".")),a=new Le(l,i.segmentEnd?i.segmentEnd:l+2,a[2]),r&&(r.endTime=l,s.push(r)),r=a}return r&&s.push(r),s},ie("shaka.text.LrcTextParser",ki),ki.prototype.parseMedia=ki.prototype.parseMedia,ki.prototype.setSequenceMode=ki.prototype.setSequenceMode,ki.prototype.parseInit=ki.prototype.parseInit;var YE=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,KE=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;wt["application/x-subtitle-lrc"]=function(){return new ki};function xi(){}xi.prototype.parseInit=function(){},xi.prototype.setSequenceMode=function(){},xi.prototype.parseMedia=function(e,i){var r=at(e);if(e=[],r=="")return e;var s=Zs(r,"tt");if(!s)throw new F(2,2,2005,"Failed to parse TTML.");if(r=s.getElementsByTagName("body")[0],!r)return[];var a=hr(s,Ro,"frameRate"),l=hr(s,Ro,"subFrameRate"),h=hr(s,Ro,"frameRateMultiplier"),d=hr(s,Ro,"tickRate"),g=hr(s,Ro,"cellResolution"),_=s.getAttribute("xml:space")||"default",x=hr(s,Vl,"extent");if(_!="default"&&_!="preserve")throw new F(2,2,2005,"Invalid xml:space value: "+_);_=_=="default",a=new JE(a,l,h,d),g=g&&(g=/^(\d+) (\d+)$/.exec(g))?{columns:parseInt(g[1],10),rows:parseInt(g[2],10)}:null,l=(l=s.getElementsByTagName("metadata")[0])?fT(l):[],h=Array.from(s.getElementsByTagName("style")),s=Array.from(s.getElementsByTagName("region")),d=[];for(var T=y(s),S=T.next();!S.done;S=T.next()){var A=S.value;S=new zn;var M=A.getAttribute("xml:id");if(M){S.id=M;var O=null;x&&(O=wd.exec(x)||Td.exec(x)),M=O?Number(O[1]):null,O=O?Number(O[2]):null;var P,k;(P=jl(A,h,"extent"))&&(P=(k=wd.exec(P))||Td.exec(P),P!=null&&(S.width=Number(P[1]),S.height=Number(P[2]),k||(M!=null&&(S.width=100*S.width/M),O!=null&&(S.height=100*S.height/O)),S.widthUnits=k||M!=null?ji:0,S.heightUnits=k||O!=null?ji:0)),(A=jl(A,h,"origin"))&&(P=(k=wd.exec(A))||Td.exec(A),P!=null&&(S.viewportAnchorX=Number(P[1]),S.viewportAnchorY=Number(P[2]),k||(O!=null&&(S.viewportAnchorY=100*S.viewportAnchorY/O),M!=null&&(S.viewportAnchorX=100*S.viewportAnchorX/M)),S.viewportAnchorUnits=k||M!=null?ji:0))}else S=null;S&&d.push(S)}if(st(r,"p").length)throw new F(2,2,2001,"<p> can only be inside <div> in TTML");for(x=y(st(r,"div")),T=x.next();!T.done;T=x.next())if(st(T.value,"span").length)throw new F(2,2,2001,"<span> can only be inside <p> in TTML");return(i=bx(r,i,a,l,h,s,d,_,g,null,!1))&&(i.backgroundColor||(i.backgroundColor="transparent"),e.push(i)),e};function bx(e,i,r,s,a,l,h,d,g,_,x){var T=e.parentNode;if(e.nodeType==Node.COMMENT_NODE)return null;if(e.nodeType==Node.TEXT_NODE){if(!x)return null;var S=document.createElement("span");S.textContent=e.textContent}else S=e;for(var A=null,M=y(rb),O=M.next();!O.done&&!(A=Hl(S,"backgroundImage",s,"#",O.value)[0]);O=M.next());if(M=x,(e.nodeName=="p"||A)&&(x=!0),d=(S.getAttribute("xml:space")||(d?"default":"preserve"))=="default",O=Array.from(S.childNodes).every(function(N){return N.nodeType==Node.TEXT_NODE}),e=[],!O)for(var P=y(S.childNodes),k=P.next();!k.done;k=P.next())(k=bx(k.value,i,r,s,a,l,h,d,g,S,x))&&e.push(k);s=_!=null,P=/\S/.test(S.textContent);var z=S.hasAttribute("begin")||S.hasAttribute("end")||S.hasAttribute("dur");if(!(z||P||S.tagName=="br"||e.length!=0||s&&!d))return null;for(k=Lx(S,r),P=k.start,k=k.end;T&&T.nodeType==Node.ELEMENT_NODE&&T.tagName!="tt";)k=QE(T,r,P,k),P=k.start,k=k.end,T=T.parentNode;if(P==null&&(P=0),P+=i.periodStart,k=k==null?1/0:k+i.periodStart,P=Math.max(P,i.segmentStart),k=Math.min(k,i.segmentEnd),!z&&0<e.length)for(P=1/0,k=0,i=y(e),r=i.next();!r.done;r=i.next())r=r.value,P=Math.min(P,r.startTime),k=Math.max(k,r.endTime);if(S.tagName=="br")return a=new Le(P,k,""),a.lineBreak=!0,a;if(i="",O&&(i=S.textContent,d&&(i=i.trim(),i=i.replace(/\s+/g," "))),i=new Le(P,k,i),i.nestedCues=e,x||(i.isContainer=!0),g&&(i.cellResolution=g),g=Hl(S,"region",l,"")[0],S.hasAttribute("region")&&g&&g.getAttribute("xml:id")){var D=g.getAttribute("xml:id");i.region=h.filter(function(N){return N.id==D})[0]}return h=g,_&&s&&!S.getAttribute("region")&&!S.getAttribute("style")&&(h=Hl(_,"region",l,"")[0]),ZE(i,S,h,A,a,M,e.length==0),i}function ZE(e,i,r,s,a,l,h){if(l=l||h,kt(i,r,a,"direction",l)=="rtl"&&(e.direction="rtl"),h=kt(i,r,a,"writingMode",l),h=="tb"||h=="tblr"?e.writingMode="vertical-lr":h=="tbrl"?e.writingMode="vertical-rl":h=="rltb"||h=="rl"?e.direction="rtl":h&&(e.direction=Uu),(h=kt(i,r,a,"textAlign",!0))?(e.positionAlign=ib[h],e.lineAlign=tb[h],e.textAlign=Nu[h.toUpperCase()]):e.textAlign=sr,(h=kt(i,r,a,"displayAlign",!0))&&(e.displayAlign=qf[h.toUpperCase()]),(h=kt(i,r,a,"color",l))&&(e.color=h),(h=kt(i,r,a,"backgroundColor",l))&&(e.backgroundColor=h),(h=kt(i,r,a,"border",l))&&(e.border=h),h=kt(i,r,a,"fontFamily",l))switch(h){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=h}if((h=kt(i,r,a,"fontWeight",l))&&h=="bold"&&(e.fontWeight=700),h=kt(i,r,a,"wrapOption",l),e.wrapLine=!(h&&h=="noWrap"),(h=kt(i,r,a,"lineHeight",l))&&h.match(xs)&&(e.lineHeight=h),(h=kt(i,r,a,"fontSize",l))&&(h.match(xs)||h.match(eb))&&(e.fontSize=h),(h=kt(i,r,a,"fontStyle",l))&&(e.fontStyle=Zf[h.toUpperCase()]),s){h=s.getAttribute("imageType")||s.getAttribute("imagetype");var d=s.getAttribute("encoding");s=s.textContent.trim(),h=="PNG"&&d=="Base64"&&s&&(e.backgroundImage="data:image/png;base64,"+s)}(s=kt(i,r,a,"textOutline",l))&&(s=s.split(" "),s[0].match(xs)?e.textStrokeColor=e.color:(e.textStrokeColor=s[0],s.shift()),s[0]&&s[0].match(xs)?e.textStrokeWidth=s[0]:e.textStrokeColor=""),(s=kt(i,r,a,"letterSpacing",l))&&s.match(xs)&&(e.letterSpacing=s),(s=kt(i,r,a,"linePadding",l))&&s.match(xs)&&(e.linePadding=s),(l=kt(i,r,a,"opacity",l))&&(e.opacity=parseFloat(l)),(r=jl(r,a,"textDecoration"))&&Ix(e,r),(i=yd(i,a,"textDecoration"))&&Ix(e,i)}function Ix(e,i){i=y(i.split(" "));for(var r=i.next();!r.done;r=i.next())switch(r.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&gt(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&gt(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&gt(e.textDecoration,"overline")}}function kt(e,i,r,s,a){return a=a===void 0?!0:a,(e=yd(e,r,s))?e:a?jl(i,r,s):null}function jl(e,i,r){if(!e)return null;var s=hr(e,Vl,r);return s||Rx(e,i,r)}function yd(e,i,r){var s=hr(e,Vl,r);return s||Rx(e,i,r)}function Rx(e,i,r){e=Hl(e,"style",i,"");for(var s=null,a=0;a<e.length;a++){var l=on(e[a],"urn:ebu:tt:style",r);l||(l=hr(e[a],Vl,r)),l||(l=yd(e[a],i,r)),l&&(s=l)}return s}function Hl(e,i,r,s,a){var l=[];if(!e||1>r.length)return l;var h=e;for(e=null;h&&!(e=a?on(h,a,i):h.getAttribute(i))&&(h=h.parentNode,h instanceof Element););if(i=e){for(i=y(i.split(" ")),a=i.next();!a.done;a=i.next())for(a=a.value,e=y(r),h=e.next();!h.done;h=e.next())if(h=h.value,s+h.getAttribute("xml:id")==a){l.push(h);break}}return l}function QE(e,i,r,s){return e=Lx(e,i),r==null?r=e.start:e.start!=null&&(r+=e.start),s==null?s=e.end:e.start!=null&&(s+=e.start),{start:r,end:s}}function Lx(e,i){var r=xd(e.getAttribute("begin"),i),s=xd(e.getAttribute("end"),i);return e=xd(e.getAttribute("dur"),i),s==null&&e!=null&&(s=r+e),{start:r,end:s}}function xd(e,i){var r=null;if(Mx.test(e)){e=Mx.exec(e),r=Number(e[1]);var s=Number(e[2]),a=Number(e[3]),l=Number(e[4]);l+=(Number(e[5])||0)/i.h,a+=l/i.frameRate,r=a+60*s+3600*r}else if(Px.test(e))r=vd(Px,e);else if(kx.test(e))r=vd(kx,e);else if(Ox.test(e))e=Ox.exec(e),r=Number(e[1])/i.frameRate;else if(Dx.test(e))e=Dx.exec(e),r=Number(e[1])/i.g;else if(Fx.test(e))r=vd(Fx,e);else if(e)throw new F(2,2,2001,"Could not parse cue time range in TTML");return r}function vd(e,i){return e=e.exec(i),e==null||e[0]==""?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}ie("shaka.text.TtmlTextParser",xi),xi.prototype.parseMedia=xi.prototype.parseMedia,xi.prototype.setSequenceMode=xi.prototype.setSequenceMode,xi.prototype.parseInit=xi.prototype.parseInit;function JE(e,i,r,s){this.frameRate=Number(e)||30,this.h=Number(i)||1,this.g=Number(s),this.g==0&&(this.g=e?this.frameRate*this.h:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))}var wd=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,eb=/^(\d{1,2}(?:\.\d+)?|100)%$/,xs=/^(\d+px|\d+em|\d*\.?\d+c)$/,Td=/^(\d+)px (\d+)px$/,Mx=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Px=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,kx=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Ox=/^(\d*(?:\.\d*)?)f$/,Dx=/^(\d*(?:\.\d*)?)t$/,Fx=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),tb={left:Yr,center:"center",right:"end",start:Yr,end:"end"},ib={left:"line-left",center:"center",right:"line-right"},Ro=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],Vl=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],rb=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];wt["application/ttml+xml"]=function(){return new xi};function Xt(){this.g=new xi}Xt.prototype.parseInit=function(e){var i=!1;if(new qe().box("moov",rt).box("trak",rt).box("mdia",rt).box("minf",rt).box("stbl",rt).P("stsd",$s).box("stpp",function(r){i=!0,r.parser.stop()}).parse(e),!i)throw new F(2,2,2007)},Xt.prototype.setSequenceMode=function(){},Xt.prototype.parseMedia=function(e,i){var r=this,s=!1,a=[];if(new qe().box("mdat",es(function(l){s=!0,a=a.concat(r.g.parseMedia(l,i))})).parse(e,!1),!s)throw new F(2,2,2007);return a},ie("shaka.text.Mp4TtmlParser",Xt),Xt.prototype.parseMedia=Xt.prototype.parseMedia,Xt.prototype.setSequenceMode=Xt.prototype.setSequenceMode,Xt.prototype.parseInit=Xt.prototype.parseInit,wt['application/mp4; codecs="stpp"']=function(){return new Xt},wt['application/mp4; codecs="stpp.ttml"']=function(){return new Xt},wt['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new Xt},wt['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new Xt};function qt(){this.g=!1}qt.prototype.parseInit=function(){},qt.prototype.setSequenceMode=function(e){this.g=e},qt.prototype.parseMedia=function(e,i){e=at(e),e=e.replace(/\r\n|\r(?=[^\n]|$)/gm,`
`);var r=e.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(r[0]))throw new F(2,2,2e3);if(e=i.vttOffset,r[0].includes("X-TIMESTAMP-MAP")&&this.g){var s=r[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=r[0].match(/MPEGTS:(\d+)/m);if(s&&a){if(e=Gl(new gn(s[1])),e==null)throw new F(2,2,2e3);for(a=Number(a[1]),s=i.segmentStart-i.periodStart;95443.7176888889<=s;)s-=95443.7176888889,a+=8589934592;e=i.periodStart+a/9e4-e}}for(i=[],a=y(r[0].split(`
`)),s=a.next();!s.done;s=a.next())if(s=s.value,/^Region:/.test(s)){s=new gn(s);var l=new zn;mn(s),ms(s);for(var h=mn(s);h;){var d=l,g=h;(h=/^id=(.*)$/.exec(g))?d.id=h[1]:(h=/^width=(\d{1,2}|100)%$/.exec(g))?d.width=Number(h[1]):(h=/^lines=(\d+)$/.exec(g))?(d.height=Number(h[1]),d.heightUnits=2):(h=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(g))?(d.regionAnchorX=Number(h[1]),d.regionAnchorY=Number(h[2])):(h=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(g))?(d.viewportAnchorX=Number(h[1]),d.viewportAnchorY=Number(h[2])):/^scroll=up$/.exec(g)&&(d.scroll="up"),ms(s),h=mn(s)}i.push(l)}for(a=new Map,Nx(a),s=[],r=y(r.slice(1)),l=r.next();!l.done;l=r.next()){if(l=l.value.split(`
`),(l.length!=1||l[0])&&!/^NOTE($|[ \t])/.test(l[0])&&l[0]=="STYLE"){for(d=[],h=-1,g=1;g<l.length;g++)l[g].includes("::cue")&&(d.push([]),h=d.length-1),h!=-1&&(d[h].push(l[g]),l[g].includes("}")&&(h=-1));for(d=y(d),h=d.next();!h.done;h=d.next()){var _=h.value;h="global",(g=_[0].match(/\((.*)\)/))&&(h=g.pop()),g=_.slice(1,-1),_[0].includes("}")&&(_=/\{(.*?)\}/.exec(_[0]))&&(g=_[1].split(";")),(_=a.get(h))||(_=new Le(0,0,""));for(var x=!1,T=0;T<g.length;T++){var S=/^\s*([^:]+):\s*(.*)/.exec(g[T]);if(S){var A=S[2].trim().replace(";","");switch(S[1].trim()){case"background-color":case"background":x=!0,_.backgroundColor=A;break;case"color":x=!0,_.color=A;break;case"font-family":x=!0,_.fontFamily=A;break;case"font-size":x=!0,_.fontSize=A;break;case"font-weight":(700<=parseInt(A,10)||A=="bold")&&(x=!0,_.fontWeight=700);break;case"font-style":switch(A){case"normal":x=!0,_.fontStyle=ju;break;case"italic":x=!0,_.fontStyle="italic";break;case"oblique":x=!0,_.fontStyle="oblique"}break;case"opacity":x=!0,_.opacity=parseFloat(A);break;case"text-shadow":x=!0,_.textShadow=A;break;case"white-space":x=!0,_.wrapLine=A!="noWrap"}}}x&&a.set(h,_)}}if(x=e,l.length==1&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||l[0]=="STYLE"||l[0]=="REGION")l=null;else{if(d=null,l[0].includes("-->")||(d=l[0],l.splice(0,1)),h=new gn(l[0]),g=Gl(h),T=Ur(h,/[ \t]+--\x3e[ \t]+/g),_=Gl(h),g==null||T==null||_==null)throw new F(2,2,2001,"Could not parse cue time range in WebVTT");for(g+=x,_+=x,x=l.slice(1).join(`
`).trim(),a.has("global")?(l=a.get("global").clone(),l.startTime=g,l.endTime=_,l.payload=""):l=new Le(g,_,""),Ux(x,l,a),ms(h),g=mn(h);g;)Bx(l,g,i),ms(h),g=mn(h);d!=null&&(l.id=d)}l&&s.push(l)}return s};function Nx(e){for(var i=y(Object.entries($f)),r=i.next();!r.done;r=i.next()){var s=y(r.value);r=s.next().value,s=s.next().value;var a=new Le(0,0,"");a.color=s,e.set("."+r,a)}for(i=y(Object.entries(Yf)),r=i.next();!r.done;r=i.next())s=y(r.value),r=s.next().value,s=s.next().value,a=new Le(0,0,""),a.backgroundColor=s,e.set("."+r,a)}function Ux(e,i,r){r.size===0&&Nx(r);e:{var s=e;e=[];for(var a=-1,l="",h=0;h<s.length;h++)if(s[h]==="/"&&0<h&&s[h-1]==="<"){var d=s.indexOf(">",h);if(d<=h){e=s;break e}if((d=s.substring(h+1,d))&&d==="c"){var g=e.pop();g?g===d?(l+="/"+d+">",h+=d.length+1):g.startsWith("c.")?(h+=d.length+1,l+="/"+g+">"):l+=s[h]:l+=s[h]}else l+=s[h]}else s[h]==="<"?(a=h+1,s[a]!="c"&&(a=-1)):s[h]===">"&&0<a&&(e.push(s.substr(a,h-a)),a=-1),l+=s[h];e=l}for(s=[],l=-1,a=0;a<e.length;a++)e[a]==="<"?l=a+1:e[a]===">"&&0<l&&(l=e.substr(l,a-l),l.match(jx)&&s.push(l),l=-1);for(s=y(s),a=s.next();!a.done;a=s.next())a=a.value,e=e.replace("<"+a+">",'<div time="'+a+'">'),e+="</div>";e:{for(a=e,l=[],h=-1,s="",e=!1,d=0;d<a.length;d++)if(a[d]==="/"){if(g=a.indexOf(">",d),g===-1){e=a;break e}if((g=a.substring(d+1,g))&&g=="v"){e=!0;var _=null;if(l.length&&(_=l[l.length-1]),_){if(_===g)s+="/"+g+">";else{if(!_.startsWith("v")){s+=a[d];continue}s+="/"+_+">"}d+=g.length+1}else s+=a[d]}else s+=a[d]}else a[d]==="<"?(h=d+1,a[h]!="v"&&(h=-1)):a[d]===">"&&0<h&&(l.push(a.substr(h,d-h)),h=-1),s+=a[d];for(a=y(l),l=a.next();!l.done;l=a.next())l=l.value,h=l.replace(" ",".voice-"),s=s.replace("<"+l+">","<"+h+">"),s=s.replace("</"+l+">","</"+h+">"),e||(s+="</"+h+">");e=s}if(a=Zs("<span>"+e+"</span>","span")){if(s=[],a=a.childNodes,a.length==1&&(l=a[0],l.nodeType==Node.TEXT_NODE||l.nodeType==Node.CDATA_SECTION_NODE)){i.payload=Sd(e);return}for(e=y(a),a=e.next();!a.done;a=e.next())zx(a.value,i,s,r);i.nestedCues=s}else i.payload=Sd(e)}function Wl(e,i){return e&&0<e.length?e:i}function zx(e,i,r,s){var a=i.clone();if(e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var l=y(e.nodeName.split(/(?=[ .])+/g)),h=l.next();!h.done;h=l.next()){var d=h=h.value;if(d.startsWith(".voice-")){var g=d.split("-").pop();d='v[voice="'+g+'"]',s.has(d)||(d="v[voice="+g+"]")}switch(s.has(d)&&(d=s.get(d))&&(a.backgroundColor=Wl(d.backgroundColor,a.backgroundColor),a.color=Wl(d.color,a.color),a.fontFamily=Wl(d.fontFamily,a.fontFamily),a.fontSize=Wl(d.fontSize,a.fontSize),a.fontWeight=d.fontWeight,a.fontStyle=d.fontStyle,a.opacity=d.opacity,a.wrapLine=d.wrapLine),h){case"br":h=i.clone(),h.lineBreak=!0,r.push(h);break;case"b":a.fontWeight=700;break;case"i":a.fontStyle="italic";break;case"u":a.textDecoration.push("underline");break;case"div":(h=e.getAttribute("time"))&&(h=Gl(new gn(h)))&&(a.startTime=h)}}if(Zp(e))for(l=!0,s=y(e.textContent.split(`
`)),e=s.next();!e.done;e=s.next())e=e.value,l||(l=i.clone(),l.lineBreak=!0,r.push(l)),0<e.length&&(l=a.clone(),l.payload=Sd(e),r.push(l)),l=!1;else for(i=y(e.childNodes),e=i.next();!e.done;e=i.next())zx(e.value,a,r,s)}function Bx(e,i,r){var s;(s=/^align:(start|middle|center|end|left|right)$/.exec(i))?(i=s[1],i=="middle"?e.textAlign=sr:e.textAlign=Nu[i.toUpperCase()]):(s=/^vertical:(lr|rl)$/.exec(i))?e.writingMode=s[1]=="lr"?"vertical-lr":"vertical-rl":(s=/^size:([\d.]+)%$/.exec(i))?e.size=Number(s[1]):(s=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(i))?(e.position=Number(s[1]),s[2]&&(i=s[2],e.positionAlign=i=="line-left"||i=="start"?"line-left":i=="line-right"||i=="end"?"line-right":"center")):(s=/^region:(.*)$/.exec(i))?(i=nb(r,s[1]))&&(e.region=i):(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(i))?(e.lineInterpretation=1,e.line=Number(r[1]),r[2]&&(e.lineAlign=Bu[r[2].toUpperCase()])):(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(i))&&(e.lineInterpretation=zu,e.line=Number(r[1]),r[2]&&(e.lineAlign=Bu[r[2].toUpperCase()]))}function nb(e,i){return e=e.filter(function(r){return r.id==i}),e.length?e[0]:null}function Gl(e){if(e=Ur(e,jx),e==null)return null;var i=Number(e[2]),r=Number(e[3]);return 59<i||59<r?null:Number(e[4])/1e3+r+60*i+3600*(Number(e[1])||0)}function Sd(e){var i={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":"","&lrm;":"","&rlm;":""},r=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,s=RegExp(r.source);return e&&s.test(e)?e.replace(r,function(a){return i[a]||"'"}):e||""}ie("shaka.text.VttTextParser",qt),qt.prototype.parseMedia=qt.prototype.parseMedia,qt.prototype.setSequenceMode=qt.prototype.setSequenceMode,qt.prototype.parseInit=qt.prototype.parseInit;var jx=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;wt["text/vtt"]=function(){return new qt},wt['text/vtt; codecs="vtt"']=function(){return new qt},wt['text/vtt; codecs="wvtt"']=function(){return new qt};function Oi(){this.g=null}Oi.prototype.parseInit=function(e){var i=this,r=!1;if(new qe().box("moov",rt).box("trak",rt).box("mdia",rt).P("mdhd",function(s){s=wh(s.reader,s.version),i.g=s.timescale}).box("minf",rt).box("stbl",rt).P("stsd",$s).box("wvtt",function(){r=!0}).parse(e),!this.g)throw new F(2,2,2008);if(!r)throw new F(2,2,2008)},Oi.prototype.setSequenceMode=function(){},Oi.prototype.parseMedia=function(e,i){if(!this.g)throw new F(2,2,2008);var r=0,s=[],a,l=[],h=!1,d=!1,g=!1,_=null;if(new qe().box("moof",rt).box("traf",rt).P("tfdt",function(D){h=!0,r=Og(D.reader,D.version).we}).P("tfhd",function(D){_=kg(D.reader,D.flags).Ce}).P("trun",function(D){d=!0,s=Dg(D.reader,D.version,D.flags).Re}).box("mdat",es(function(D){g=!0,a=D})).parse(e,!1),!g&&!h&&!d)throw new F(2,2,2008);e=r;for(var x=new Be(a,0),T=y(s),S=T.next();!S.done;S=T.next()){S=S.value;var A=S.ee||_,M=S.ed?r+S.ed:e;e=M+(A||0);var O=0;do{var P=x.K();O+=P;var k=x.K(),z=null;Aa(k)=="vttc"?8<P&&(z=x.Za(P-8)):x.skip(P-8),A&&z&&(P=sb(z,i.periodStart+M/this.g,i.periodStart+e/this.g),l.push(P))}while(S.sampleSize&&O<S.sampleSize)}return l.filter(Rr)};function sb(e,i,r){var s,a,l;return new qe().box("payl",es(function(h){s=at(h)})).box("iden",es(function(h){a=at(h)})).box("sttg",es(function(h){l=at(h)})).parse(e),s?ob(s,a,l,i,r):null}function ob(e,i,r,s,a){if(s=new Le(s,a,""),Ux(e,s,new Map),i&&(s.id=i),r)for(e=new gn(r),i=mn(e);i;)Bx(s,i,[]),ms(e),i=mn(e);return s}ie("shaka.text.Mp4VttParser",Oi),Oi.prototype.parseMedia=Oi.prototype.parseMedia,Oi.prototype.setSequenceMode=Oi.prototype.setSequenceMode,Oi.prototype.parseInit=Oi.prototype.parseInit,wt['application/mp4; codecs="wvtt"']=function(){return new Oi};function Di(){}Di.prototype.parseInit=function(){},Di.prototype.setSequenceMode=function(){},Di.prototype.parseMedia=function(e){var i=at(e).replace(/\r+/g,"");if(i=i.trim(),e=[],i=="")return e;i=y(i.split(`

`));for(var r=i.next();!r.done;r=i.next()){r=r.value.split(`
`);var s=new gn(r[0]),a=Hx(s),l=Ur(s,/,/g);if(s=Hx(s),a==null||l==null||s==null)throw new F(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new Le(a,s,r.slice(1).join(`
`).trim()))}return e};function Hx(e){if(e=Ur(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g),e==null)return null;var i=Number(e[2]),r=Number(e[3]);return 59<i||59<r?null:Number(e[4])/1e3+r+60*i+3600*(Number(e[1])||0)}ie("shaka.text.SbvTextParser",Di),Di.prototype.parseMedia=Di.prototype.parseMedia,Di.prototype.setSequenceMode=Di.prototype.setSequenceMode,Di.prototype.parseInit=Di.prototype.parseInit,wt["text/x-subviewer"]=function(){return new Di};function vi(){this.g=new qt}vi.prototype.parseInit=function(){},vi.prototype.setSequenceMode=function(){},vi.prototype.parseMedia=function(e,i){return e=at(e),e=Vx(e),e=Ie(Mr(e)),this.g.parseMedia(e,i)};function Vx(e){var i=`WEBVTT

`;if(e=="")return i;e=e.replace(/\r+/g,""),e=e.trim(),e=y(e.split(`

`));for(var r=e.next();!r.done;r=e.next())r=r.value.split(/\n/),r[0].match(/\d+/)&&r.shift(),r[0]=r[0].replace(/,/g,"."),i+=r.join(`
`)+`

`;return i}ie("shaka.text.SrtTextParser",vi),vi.srt2webvtt=Vx,vi.prototype.parseMedia=vi.prototype.parseMedia,vi.prototype.setSequenceMode=vi.prototype.setSequenceMode,vi.prototype.parseInit=vi.prototype.parseInit,wt["text/srt"]=function(){return new vi};function Fi(){}Fi.prototype.parseInit=function(){},Fi.prototype.setSequenceMode=function(){},Fi.prototype.parseMedia=function(e){var i="",r="";e=at(e).split(/\r?\n\s*\r?\n/),e=y(e);for(var s=e.next();!s.done;s=e.next()){var a=lb.exec(s.value);a&&(s=a[1],a=a[2],s=="V4 Styles"||s=="V4+ Styles"?i=a:s=="Events"&&(r=a))}e=[],s=null,i=y(i.split(/\r?\n/));for(var l=i.next();!l.done;l=i.next())if(a=l.value,!/^\s*;/.test(a)&&(l=Xx.exec(a))){if(a=l[1].trim(),l=l[2].trim(),a=="Format")s=l.split(Xl);else if(a=="Style"){a=l.split(Xl),l={};for(var h=0;h<s.length&&h<a.length;h++)l[s[h]]=a[h];e.push(l)}}for(s=[],i=null,a={},r=y(r.split(/\r?\n/)),l=r.next();!l.done;a={vd:a.vd},l=r.next())if(l=l.value,!/^\s*;/.test(l)&&(h=Xx.exec(l))){if(l=h[1].trim(),h=h[2].trim(),l=="Format")i=h.split(Xl);else if(l=="Dialogue"){h=h.split(Xl),l={};for(var d=0;d<i.length&&d<h.length;d++)l[i[d]]=h[d];d=Gx(l.Start);var g=Gx(l.End);h=new Le(d,g,h.slice(i.length-1).join(",").replace(/\\N/g,`
`).replace(/\{[^}]+\}/g,"")),a.vd=l.Style,(l=e.find(function(_){return function(x){return x.Name==_.vd}}(a)))&&ab(h,l),s.push(h)}}return s};function ab(e,i){var r=i.Fontname;if(r&&(e.fontFamily=r),(r=i.Fontsize)&&(e.fontSize=r+"px"),(r=i.PrimaryColour)&&(r=Wx(r))&&(e.color=r),(r=i.BackColour)&&(r=Wx(r))&&(e.backgroundColor=r),i.Bold&&(e.fontWeight=700),i.Italic&&(e.fontStyle="italic"),i.Underline&&e.textDecoration.push("underline"),(r=i.Spacing)&&(e.letterSpacing=r+"px"),r=i.Alignment)switch(parseInt(r,10)){case 1:e.displayAlign=Ps,e.textAlign="start";break;case 2:e.displayAlign=Ps,e.textAlign=sr;break;case 3:e.displayAlign=Ps,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=sr;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=sr;break;case 11:e.displayAlign="center",e.textAlign="end"}(i=i.AlphaLevel)&&(e.opacity=parseFloat(i))}function Wx(e){return e=parseInt(e.replace("&H",""),16),0<=e?"rgba("+(e&255)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function Gx(e){return e=ub.exec(e),3600*(e[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}ie("shaka.text.SsaTextParser",Fi),Fi.prototype.parseMedia=Fi.prototype.parseMedia,Fi.prototype.setSequenceMode=Fi.prototype.setSequenceMode,Fi.prototype.parseInit=Fi.prototype.parseInit;var lb=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,Xx=/^\s*([^:]+):\s*(.*)/,Xl=/\s*,\s*/,ub=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;wt["text/x-ssa"]=function(){return new Fi};/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/function qx(){}var Lo;function $x(){Lo?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Lo=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=hb):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function hb(e,i){var r=this,s;return B(function(a){return a.g==1?(console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),b(a,Lo.call(r,e,i),2)):(s=a.h,iv(s)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Lo,a.return(s)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=Yx,a.return(Yx.call(r,e,i))))})}function Yx(e,i){var r=this,s,a,l,h,d,g,_,x,T,S;return B(function(A){if(A.g==1){for(console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),s=tv(e),a=[],l=y(i),h=l.next();!h.done;h=l.next())d=h.value,g=Kx(d.videoCapabilities,s),_=Kx(d.audioCapabilities,s),d.videoCapabilities&&d.videoCapabilities.length&&!g.length||d.audioCapabilities&&d.audioCapabilities.length&&!_.length||(x=Object.assign({},d),x.videoCapabilities=g,x.audioCapabilities=_,a.push(x));if(!a.length)throw T=Error("Unsupported keySystem or supportedConfigurations."),T.name="NotSupportedError",T.code=DOMException.NOT_SUPPORTED_ERR,T;return b(A,Lo.call(r,e,a),2)}return S=A.h,A.return(new ql(S,s))})}function Kx(e,i){return e&&e.filter(function(r){return!r.encryptionScheme||r.encryptionScheme==i})}ie("EmeEncryptionSchemePolyfill",qx),qx.install=$x;function Zx(){}var Mo;function Qx(){Mo?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Mo=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=cb):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function cb(e){var i=this,r,s,a;return B(function(l){switch(l.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),b(l,Mo.call(i,e),2);case 2:if(r=l.h,!e.keySystemConfiguration)return l.return(r);if((s=r.keySystemAccess)&&iv(s))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Mo,l.return(r);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Jx,s){l.A(3);break}return a=r,b(l,ev(e),4);case 4:return a.keySystemAccess=l.h,l.return(r);case 3:return l.return(Jx.call(i,e))}})}function Jx(e){var i=this,r,s,a,l,h,d,g,_;return B(function(x){switch(x.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),r=null,e.keySystemConfiguration&&(s=e.keySystemConfiguration,a=s.keySystem,l=s.audio&&s.audio.encryptionScheme,h=s.video&&s.video.encryptionScheme,r=tv(a),d={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},l&&l!=r||h&&h!=r)?x.return(d):b(x,Mo.call(i,e),2);case 2:if(g=x.h,g.keySystemAccess){g.keySystemAccess=new ql(g.keySystemAccess,r),x.A(3);break}if(!e.keySystemConfiguration){x.A(3);break}return _=g,b(x,ev(e),5);case 5:_.keySystemAccess=x.h;case 3:return x.return(g)}})}function ev(e){var i,r;return B(function(s){if(s.g==1){var a=e.keySystemConfiguration,l=[],h=[];return a.audio&&l.push({robustness:a.audio.robustness||"",contentType:e.audio.contentType}),a.video&&h.push({robustness:a.video.robustness||"",contentType:e.video.contentType}),a={initDataTypes:a.initDataType?[a.initDataType]:[],distinctiveIdentifier:a.distinctiveIdentifier,persistentState:a.persistentState,sessionTypes:a.sessionTypes},l.length&&(a.audioCapabilities=l),h.length&&(a.videoCapabilities=h),i=a,b(s,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[i]),2)}return r=s.h,s.return(r)})}ie("McEncryptionSchemePolyfill",Zx),Zx.install=Qx;function ql(e,i){this.h=e,this.g=i,this.keySystem=e.keySystem}ql.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var i=y(e.videoCapabilities),r=i.next();!r.done;r=i.next())r.value.encryptionScheme=this.g;if(e.audioCapabilities)for(i=y(e.audioCapabilities),r=i.next();!r.done;r=i.next())r.value.encryptionScheme=this.g;return e},ql.prototype.createMediaKeys=function(){return this.h.createMediaKeys()};function tv(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function iv(e){e=e.getConfiguration();var i=e.audioCapabilities&&e.audioCapabilities[0];return!!((e=e.videoCapabilities&&e.videoCapabilities[0]||i)&&e.encryptionScheme!==void 0)}function Cd(){}function rv(){$x(),Qx()}ie("EncryptionSchemePolyfills",Cd),Cd.install=rv,typeof m<"u"&&m.exports&&(m.exports=Cd)}).call(n,t,t,void 0);for(var o in n.shaka)c[o]=n.shaka[o]})()})(ww);const iM=A0(ww);class rM extends J.Component{constructor(){super(...arguments),this.videoUrl="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",this.index=1,this.contentId="",this._isPlaying=!0,this._toggleUI=()=>{this.tag("Wrapper").setSmooth("alpha",1);const t=qo.setTimeout(()=>{this.tag("Wrapper").setSmooth("alpha",0),qo.clearTimeout(t)},4e3)},this._loadPlayback=async(t,n)=>{this._setupShakaPlayer(n),await this._player.load(t),this._toggleUI()},this._unloadPlayback=async()=>{await this._player.unload()}}static _template(){return{Wrapper:{alpha:1,BackButton:{x:40,y:40,zIndex:99,type:ku},PlayPause:{type:zL}}}}set params(t){const{id:n}=t;this.contentId=n}_firstActive(){xn.consumer(this),xn.loader(this._loadPlayback),xn.unloader(this._unloadPlayback),this._toggleUI()}_init(){}_active(){xn.open(this.videoUrl),this._toggleUI()}_inactive(){xn.close()}_handleUp(){this.index>0&&(this.index-=1),this._toggleUI()}_handleDown(){this.index<1&&(this.index+=1),this._toggleUI()}_handleEnter(){if(this.index===0)Bt.navigate(`content/railItem/${this.contentId}`);else if(this.index===1){const t=this.tag("PlayPause");t.isPlaying=!t.isPlaying,t.isPlaying?xn.play():xn.pause()}this._toggleUI()}_getFocused(){return this.tag("Wrapper").children[this.index]}_setupShakaPlayer(t){t.autoplay=!0,this._player=new iM.Player(t),console.log(this._player)}}class nM extends J.Component{constructor(){super(...arguments),this.data={}}static _template(){return{rect:!0,color:ee.colors.primary,shader:{type:J.shaders.RoundedRectangle,radius:20},Image:{shader:{type:J.shaders.RoundedRectangle,radius:20}},Label:{x:10,y:435,w:t=>t,color:ee.colors.accentGrey.light,text:{fontSize:30}}}}set item(t){const{label:n,src:o,data:u}=t;this.data=u,this.patch({Image:{src:o},Label:{text:n==null?void 0:n.toString()}})}_handleEnter(){Bt.navigate(`content/gridItem/${this.data.uid}`,{contentData:this.data,from:"Grid"})}_focus(){this.patch({smooth:{color:ee.colors.secondary,scale:1.1},Label:{smooth:{color:ee.colors.white}},Rectangle:{color:ee.colors.yellow,x:10,y:t=>t+72,w:t=>t-20,h:5,rect:!0}})}_unfocus(){this.patch({smooth:{color:ee.colors.primary,scale:1},Label:{smooth:{color:ee.colors.accentGrey.light}},Rectangle:void 0})}}class sM extends J.Component{constructor(){super(...arguments),this.index=1,this.data=[],this.dataLength=0,this.intervalSub=0,this.isLoading=!0}static _template(){return{w:1920,h:1080,color:ee.colors.primaryLight,rect:!0,shader:{x:100,y:-100,pivot:.5,type:J.shaders.RadialGradient,outerColor:ee.colors.primaryLight,innerColor:ee.colors.dark,radius:800},BackButton:{x:40,y:40,shader:null,type:ku},Content:{Grid:{x:110,y:200,columns:5,spacing:160,crossSpacing:50,itemType:nM,type:WL}}}}_init(){this.setLongRail()}async setLongRail(){var n,o,u;this.isLoading=!0,this.data=await bf.get("longData"),this.dataLength=this.data.length;const t=[];for(let f=0;f<this.dataLength;f++){let m=(n=this.data[f])==null?void 0:n.title,p=(u=(o=this.data[f])==null?void 0:o.images.find(v=>v.width===288))==null?void 0:u.url;t.push({w:288,h:432,item:{label:m,src:p||"https://pmd205470tn-a.akamaihd.net/D2C_-_Content/191/249/oyPcsfGWL5Se6RGW1JCVgpHlASH_288x432_13635141800.jpg",data:this.data[f]}})}this.tag("Grid").add(t.map(f=>f)),this.isLoading=!1}_getFocused(){return this.index===0?this.tag("BackButton"):this.tag("Grid")}_handleUp(){this.index>0&&(this.index-=1)}_handleDown(){this.index<1&&(this.index+=1)}_handleEnter(){this.index===0&&Bt.navigate("home")}}const oM={root:"home",routes:[{path:"home",component:Wv},{path:"search",component:ZL},{path:"grid",component:sM},{path:"settings",component:Wv},{path:"content/:from/:id",component:tM,options:{reuseInstance:!1}},{path:"player/:id",component:rM}]};class aM extends Bt.App{_setup(){Bt.startRouter(oM,this)}static getFonts(){return[{family:"Saira Regular",url:Xo.proxyUrl("fonts/Saira-VariableFont_wdth,wght.ttf")},{family:"Saira Italics",url:Xo.proxyUrl("fonts/Saira-Italic-VariableFont_wdth,wght.ttf")}]}}const lM=SR(aM,{stage:{pauseRafLoopOnIdle:!0,fontSharp:!0},debug:!0,enablePointer:!0,keys:{38:"Up",40:"Down",37:"Left",39:"Right",13:"Enter",8:"Back",27:"Exit"}},{}),uM=lM.stage.getCanvas();document.body.appendChild(uM);export{hM as __vite_legacy_guard};
//# sourceMappingURL=index-60c43c70.js.map
